var MusicLab=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=100)}([function(e,t){e.exports=React},function(e,t,n){"use strict";function r(){}n.r(t),n.d(t,"WebGLMultisampleRenderTarget",function(){return dn}),n.d(t,"WebGLRenderTargetCube",function(){return fn}),n.d(t,"WebGLRenderTarget",function(){return pn}),n.d(t,"WebGLRenderer",function(){return Pa}),n.d(t,"ShaderLib",function(){return Ln}),n.d(t,"UniformsLib",function(){return Rn}),n.d(t,"UniformsUtils",function(){return Pn}),n.d(t,"ShaderChunk",function(){return wn}),n.d(t,"FogExp2",function(){return Aa}),n.d(t,"Fog",function(){return Oa}),n.d(t,"Scene",function(){return Ca}),n.d(t,"Sprite",function(){return ka}),n.d(t,"LOD",function(){return Na}),n.d(t,"SkinnedMesh",function(){return za}),n.d(t,"Skeleton",function(){return Da}),n.d(t,"Bone",function(){return Ba}),n.d(t,"Mesh",function(){return Lr}),n.d(t,"LineSegments",function(){return Ua}),n.d(t,"LineLoop",function(){return Va}),n.d(t,"Line",function(){return Fa}),n.d(t,"Points",function(){return Ga}),n.d(t,"Group",function(){return pa}),n.d(t,"VideoTexture",function(){return Wa}),n.d(t,"DataTexture",function(){return mn}),n.d(t,"DataTexture2DArray",function(){return Wr}),n.d(t,"DataTexture3D",function(){return qr}),n.d(t,"CompressedTexture",function(){return qa}),n.d(t,"CubeTexture",function(){return Gr}),n.d(t,"CanvasTexture",function(){return Xa}),n.d(t,"DepthTexture",function(){return Ya}),n.d(t,"Texture",function(){return un}),n.d(t,"AnimationLoader",function(){return Fs}),n.d(t,"CompressedTextureLoader",function(){return Us}),n.d(t,"DataTextureLoader",function(){return Vs}),n.d(t,"CubeTextureLoader",function(){return Gs}),n.d(t,"TextureLoader",function(){return Ws}),n.d(t,"ObjectLoader",function(){return Cc}),n.d(t,"MaterialLoader",function(){return Tc}),n.d(t,"BufferGeometryLoader",function(){return Ac}),n.d(t,"DefaultLoadingManager",function(){return Ds}),n.d(t,"LoadingManager",function(){return zs}),n.d(t,"ImageLoader",function(){return Hs}),n.d(t,"ImageBitmapLoader",function(){return jc}),n.d(t,"FontLoader",function(){return Hc}),n.d(t,"FileLoader",function(){return js}),n.d(t,"Loader",function(){return Gc}),n.d(t,"LoaderUtils",function(){return Pc}),n.d(t,"Cache",function(){return Ns}),n.d(t,"AudioLoader",function(){return nl}),n.d(t,"SpotLightShadow",function(){return yc}),n.d(t,"SpotLight",function(){return bc}),n.d(t,"PointLight",function(){return _c}),n.d(t,"RectAreaLight",function(){return Sc}),n.d(t,"HemisphereLight",function(){return gc}),n.d(t,"DirectionalLightShadow",function(){return xc}),n.d(t,"DirectionalLight",function(){return Ec}),n.d(t,"AmbientLight",function(){return Mc}),n.d(t,"LightShadow",function(){return vc}),n.d(t,"Light",function(){return mc}),n.d(t,"StereoCamera",function(){return rl}),n.d(t,"PerspectiveCamera",function(){return fa}),n.d(t,"OrthographicCamera",function(){return wc}),n.d(t,"CubeCamera",function(){return il}),n.d(t,"ArrayCamera",function(){return ma}),n.d(t,"Camera",function(){return da}),n.d(t,"AudioListener",function(){return ol}),n.d(t,"PositionalAudio",function(){return cl}),n.d(t,"AudioContext",function(){return tl}),n.d(t,"AudioAnalyser",function(){return ll}),n.d(t,"Audio",function(){return sl}),n.d(t,"VectorKeyframeTrack",function(){return Ls}),n.d(t,"StringKeyframeTrack",function(){return Rs}),n.d(t,"QuaternionKeyframeTrack",function(){return Cs}),n.d(t,"NumberKeyframeTrack",function(){return As}),n.d(t,"ColorKeyframeTrack",function(){return Ps}),n.d(t,"BooleanKeyframeTrack",function(){return Ts}),n.d(t,"PropertyMixer",function(){return ul}),n.d(t,"PropertyBinding",function(){return Pl}),n.d(t,"KeyframeTrack",function(){return Ss}),n.d(t,"AnimationUtils",function(){return _s}),n.d(t,"AnimationObjectGroup",function(){return Al}),n.d(t,"AnimationMixer",function(){return Cl}),n.d(t,"AnimationClip",function(){return Is}),n.d(t,"Uniform",function(){return Rl}),n.d(t,"InstancedBufferGeometry",function(){return Ll}),n.d(t,"BufferGeometry",function(){return sr}),n.d(t,"Geometry",function(){return Xn}),n.d(t,"InterleavedBufferAttribute",function(){return La}),n.d(t,"InstancedInterleavedBuffer",function(){return Il}),n.d(t,"InterleavedBuffer",function(){return Ra}),n.d(t,"InstancedBufferAttribute",function(){return kl}),n.d(t,"Face3",function(){return Nn}),n.d(t,"Object3D",function(){return Hn}),n.d(t,"Raycaster",function(){return Nl}),n.d(t,"Layers",function(){return Dn}),n.d(t,"EventDispatcher",function(){return r}),n.d(t,"Clock",function(){return al}),n.d(t,"QuaternionLinearInterpolant",function(){return Os}),n.d(t,"LinearInterpolant",function(){return Es}),n.d(t,"DiscreteInterpolant",function(){return Ms}),n.d(t,"CubicInterpolant",function(){return xs}),n.d(t,"Interpolant",function(){return ws}),n.d(t,"Triangle",function(){return Cr}),n.d(t,"Math",function(){return Gt}),n.d(t,"Spherical",function(){return Bl}),n.d(t,"Cylindrical",function(){return jl}),n.d(t,"Plane",function(){return yn}),n.d(t,"Frustum",function(){return bn}),n.d(t,"Sphere",function(){return vn}),n.d(t,"Ray",function(){return Or}),n.d(t,"Matrix4",function(){return _n}),n.d(t,"Matrix3",function(){return Yt}),n.d(t,"Box3",function(){return gn}),n.d(t,"Box2",function(){return Fl}),n.d(t,"Line3",function(){return Ul}),n.d(t,"Euler",function(){return zn}),n.d(t,"Vector4",function(){return hn}),n.d(t,"Vector3",function(){return Xt}),n.d(t,"Vector2",function(){return Wt}),n.d(t,"Quaternion",function(){return qt}),n.d(t,"Color",function(){return On}),n.d(t,"ImmediateRenderObject",function(){return Vl}),n.d(t,"VertexNormalsHelper",function(){return Hl}),n.d(t,"SpotLightHelper",function(){return Gl}),n.d(t,"SkeletonHelper",function(){return Wl}),n.d(t,"PointLightHelper",function(){return ql}),n.d(t,"RectAreaLightHelper",function(){return Xl}),n.d(t,"HemisphereLightHelper",function(){return Yl}),n.d(t,"GridHelper",function(){return Kl}),n.d(t,"PolarGridHelper",function(){return $l}),n.d(t,"PositionalAudioHelper",function(){return Zl}),n.d(t,"FaceNormalsHelper",function(){return Jl}),n.d(t,"DirectionalLightHelper",function(){return Ql}),n.d(t,"CameraHelper",function(){return eu}),n.d(t,"BoxHelper",function(){return tu}),n.d(t,"Box3Helper",function(){return nu}),n.d(t,"PlaneHelper",function(){return ru}),n.d(t,"ArrowHelper",function(){return iu}),n.d(t,"AxesHelper",function(){return au}),n.d(t,"Shape",function(){return fc}),n.d(t,"Path",function(){return dc}),n.d(t,"ShapePath",function(){return Fc}),n.d(t,"Font",function(){return Uc}),n.d(t,"CurvePath",function(){return pc}),n.d(t,"Curve",function(){return qs}),n.d(t,"ImageUtils",function(){return cn}),n.d(t,"ShapeUtils",function(){return Do}),n.d(t,"WebGLUtils",function(){return ha}),n.d(t,"WireframeGeometry",function(){return Ka}),n.d(t,"ParametricGeometry",function(){return $a}),n.d(t,"ParametricBufferGeometry",function(){return Za}),n.d(t,"TetrahedronGeometry",function(){return eo}),n.d(t,"TetrahedronBufferGeometry",function(){return to}),n.d(t,"OctahedronGeometry",function(){return no}),n.d(t,"OctahedronBufferGeometry",function(){return ro}),n.d(t,"IcosahedronGeometry",function(){return io}),n.d(t,"IcosahedronBufferGeometry",function(){return ao}),n.d(t,"DodecahedronGeometry",function(){return oo}),n.d(t,"DodecahedronBufferGeometry",function(){return so}),n.d(t,"PolyhedronGeometry",function(){return Ja}),n.d(t,"PolyhedronBufferGeometry",function(){return Qa}),n.d(t,"TubeGeometry",function(){return co}),n.d(t,"TubeBufferGeometry",function(){return lo}),n.d(t,"TorusKnotGeometry",function(){return uo}),n.d(t,"TorusKnotBufferGeometry",function(){return ho}),n.d(t,"TorusGeometry",function(){return po}),n.d(t,"TorusBufferGeometry",function(){return fo}),n.d(t,"TextGeometry",function(){return Go}),n.d(t,"TextBufferGeometry",function(){return Wo}),n.d(t,"SphereGeometry",function(){return qo}),n.d(t,"SphereBufferGeometry",function(){return Xo}),n.d(t,"RingGeometry",function(){return Yo}),n.d(t,"RingBufferGeometry",function(){return Ko}),n.d(t,"PlaneGeometry",function(){return ur}),n.d(t,"PlaneBufferGeometry",function(){return hr}),n.d(t,"LatheGeometry",function(){return $o}),n.d(t,"LatheBufferGeometry",function(){return Zo}),n.d(t,"ShapeGeometry",function(){return Jo}),n.d(t,"ShapeBufferGeometry",function(){return Qo}),n.d(t,"ExtrudeGeometry",function(){return Fo}),n.d(t,"ExtrudeBufferGeometry",function(){return Uo}),n.d(t,"EdgesGeometry",function(){return ts}),n.d(t,"ConeGeometry",function(){return is}),n.d(t,"ConeBufferGeometry",function(){return as}),n.d(t,"CylinderGeometry",function(){return ns}),n.d(t,"CylinderBufferGeometry",function(){return rs}),n.d(t,"CircleGeometry",function(){return os}),n.d(t,"CircleBufferGeometry",function(){return ss}),n.d(t,"BoxGeometry",function(){return cr}),n.d(t,"CubeGeometry",function(){return cr}),n.d(t,"BoxBufferGeometry",function(){return lr}),n.d(t,"ShadowMaterial",function(){return ls}),n.d(t,"SpriteMaterial",function(){return Ia}),n.d(t,"RawShaderMaterial",function(){return us}),n.d(t,"ShaderMaterial",function(){return Ar}),n.d(t,"PointsMaterial",function(){return Ha}),n.d(t,"MeshPhysicalMaterial",function(){return ps}),n.d(t,"MeshStandardMaterial",function(){return hs}),n.d(t,"MeshPhongMaterial",function(){return ds}),n.d(t,"MeshToonMaterial",function(){return fs}),n.d(t,"MeshNormalMaterial",function(){return ms}),n.d(t,"MeshLambertMaterial",function(){return gs}),n.d(t,"MeshDepthMaterial",function(){return oa}),n.d(t,"MeshDistanceMaterial",function(){return sa}),n.d(t,"MeshBasicMaterial",function(){return Rr}),n.d(t,"MeshMatcapMaterial",function(){return vs}),n.d(t,"LineDashedMaterial",function(){return ys}),n.d(t,"LineBasicMaterial",function(){return ja}),n.d(t,"Material",function(){return dr}),n.d(t,"Float64BufferAttribute",function(){return rr}),n.d(t,"Float32BufferAttribute",function(){return nr}),n.d(t,"Uint32BufferAttribute",function(){return tr}),n.d(t,"Int32BufferAttribute",function(){return er}),n.d(t,"Uint16BufferAttribute",function(){return Qn}),n.d(t,"Int16BufferAttribute",function(){return Jn}),n.d(t,"Uint8ClampedBufferAttribute",function(){return Zn}),n.d(t,"Uint8BufferAttribute",function(){return $n}),n.d(t,"Int8BufferAttribute",function(){return Kn}),n.d(t,"BufferAttribute",function(){return Yn}),n.d(t,"ArcCurve",function(){return Ys}),n.d(t,"CatmullRomCurve3",function(){return ec}),n.d(t,"CubicBezierCurve",function(){return ic}),n.d(t,"CubicBezierCurve3",function(){return ac}),n.d(t,"EllipseCurve",function(){return Xs}),n.d(t,"LineCurve",function(){return oc}),n.d(t,"LineCurve3",function(){return sc}),n.d(t,"QuadraticBezierCurve",function(){return cc}),n.d(t,"QuadraticBezierCurve3",function(){return lc}),n.d(t,"SplineCurve",function(){return uc}),n.d(t,"REVISION",function(){return l}),n.d(t,"MOUSE",function(){return u}),n.d(t,"CullFaceNone",function(){return h}),n.d(t,"CullFaceBack",function(){return p}),n.d(t,"CullFaceFront",function(){return d}),n.d(t,"CullFaceFrontBack",function(){return f}),n.d(t,"FrontFaceDirectionCW",function(){return m}),n.d(t,"FrontFaceDirectionCCW",function(){return g}),n.d(t,"BasicShadowMap",function(){return v}),n.d(t,"PCFShadowMap",function(){return y}),n.d(t,"PCFSoftShadowMap",function(){return b}),n.d(t,"FrontSide",function(){return _}),n.d(t,"BackSide",function(){return w}),n.d(t,"DoubleSide",function(){return x}),n.d(t,"FlatShading",function(){return E}),n.d(t,"SmoothShading",function(){return M}),n.d(t,"NoColors",function(){return S}),n.d(t,"FaceColors",function(){return T}),n.d(t,"VertexColors",function(){return P}),n.d(t,"NoBlending",function(){return A}),n.d(t,"NormalBlending",function(){return O}),n.d(t,"AdditiveBlending",function(){return C}),n.d(t,"SubtractiveBlending",function(){return R}),n.d(t,"MultiplyBlending",function(){return L}),n.d(t,"CustomBlending",function(){return I}),n.d(t,"AddEquation",function(){return k}),n.d(t,"SubtractEquation",function(){return N}),n.d(t,"ReverseSubtractEquation",function(){return z}),n.d(t,"MinEquation",function(){return D}),n.d(t,"MaxEquation",function(){return B}),n.d(t,"ZeroFactor",function(){return j}),n.d(t,"OneFactor",function(){return F}),n.d(t,"SrcColorFactor",function(){return U}),n.d(t,"OneMinusSrcColorFactor",function(){return V}),n.d(t,"SrcAlphaFactor",function(){return H}),n.d(t,"OneMinusSrcAlphaFactor",function(){return G}),n.d(t,"DstAlphaFactor",function(){return W}),n.d(t,"OneMinusDstAlphaFactor",function(){return q}),n.d(t,"DstColorFactor",function(){return X}),n.d(t,"OneMinusDstColorFactor",function(){return Y}),n.d(t,"SrcAlphaSaturateFactor",function(){return K}),n.d(t,"NeverDepth",function(){return $}),n.d(t,"AlwaysDepth",function(){return Z}),n.d(t,"LessDepth",function(){return J}),n.d(t,"LessEqualDepth",function(){return Q}),n.d(t,"EqualDepth",function(){return ee}),n.d(t,"GreaterEqualDepth",function(){return te}),n.d(t,"GreaterDepth",function(){return ne}),n.d(t,"NotEqualDepth",function(){return re}),n.d(t,"MultiplyOperation",function(){return ie}),n.d(t,"MixOperation",function(){return ae}),n.d(t,"AddOperation",function(){return oe}),n.d(t,"NoToneMapping",function(){return se}),n.d(t,"LinearToneMapping",function(){return ce}),n.d(t,"ReinhardToneMapping",function(){return le}),n.d(t,"Uncharted2ToneMapping",function(){return ue}),n.d(t,"CineonToneMapping",function(){return he}),n.d(t,"ACESFilmicToneMapping",function(){return pe}),n.d(t,"UVMapping",function(){return de}),n.d(t,"CubeReflectionMapping",function(){return fe}),n.d(t,"CubeRefractionMapping",function(){return me}),n.d(t,"EquirectangularReflectionMapping",function(){return ge}),n.d(t,"EquirectangularRefractionMapping",function(){return ve}),n.d(t,"SphericalReflectionMapping",function(){return ye}),n.d(t,"CubeUVReflectionMapping",function(){return be}),n.d(t,"CubeUVRefractionMapping",function(){return _e}),n.d(t,"RepeatWrapping",function(){return we}),n.d(t,"ClampToEdgeWrapping",function(){return xe}),n.d(t,"MirroredRepeatWrapping",function(){return Ee}),n.d(t,"NearestFilter",function(){return Me}),n.d(t,"NearestMipMapNearestFilter",function(){return Se}),n.d(t,"NearestMipMapLinearFilter",function(){return Te}),n.d(t,"LinearFilter",function(){return Pe}),n.d(t,"LinearMipMapNearestFilter",function(){return Ae}),n.d(t,"LinearMipMapLinearFilter",function(){return Oe}),n.d(t,"UnsignedByteType",function(){return Ce}),n.d(t,"ByteType",function(){return Re}),n.d(t,"ShortType",function(){return Le}),n.d(t,"UnsignedShortType",function(){return Ie}),n.d(t,"IntType",function(){return ke}),n.d(t,"UnsignedIntType",function(){return Ne}),n.d(t,"FloatType",function(){return ze}),n.d(t,"HalfFloatType",function(){return De}),n.d(t,"UnsignedShort4444Type",function(){return Be}),n.d(t,"UnsignedShort5551Type",function(){return je}),n.d(t,"UnsignedShort565Type",function(){return Fe}),n.d(t,"UnsignedInt248Type",function(){return Ue}),n.d(t,"AlphaFormat",function(){return Ve}),n.d(t,"RGBFormat",function(){return He}),n.d(t,"RGBAFormat",function(){return Ge}),n.d(t,"LuminanceFormat",function(){return We}),n.d(t,"LuminanceAlphaFormat",function(){return qe}),n.d(t,"RGBEFormat",function(){return Xe}),n.d(t,"DepthFormat",function(){return Ye}),n.d(t,"DepthStencilFormat",function(){return Ke}),n.d(t,"RedFormat",function(){return $e}),n.d(t,"RGB_S3TC_DXT1_Format",function(){return Ze}),n.d(t,"RGBA_S3TC_DXT1_Format",function(){return Je}),n.d(t,"RGBA_S3TC_DXT3_Format",function(){return Qe}),n.d(t,"RGBA_S3TC_DXT5_Format",function(){return et}),n.d(t,"RGB_PVRTC_4BPPV1_Format",function(){return tt}),n.d(t,"RGB_PVRTC_2BPPV1_Format",function(){return nt}),n.d(t,"RGBA_PVRTC_4BPPV1_Format",function(){return rt}),n.d(t,"RGBA_PVRTC_2BPPV1_Format",function(){return it}),n.d(t,"RGB_ETC1_Format",function(){return at}),n.d(t,"RGBA_ASTC_4x4_Format",function(){return ot}),n.d(t,"RGBA_ASTC_5x4_Format",function(){return st}),n.d(t,"RGBA_ASTC_5x5_Format",function(){return ct}),n.d(t,"RGBA_ASTC_6x5_Format",function(){return lt}),n.d(t,"RGBA_ASTC_6x6_Format",function(){return ut}),n.d(t,"RGBA_ASTC_8x5_Format",function(){return ht}),n.d(t,"RGBA_ASTC_8x6_Format",function(){return pt}),n.d(t,"RGBA_ASTC_8x8_Format",function(){return dt}),n.d(t,"RGBA_ASTC_10x5_Format",function(){return ft}),n.d(t,"RGBA_ASTC_10x6_Format",function(){return mt}),n.d(t,"RGBA_ASTC_10x8_Format",function(){return gt}),n.d(t,"RGBA_ASTC_10x10_Format",function(){return vt}),n.d(t,"RGBA_ASTC_12x10_Format",function(){return yt}),n.d(t,"RGBA_ASTC_12x12_Format",function(){return bt}),n.d(t,"LoopOnce",function(){return _t}),n.d(t,"LoopRepeat",function(){return wt}),n.d(t,"LoopPingPong",function(){return xt}),n.d(t,"InterpolateDiscrete",function(){return Et}),n.d(t,"InterpolateLinear",function(){return Mt}),n.d(t,"InterpolateSmooth",function(){return St}),n.d(t,"ZeroCurvatureEnding",function(){return Tt}),n.d(t,"ZeroSlopeEnding",function(){return Pt}),n.d(t,"WrapAroundEnding",function(){return At}),n.d(t,"TrianglesDrawMode",function(){return Ot}),n.d(t,"TriangleStripDrawMode",function(){return Ct}),n.d(t,"TriangleFanDrawMode",function(){return Rt}),n.d(t,"LinearEncoding",function(){return Lt}),n.d(t,"sRGBEncoding",function(){return It}),n.d(t,"GammaEncoding",function(){return kt}),n.d(t,"RGBEEncoding",function(){return Nt}),n.d(t,"LogLuvEncoding",function(){return zt}),n.d(t,"RGBM7Encoding",function(){return Dt}),n.d(t,"RGBM16Encoding",function(){return Bt}),n.d(t,"RGBDEncoding",function(){return jt}),n.d(t,"BasicDepthPacking",function(){return Ft}),n.d(t,"RGBADepthPacking",function(){return Ut}),n.d(t,"TangentSpaceNormalMap",function(){return Vt}),n.d(t,"ObjectSpaceNormalMap",function(){return Ht}),n.d(t,"Face4",function(){return ou}),n.d(t,"LineStrip",function(){return su}),n.d(t,"LinePieces",function(){return cu}),n.d(t,"MeshFaceMaterial",function(){return lu}),n.d(t,"MultiMaterial",function(){return uu}),n.d(t,"PointCloud",function(){return hu}),n.d(t,"Particle",function(){return pu}),n.d(t,"ParticleSystem",function(){return du}),n.d(t,"PointCloudMaterial",function(){return fu}),n.d(t,"ParticleBasicMaterial",function(){return mu}),n.d(t,"ParticleSystemMaterial",function(){return gu}),n.d(t,"Vertex",function(){return vu}),n.d(t,"DynamicBufferAttribute",function(){return yu}),n.d(t,"Int8Attribute",function(){return bu}),n.d(t,"Uint8Attribute",function(){return _u}),n.d(t,"Uint8ClampedAttribute",function(){return wu}),n.d(t,"Int16Attribute",function(){return xu}),n.d(t,"Uint16Attribute",function(){return Eu}),n.d(t,"Int32Attribute",function(){return Mu}),n.d(t,"Uint32Attribute",function(){return Su}),n.d(t,"Float32Attribute",function(){return Tu}),n.d(t,"Float64Attribute",function(){return Pu}),n.d(t,"ClosedSplineCurve3",function(){return Au}),n.d(t,"SplineCurve3",function(){return Ou}),n.d(t,"Spline",function(){return Cu}),n.d(t,"AxisHelper",function(){return Ru}),n.d(t,"BoundingBoxHelper",function(){return Lu}),n.d(t,"EdgesHelper",function(){return Iu}),n.d(t,"WireframeHelper",function(){return ku}),n.d(t,"XHRLoader",function(){return Nu}),n.d(t,"BinaryTextureLoader",function(){return zu}),n.d(t,"GeometryUtils",function(){return Du}),n.d(t,"Projector",function(){return Bu}),n.d(t,"CanvasRenderer",function(){return ju}),n.d(t,"JSONLoader",function(){return Fu}),n.d(t,"SceneUtils",function(){return Uu}),n.d(t,"LensFlare",function(){return Vu}),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}),void 0===Math.sign&&(Math.sign=function(e){return e<0?-1:e>0?1:+e}),"name"in Function.prototype==!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t}),Object.assign(r.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)},removeEventListener:function(e,t){if(void 0!==this._listeners){var n=this._listeners[e];if(void 0!==n){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var n=t.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,e)}}}});var i,a,o,s,c,l="103",u={LEFT:0,MIDDLE:1,RIGHT:2},h=0,p=1,d=2,f=3,m=0,g=1,v=0,y=1,b=2,_=0,w=1,x=2,E=1,M=2,S=0,T=1,P=2,A=0,O=1,C=2,R=3,L=4,I=5,k=100,N=101,z=102,D=103,B=104,j=200,F=201,U=202,V=203,H=204,G=205,W=206,q=207,X=208,Y=209,K=210,$=0,Z=1,J=2,Q=3,ee=4,te=5,ne=6,re=7,ie=0,ae=1,oe=2,se=0,ce=1,le=2,ue=3,he=4,pe=5,de=300,fe=301,me=302,ge=303,ve=304,ye=305,be=306,_e=307,we=1e3,xe=1001,Ee=1002,Me=1003,Se=1004,Te=1005,Pe=1006,Ae=1007,Oe=1008,Ce=1009,Re=1010,Le=1011,Ie=1012,ke=1013,Ne=1014,ze=1015,De=1016,Be=1017,je=1018,Fe=1019,Ue=1020,Ve=1021,He=1022,Ge=1023,We=1024,qe=1025,Xe=Ge,Ye=1026,Ke=1027,$e=1028,Ze=33776,Je=33777,Qe=33778,et=33779,tt=35840,nt=35841,rt=35842,it=35843,at=36196,ot=37808,st=37809,ct=37810,lt=37811,ut=37812,ht=37813,pt=37814,dt=37815,ft=37816,mt=37817,gt=37818,vt=37819,yt=37820,bt=37821,_t=2200,wt=2201,xt=2202,Et=2300,Mt=2301,St=2302,Tt=2400,Pt=2401,At=2402,Ot=0,Ct=1,Rt=2,Lt=3e3,It=3001,kt=3007,Nt=3002,zt=3003,Dt=3004,Bt=3005,jt=3006,Ft=3200,Ut=3201,Vt=0,Ht=1,Gt={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var e=[],t=0;t<256;t++)e[t]=(t<16?"0":"")+t.toString(16);return function(){var t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(e[255&t]+e[t>>8&255]+e[t>>16&255]+e[t>>24&255]+"-"+e[255&n]+e[n>>8&255]+"-"+e[n>>16&15|64]+e[n>>24&255]+"-"+e[63&r|128]+e[r>>8&255]+"-"+e[r>>16&255]+e[r>>24&255]+e[255&i]+e[i>>8&255]+e[i>>16&255]+e[i>>24&255]).toUpperCase()}}(),clamp:function(e,t,n){return Math.max(t,Math.min(n,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},lerp:function(e,t,n){return(1-n)*e+n*t},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*Gt.DEG2RAD},radToDeg:function(e){return e*Gt.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}};function Wt(e,t){this.x=e||0,this.y=t||0}function qt(e,t,n,r){this._x=e||0,this._y=t||0,this._z=n||0,this._w=void 0!==r?r:1}function Xt(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0}function Yt(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.defineProperties(Wt.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Object.assign(Wt.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){var t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampScalar:(i=new Wt,a=new Wt,function(e,t){return i.set(e,e),a.set(t,t),this.clamp(i,a)}),clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},cross:function(e){return this.x*e.y-this.y*e.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var e=Math.atan2(this.y,this.x);return e<0&&(e+=2*Math.PI),e},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,a=this.y-e.y;return this.x=i*n-a*r+e.x,this.y=i*r+a*n+e.y,this}}),Object.assign(qt,{slerp:function(e,t,n,r){return n.copy(e).slerp(t,r)},slerpFlat:function(e,t,n,r,i,a,o){var s=n[r+0],c=n[r+1],l=n[r+2],u=n[r+3],h=i[a+0],p=i[a+1],d=i[a+2],f=i[a+3];if(u!==f||s!==h||c!==p||l!==d){var m=1-o,g=s*h+c*p+l*d+u*f,v=g>=0?1:-1,y=1-g*g;if(y>Number.EPSILON){var b=Math.sqrt(y),_=Math.atan2(b,g*v);m=Math.sin(m*_)/b,o=Math.sin(o*_)/b}var w=o*v;if(s=s*m+h*w,c=c*m+p*w,l=l*m+d*w,u=u*m+f*w,m===1-o){var x=1/Math.sqrt(s*s+c*c+l*l+u*u);s*=x,c*=x,l*=x,u*=x}}e[t]=s,e[t+1]=c,e[t+2]=l,e[t+3]=u}}),Object.defineProperties(qt.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this.onChangeCallback()}}}),Object.assign(qt.prototype,{isQuaternion:!0,set:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this.onChangeCallback(),this},setFromEuler:function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=e._x,r=e._y,i=e._z,a=e.order,o=Math.cos,s=Math.sin,c=o(n/2),l=o(r/2),u=o(i/2),h=s(n/2),p=s(r/2),d=s(i/2);return"XYZ"===a?(this._x=h*l*u+c*p*d,this._y=c*p*u-h*l*d,this._z=c*l*d+h*p*u,this._w=c*l*u-h*p*d):"YXZ"===a?(this._x=h*l*u+c*p*d,this._y=c*p*u-h*l*d,this._z=c*l*d-h*p*u,this._w=c*l*u+h*p*d):"ZXY"===a?(this._x=h*l*u-c*p*d,this._y=c*p*u+h*l*d,this._z=c*l*d+h*p*u,this._w=c*l*u-h*p*d):"ZYX"===a?(this._x=h*l*u-c*p*d,this._y=c*p*u+h*l*d,this._z=c*l*d-h*p*u,this._w=c*l*u+h*p*d):"YZX"===a?(this._x=h*l*u+c*p*d,this._y=c*p*u+h*l*d,this._z=c*l*d-h*p*u,this._w=c*l*u-h*p*d):"XZY"===a&&(this._x=h*l*u-c*p*d,this._y=c*p*u-h*l*d,this._z=c*l*d+h*p*u,this._w=c*l*u+h*p*d),!1!==t&&this.onChangeCallback(),this},setFromAxisAngle:function(e,t){var n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this.onChangeCallback(),this},setFromRotationMatrix:function(e){var t,n=e.elements,r=n[0],i=n[4],a=n[8],o=n[1],s=n[5],c=n[9],l=n[2],u=n[6],h=n[10],p=r+s+h;return p>0?(t=.5/Math.sqrt(p+1),this._w=.25/t,this._x=(u-c)*t,this._y=(a-l)*t,this._z=(o-i)*t):r>s&&r>h?(t=2*Math.sqrt(1+r-s-h),this._w=(u-c)/t,this._x=.25*t,this._y=(i+o)/t,this._z=(a+l)/t):s>h?(t=2*Math.sqrt(1+s-r-h),this._w=(a-l)/t,this._x=(i+o)/t,this._y=.25*t,this._z=(c+u)/t):(t=2*Math.sqrt(1+h-r-s),this._w=(o-i)/t,this._x=(a+l)/t,this._y=(c+u)/t,this._z=.25*t),this.onChangeCallback(),this},setFromUnitVectors:function(e,t){var n=e.dot(t)+1;return n<1e-6?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()},angleTo:function(e){return 2*Math.acos(Math.abs(Gt.clamp(this.dot(e),-1,1)))},rotateTowards:function(e,t){var n=this.angleTo(e);if(0===n)return this;var r=Math.min(1,t/n);return this.slerp(e,r),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this.onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){var n=e._x,r=e._y,i=e._z,a=e._w,o=t._x,s=t._y,c=t._z,l=t._w;return this._x=n*l+a*o+r*c-i*s,this._y=r*l+a*s+i*o-n*c,this._z=i*l+a*c+n*s-r*o,this._w=a*l-n*o-r*s-i*c,this.onChangeCallback(),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var n=this._x,r=this._y,i=this._z,a=this._w,o=a*e._w+n*e._x+r*e._y+i*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=n,this._y=r,this._z=i,this;var s=1-o*o;if(s<=Number.EPSILON){var c=1-t;return this._w=c*a+t*this._w,this._x=c*n+t*this._x,this._y=c*r+t*this._y,this._z=c*i+t*this._z,this.normalize()}var l=Math.sqrt(s),u=Math.atan2(l,o),h=Math.sin((1-t)*u)/l,p=Math.sin(t*u)/l;return this._w=a*h+this._w*p,this._x=n*h+this._x*p,this._y=r*h+this._y*p,this._z=i*h+this._z*p,this.onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(Xt.prototype,{isVector3:!0,set:function(e,t,n){return this.x=e,this.y=t,this.z=n,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:(s=new qt,function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(s.setFromEuler(e))}),applyAxisAngle:function(){var e=new qt;return function(t,n){return this.applyQuaternion(e.setFromAxisAngle(t,n))}}(),applyMatrix3:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this},applyMatrix4:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements,a=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*a,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*a,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*a,this},applyQuaternion:function(e){var t=this.x,n=this.y,r=this.z,i=e.x,a=e.y,o=e.z,s=e.w,c=s*t+a*r-o*n,l=s*n+o*t-i*r,u=s*r+i*n-a*t,h=-i*t-a*n-o*r;return this.x=c*s+h*-i+l*-o-u*-a,this.y=l*s+h*-a+u*-i-c*-o,this.z=u*s+h*-o+c*-a-l*-i,this},project:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)},unproject:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)},transformDirection:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:function(){var e=new Xt,t=new Xt;return function(n,r){return e.set(n,n,n),t.set(r,r,r),this.clamp(e,t)}}(),clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},cross:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)},crossVectors:function(e,t){var n=e.x,r=e.y,i=e.z,a=t.x,o=t.y,s=t.z;return this.x=r*s-i*o,this.y=i*a-n*s,this.z=n*o-r*a,this},projectOnVector:function(e){var t=e.dot(this)/e.lengthSq();return this.copy(e).multiplyScalar(t)},projectOnPlane:(o=new Xt,function(e){return o.copy(this).projectOnVector(e),this.sub(o)}),reflect:function(){var e=new Xt;return function(t){return this.sub(e.copy(t).multiplyScalar(2*this.dot(t)))}}(),angleTo:function(e){var t=this.dot(e)/Math.sqrt(this.lengthSq()*e.lengthSq());return Math.acos(Gt.clamp(t,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)},setFromSphericalCoords:function(e,t,n){var r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this},setFromCylindrical:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)},setFromCylindricalCoords:function(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this},setFromMatrixPosition:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}}),Object.assign(Yt.prototype,{isMatrix3:!0,set:function(e,t,n,r,i,a,o,s,c){var l=this.elements;return l[0]=e,l[1]=r,l[2]=o,l[3]=t,l[4]=i,l[5]=s,l[6]=n,l[7]=a,l[8]=c,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this},setFromMatrix4:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},applyToBufferAttribute:function(){var e=new Xt;return function(t){for(var n=0,r=t.count;n<r;n++)e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.applyMatrix3(this),t.setXYZ(n,e.x,e.y,e.z);return t}}(),multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var n=e.elements,r=t.elements,i=this.elements,a=n[0],o=n[3],s=n[6],c=n[1],l=n[4],u=n[7],h=n[2],p=n[5],d=n[8],f=r[0],m=r[3],g=r[6],v=r[1],y=r[4],b=r[7],_=r[2],w=r[5],x=r[8];return i[0]=a*f+o*v+s*_,i[3]=a*m+o*y+s*w,i[6]=a*g+o*b+s*x,i[1]=c*f+l*v+u*_,i[4]=c*m+l*y+u*w,i[7]=c*g+l*b+u*x,i[2]=h*f+p*v+d*_,i[5]=h*m+p*y+d*w,i[8]=h*g+p*b+d*x,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],c=e[7],l=e[8];return t*a*l-t*o*c-n*i*l+n*o*s+r*i*c-r*a*s},getInverse:function(e,t){e&&e.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var n=e.elements,r=this.elements,i=n[0],a=n[1],o=n[2],s=n[3],c=n[4],l=n[5],u=n[6],h=n[7],p=n[8],d=p*c-l*h,f=l*u-p*s,m=h*s-c*u,g=i*d+a*f+o*m;if(0===g){var v="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(v);return console.warn(v),this.identity()}var y=1/g;return r[0]=d*y,r[1]=(o*h-p*a)*y,r[2]=(l*a-o*c)*y,r[3]=f*y,r[4]=(p*i-o*u)*y,r[5]=(o*s-l*i)*y,r[6]=m*y,r[7]=(a*u-h*i)*y,r[8]=(c*i-a*s)*y,this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},setUvTransform:function(e,t,n,r,i,a,o){var s=Math.cos(i),c=Math.sin(i);this.set(n*s,n*c,-n*(s*a+c*o)+a+e,-r*c,r*s,-r*(-c*a+s*o)+o+t,0,0,1)},scale:function(e,t){var n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this},rotate:function(e){var t=Math.cos(e),n=Math.sin(e),r=this.elements,i=r[0],a=r[3],o=r[6],s=r[1],c=r[4],l=r[7];return r[0]=t*i+n*s,r[3]=t*a+n*c,r[6]=t*o+n*l,r[1]=-n*i+t*s,r[4]=-n*a+t*c,r[7]=-n*o+t*l,this},translate:function(e,t){var n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this},equals:function(e){for(var t=this.elements,n=e.elements,r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var n=0;n<9;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}});var Kt,$t,Zt,Jt,Qt,en,tn,nn,rn,an,on,sn,cn={getDataURL:function(e){var t;if("undefined"==typeof HTMLCanvasElement)return e.src;if(e instanceof HTMLCanvasElement)t=e;else{void 0===c&&(c=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),c.width=e.width,c.height=e.height;var n=c.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=c}return t.width>2048||t.height>2048?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}},ln=0;function un(e,t,n,r,i,a,o,s,c,l){Object.defineProperty(this,"id",{value:ln++}),this.uuid=Gt.generateUUID(),this.name="",this.image=void 0!==e?e:un.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==t?t:un.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:xe,this.wrapT=void 0!==r?r:xe,this.magFilter=void 0!==i?i:Pe,this.minFilter=void 0!==a?a:Oe,this.anisotropy=void 0!==c?c:1,this.format=void 0!==o?o:Ge,this.type=void 0!==s?s:Ce,this.offset=new Wt(0,0),this.repeat=new Wt(1,1),this.center=new Wt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Yt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==l?l:Lt,this.version=0,this.onUpdate=null}function hn(e,t,n,r){this.x=e||0,this.y=t||0,this.z=n||0,this.w=void 0!==r?r:1}function pn(e,t,n){this.width=e,this.height=t,this.scissor=new hn(0,0,e,t),this.scissorTest=!1,this.viewport=new hn(0,0,e,t),n=n||{},this.texture=new un(void 0,void 0,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:Pe,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function dn(e,t,n){pn.call(this,e,t,n),this.samples=4}function fn(e,t,n){pn.call(this,e,t,n)}function mn(e,t,n,r,i,a,o,s,c,l,u,h){un.call(this,null,a,o,s,c,l,r,i,u,h),this.image={data:e,width:t,height:n},this.magFilter=void 0!==c?c:Me,this.minFilter=void 0!==l?l:Me,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function gn(e,t){this.min=void 0!==e?e:new Xt(1/0,1/0,1/0),this.max=void 0!==t?t:new Xt(-1/0,-1/0,-1/0)}function vn(e,t){this.center=void 0!==e?e:new Xt,this.radius=void 0!==t?t:0}function yn(e,t){this.normal=void 0!==e?e:new Xt(1,0,0),this.constant=void 0!==t?t:0}function bn(e,t,n,r,i,a){this.planes=[void 0!==e?e:new yn,void 0!==t?t:new yn,void 0!==n?n:new yn,void 0!==r?r:new yn,void 0!==i?i:new yn,void 0!==a?a:new yn]}function _n(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}un.DEFAULT_IMAGE=void 0,un.DEFAULT_MAPPING=de,un.prototype=Object.assign(Object.create(r.prototype),{constructor:un,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){var t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var r=this.image;if(void 0===r.uuid&&(r.uuid=Gt.generateUUID()),!t&&void 0===e.images[r.uuid]){var i;if(Array.isArray(r)){i=[];for(var a=0,o=r.length;a<o;a++)i.push(cn.getDataURL(r[a]))}else i=cn.getDataURL(r);e.images[r.uuid]={uuid:r.uuid,url:i}}n.image=r.uuid}return t||(e.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(this.mapping!==de)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case we:e.x=e.x-Math.floor(e.x);break;case xe:e.x=e.x<0?0:1;break;case Ee:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case we:e.y=e.y-Math.floor(e.y);break;case xe:e.y=e.y<0?0:1;break;case Ee:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}}),Object.defineProperty(un.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(hn.prototype,{isVector4:!0,set:function(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,n=this.y,r=this.z,i=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*r+a[12]*i,this.y=a[1]*t+a[5]*n+a[9]*r+a[13]*i,this.z=a[2]*t+a[6]*n+a[10]*r+a[14]*i,this.w=a[3]*t+a[7]*n+a[11]*r+a[15]*i,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,n,r,i,a=e.elements,o=a[0],s=a[4],c=a[8],l=a[1],u=a[5],h=a[9],p=a[2],d=a[6],f=a[10];if(Math.abs(s-l)<.01&&Math.abs(c-p)<.01&&Math.abs(h-d)<.01){if(Math.abs(s+l)<.1&&Math.abs(c+p)<.1&&Math.abs(h+d)<.1&&Math.abs(o+u+f-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;var m=(o+1)/2,g=(u+1)/2,v=(f+1)/2,y=(s+l)/4,b=(c+p)/4,_=(h+d)/4;return m>g&&m>v?m<.01?(n=0,r=.707106781,i=.707106781):(r=y/(n=Math.sqrt(m)),i=b/n):g>v?g<.01?(n=.707106781,r=0,i=.707106781):(n=y/(r=Math.sqrt(g)),i=_/r):v<.01?(n=.707106781,r=.707106781,i=0):(n=b/(i=Math.sqrt(v)),r=_/i),this.set(n,r,i,t),this}var w=Math.sqrt((d-h)*(d-h)+(c-p)*(c-p)+(l-s)*(l-s));return Math.abs(w)<.001&&(w=1),this.x=(d-h)/w,this.y=(c-p)/w,this.z=(l-s)/w,this.w=Math.acos((o+u+f-1)/2),this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},clampScalar:function(){var e,t;return function(n,r){return void 0===e&&(e=new hn,t=new hn),e.set(n,n,n,n),t.set(r,r,r,r),this.clamp(e,t)}}(),clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}}),pn.prototype=Object.assign(Object.create(r.prototype),{constructor:pn,isWebGLRenderTarget:!0,setSize:function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),dn.prototype=Object.assign(Object.create(pn.prototype),{constructor:dn,isWebGLMultisampleRenderTarget:!0,copy:function(e){return pn.prototype.copy.call(this,e),this.samples=e.samples,this}}),fn.prototype=Object.create(pn.prototype),fn.prototype.constructor=fn,fn.prototype.isWebGLRenderTargetCube=!0,mn.prototype=Object.create(un.prototype),mn.prototype.constructor=mn,mn.prototype.isDataTexture=!0,Object.assign(gn.prototype,{isBox3:!0,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(e){for(var t=1/0,n=1/0,r=1/0,i=-1/0,a=-1/0,o=-1/0,s=0,c=e.length;s<c;s+=3){var l=e[s],u=e[s+1],h=e[s+2];l<t&&(t=l),u<n&&(n=u),h<r&&(r=h),l>i&&(i=l),u>a&&(a=u),h>o&&(o=h)}return this.min.set(t,n,r),this.max.set(i,a,o),this},setFromBufferAttribute:function(e){for(var t=1/0,n=1/0,r=1/0,i=-1/0,a=-1/0,o=-1/0,s=0,c=e.count;s<c;s++){var l=e.getX(s),u=e.getY(s),h=e.getZ(s);l<t&&(t=l),u<n&&(n=u),h<r&&(r=h),l>i&&(i=l),u>a&&(a=u),h>o&&(o=h)}return this.min.set(t,n,r),this.max.set(i,a,o),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new Xt;return function(t,n){var r=e.copy(n).multiplyScalar(.5);return this.min.copy(t).sub(r),this.max.copy(t).add(r),this}}(),setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new Xt),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new Xt),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(){var e,t,n,r=new Xt;function i(i){var a=i.geometry;if(void 0!==a)if(a.isGeometry){var o=a.vertices;for(t=0,n=o.length;t<n;t++)r.copy(o[t]),r.applyMatrix4(i.matrixWorld),e.expandByPoint(r)}else if(a.isBufferGeometry){var s=a.attributes.position;if(void 0!==s)for(t=0,n=s.count;t<n;t++)r.fromBufferAttribute(s,t).applyMatrix4(i.matrixWorld),e.expandByPoint(r)}}return function(t){return e=this,t.updateMatrixWorld(!0),t.traverse(i),this}}(),containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .getParameter() target is now required"),t=new Xt),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:($t=new Xt,function(e){return this.clampPoint(e.center,$t),$t.distanceToSquared(e.center)<=e.radius*e.radius}),intersectsPlane:function(e){var t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant},intersectsTriangle:function(){var e=new Xt,t=new Xt,n=new Xt,r=new Xt,i=new Xt,a=new Xt,o=new Xt,s=new Xt,c=new Xt,l=new Xt;function u(r){var i,a;for(i=0,a=r.length-3;i<=a;i+=3){o.fromArray(r,i);var s=c.x*Math.abs(o.x)+c.y*Math.abs(o.y)+c.z*Math.abs(o.z),l=e.dot(o),u=t.dot(o),h=n.dot(o);if(Math.max(-Math.max(l,u,h),Math.min(l,u,h))>s)return!1}return!0}return function(o){if(this.isEmpty())return!1;this.getCenter(s),c.subVectors(this.max,s),e.subVectors(o.a,s),t.subVectors(o.b,s),n.subVectors(o.c,s),r.subVectors(t,e),i.subVectors(n,t),a.subVectors(e,n);var h=[0,-r.z,r.y,0,-i.z,i.y,0,-a.z,a.y,r.z,0,-r.x,i.z,0,-i.x,a.z,0,-a.x,-r.y,r.x,0,-i.y,i.x,0,-a.y,a.x,0];return!!u(h)&&(!!u(h=[1,0,0,0,1,0,0,0,1])&&(l.crossVectors(r,i),u(h=[l.x,l.y,l.z])))}}(),clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .clampPoint() target is now required"),t=new Xt),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new Xt;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),getBoundingSphere:function(){var e=new Xt;return function(t){return void 0===t&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=.5*this.getSize(e).length(),t}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:(Kt=[new Xt,new Xt,new Xt,new Xt,new Xt,new Xt,new Xt,new Xt],function(e){return this.isEmpty()?this:(Kt[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Kt[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Kt[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Kt[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Kt[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Kt[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Kt[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Kt[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Kt),this)}),translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),Object.assign(vn.prototype,{set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:(Zt=new gn,function(e,t){var n=this.center;void 0!==t?n.copy(t):Zt.setFromPoints(e).getCenter(n);for(var r=0,i=0,a=e.length;i<a;i++)r=Math.max(r,n.distanceToSquared(e[i]));return this.radius=Math.sqrt(r),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,t){var n=this.center.distanceToSquared(e);return void 0===t&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),t=new Xt),t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t},getBoundingBox:function(e){return void 0===e&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new gn),e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}}),Object.assign(yn.prototype,{set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(){var e=new Xt,t=new Xt;return function(n,r,i){var a=e.subVectors(i,r).cross(t.subVectors(n,r)).normalize();return this.setFromNormalAndCoplanarPoint(a,n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return void 0===t&&(console.warn("THREE.Plane: .projectPoint() target is now required"),t=new Xt),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(){var e=new Xt;return function(t,n){void 0===n&&(console.warn("THREE.Plane: .intersectLine() target is now required"),n=new Xt);var r=t.delta(e),i=this.normal.dot(r);if(0===i)return 0===this.distanceToPoint(t.start)?n.copy(t.start):void 0;var a=-(t.start.dot(this.normal)+this.constant)/i;return a<0||a>1?void 0:n.copy(r).multiplyScalar(a).add(t.start)}}(),intersectsLine:function(e){var t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return void 0===e&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new Xt),e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var e=new Xt,t=new Yt;return function(n,r){var i=r||t.getNormalMatrix(n),a=this.coplanarPoint(e).applyMatrix4(n),o=this.normal.applyMatrix3(i).normalize();return this.constant=-a.dot(o),this}}(),translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}}),Object.assign(bn.prototype,{set:function(e,t,n,r,i,a){var o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(n),o[3].copy(r),o[4].copy(i),o[5].copy(a),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){for(var t=this.planes,n=0;n<6;n++)t[n].copy(e.planes[n]);return this},setFromMatrix:function(e){var t=this.planes,n=e.elements,r=n[0],i=n[1],a=n[2],o=n[3],s=n[4],c=n[5],l=n[6],u=n[7],h=n[8],p=n[9],d=n[10],f=n[11],m=n[12],g=n[13],v=n[14],y=n[15];return t[0].setComponents(o-r,u-s,f-h,y-m).normalize(),t[1].setComponents(o+r,u+s,f+h,y+m).normalize(),t[2].setComponents(o+i,u+c,f+p,y+g).normalize(),t[3].setComponents(o-i,u-c,f-p,y-g).normalize(),t[4].setComponents(o-a,u-l,f-d,y-v).normalize(),t[5].setComponents(o+a,u+l,f+d,y+v).normalize(),this},intersectsObject:(Qt=new vn,function(e){var t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),Qt.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Qt)}),intersectsSprite:function(){var e=new vn;return function(t){return e.center.set(0,0,0),e.radius=.7071067811865476,e.applyMatrix4(t.matrixWorld),this.intersectsSphere(e)}}(),intersectsSphere:function(e){for(var t=this.planes,n=e.center,r=-e.radius,i=0;i<6;i++){if(t[i].distanceToPoint(n)<r)return!1}return!0},intersectsBox:(Jt=new Xt,function(e){for(var t=this.planes,n=0;n<6;n++){var r=t[n];if(Jt.x=r.normal.x>0?e.max.x:e.min.x,Jt.y=r.normal.y>0?e.max.y:e.min.y,Jt.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Jt)<0)return!1}return!0}),containsPoint:function(e){for(var t=this.planes,n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}}),Object.assign(_n.prototype,{isMatrix4:!0,set:function(e,t,n,r,i,a,o,s,c,l,u,h,p,d,f,m){var g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=r,g[1]=i,g[5]=a,g[9]=o,g[13]=s,g[2]=c,g[6]=l,g[10]=u,g[14]=h,g[3]=p,g[7]=d,g[11]=f,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new _n).fromArray(this.elements)},copy:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this},copyPosition:function(e){var t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this},extractBasis:function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this},extractRotation:function(){var e=new Xt;return function(t){var n=this.elements,r=t.elements,i=1/e.setFromMatrixColumn(t,0).length(),a=1/e.setFromMatrixColumn(t,1).length(),o=1/e.setFromMatrixColumn(t,2).length();return n[0]=r[0]*i,n[1]=r[1]*i,n[2]=r[2]*i,n[3]=0,n[4]=r[4]*a,n[5]=r[5]*a,n[6]=r[6]*a,n[7]=0,n[8]=r[8]*o,n[9]=r[9]*o,n[10]=r[10]*o,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}}(),makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,n=e.x,r=e.y,i=e.z,a=Math.cos(n),o=Math.sin(n),s=Math.cos(r),c=Math.sin(r),l=Math.cos(i),u=Math.sin(i);if("XYZ"===e.order){var h=a*l,p=a*u,d=o*l,f=o*u;t[0]=s*l,t[4]=-s*u,t[8]=c,t[1]=p+d*c,t[5]=h-f*c,t[9]=-o*s,t[2]=f-h*c,t[6]=d+p*c,t[10]=a*s}else if("YXZ"===e.order){var m=s*l,g=s*u,v=c*l,y=c*u;t[0]=m+y*o,t[4]=v*o-g,t[8]=a*c,t[1]=a*u,t[5]=a*l,t[9]=-o,t[2]=g*o-v,t[6]=y+m*o,t[10]=a*s}else if("ZXY"===e.order){m=s*l,g=s*u,v=c*l,y=c*u;t[0]=m-y*o,t[4]=-a*u,t[8]=v+g*o,t[1]=g+v*o,t[5]=a*l,t[9]=y-m*o,t[2]=-a*c,t[6]=o,t[10]=a*s}else if("ZYX"===e.order){h=a*l,p=a*u,d=o*l,f=o*u;t[0]=s*l,t[4]=d*c-p,t[8]=h*c+f,t[1]=s*u,t[5]=f*c+h,t[9]=p*c-d,t[2]=-c,t[6]=o*s,t[10]=a*s}else if("YZX"===e.order){var b=a*s,_=a*c,w=o*s,x=o*c;t[0]=s*l,t[4]=x-b*u,t[8]=w*u+_,t[1]=u,t[5]=a*l,t[9]=-o*l,t[2]=-c*l,t[6]=_*u+w,t[10]=b-x*u}else if("XZY"===e.order){b=a*s,_=a*c,w=o*s,x=o*c;t[0]=s*l,t[4]=-u,t[8]=c*l,t[1]=b*u+x,t[5]=a*l,t[9]=_*u-w,t[2]=w*u-_,t[6]=o*l,t[10]=x*u+b}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromQuaternion:(on=new Xt(0,0,0),sn=new Xt(1,1,1),function(e){return this.compose(on,e,sn)}),lookAt:(nn=new Xt,rn=new Xt,an=new Xt,function(e,t,n){var r=this.elements;return an.subVectors(e,t),0===an.lengthSq()&&(an.z=1),an.normalize(),nn.crossVectors(n,an),0===nn.lengthSq()&&(1===Math.abs(n.z)?an.x+=1e-4:an.z+=1e-4,an.normalize(),nn.crossVectors(n,an)),nn.normalize(),rn.crossVectors(an,nn),r[0]=nn.x,r[4]=rn.x,r[8]=an.x,r[1]=nn.y,r[5]=rn.y,r[9]=an.y,r[2]=nn.z,r[6]=rn.z,r[10]=an.z,this}),multiply:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var n=e.elements,r=t.elements,i=this.elements,a=n[0],o=n[4],s=n[8],c=n[12],l=n[1],u=n[5],h=n[9],p=n[13],d=n[2],f=n[6],m=n[10],g=n[14],v=n[3],y=n[7],b=n[11],_=n[15],w=r[0],x=r[4],E=r[8],M=r[12],S=r[1],T=r[5],P=r[9],A=r[13],O=r[2],C=r[6],R=r[10],L=r[14],I=r[3],k=r[7],N=r[11],z=r[15];return i[0]=a*w+o*S+s*O+c*I,i[4]=a*x+o*T+s*C+c*k,i[8]=a*E+o*P+s*R+c*N,i[12]=a*M+o*A+s*L+c*z,i[1]=l*w+u*S+h*O+p*I,i[5]=l*x+u*T+h*C+p*k,i[9]=l*E+u*P+h*R+p*N,i[13]=l*M+u*A+h*L+p*z,i[2]=d*w+f*S+m*O+g*I,i[6]=d*x+f*T+m*C+g*k,i[10]=d*E+f*P+m*R+g*N,i[14]=d*M+f*A+m*L+g*z,i[3]=v*w+y*S+b*O+_*I,i[7]=v*x+y*T+b*C+_*k,i[11]=v*E+y*P+b*R+_*N,i[15]=v*M+y*A+b*L+_*z,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},applyToBufferAttribute:function(){var e=new Xt;return function(t){for(var n=0,r=t.count;n<r;n++)e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.applyMatrix4(this),t.setXYZ(n,e.x,e.y,e.z);return t}}(),determinant:function(){var e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],a=e[1],o=e[5],s=e[9],c=e[13],l=e[2],u=e[6],h=e[10],p=e[14];return e[3]*(+i*s*u-r*c*u-i*o*h+n*c*h+r*o*p-n*s*p)+e[7]*(+t*s*p-t*c*h+i*a*h-r*a*p+r*c*l-i*s*l)+e[11]*(+t*c*u-t*o*p-i*a*u+n*a*p+i*o*l-n*c*l)+e[15]*(-r*o*l-t*s*u+t*o*h+r*a*u-n*a*h+n*s*l)},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(e){var t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this},getInverse:function(e,t){var n=this.elements,r=e.elements,i=r[0],a=r[1],o=r[2],s=r[3],c=r[4],l=r[5],u=r[6],h=r[7],p=r[8],d=r[9],f=r[10],m=r[11],g=r[12],v=r[13],y=r[14],b=r[15],_=d*y*h-v*f*h+v*u*m-l*y*m-d*u*b+l*f*b,w=g*f*h-p*y*h-g*u*m+c*y*m+p*u*b-c*f*b,x=p*v*h-g*d*h+g*l*m-c*v*m-p*l*b+c*d*b,E=g*d*u-p*v*u-g*l*f+c*v*f+p*l*y-c*d*y,M=i*_+a*w+o*x+s*E;if(0===M){var S="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(S);return console.warn(S),this.identity()}var T=1/M;return n[0]=_*T,n[1]=(v*f*s-d*y*s-v*o*m+a*y*m+d*o*b-a*f*b)*T,n[2]=(l*y*s-v*u*s+v*o*h-a*y*h-l*o*b+a*u*b)*T,n[3]=(d*u*s-l*f*s-d*o*h+a*f*h+l*o*m-a*u*m)*T,n[4]=w*T,n[5]=(p*y*s-g*f*s+g*o*m-i*y*m-p*o*b+i*f*b)*T,n[6]=(g*u*s-c*y*s-g*o*h+i*y*h+c*o*b-i*u*b)*T,n[7]=(c*f*s-p*u*s+p*o*h-i*f*h-c*o*m+i*u*m)*T,n[8]=x*T,n[9]=(g*d*s-p*v*s-g*a*m+i*v*m+p*a*b-i*d*b)*T,n[10]=(c*v*s-g*l*s+g*a*h-i*v*h-c*a*b+i*l*b)*T,n[11]=(p*l*s-c*d*s-p*a*h+i*d*h+c*a*m-i*l*m)*T,n[12]=E*T,n[13]=(p*v*o-g*d*o+g*a*f-i*v*f-p*a*y+i*d*y)*T,n[14]=(g*l*o-c*v*o-g*a*u+i*v*u+c*a*y-i*l*y)*T,n[15]=(c*d*o-p*l*o+p*a*u-i*d*u-c*a*f+i*l*f)*T,this},scale:function(e){var t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))},makeTranslation:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=1-n,a=e.x,o=e.y,s=e.z,c=i*a,l=i*o;return this.set(c*a+n,c*o-r*s,c*s+r*o,0,c*o+r*s,l*o+n,l*s-r*a,0,c*s-r*o,l*s+r*a,i*s*s+n,0,0,0,0,1),this},makeScale:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(e,t,n){return this.set(1,t,n,0,e,1,n,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,n){var r=this.elements,i=t._x,a=t._y,o=t._z,s=t._w,c=i+i,l=a+a,u=o+o,h=i*c,p=i*l,d=i*u,f=a*l,m=a*u,g=o*u,v=s*c,y=s*l,b=s*u,_=n.x,w=n.y,x=n.z;return r[0]=(1-(f+g))*_,r[1]=(p+b)*_,r[2]=(d-y)*_,r[3]=0,r[4]=(p-b)*w,r[5]=(1-(h+g))*w,r[6]=(m+v)*w,r[7]=0,r[8]=(d+y)*x,r[9]=(m-v)*x,r[10]=(1-(h+f))*x,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this},decompose:(en=new Xt,tn=new _n,function(e,t,n){var r=this.elements,i=en.set(r[0],r[1],r[2]).length(),a=en.set(r[4],r[5],r[6]).length(),o=en.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],tn.copy(this);var s=1/i,c=1/a,l=1/o;return tn.elements[0]*=s,tn.elements[1]*=s,tn.elements[2]*=s,tn.elements[4]*=c,tn.elements[5]*=c,tn.elements[6]*=c,tn.elements[8]*=l,tn.elements[9]*=l,tn.elements[10]*=l,t.setFromRotationMatrix(tn),n.x=i,n.y=a,n.z=o,this}),makePerspective:function(e,t,n,r,i,a){void 0===a&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var o=this.elements,s=2*i/(t-e),c=2*i/(n-r),l=(t+e)/(t-e),u=(n+r)/(n-r),h=-(a+i)/(a-i),p=-2*a*i/(a-i);return o[0]=s,o[4]=0,o[8]=l,o[12]=0,o[1]=0,o[5]=c,o[9]=u,o[13]=0,o[2]=0,o[6]=0,o[10]=h,o[14]=p,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},makeOrthographic:function(e,t,n,r,i,a){var o=this.elements,s=1/(t-e),c=1/(n-r),l=1/(a-i),u=(t+e)*s,h=(n+r)*c,p=(a+i)*l;return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-u,o[1]=0,o[5]=2*c,o[9]=0,o[13]=-h,o[2]=0,o[6]=0,o[10]=-2*l,o[14]=-p,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},equals:function(e){for(var t=this.elements,n=e.elements,r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var n=0;n<16;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}});var wn={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick( specularColor, dotNV );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvarying vec3 vViewPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV( sampler2D envMap, vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = normalMatrix * objectTangent;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent ));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif",lights_pars_begin:"uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#endif\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\tfloat clearCoatInv = 1.0 - clearCoatDHR;\n\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec3 singleScattering = vec3( 0.0 );\n\t\tvec3 multiScattering = vec3( 0.0 );\n\t\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\t\tvec3 diffuse = material.diffuseColor;\n\t\treflectedLight.indirectSpecular += clearCoatInv * radiance * singleScattering;\n\t\treflectedLight.indirectDiffuse += multiScattering * cosineWeightedIrradiance;\n\t\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n\t#else\n\t\treflectedLight.indirectSpecular += clearCoatInv * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#endif\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearCoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\t#ifndef STANDARD\n\t\tclearCoatRadiance += getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, irradiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t#endif\n#endif",normal_fragment_maps:"#ifdef USE_NORMALMAP\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t#ifdef FLIP_SIDED\n\t\t\tnormal = - normal;\n\t\t#endif\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\tnormal = normalize( normalMatrix * normal );\n\t#else\n\t\t#ifdef USE_TANGENT\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t\tmapN.xy = normalScale * mapN.xy;\n\t\t\tnormal = normalize( vTBN * mapN );\n\t\t#else\n\t\t\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n\t\t#endif\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tuniform mat3 normalMatrix;\n\t#else\n\t\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\t\tvec2 st0 = dFdx( vUv.st );\n\t\t\tvec2 st1 = dFdy( vUv.st );\n\t\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\t\tvec3 N = normalize( surf_norm );\n\t\t\tmat3 tsn = mat3( S, T, N );\n\t\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t\tmapN.xy *= normalScale;\n\t\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\treturn normalize( tsn * mapN );\n\t\t}\n\t#endif\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#if defined( DITHERING )\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );\n}",uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"};function xn(e){var t={};for(var n in e)for(var r in t[n]={},e[n]){var i=e[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?t[n][r]=i.clone():Array.isArray(i)?t[n][r]=i.slice():t[n][r]=i}return t}function En(e){for(var t={},n=0;n<e.length;n++){var r=xn(e[n]);for(var i in r)t[i]=r[i]}return t}var Mn,Sn,Tn,Pn={clone:xn,merge:En},An={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function On(e,t,n){return void 0===t&&void 0===n?this.set(e):this.setRGB(e,t,n)}Object.assign(On.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setScalar:function(e){return this.r=e,this.g=e,this.b=e,this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,t,n){return this.r=e,this.g=t,this.b=n,this},setHSL:function(){function e(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}return function(t,n,r){if(t=Gt.euclideanModulo(t,1),n=Gt.clamp(n,0,1),r=Gt.clamp(r,0,1),0===n)this.r=this.g=this.b=r;else{var i=r<=.5?r*(1+n):r+n-r*n,a=2*r-i;this.r=e(a,i,t+1/3),this.g=e(a,i,t),this.b=e(a,i,t-1/3)}return this}}(),setStyle:function(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var r,i=n[1],a=n[2];switch(i){case"rgb":case"rgba":if(r=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,t(r[5]),this;if(r=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,t(r[5]),this;break;case"hsl":case"hsla":if(r=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a)){var o=parseFloat(r[1])/360,s=parseInt(r[2],10)/100,c=parseInt(r[3],10)/100;return t(r[5]),this.setHSL(o,s,c)}}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(e)){var l,u=(l=n[1]).length;if(3===u)return this.r=parseInt(l.charAt(0)+l.charAt(0),16)/255,this.g=parseInt(l.charAt(1)+l.charAt(1),16)/255,this.b=parseInt(l.charAt(2)+l.charAt(2),16)/255,this;if(6===u)return this.r=parseInt(l.charAt(0)+l.charAt(1),16)/255,this.g=parseInt(l.charAt(2)+l.charAt(3),16)/255,this.b=parseInt(l.charAt(4)+l.charAt(5),16)/255,this}e&&e.length>0&&(void 0!==(l=An[e])?this.setHex(l):console.warn("THREE.Color: Unknown color "+e));return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){void 0===t&&(t=2);var n=t>0?1/t:1;return this.r=Math.pow(e.r,n),this.g=Math.pow(e.g,n),this.b=Math.pow(e.b,n),this},convertGammaToLinear:function(e){return this.copyGammaToLinear(this,e),this},convertLinearToGamma:function(e){return this.copyLinearToGamma(this,e),this},copySRGBToLinear:function(){function e(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}return function(t){return this.r=e(t.r),this.g=e(t.g),this.b=e(t.b),this}}(),copyLinearToSRGB:function(){function e(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}return function(t){return this.r=e(t.r),this.g=e(t.g),this.b=e(t.b),this}}(),convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){void 0===e&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});var t,n,r=this.r,i=this.g,a=this.b,o=Math.max(r,i,a),s=Math.min(r,i,a),c=(s+o)/2;if(s===o)t=0,n=0;else{var l=o-s;switch(n=c<=.5?l/(o+s):l/(2-o-s),o){case r:t=(i-a)/l+(i<a?6:0);break;case i:t=(a-r)/l+2;break;case a:t=(r-i)/l+4}t/=6}return e.h=t,e.s=n,e.l=c,e},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:(Tn={},function(e,t,n){return this.getHSL(Tn),Tn.h+=e,Tn.s+=t,Tn.l+=n,this.setHSL(Tn.h,Tn.s,Tn.l),this}),add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},lerpHSL:(Mn={h:0,s:0,l:0},Sn={h:0,s:0,l:0},function(e,t){this.getHSL(Mn),e.getHSL(Sn);var n=Gt.lerp(Mn.h,Sn.h,t),r=Gt.lerp(Mn.s,Sn.s,t),i=Gt.lerp(Mn.l,Sn.l,t);return this.setHSL(n,r,i),this}),equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return void 0===t&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},toJSON:function(){return this.getHex()}});var Cn,Rn={common:{diffuse:{value:new On(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Yt},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Wt(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new On(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new On(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new Yt}},sprite:{diffuse:{value:new On(15658734)},opacity:{value:1},center:{value:new Wt(.5,.5)},rotation:{value:0},map:{value:null},uvTransform:{value:new Yt}}},Ln={basic:{uniforms:En([Rn.common,Rn.specularmap,Rn.envmap,Rn.aomap,Rn.lightmap,Rn.fog]),vertexShader:wn.meshbasic_vert,fragmentShader:wn.meshbasic_frag},lambert:{uniforms:En([Rn.common,Rn.specularmap,Rn.envmap,Rn.aomap,Rn.lightmap,Rn.emissivemap,Rn.fog,Rn.lights,{emissive:{value:new On(0)}}]),vertexShader:wn.meshlambert_vert,fragmentShader:wn.meshlambert_frag},phong:{uniforms:En([Rn.common,Rn.specularmap,Rn.envmap,Rn.aomap,Rn.lightmap,Rn.emissivemap,Rn.bumpmap,Rn.normalmap,Rn.displacementmap,Rn.gradientmap,Rn.fog,Rn.lights,{emissive:{value:new On(0)},specular:{value:new On(1118481)},shininess:{value:30}}]),vertexShader:wn.meshphong_vert,fragmentShader:wn.meshphong_frag},standard:{uniforms:En([Rn.common,Rn.envmap,Rn.aomap,Rn.lightmap,Rn.emissivemap,Rn.bumpmap,Rn.normalmap,Rn.displacementmap,Rn.roughnessmap,Rn.metalnessmap,Rn.fog,Rn.lights,{emissive:{value:new On(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:wn.meshphysical_vert,fragmentShader:wn.meshphysical_frag},matcap:{uniforms:En([Rn.common,Rn.bumpmap,Rn.normalmap,Rn.displacementmap,Rn.fog,{matcap:{value:null}}]),vertexShader:wn.meshmatcap_vert,fragmentShader:wn.meshmatcap_frag},points:{uniforms:En([Rn.points,Rn.fog]),vertexShader:wn.points_vert,fragmentShader:wn.points_frag},dashed:{uniforms:En([Rn.common,Rn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:wn.linedashed_vert,fragmentShader:wn.linedashed_frag},depth:{uniforms:En([Rn.common,Rn.displacementmap]),vertexShader:wn.depth_vert,fragmentShader:wn.depth_frag},normal:{uniforms:En([Rn.common,Rn.bumpmap,Rn.normalmap,Rn.displacementmap,{opacity:{value:1}}]),vertexShader:wn.normal_vert,fragmentShader:wn.normal_frag},sprite:{uniforms:En([Rn.sprite,Rn.fog]),vertexShader:wn.sprite_vert,fragmentShader:wn.sprite_frag},background:{uniforms:{uvTransform:{value:new Yt},t2D:{value:null}},vertexShader:wn.background_vert,fragmentShader:wn.background_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:wn.cube_vert,fragmentShader:wn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:wn.equirect_vert,fragmentShader:wn.equirect_frag},distanceRGBA:{uniforms:En([Rn.common,Rn.displacementmap,{referencePosition:{value:new Xt},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:wn.distanceRGBA_vert,fragmentShader:wn.distanceRGBA_frag},shadow:{uniforms:En([Rn.lights,Rn.fog,{color:{value:new On(0)},opacity:{value:1}}]),vertexShader:wn.shadow_vert,fragmentShader:wn.shadow_frag}};function In(){var e=null,t=!1,n=null;function r(i,a){!1!==t&&(n(i,a),e.requestAnimationFrame(r))}return{start:function(){!0!==t&&null!==n&&(e.requestAnimationFrame(r),t=!0)},stop:function(){t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function kn(e){var t=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),t.get(e)},remove:function(n){n.isInterleavedBufferAttribute&&(n=n.data);var r=t.get(n);r&&(e.deleteBuffer(r.buffer),t.delete(n))},update:function(n,r){n.isInterleavedBufferAttribute&&(n=n.data);var i=t.get(n);void 0===i?t.set(n,function(t,n){var r=t.array,i=t.dynamic?35048:35044,a=e.createBuffer();e.bindBuffer(n,a),e.bufferData(n,r,i),t.onUploadCallback();var o=5126;return r instanceof Float32Array?o=5126:r instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):r instanceof Uint16Array?o=5123:r instanceof Int16Array?o=5122:r instanceof Uint32Array?o=5125:r instanceof Int32Array?o=5124:r instanceof Int8Array?o=5120:r instanceof Uint8Array&&(o=5121),{buffer:a,type:o,bytesPerElement:r.BYTES_PER_ELEMENT,version:t.version}}(n,r)):i.version<n.version&&(function(t,n,r){var i=n.array,a=n.updateRange;e.bindBuffer(r,t),!1===n.dynamic?e.bufferData(r,i,35044):-1===a.count?e.bufferSubData(r,0,i):0===a.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(e.bufferSubData(r,a.offset*i.BYTES_PER_ELEMENT,i.subarray(a.offset,a.offset+a.count)),a.count=-1)}(i.buffer,n,r),i.version=n.version)}}}function Nn(e,t,n,r,i,a){this.a=e,this.b=t,this.c=n,this.normal=r&&r.isVector3?r:new Xt,this.vertexNormals=Array.isArray(r)?r:[],this.color=i&&i.isColor?i:new On,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0!==a?a:0}function zn(e,t,n,r){this._x=e||0,this._y=t||0,this._z=n||0,this._order=r||zn.DefaultOrder}function Dn(){this.mask=1}Ln.physical={uniforms:En([Ln.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:wn.meshphysical_vert,fragmentShader:wn.meshphysical_frag},Object.assign(Nn.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,n=e.vertexNormals.length;t<n;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(t=0,n=e.vertexColors.length;t<n;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}}),zn.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],zn.DefaultOrder="XYZ",Object.defineProperties(zn.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this.onChangeCallback()}}}),Object.assign(zn.prototype,{isEuler:!0,set:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._order=r||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this.onChangeCallback(),this},setFromRotationMatrix:function(e,t,n){var r=Gt.clamp,i=e.elements,a=i[0],o=i[4],s=i[8],c=i[1],l=i[5],u=i[9],h=i[2],p=i[6],d=i[10];return"XYZ"===(t=t||this._order)?(this._y=Math.asin(r(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(-u,d),this._z=Math.atan2(-o,a)):(this._x=Math.atan2(p,l),this._z=0)):"YXZ"===t?(this._x=Math.asin(-r(u,-1,1)),Math.abs(u)<.99999?(this._y=Math.atan2(s,d),this._z=Math.atan2(c,l)):(this._y=Math.atan2(-h,a),this._z=0)):"ZXY"===t?(this._x=Math.asin(r(p,-1,1)),Math.abs(p)<.99999?(this._y=Math.atan2(-h,d),this._z=Math.atan2(-o,l)):(this._y=0,this._z=Math.atan2(c,a))):"ZYX"===t?(this._y=Math.asin(-r(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(p,d),this._z=Math.atan2(c,a)):(this._x=0,this._z=Math.atan2(-o,l))):"YZX"===t?(this._z=Math.asin(r(c,-1,1)),Math.abs(c)<.99999?(this._x=Math.atan2(-u,l),this._y=Math.atan2(-h,a)):(this._x=0,this._y=Math.atan2(s,d))):"XZY"===t?(this._z=Math.asin(-r(o,-1,1)),Math.abs(o)<.99999?(this._x=Math.atan2(p,l),this._y=Math.atan2(s,a)):(this._x=Math.atan2(-u,d),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,!1!==n&&this.onChangeCallback(),this},setFromQuaternion:function(){var e=new _n;return function(t,n,r){return e.makeRotationFromQuaternion(t),this.setFromRotationMatrix(e,n,r)}}(),setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:(Cn=new qt,function(e){return Cn.setFromEuler(this),this.setFromQuaternion(Cn,e)}),equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new Xt(this._x,this._y,this._z)},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(Dn.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask|=1<<e|0},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},test:function(e){return 0!=(this.mask&e.mask)}});var Bn,jn,Fn,Un,Vn=0;function Hn(){Object.defineProperty(this,"id",{value:Vn++}),this.uuid=Gt.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Hn.DefaultUp.clone();var e=new Xt,t=new zn,n=new qt,r=new Xt(1,1,1);t.onChange(function(){n.setFromEuler(t,!1)}),n.onChange(function(){t.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new _n},normalMatrix:{value:new Yt}}),this.matrix=new _n,this.matrixWorld=new _n,this.matrixAutoUpdate=Hn.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Dn,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}Hn.DefaultUp=new Xt(0,1,0),Hn.DefaultMatrixAutoUpdate=!0,Hn.prototype=Object.assign(Object.create(r.prototype),{constructor:Hn,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(e){this.matrix.multiplyMatrices(e,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:(Un=new qt,function(e,t){return Un.setFromAxisAngle(e,t),this.quaternion.multiply(Un),this}),rotateOnWorldAxis:function(){var e=new qt;return function(t,n){return e.setFromAxisAngle(t,n),this.quaternion.premultiply(e),this}}(),rotateX:function(){var e=new Xt(1,0,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateY:function(){var e=new Xt(0,1,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateZ:function(){var e=new Xt(0,0,1);return function(t){return this.rotateOnAxis(e,t)}}(),translateOnAxis:function(){var e=new Xt;return function(t,n){return e.copy(t).applyQuaternion(this.quaternion),this.position.add(e.multiplyScalar(n)),this}}(),translateX:function(){var e=new Xt(1,0,0);return function(t){return this.translateOnAxis(e,t)}}(),translateY:function(){var e=new Xt(0,1,0);return function(t){return this.translateOnAxis(e,t)}}(),translateZ:function(){var e=new Xt(0,0,1);return function(t){return this.translateOnAxis(e,t)}}(),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:(Fn=new _n,function(e){return e.applyMatrix4(Fn.getInverse(this.matrixWorld))}),lookAt:function(){var e=new qt,t=new _n,n=new Xt,r=new Xt;return function(i,a,o){i.isVector3?n.copy(i):n.set(i,a,o);var s=this.parent;this.updateWorldMatrix(!0,!1),r.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?t.lookAt(r,n,this.up):t.lookAt(n,r,this.up),this.quaternion.setFromRotationMatrix(t),s&&(t.extractRotation(s.matrixWorld),e.setFromRotationMatrix(t),this.quaternion.premultiply(e.inverse()))}}(),add:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,e.dispatchEvent({type:"added"}),this.children.push(e)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var n=this.children.indexOf(e);return-1!==n&&(e.parent=null,e.dispatchEvent({type:"removed"}),this.children.splice(n,1)),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n].getObjectByProperty(e,t);if(void 0!==i)return i}},getWorldPosition:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new Xt),this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:(Bn=new Xt,jn=new Xt,function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),e=new qt),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Bn,e,jn),e}),getWorldScale:function(){var e=new Xt,t=new qt;return function(n){return void 0===n&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),n=new Xt),this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,t,n),n}}(),getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new Xt),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()},raycast:function(){},traverse:function(e){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)},updateWorldMatrix:function(e,t){var n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t)for(var r=this.children,i=0,a=r.length;i<a;i++)r[i].updateWorldMatrix(!1,!0)},toJSON:function(e){var t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};function i(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isMesh&&this.drawMode!==Ot&&(r.drawMode=this.drawMode),this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);var a=this.geometry.parameters;if(void 0!==a&&void 0!==a.shapes){var o=a.shapes;if(Array.isArray(o))for(var s=0,c=o.length;s<c;s++){var l=o[s];i(e.shapes,l)}else i(e.shapes,o)}}if(void 0!==this.material)if(Array.isArray(this.material)){var u=[];for(s=0,c=this.material.length;s<c;s++)u.push(i(e.materials,this.material[s]));r.material=u}else r.material=i(e.materials,this.material);if(this.children.length>0){r.children=[];for(s=0;s<this.children.length;s++)r.children.push(this.children[s].toJSON(e).object)}if(t){var h=m(e.geometries),p=m(e.materials),d=m(e.textures),f=m(e.images);o=m(e.shapes);h.length>0&&(n.geometries=h),p.length>0&&(n.materials=p),d.length>0&&(n.textures=d),f.length>0&&(n.images=f),o.length>0&&(n.shapes=o)}return n.object=r,n;function m(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e,t){if(void 0===t&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var n=0;n<e.children.length;n++){var r=e.children[n];this.add(r.clone())}return this}});var Gn,Wn,qn=0;function Xn(){Object.defineProperty(this,"id",{value:qn+=2}),this.uuid=Gt.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function Yn(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function Kn(e,t,n){Yn.call(this,new Int8Array(e),t,n)}function $n(e,t,n){Yn.call(this,new Uint8Array(e),t,n)}function Zn(e,t,n){Yn.call(this,new Uint8ClampedArray(e),t,n)}function Jn(e,t,n){Yn.call(this,new Int16Array(e),t,n)}function Qn(e,t,n){Yn.call(this,new Uint16Array(e),t,n)}function er(e,t,n){Yn.call(this,new Int32Array(e),t,n)}function tr(e,t,n){Yn.call(this,new Uint32Array(e),t,n)}function nr(e,t,n){Yn.call(this,new Float32Array(e),t,n)}function rr(e,t,n){Yn.call(this,new Float64Array(e),t,n)}function ir(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function ar(e){if(0===e.length)return-1/0;for(var t=e[0],n=1,r=e.length;n<r;++n)e[n]>t&&(t=e[n]);return t}Xn.prototype=Object.assign(Object.create(r.prototype),{constructor:Xn,isGeometry:!0,applyMatrix:function(e){for(var t=(new Yt).getNormalMatrix(e),n=0,r=this.vertices.length;n<r;n++){this.vertices[n].applyMatrix4(e)}for(n=0,r=this.faces.length;n<r;n++){var i=this.faces[n];i.normal.applyMatrix3(t).normalize();for(var a=0,o=i.vertexNormals.length;a<o;a++)i.vertexNormals[a].applyMatrix3(t).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var e=new _n;return function(t){return e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e=new _n;return function(t){return e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e=new _n;return function(t){return e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e=new _n;return function(t,n,r){return e.makeTranslation(t,n,r),this.applyMatrix(e),this}}(),scale:function(){var e=new _n;return function(t,n,r){return e.makeScale(t,n,r),this.applyMatrix(e),this}}(),lookAt:(Wn=new Hn,function(e){Wn.lookAt(e),Wn.updateMatrix(),this.applyMatrix(Wn.matrix)}),fromBufferGeometry:function(e){var t=this,n=null!==e.index?e.index.array:void 0,r=e.attributes,i=r.position.array,a=void 0!==r.normal?r.normal.array:void 0,o=void 0!==r.color?r.color.array:void 0,s=void 0!==r.uv?r.uv.array:void 0,c=void 0!==r.uv2?r.uv2.array:void 0;void 0!==c&&(this.faceVertexUvs[1]=[]);for(var l=0,u=0;l<i.length;l+=3,u+=2)t.vertices.push((new Xt).fromArray(i,l)),void 0!==o&&t.colors.push((new On).fromArray(o,l));function h(e,n,r,i){var l=void 0===o?[]:[t.colors[e].clone(),t.colors[n].clone(),t.colors[r].clone()],u=new Nn(e,n,r,void 0===a?[]:[(new Xt).fromArray(a,3*e),(new Xt).fromArray(a,3*n),(new Xt).fromArray(a,3*r)],l,i);t.faces.push(u),void 0!==s&&t.faceVertexUvs[0].push([(new Wt).fromArray(s,2*e),(new Wt).fromArray(s,2*n),(new Wt).fromArray(s,2*r)]),void 0!==c&&t.faceVertexUvs[1].push([(new Wt).fromArray(c,2*e),(new Wt).fromArray(c,2*n),(new Wt).fromArray(c,2*r)])}var p=e.groups;if(p.length>0)for(l=0;l<p.length;l++)for(var d=p[l],f=d.start,m=(u=f,f+d.count);u<m;u+=3)void 0!==n?h(n[u],n[u+1],n[u+2],d.materialIndex):h(u,u+1,u+2,d.materialIndex);else if(void 0!==n)for(l=0;l<n.length;l+=3)h(n[l],n[l+1],n[l+2]);else for(l=0;l<i.length/3;l+=3)h(l,l+1,l+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:(Gn=new Xt,function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Gn).negate(),this.translate(Gn.x,Gn.y,Gn.z),this}),normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,t=this.boundingSphere.radius,n=0===t?1:1/t,r=new _n;return r.set(n,0,0,-n*e.x,0,n,0,-n*e.y,0,0,n,-n*e.z,0,0,0,1),this.applyMatrix(r),this},computeFaceNormals:function(){for(var e=new Xt,t=new Xt,n=0,r=this.faces.length;n<r;n++){var i=this.faces[n],a=this.vertices[i.a],o=this.vertices[i.b],s=this.vertices[i.c];e.subVectors(s,o),t.subVectors(a,o),e.cross(t),e.normalize(),i.normal.copy(e)}},computeVertexNormals:function(e){var t,n,r,i,a,o;for(void 0===e&&(e=!0),o=new Array(this.vertices.length),t=0,n=this.vertices.length;t<n;t++)o[t]=new Xt;if(e){var s,c,l,u=new Xt,h=new Xt;for(r=0,i=this.faces.length;r<i;r++)a=this.faces[r],s=this.vertices[a.a],c=this.vertices[a.b],l=this.vertices[a.c],u.subVectors(l,c),h.subVectors(s,c),u.cross(h),o[a.a].add(u),o[a.b].add(u),o[a.c].add(u)}else for(this.computeFaceNormals(),r=0,i=this.faces.length;r<i;r++)o[(a=this.faces[r]).a].add(a.normal),o[a.b].add(a.normal),o[a.c].add(a.normal);for(t=0,n=this.vertices.length;t<n;t++)o[t].normalize();for(r=0,i=this.faces.length;r<i;r++){var p=(a=this.faces[r]).vertexNormals;3===p.length?(p[0].copy(o[a.a]),p[1].copy(o[a.b]),p[2].copy(o[a.c])):(p[0]=o[a.a].clone(),p[1]=o[a.b].clone(),p[2]=o[a.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var e,t,n;for(this.computeFaceNormals(),e=0,t=this.faces.length;e<t;e++){var r=(n=this.faces[e]).vertexNormals;3===r.length?(r[0].copy(n.normal),r[1].copy(n.normal),r[2].copy(n.normal)):(r[0]=n.normal.clone(),r[1]=n.normal.clone(),r[2]=n.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var e,t,n,r,i;for(n=0,r=this.faces.length;n<r;n++)for((i=this.faces[n]).__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]),e=0,t=i.vertexNormals.length;e<t;e++)i.__originalVertexNormals[e]?i.__originalVertexNormals[e].copy(i.vertexNormals[e]):i.__originalVertexNormals[e]=i.vertexNormals[e].clone();var a=new Xn;for(a.faces=this.faces,e=0,t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var o=this.morphNormals[e].faceNormals,s=this.morphNormals[e].vertexNormals;for(n=0,r=this.faces.length;n<r;n++)c=new Xt,l={a:new Xt,b:new Xt,c:new Xt},o.push(c),s.push(l)}var c,l,u=this.morphNormals[e];for(a.vertices=this.morphTargets[e].vertices,a.computeFaceNormals(),a.computeVertexNormals(),n=0,r=this.faces.length;n<r;n++)i=this.faces[n],c=u.faceNormals[n],l=u.vertexNormals[n],c.copy(i.normal),l.a.copy(i.vertexNormals[0]),l.b.copy(i.vertexNormals[1]),l.c.copy(i.vertexNormals[2])}for(n=0,r=this.faces.length;n<r;n++)(i=this.faces[n]).normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new gn),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new vn),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,n){if(e&&e.isGeometry){var r,i=this.vertices.length,a=this.vertices,o=e.vertices,s=this.faces,c=e.faces,l=this.faceVertexUvs[0],u=e.faceVertexUvs[0],h=this.colors,p=e.colors;void 0===n&&(n=0),void 0!==t&&(r=(new Yt).getNormalMatrix(t));for(var d=0,f=o.length;d<f;d++){var m=o[d].clone();void 0!==t&&m.applyMatrix4(t),a.push(m)}for(d=0,f=p.length;d<f;d++)h.push(p[d].clone());for(d=0,f=c.length;d<f;d++){var g,v,y,b=c[d],_=b.vertexNormals,w=b.vertexColors;(g=new Nn(b.a+i,b.b+i,b.c+i)).normal.copy(b.normal),void 0!==r&&g.normal.applyMatrix3(r).normalize();for(var x=0,E=_.length;x<E;x++)v=_[x].clone(),void 0!==r&&v.applyMatrix3(r).normalize(),g.vertexNormals.push(v);g.color.copy(b.color);for(x=0,E=w.length;x<E;x++)y=w[x],g.vertexColors.push(y.clone());g.materialIndex=b.materialIndex+n,s.push(g)}for(d=0,f=u.length;d<f;d++){var M=u[d],S=[];if(void 0!==M){for(x=0,E=M.length;x<E;x++)S.push(M[x].clone());l.push(S)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e)},mergeMesh:function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},mergeVertices:function(){var e,t,n,r,i,a,o,s,c={},l=[],u=[],h=Math.pow(10,4);for(n=0,r=this.vertices.length;n<r;n++)e=this.vertices[n],void 0===c[t=Math.round(e.x*h)+"_"+Math.round(e.y*h)+"_"+Math.round(e.z*h)]?(c[t]=n,l.push(this.vertices[n]),u[n]=l.length-1):u[n]=u[c[t]];var p=[];for(n=0,r=this.faces.length;n<r;n++){(i=this.faces[n]).a=u[i.a],i.b=u[i.b],i.c=u[i.c],a=[i.a,i.b,i.c];for(var d=0;d<3;d++)if(a[d]===a[(d+1)%3]){p.push(n);break}}for(n=p.length-1;n>=0;n--){var f=p[n];for(this.faces.splice(f,1),o=0,s=this.faceVertexUvs.length;o<s;o++)this.faceVertexUvs[o].splice(f,1)}var m=this.vertices.length-l.length;return this.vertices=l,m},setFromPoints:function(e){this.vertices=[];for(var t=0,n=e.length;t<n;t++){var r=e[t];this.vertices.push(new Xt(r.x,r.y,r.z||0))}return this},sortFacesByMaterialIndex:function(){for(var e=this.faces,t=e.length,n=0;n<t;n++)e[n]._id=n;e.sort(function(e,t){return e.materialIndex-t.materialIndex});var r,i,a=this.faceVertexUvs[0],o=this.faceVertexUvs[1];a&&a.length===t&&(r=[]),o&&o.length===t&&(i=[]);for(n=0;n<t;n++){var s=e[n]._id;r&&r.push(a[s]),i&&i.push(o[s])}r&&(this.faceVertexUvs[0]=r),i&&(this.faceVertexUvs[1]=i)},toJSON:function(){var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}for(var r=[],i=0;i<this.vertices.length;i++){var a=this.vertices[i];r.push(a.x,a.y,a.z)}var o=[],s=[],c={},l=[],u={},h=[],p={};for(i=0;i<this.faces.length;i++){var d=this.faces[i],f=void 0!==this.faceVertexUvs[0][i],m=d.normal.length()>0,g=d.vertexNormals.length>0,v=1!==d.color.r||1!==d.color.g||1!==d.color.b,y=d.vertexColors.length>0,b=0;if(b=E(b,0,0),b=E(b,1,!0),b=E(b,2,!1),b=E(b,3,f),b=E(b,4,m),b=E(b,5,g),b=E(b,6,v),b=E(b,7,y),o.push(b),o.push(d.a,d.b,d.c),o.push(d.materialIndex),f){var _=this.faceVertexUvs[0][i];o.push(T(_[0]),T(_[1]),T(_[2]))}if(m&&o.push(M(d.normal)),g){var w=d.vertexNormals;o.push(M(w[0]),M(w[1]),M(w[2]))}if(v&&o.push(S(d.color)),y){var x=d.vertexColors;o.push(S(x[0]),S(x[1]),S(x[2]))}}function E(e,t,n){return n?e|1<<t:e&~(1<<t)}function M(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==c[t]?c[t]:(c[t]=s.length/3,s.push(e.x,e.y,e.z),c[t])}function S(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==u[t]?u[t]:(u[t]=l.length,l.push(e.getHex()),u[t])}function T(e){var t=e.x.toString()+e.y.toString();return void 0!==p[t]?p[t]:(p[t]=h.length/2,h.push(e.x,e.y),p[t])}return e.data={},e.data.vertices=r,e.data.normals=s,l.length>0&&(e.data.colors=l),h.length>0&&(e.data.uvs=[h]),e.data.faces=o,e},clone:function(){return(new Xn).copy(this)},copy:function(e){var t,n,r,i,a,o;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var s=e.vertices;for(t=0,n=s.length;t<n;t++)this.vertices.push(s[t].clone());var c=e.colors;for(t=0,n=c.length;t<n;t++)this.colors.push(c[t].clone());var l=e.faces;for(t=0,n=l.length;t<n;t++)this.faces.push(l[t].clone());for(t=0,n=e.faceVertexUvs.length;t<n;t++){var u=e.faceVertexUvs[t];for(void 0===this.faceVertexUvs[t]&&(this.faceVertexUvs[t]=[]),r=0,i=u.length;r<i;r++){var h=u[r],p=[];for(a=0,o=h.length;a<o;a++){var d=h[a];p.push(d.clone())}this.faceVertexUvs[t].push(p)}}var f=e.morphTargets;for(t=0,n=f.length;t<n;t++){var m={};if(m.name=f[t].name,void 0!==f[t].vertices)for(m.vertices=[],r=0,i=f[t].vertices.length;r<i;r++)m.vertices.push(f[t].vertices[r].clone());if(void 0!==f[t].normals)for(m.normals=[],r=0,i=f[t].normals.length;r<i;r++)m.normals.push(f[t].normals[r].clone());this.morphTargets.push(m)}var g=e.morphNormals;for(t=0,n=g.length;t<n;t++){var v={};if(void 0!==g[t].vertexNormals)for(v.vertexNormals=[],r=0,i=g[t].vertexNormals.length;r<i;r++){var y=g[t].vertexNormals[r],b={};b.a=y.a.clone(),b.b=y.b.clone(),b.c=y.c.clone(),v.vertexNormals.push(b)}if(void 0!==g[t].faceNormals)for(v.faceNormals=[],r=0,i=g[t].faceNormals.length;r<i;r++)v.faceNormals.push(g[t].faceNormals[r].clone());this.morphNormals.push(v)}var _=e.skinWeights;for(t=0,n=_.length;t<n;t++)this.skinWeights.push(_[t].clone());var w=e.skinIndices;for(t=0,n=w.length;t<n;t++)this.skinIndices.push(w[t].clone());var x=e.lineDistances;for(t=0,n=x.length;t<n;t++)this.lineDistances.push(x[t]);var E=e.boundingBox;null!==E&&(this.boundingBox=E.clone());var M=e.boundingSphere;return null!==M&&(this.boundingSphere=M.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(Yn.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(Yn.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=void 0!==e?e.length/this.itemSize:0,this.array=e,this},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.dynamic=e.dynamic,this},copyAt:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(var r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),a=new On),t[n++]=a.r,t[n++]=a.g,t[n++]=a.b}return this},copyVector2sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),a=new Wt),t[n++]=a.x,t[n++]=a.y}return this},copyVector3sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),a=new Xt),t[n++]=a.x,t[n++]=a.y,t[n++]=a.z}return this},copyVector4sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),a=new hn),t[n++]=a.x,t[n++]=a.y,t[n++]=a.z,t[n++]=a.w}return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this},setXYZ:function(e,t,n,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this},setXYZW:function(e,t,n,r,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),Kn.prototype=Object.create(Yn.prototype),Kn.prototype.constructor=Kn,$n.prototype=Object.create(Yn.prototype),$n.prototype.constructor=$n,Zn.prototype=Object.create(Yn.prototype),Zn.prototype.constructor=Zn,Jn.prototype=Object.create(Yn.prototype),Jn.prototype.constructor=Jn,Qn.prototype=Object.create(Yn.prototype),Qn.prototype.constructor=Qn,er.prototype=Object.create(Yn.prototype),er.prototype.constructor=er,tr.prototype=Object.create(Yn.prototype),tr.prototype.constructor=tr,nr.prototype=Object.create(Yn.prototype),nr.prototype.constructor=nr,rr.prototype=Object.create(Yn.prototype),rr.prototype.constructor=rr,Object.assign(ir.prototype,{computeGroups:function(e){for(var t,n=[],r=void 0,i=e.faces,a=0;a<i.length;a++){var o=i[a];o.materialIndex!==r&&(r=o.materialIndex,void 0!==t&&(t.count=3*a-t.start,n.push(t)),t={start:3*a,materialIndex:r})}void 0!==t&&(t.count=3*a-t.start,n.push(t)),this.groups=n},fromGeometry:function(e){var t,n=e.faces,r=e.vertices,i=e.faceVertexUvs,a=i[0]&&i[0].length>0,o=i[1]&&i[1].length>0,s=e.morphTargets,c=s.length;if(c>0){t=[];for(var l=0;l<c;l++)t[l]={name:s[l].name,data:[]};this.morphTargets.position=t}var u,h=e.morphNormals,p=h.length;if(p>0){u=[];for(l=0;l<p;l++)u[l]={name:h[l].name,data:[]};this.morphTargets.normal=u}var d=e.skinIndices,f=e.skinWeights,m=d.length===r.length,g=f.length===r.length;r.length>0&&0===n.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(l=0;l<n.length;l++){var v=n[l];this.vertices.push(r[v.a],r[v.b],r[v.c]);var y=v.vertexNormals;if(3===y.length)this.normals.push(y[0],y[1],y[2]);else{var b=v.normal;this.normals.push(b,b,b)}var _,w=v.vertexColors;if(3===w.length)this.colors.push(w[0],w[1],w[2]);else{var x=v.color;this.colors.push(x,x,x)}if(!0===a)void 0!==(_=i[0][l])?this.uvs.push(_[0],_[1],_[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",l),this.uvs.push(new Wt,new Wt,new Wt));if(!0===o)void 0!==(_=i[1][l])?this.uvs2.push(_[0],_[1],_[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",l),this.uvs2.push(new Wt,new Wt,new Wt));for(var E=0;E<c;E++){var M=s[E].vertices;t[E].data.push(M[v.a],M[v.b],M[v.c])}for(E=0;E<p;E++){var S=h[E].vertexNormals[l];u[E].data.push(S.a,S.b,S.c)}m&&this.skinIndices.push(d[v.a],d[v.b],d[v.c]),g&&this.skinWeights.push(f[v.a],f[v.b],f[v.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}});var or=1;function sr(){Object.defineProperty(this,"id",{value:or+=2}),this.uuid=Gt.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}function cr(e,t,n,r,i,a){Xn.call(this),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:a},this.fromBufferGeometry(new lr(e,t,n,r,i,a)),this.mergeVertices()}function lr(e,t,n,r,i,a){sr.call(this),this.type="BoxBufferGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:a};var o=this;e=e||1,t=t||1,n=n||1,r=Math.floor(r)||1,i=Math.floor(i)||1,a=Math.floor(a)||1;var s=[],c=[],l=[],u=[],h=0,p=0;function d(e,t,n,r,i,a,d,f,m,g,v){var y,b,_=a/m,w=d/g,x=a/2,E=d/2,M=f/2,S=m+1,T=g+1,P=0,A=0,O=new Xt;for(b=0;b<T;b++){var C=b*w-E;for(y=0;y<S;y++){var R=y*_-x;O[e]=R*r,O[t]=C*i,O[n]=M,c.push(O.x,O.y,O.z),O[e]=0,O[t]=0,O[n]=f>0?1:-1,l.push(O.x,O.y,O.z),u.push(y/m),u.push(1-b/g),P+=1}}for(b=0;b<g;b++)for(y=0;y<m;y++){var L=h+y+S*b,I=h+y+S*(b+1),k=h+(y+1)+S*(b+1),N=h+(y+1)+S*b;s.push(L,I,N),s.push(I,k,N),A+=6}o.addGroup(p,A,v),p+=A,h+=P}d("z","y","x",-1,-1,n,t,e,a,i,0),d("z","y","x",1,-1,n,t,-e,a,i,1),d("x","z","y",1,1,e,n,t,r,a,2),d("x","z","y",1,-1,e,n,-t,r,a,3),d("x","y","z",1,-1,e,t,n,r,i,4),d("x","y","z",-1,-1,e,t,-n,r,i,5),this.setIndex(s),this.addAttribute("position",new nr(c,3)),this.addAttribute("normal",new nr(l,3)),this.addAttribute("uv",new nr(u,2))}function ur(e,t,n,r){Xn.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r},this.fromBufferGeometry(new hr(e,t,n,r)),this.mergeVertices()}function hr(e,t,n,r){sr.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};var i,a,o=(e=e||1)/2,s=(t=t||1)/2,c=Math.floor(n)||1,l=Math.floor(r)||1,u=c+1,h=l+1,p=e/c,d=t/l,f=[],m=[],g=[],v=[];for(a=0;a<h;a++){var y=a*d-s;for(i=0;i<u;i++){var b=i*p-o;m.push(b,-y,0),g.push(0,0,1),v.push(i/c),v.push(1-a/l)}}for(a=0;a<l;a++)for(i=0;i<c;i++){var _=i+u*a,w=i+u*(a+1),x=i+1+u*(a+1),E=i+1+u*a;f.push(_,w,E),f.push(w,x,E)}this.setIndex(f),this.addAttribute("position",new nr(m,3)),this.addAttribute("normal",new nr(g,3)),this.addAttribute("uv",new nr(v,2))}sr.prototype=Object.assign(Object.create(r.prototype),{constructor:sr,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){Array.isArray(e)?this.index=new(ar(e)>65535?tr:Qn)(e,1):this.index=e},addAttribute:function(e,t){return t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):(this.attributes[e]=t,this):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(e,new Yn(arguments[1],arguments[2])))},getAttribute:function(e){return this.attributes[e]},removeAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,n){this.groups.push({start:e,count:t,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix:function(e){var t=this.attributes.position;void 0!==t&&(e.applyToBufferAttribute(t),t.needsUpdate=!0);var n=this.attributes.normal;void 0!==n&&((new Yt).getNormalMatrix(e).applyToBufferAttribute(n),n.needsUpdate=!0);var r=this.attributes.tangent;void 0!==r&&((new Yt).getNormalMatrix(e).applyToBufferAttribute(r),r.needsUpdate=!0);return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var e=new _n;return function(t){return e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e=new _n;return function(t){return e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e=new _n;return function(t){return e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e=new _n;return function(t,n,r){return e.makeTranslation(t,n,r),this.applyMatrix(e),this}}(),scale:function(){var e=new _n;return function(t,n,r){return e.makeScale(t,n,r),this.applyMatrix(e),this}}(),lookAt:function(){var e=new Hn;return function(t){e.lookAt(t),e.updateMatrix(),this.applyMatrix(e.matrix)}}(),center:function(){var e=new Xt;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(e).negate(),this.translate(e.x,e.y,e.z),this}}(),setFromObject:function(e){var t=e.geometry;if(e.isPoints||e.isLine){var n=new nr(3*t.vertices.length,3),r=new nr(3*t.colors.length,3);if(this.addAttribute("position",n.copyVector3sArray(t.vertices)),this.addAttribute("color",r.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length){var i=new nr(t.lineDistances.length,1);this.addAttribute("lineDistance",i.copyArray(t.lineDistances))}null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone())}else e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t);return this},setFromPoints:function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];t.push(i.x,i.y,i.z||0)}return this.addAttribute("position",new nr(t,3)),this},updateFromObject:function(e){var t,n=e.geometry;if(e.isMesh){var r=n.__directGeometry;if(!0===n.elementsNeedUpdate&&(r=void 0,n.elementsNeedUpdate=!1),void 0===r)return this.fromGeometry(n);r.verticesNeedUpdate=n.verticesNeedUpdate,r.normalsNeedUpdate=n.normalsNeedUpdate,r.colorsNeedUpdate=n.colorsNeedUpdate,r.uvsNeedUpdate=n.uvsNeedUpdate,r.groupsNeedUpdate=n.groupsNeedUpdate,n.verticesNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.groupsNeedUpdate=!1,n=r}return!0===n.verticesNeedUpdate&&(void 0!==(t=this.attributes.position)&&(t.copyVector3sArray(n.vertices),t.needsUpdate=!0),n.verticesNeedUpdate=!1),!0===n.normalsNeedUpdate&&(void 0!==(t=this.attributes.normal)&&(t.copyVector3sArray(n.normals),t.needsUpdate=!0),n.normalsNeedUpdate=!1),!0===n.colorsNeedUpdate&&(void 0!==(t=this.attributes.color)&&(t.copyColorsArray(n.colors),t.needsUpdate=!0),n.colorsNeedUpdate=!1),n.uvsNeedUpdate&&(void 0!==(t=this.attributes.uv)&&(t.copyVector2sArray(n.uvs),t.needsUpdate=!0),n.uvsNeedUpdate=!1),n.lineDistancesNeedUpdate&&(void 0!==(t=this.attributes.lineDistance)&&(t.copyArray(n.lineDistances),t.needsUpdate=!0),n.lineDistancesNeedUpdate=!1),n.groupsNeedUpdate&&(n.computeGroups(e.geometry),this.groups=n.groups,n.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=(new ir).fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var t=new Float32Array(3*e.vertices.length);if(this.addAttribute("position",new Yn(t,3).copyVector3sArray(e.vertices)),e.normals.length>0){var n=new Float32Array(3*e.normals.length);this.addAttribute("normal",new Yn(n,3).copyVector3sArray(e.normals))}if(e.colors.length>0){var r=new Float32Array(3*e.colors.length);this.addAttribute("color",new Yn(r,3).copyColorsArray(e.colors))}if(e.uvs.length>0){var i=new Float32Array(2*e.uvs.length);this.addAttribute("uv",new Yn(i,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){var a=new Float32Array(2*e.uvs2.length);this.addAttribute("uv2",new Yn(a,2).copyVector2sArray(e.uvs2))}for(var o in this.groups=e.groups,e.morphTargets){for(var s=[],c=e.morphTargets[o],l=0,u=c.length;l<u;l++){var h=c[l],p=new nr(3*h.data.length,3);p.name=h.name,s.push(p.copyVector3sArray(h.data))}this.morphAttributes[o]=s}if(e.skinIndices.length>0){var d=new nr(4*e.skinIndices.length,4);this.addAttribute("skinIndex",d.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){var f=new nr(4*e.skinWeights.length,4);this.addAttribute("skinWeight",f.copyVector4sArray(e.skinWeights))}return null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){var e=new gn;return function(){null===this.boundingBox&&(this.boundingBox=new gn);var t=this.attributes.position,n=this.morphAttributes.position;if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),n)for(var r=0,i=n.length;r<i;r++){var a=n[r];e.setFromBufferAttribute(a),this.boundingBox.expandByPoint(e.min),this.boundingBox.expandByPoint(e.max)}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}}(),computeBoundingSphere:function(){var e=new gn,t=new gn,n=new Xt;return function(){null===this.boundingSphere&&(this.boundingSphere=new vn);var r=this.attributes.position,i=this.morphAttributes.position;if(r){var a=this.boundingSphere.center;if(e.setFromBufferAttribute(r),i)for(var o=0,s=i.length;o<s;o++){var c=i[o];t.setFromBufferAttribute(c),e.expandByPoint(t.min),e.expandByPoint(t.max)}e.getCenter(a);var l=0;for(o=0,s=r.count;o<s;o++)n.fromBufferAttribute(r,o),l=Math.max(l,a.distanceToSquared(n));if(i)for(o=0,s=i.length;o<s;o++)for(var u=0,h=(c=i[o]).count;u<h;u++)n.fromBufferAttribute(c,o),l=Math.max(l,a.distanceToSquared(n));this.boundingSphere.radius=Math.sqrt(l),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,t=this.attributes;if(t.position){var n=t.position.array;if(void 0===t.normal)this.addAttribute("normal",new Yn(new Float32Array(n.length),3));else for(var r=t.normal.array,i=0,a=r.length;i<a;i++)r[i]=0;var o,s,c,l=t.normal.array,u=new Xt,h=new Xt,p=new Xt,d=new Xt,f=new Xt;if(e){var m=e.array;for(i=0,a=e.count;i<a;i+=3)o=3*m[i+0],s=3*m[i+1],c=3*m[i+2],u.fromArray(n,o),h.fromArray(n,s),p.fromArray(n,c),d.subVectors(p,h),f.subVectors(u,h),d.cross(f),l[o]+=d.x,l[o+1]+=d.y,l[o+2]+=d.z,l[s]+=d.x,l[s+1]+=d.y,l[s+2]+=d.z,l[c]+=d.x,l[c+1]+=d.y,l[c+2]+=d.z}else for(i=0,a=n.length;i<a;i+=9)u.fromArray(n,i),h.fromArray(n,i+3),p.fromArray(n,i+6),d.subVectors(p,h),f.subVectors(u,h),d.cross(f),l[i]=d.x,l[i+1]=d.y,l[i+2]=d.z,l[i+3]=d.x,l[i+4]=d.y,l[i+5]=d.z,l[i+6]=d.x,l[i+7]=d.y,l[i+8]=d.z;this.normalizeNormals(),t.normal.needsUpdate=!0}},merge:function(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n=this.attributes;for(var r in n)if(void 0!==e.attributes[r])for(var i=n[r].array,a=e.attributes[r],o=a.array,s=0,c=a.itemSize*t;s<o.length;s++,c++)i[c]=o[s];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:function(){var e=new Xt;return function(){for(var t=this.attributes.normal,n=0,r=t.count;n<r;n++)e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.normalize(),t.setXYZ(n,e.x,e.y,e.z)}}(),toNonIndexed:function(){function e(e,t){for(var n=e.array,r=e.itemSize,i=new n.constructor(t.length*r),a=0,o=0,s=0,c=t.length;s<c;s++){a=t[s]*r;for(var l=0;l<r;l++)i[o++]=n[a++]}return new Yn(i,r)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t=new sr,n=this.index.array,r=this.attributes;for(var i in r){var a=e(r[i],n);t.addAttribute(i,a)}var o=this.morphAttributes;for(i in o){for(var s=[],c=o[i],l=0,u=c.length;l<u;l++){a=e(c[l],n);s.push(a)}t.morphAttributes[i]=s}for(var h=this.groups,p=(l=0,h.length);l<p;l++){var d=h[l];t.addGroup(d.start,d.count,d.materialIndex)}return t},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};var r=this.index;null!==r&&(e.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});var i=this.attributes;for(var n in i){var a={itemSize:(p=i[n]).itemSize,type:p.array.constructor.name,array:Array.prototype.slice.call(p.array),normalized:p.normalized};""!==p.name&&(a.name=p.name),e.data.attributes[n]=a}var o={},s=!1;for(var n in this.morphAttributes){for(var c=this.morphAttributes[n],l=[],u=0,h=c.length;u<h;u++){var p;a={itemSize:(p=c[u]).itemSize,type:p.array.constructor.name,array:Array.prototype.slice.call(p.array),normalized:p.normalized};""!==p.name&&(a.name=p.name),l.push(a)}l.length>0&&(o[n]=l,s=!0)}s&&(e.data.morphAttributes=o);var d=this.groups;d.length>0&&(e.data.groups=JSON.parse(JSON.stringify(d)));var f=this.boundingSphere;return null!==f&&(e.data.boundingSphere={center:f.center.toArray(),radius:f.radius}),e},clone:function(){return(new sr).copy(this)},copy:function(e){var t,n,r;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var i=e.index;null!==i&&this.setIndex(i.clone());var a=e.attributes;for(t in a){var o=a[t];this.addAttribute(t,o.clone())}var s=e.morphAttributes;for(t in s){var c=[],l=s[t];for(n=0,r=l.length;n<r;n++)c.push(l[n].clone());this.morphAttributes[t]=c}var u=e.groups;for(n=0,r=u.length;n<r;n++){var h=u[n];this.addGroup(h.start,h.count,h.materialIndex)}var p=e.boundingBox;null!==p&&(this.boundingBox=p.clone());var d=e.boundingSphere;return null!==d&&(this.boundingSphere=d.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),cr.prototype=Object.create(Xn.prototype),cr.prototype.constructor=cr,lr.prototype=Object.create(sr.prototype),lr.prototype.constructor=lr,ur.prototype=Object.create(Xn.prototype),ur.prototype.constructor=ur,hr.prototype=Object.create(sr.prototype),hr.prototype.constructor=hr;var pr=0;function dr(){Object.defineProperty(this,"id",{value:pr++}),this.uuid=Gt.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=O,this.side=_,this.flatShading=!1,this.vertexTangents=!1,this.vertexColors=S,this.opacity=1,this.transparent=!1,this.blendSrc=H,this.blendDst=G,this.blendEquation=k,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Q,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.userData={},this.needsUpdate=!0}dr.prototype=Object.assign(Object.create(r.prototype),{constructor:dr,isMaterial:!0,onBeforeCompile:function(){},setValues:function(e){if(void 0!==e)for(var t in e){var n=e[t];if(void 0!==n)if("shading"!==t){var r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===E;else console.warn("THREE.Material: '"+t+"' parameter is undefined.")}},toJSON:function(e){var t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearCoat&&(n.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(n.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,n.reflectivity=this.reflectivity,void 0!==this.combine&&(n.combine=this.combine),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==O&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),this.side!==_&&(n.side=this.side),this.vertexColors!==S&&(n.vertexColors=this.vertexColors),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.skinning&&(n.skinning=!0),!1===this.visible&&(n.visible=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t){var i=r(e.textures),a=r(e.images);i.length>0&&(n.textures=i),a.length>0&&(n.images=a)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.lights=e.lights,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.userData=JSON.parse(JSON.stringify(e.userData)),this.clipShadows=e.clipShadows,this.clipIntersection=e.clipIntersection;var t=e.clippingPlanes,n=null;if(null!==t){var r=t.length;n=new Array(r);for(var i=0;i!==r;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.shadowSide=e.shadowSide,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var fr,mr,gr,vr,yr,br,_r,wr,xr,Er,Mr,Sr,Tr="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",Pr="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";function Ar(e){dr.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=Tr,this.fragmentShader=Pr,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function Or(e,t){this.origin=void 0!==e?e:new Xt,this.direction=void 0!==t?t:new Xt}function Cr(e,t,n){this.a=void 0!==e?e:new Xt,this.b=void 0!==t?t:new Xt,this.c=void 0!==n?n:new Xt}function Rr(e){dr.call(this),this.type="MeshBasicMaterial",this.color=new On(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ie,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(e)}function Lr(e,t){Hn.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new sr,this.material=void 0!==t?t:new Rr({color:16777215*Math.random()}),this.drawMode=Ot,this.updateMorphTargets()}function Ir(e,t,n,r){var i,a,o=new On(0),s=0,c=null,l=0;function u(e,n){t.buffers.color.setClear(e.r,e.g,e.b,n,r)}return{getClearColor:function(){return o},setClearColor:function(e,t){o.set(e),u(o,s=void 0!==t?t:1)},getClearAlpha:function(){return s},setClearAlpha:function(e){u(o,s=e)},render:function(t,r,h,p){var d=r.background,f=e.vr,m=f.getSession&&f.getSession();if(m&&"additive"===m.environmentBlendMode&&(d=null),null===d?(u(o,s),c=null,l=0):d&&d.isColor&&(u(d,1),p=!0,c=null,l=0),(e.autoClear||p)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),d&&(d.isCubeTexture||d.isWebGLRenderTargetCube)){void 0===a&&((a=new Lr(new lr(1,1,1),new Ar({type:"BackgroundCubeMaterial",uniforms:xn(Ln.cube.uniforms),vertexShader:Ln.cube.vertexShader,fragmentShader:Ln.cube.fragmentShader,side:w,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),a.geometry.removeAttribute("uv"),a.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(a.material,"map",{get:function(){return this.uniforms.tCube.value}}),n.update(a));var g=d.isWebGLRenderTargetCube?d.texture:d;a.material.uniforms.tCube.value=g,a.material.uniforms.tFlip.value=d.isWebGLRenderTargetCube?1:-1,c===d&&l===g.version||(a.material.needsUpdate=!0,c=d,l=g.version),t.unshift(a,a.geometry,a.material,0,0,null)}else d&&d.isTexture&&(void 0===i&&((i=new Lr(new hr(2,2),new Ar({type:"BackgroundMaterial",uniforms:xn(Ln.background.uniforms),vertexShader:Ln.background.vertexShader,fragmentShader:Ln.background.fragmentShader,side:_,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),Object.defineProperty(i.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(i)),i.material.uniforms.t2D.value=d,!0===d.matrixAutoUpdate&&d.updateMatrix(),i.material.uniforms.uvTransform.value.copy(d.matrix),c===d&&l===d.version||(i.material.needsUpdate=!0,c=d,l=d.version),t.unshift(i,i.geometry,i.material,0,0,null))}}}function kr(e,t,n,r){var i;this.setMode=function(e){i=e},this.render=function(t,r){e.drawArrays(i,t,r),n.update(r,i)},this.renderInstances=function(a,o,s){var c;if(r.isWebGL2)c=e;else if(null===(c=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");c[r.isWebGL2?"drawArraysInstanced":"drawArraysInstancedANGLE"](i,o,s,a.maxInstancedCount),n.update(s,i,a.maxInstancedCount)}}function Nr(e,t,n){var r;function i(t){if("highp"===t){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var a="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext,o=void 0!==n.precision?n.precision:"highp",s=i(o);s!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",s,"instead."),o=s);var c=!0===n.logarithmicDepthBuffer,l=e.getParameter(34930),u=e.getParameter(35660),h=e.getParameter(3379),p=e.getParameter(34076),d=e.getParameter(34921),f=e.getParameter(36347),m=e.getParameter(36348),g=e.getParameter(36349),v=u>0,y=a||!!t.get("OES_texture_float");return{isWebGL2:a,getMaxAnisotropy:function(){if(void 0!==r)return r;var n=t.get("EXT_texture_filter_anisotropic");return r=null!==n?e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:i,precision:o,logarithmicDepthBuffer:c,maxTextures:l,maxVertexTextures:u,maxTextureSize:h,maxCubemapSize:p,maxAttributes:d,maxVertexUniforms:f,maxVaryings:m,maxFragmentUniforms:g,vertexTextures:v,floatFragmentTextures:y,floatVertexTextures:v&&y,maxSamples:a?e.getParameter(36183):0}}function zr(){var e=this,t=null,n=0,r=!1,i=!1,a=new yn,o=new Yt,s={value:null,needsUpdate:!1};function c(){s.value!==t&&(s.value=t,s.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function l(t,n,r,i){var c=null!==t?t.length:0,l=null;if(0!==c){if(l=s.value,!0!==i||null===l){var u=r+4*c,h=n.matrixWorldInverse;o.getNormalMatrix(h),(null===l||l.length<u)&&(l=new Float32Array(u));for(var p=0,d=r;p!==c;++p,d+=4)a.copy(t[p]).applyMatrix4(h,o),a.normal.toArray(l,d),l[d+3]=a.constant}s.value=l,s.needsUpdate=!0}return e.numPlanes=c,l}this.uniform=s,this.numPlanes=0,this.numIntersection=0,this.init=function(e,i,a){var o=0!==e.length||i||0!==n||r;return r=i,t=l(e,a,0),n=e.length,o},this.beginShadows=function(){i=!0,l(null)},this.endShadows=function(){i=!1,c()},this.setState=function(e,a,o,u,h,p){if(!r||null===e||0===e.length||i&&!o)i?l(null):c();else{var d=i?0:n,f=4*d,m=h.clippingState||null;s.value=m,m=l(e,u,f,p);for(var g=0;g!==f;++g)m[g]=t[g];h.clippingState=m,this.numIntersection=a?this.numPlanes:0,this.numPlanes+=d}}}function Dr(e){var t={};return{get:function(n){if(void 0!==t[n])return t[n];var r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return null===r&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),t[n]=r,r}}}function Br(e,t,n){var r={},i={};function a(e){var o=e.target,s=r[o.id];for(var c in null!==s.index&&t.remove(s.index),s.attributes)t.remove(s.attributes[c]);o.removeEventListener("dispose",a),delete r[o.id];var l=i[s.id];l&&(t.remove(l),delete i[s.id]),n.memory.geometries--}return{get:function(e,t){var i=r[t.id];return i||(t.addEventListener("dispose",a),t.isBufferGeometry?i=t:t.isGeometry&&(void 0===t._bufferGeometry&&(t._bufferGeometry=(new sr).setFromObject(e)),i=t._bufferGeometry),r[t.id]=i,n.memory.geometries++,i)},update:function(e){var n=e.index,r=e.attributes;for(var i in null!==n&&t.update(n,34963),r)t.update(r[i],34962);var a=e.morphAttributes;for(var i in a)for(var o=a[i],s=0,c=o.length;s<c;s++)t.update(o[s],34962)},getWireframeAttribute:function(e){var n=i[e.id];if(n)return n;var r,a=[],o=e.index,s=e.attributes;if(null!==o)for(var c=0,l=(r=o.array).length;c<l;c+=3){var u=r[c+0],h=r[c+1],p=r[c+2];a.push(u,h,h,p,p,u)}else for(c=0,l=(r=s.position.array).length/3-1;c<l;c+=3)u=c+0,h=c+1,p=c+2,a.push(u,h,h,p,p,u);return n=new(ar(a)>65535?tr:Qn)(a,1),t.update(n,34963),i[e.id]=n,n}}}function jr(e,t,n,r){var i,a,o;this.setMode=function(e){i=e},this.setIndex=function(e){a=e.type,o=e.bytesPerElement},this.render=function(t,r){e.drawElements(i,r,a,t*o),n.update(r,i)},this.renderInstances=function(s,c,l){var u;if(r.isWebGL2)u=e;else if(null===(u=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");u[r.isWebGL2?"drawElementsInstanced":"drawElementsInstancedANGLE"](i,l,a,c*o,s.maxInstancedCount),n.update(l,i,s.maxInstancedCount)}}function Fr(e){var t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,n,r){switch(r=r||1,t.calls++,n){case 4:t.triangles+=r*(e/3);break;case 5:case 6:t.triangles+=r*(e-2);break;case 1:t.lines+=r*(e/2);break;case 3:t.lines+=r*(e-1);break;case 2:t.lines+=r*e;break;case 0:t.points+=r*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function Ur(e,t){return Math.abs(t[1])-Math.abs(e[1])}function Vr(e){var t={},n=new Float32Array(8);return{update:function(r,i,a,o){var s=r.morphTargetInfluences,c=s.length,l=t[i.id];if(void 0===l){l=[];for(var u=0;u<c;u++)l[u]=[u,0];t[i.id]=l}var h=a.morphTargets&&i.morphAttributes.position,p=a.morphNormals&&i.morphAttributes.normal;for(u=0;u<c;u++)0!==(d=l[u])[1]&&(h&&i.removeAttribute("morphTarget"+u),p&&i.removeAttribute("morphNormal"+u));for(u=0;u<c;u++)(d=l[u])[0]=u,d[1]=s[u];for(l.sort(Ur),u=0;u<8;u++){var d;if(d=l[u]){var f=d[0],m=d[1];if(m){h&&i.addAttribute("morphTarget"+u,h[f]),p&&i.addAttribute("morphNormal"+u,p[f]),n[u]=m;continue}}n[u]=0}o.getUniforms().setValue(e,"morphTargetInfluences",n)}}}function Hr(e,t){var n={};return{update:function(r){var i=t.render.frame,a=r.geometry,o=e.get(r,a);return n[o.id]!==i&&(a.isGeometry&&o.updateFromObject(r),e.update(o),n[o.id]=i),o},dispose:function(){n={}}}}function Gr(e,t,n,r,i,a,o,s,c,l){e=void 0!==e?e:[],t=void 0!==t?t:fe,o=void 0!==o?o:He,un.call(this,e,t,n,r,i,a,o,s,c,l),this.flipY=!1}function Wr(e,t,n,r){un.call(this,null),this.image={data:e,width:t,height:n,depth:r},this.magFilter=Me,this.minFilter=Me,this.wrapR=xe,this.generateMipmaps=!1,this.flipY=!1}function qr(e,t,n,r){un.call(this,null),this.image={data:e,width:t,height:n,depth:r},this.magFilter=Me,this.minFilter=Me,this.wrapR=xe,this.generateMipmaps=!1,this.flipY=!1}Ar.prototype=Object.create(dr.prototype),Ar.prototype.constructor=Ar,Ar.prototype.isShaderMaterial=!0,Ar.prototype.copy=function(e){return dr.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=xn(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this},Ar.prototype.toJSON=function(e){var t=dr.prototype.toJSON.call(this,e);for(var n in t.uniforms={},this.uniforms){var r=this.uniforms[n].value;r&&r.isTexture?t.uniforms[n]={type:"t",value:r.toJSON(e).uuid}:r&&r.isColor?t.uniforms[n]={type:"c",value:r.getHex()}:r&&r.isVector2?t.uniforms[n]={type:"v2",value:r.toArray()}:r&&r.isVector3?t.uniforms[n]={type:"v3",value:r.toArray()}:r&&r.isVector4?t.uniforms[n]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?t.uniforms[n]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?t.uniforms[n]={type:"m4",value:r.toArray()}:t.uniforms[n]={value:r}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;var i={};for(var a in this.extensions)!0===this.extensions[a]&&(i[a]=!0);return Object.keys(i).length>0&&(t.extensions=i),t},Object.assign(Or.prototype,{set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return void 0===t&&(console.warn("THREE.Ray: .at() target is now required"),t=new Xt),t.copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(){var e=new Xt;return function(t){return this.origin.copy(this.at(t,e)),this}}(),closestPointToPoint:function(e,t){void 0===t&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),t=new Xt),t.subVectors(e,this.origin);var n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(){var e=new Xt;return function(t){var n=e.subVectors(t,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(t):(e.copy(this.direction).multiplyScalar(n).add(this.origin),e.distanceToSquared(t))}}(),distanceSqToSegment:(mr=new Xt,gr=new Xt,vr=new Xt,function(e,t,n,r){mr.copy(e).add(t).multiplyScalar(.5),gr.copy(t).sub(e).normalize(),vr.copy(this.origin).sub(mr);var i,a,o,s,c=.5*e.distanceTo(t),l=-this.direction.dot(gr),u=vr.dot(this.direction),h=-vr.dot(gr),p=vr.lengthSq(),d=Math.abs(1-l*l);if(d>0)if(a=l*u-h,s=c*d,(i=l*h-u)>=0)if(a>=-s)if(a<=s){var f=1/d;o=(i*=f)*(i+l*(a*=f)+2*u)+a*(l*i+a+2*h)+p}else a=c,o=-(i=Math.max(0,-(l*a+u)))*i+a*(a+2*h)+p;else a=-c,o=-(i=Math.max(0,-(l*a+u)))*i+a*(a+2*h)+p;else a<=-s?o=-(i=Math.max(0,-(-l*c+u)))*i+(a=i>0?-c:Math.min(Math.max(-c,-h),c))*(a+2*h)+p:a<=s?(i=0,o=(a=Math.min(Math.max(-c,-h),c))*(a+2*h)+p):o=-(i=Math.max(0,-(l*c+u)))*i+(a=i>0?c:Math.min(Math.max(-c,-h),c))*(a+2*h)+p;else a=l>0?-c:c,o=-(i=Math.max(0,-(l*a+u)))*i+a*(a+2*h)+p;return n&&n.copy(this.direction).multiplyScalar(i).add(this.origin),r&&r.copy(gr).multiplyScalar(a).add(mr),o}),intersectSphere:function(){var e=new Xt;return function(t,n){e.subVectors(t.center,this.origin);var r=e.dot(this.direction),i=e.dot(e)-r*r,a=t.radius*t.radius;if(i>a)return null;var o=Math.sqrt(a-i),s=r-o,c=r+o;return s<0&&c<0?null:s<0?this.at(c,n):this.at(s,n)}}(),intersectsSphere:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null},intersectPlane:function(e,t){var n=this.distanceToPlane(e);return null===n?null:this.at(n,t)},intersectsPlane:function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0},intersectBox:function(e,t){var n,r,i,a,o,s,c=1/this.direction.x,l=1/this.direction.y,u=1/this.direction.z,h=this.origin;return c>=0?(n=(e.min.x-h.x)*c,r=(e.max.x-h.x)*c):(n=(e.max.x-h.x)*c,r=(e.min.x-h.x)*c),l>=0?(i=(e.min.y-h.y)*l,a=(e.max.y-h.y)*l):(i=(e.max.y-h.y)*l,a=(e.min.y-h.y)*l),n>a||i>r?null:((i>n||n!=n)&&(n=i),(a<r||r!=r)&&(r=a),u>=0?(o=(e.min.z-h.z)*u,s=(e.max.z-h.z)*u):(o=(e.max.z-h.z)*u,s=(e.min.z-h.z)*u),n>s||o>r?null:((o>n||n!=n)&&(n=o),(s<r||r!=r)&&(r=s),r<0?null:this.at(n>=0?n:r,t)))},intersectsBox:(fr=new Xt,function(e){return null!==this.intersectBox(e,fr)}),intersectTriangle:function(){var e=new Xt,t=new Xt,n=new Xt,r=new Xt;return function(i,a,o,s,c){t.subVectors(a,i),n.subVectors(o,i),r.crossVectors(t,n);var l,u=this.direction.dot(r);if(u>0){if(s)return null;l=1}else{if(!(u<0))return null;l=-1,u=-u}e.subVectors(this.origin,i);var h=l*this.direction.dot(n.crossVectors(e,n));if(h<0)return null;var p=l*this.direction.dot(t.cross(e));if(p<0)return null;if(h+p>u)return null;var d=-l*e.dot(r);return d<0?null:this.at(d/u,c)}}(),applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}}),Object.assign(Cr,{getNormal:(br=new Xt,function(e,t,n,r){void 0===r&&(console.warn("THREE.Triangle: .getNormal() target is now required"),r=new Xt),r.subVectors(n,t),br.subVectors(e,t),r.cross(br);var i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}),getBarycoord:function(){var e=new Xt,t=new Xt,n=new Xt;return function(r,i,a,o,s){e.subVectors(o,i),t.subVectors(a,i),n.subVectors(r,i);var c=e.dot(e),l=e.dot(t),u=e.dot(n),h=t.dot(t),p=t.dot(n),d=c*h-l*l;if(void 0===s&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),s=new Xt),0===d)return s.set(-2,-1,-1);var f=1/d,m=(h*u-l*p)*f,g=(c*p-l*u)*f;return s.set(1-m-g,g,m)}}(),containsPoint:function(){var e=new Xt;return function(t,n,r,i){return Cr.getBarycoord(t,n,r,i,e),e.x>=0&&e.y>=0&&e.x+e.y<=1}}(),getUV:(yr=new Xt,function(e,t,n,r,i,a,o,s){return this.getBarycoord(e,t,n,r,yr),s.set(0,0),s.addScaledVector(i,yr.x),s.addScaledVector(a,yr.y),s.addScaledVector(o,yr.z),s})}),Object.assign(Cr.prototype,{set:function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this},setFromPointsAndIndices:function(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},getArea:function(){var e=new Xt,t=new Xt;return function(){return e.subVectors(this.c,this.b),t.subVectors(this.a,this.b),.5*e.cross(t).length()}}(),getMidpoint:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new Xt),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(e){return Cr.getNormal(this.a,this.b,this.c,e)},getPlane:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new Xt),e.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(e,t){return Cr.getBarycoord(e,this.a,this.b,this.c,t)},containsPoint:function(e){return Cr.containsPoint(e,this.a,this.b,this.c)},getUV:function(e,t,n,r,i){return Cr.getUV(e,this.a,this.b,this.c,t,n,r,i)},intersectsBox:function(e){return e.intersectsTriangle(this)},closestPointToPoint:(_r=new Xt,wr=new Xt,xr=new Xt,Er=new Xt,Mr=new Xt,Sr=new Xt,function(e,t){void 0===t&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),t=new Xt);var n,r,i=this.a,a=this.b,o=this.c;_r.subVectors(a,i),wr.subVectors(o,i),Er.subVectors(e,i);var s=_r.dot(Er),c=wr.dot(Er);if(s<=0&&c<=0)return t.copy(i);Mr.subVectors(e,a);var l=_r.dot(Mr),u=wr.dot(Mr);if(l>=0&&u<=l)return t.copy(a);var h=s*u-l*c;if(h<=0&&s>=0&&l<=0)return n=s/(s-l),t.copy(i).addScaledVector(_r,n);Sr.subVectors(e,o);var p=_r.dot(Sr),d=wr.dot(Sr);if(d>=0&&p<=d)return t.copy(o);var f=p*c-s*d;if(f<=0&&c>=0&&d<=0)return r=c/(c-d),t.copy(i).addScaledVector(wr,r);var m=l*d-p*u;if(m<=0&&u-l>=0&&p-d>=0)return xr.subVectors(o,a),r=(u-l)/(u-l+(p-d)),t.copy(a).addScaledVector(xr,r);var g=1/(m+f+h);return n=f*g,r=h*g,t.copy(i).addScaledVector(_r,n).addScaledVector(wr,r)}),equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}),Rr.prototype=Object.create(dr.prototype),Rr.prototype.constructor=Rr,Rr.prototype.isMeshBasicMaterial=!0,Rr.prototype.copy=function(e){return dr.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this},Lr.prototype=Object.assign(Object.create(Hn.prototype),{constructor:Lr,isMesh:!0,setDrawMode:function(e){this.drawMode=e},copy:function(e){return Hn.prototype.copy.call(this,e),this.drawMode=e.drawMode,void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this},updateMorphTargets:function(){var e,t,n,r=this.geometry;if(r.isBufferGeometry){var i=r.morphAttributes,a=Object.keys(i);if(a.length>0){var o=i[a[0]];if(void 0!==o)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=o.length;e<t;e++)n=o[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}else{var s=r.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(){var e=new _n,t=new Or,n=new vn,r=new Xt,i=new Xt,a=new Xt,o=new Xt,s=new Xt,c=new Xt,l=new Xt,u=new Xt,h=new Xt,p=new Wt,d=new Wt,f=new Wt,m=new Xt,g=new Xt;function v(e,t,n,r,i,a,o,s){if(null===(t.side===w?r.intersectTriangle(o,a,i,!0,s):r.intersectTriangle(i,a,o,t.side!==x,s)))return null;g.copy(s),g.applyMatrix4(e.matrixWorld);var c=n.ray.origin.distanceTo(g);return c<n.near||c>n.far?null:{distance:c,point:g.clone(),object:e}}function y(e,t,n,g,y,b,_,w,x,E){r.fromBufferAttribute(y,w),i.fromBufferAttribute(y,x),a.fromBufferAttribute(y,E);var M=e.morphTargetInfluences;if(t.morphTargets&&b&&M){l.set(0,0,0),u.set(0,0,0),h.set(0,0,0);for(var S=0,T=b.length;S<T;S++){var P=M[S],A=b[S];0!==P&&(o.fromBufferAttribute(A,w),s.fromBufferAttribute(A,x),c.fromBufferAttribute(A,E),l.addScaledVector(o.sub(r),P),u.addScaledVector(s.sub(i),P),h.addScaledVector(c.sub(a),P))}r.add(l),i.add(u),a.add(h)}var O=v(e,t,n,g,r,i,a,m);if(O){_&&(p.fromBufferAttribute(_,w),d.fromBufferAttribute(_,x),f.fromBufferAttribute(_,E),O.uv=Cr.getUV(m,r,i,a,p,d,f,new Wt));var C=new Nn(w,x,E);Cr.getNormal(r,i,a,C.normal),O.face=C}return O}return function(r,i){var a,o=this.geometry,s=this.material,c=this.matrixWorld;if(void 0!==s&&(null===o.boundingSphere&&o.computeBoundingSphere(),n.copy(o.boundingSphere),n.applyMatrix4(c),!1!==r.ray.intersectsSphere(n)&&(e.getInverse(c),t.copy(r.ray).applyMatrix4(e),null===o.boundingBox||!1!==t.intersectsBox(o.boundingBox))))if(o.isBufferGeometry){var l,u,h,g,b,_,w,x,E,M=o.index,S=o.attributes.position,T=o.morphAttributes.position,P=o.attributes.uv,A=o.groups,O=o.drawRange;if(null!==M)if(Array.isArray(s))for(g=0,_=A.length;g<_;g++)for(E=s[(x=A[g]).materialIndex],b=Math.max(x.start,O.start),w=Math.min(x.start+x.count,O.start+O.count);b<w;b+=3)l=M.getX(b),u=M.getX(b+1),h=M.getX(b+2),(a=y(this,E,r,t,S,T,P,l,u,h))&&(a.faceIndex=Math.floor(b/3),a.face.materialIndex=x.materialIndex,i.push(a));else for(g=Math.max(0,O.start),_=Math.min(M.count,O.start+O.count);g<_;g+=3)l=M.getX(g),u=M.getX(g+1),h=M.getX(g+2),(a=y(this,s,r,t,S,T,P,l,u,h))&&(a.faceIndex=Math.floor(g/3),i.push(a));else if(void 0!==S)if(Array.isArray(s))for(g=0,_=A.length;g<_;g++)for(E=s[(x=A[g]).materialIndex],b=Math.max(x.start,O.start),w=Math.min(x.start+x.count,O.start+O.count);b<w;b+=3)(a=y(this,E,r,t,S,T,P,l=b,u=b+1,h=b+2))&&(a.faceIndex=Math.floor(b/3),a.face.materialIndex=x.materialIndex,i.push(a));else for(g=Math.max(0,O.start),_=Math.min(S.count,O.start+O.count);g<_;g+=3)(a=y(this,s,r,t,S,T,P,l=g,u=g+1,h=g+2))&&(a.faceIndex=Math.floor(g/3),i.push(a))}else if(o.isGeometry){var C,R,L,I,k=Array.isArray(s),N=o.vertices,z=o.faces,D=o.faceVertexUvs[0];D.length>0&&(I=D);for(var B=0,j=z.length;B<j;B++){var F=z[B],U=k?s[F.materialIndex]:s;if(void 0!==U&&(C=N[F.a],R=N[F.b],L=N[F.c],a=v(this,U,r,t,C,R,L,m))){if(I&&I[B]){var V=I[B];p.copy(V[0]),d.copy(V[1]),f.copy(V[2]),a.uv=Cr.getUV(m,C,R,L,p,d,f,new Wt)}a.face=F,a.faceIndex=B,i.push(a)}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Gr.prototype=Object.create(un.prototype),Gr.prototype.constructor=Gr,Gr.prototype.isCubeTexture=!0,Object.defineProperty(Gr.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}}),Wr.prototype=Object.create(un.prototype),Wr.prototype.constructor=Wr,Wr.prototype.isDataTexture2DArray=!0,qr.prototype=Object.create(un.prototype),qr.prototype.constructor=qr,qr.prototype.isDataTexture3D=!0;var Xr=new un,Yr=new Wr,Kr=new qr,$r=new Gr,Zr=[],Jr=[],Qr=new Float32Array(16),ei=new Float32Array(9),ti=new Float32Array(4);function ni(e,t,n){var r=e[0];if(r<=0||r>0)return e;var i=t*n,a=Zr[i];if(void 0===a&&(a=new Float32Array(i),Zr[i]=a),0!==t){r.toArray(a,0);for(var o=1,s=0;o!==t;++o)s+=n,e[o].toArray(a,s)}return a}function ri(e,t){if(e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function ii(e,t){for(var n=0,r=t.length;n<r;n++)e[n]=t[n]}function ai(e,t){var n=Jr[t];void 0===n&&(n=new Int32Array(t),Jr[t]=n);for(var r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function oi(e,t){var n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function si(e,t){var n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function ci(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(ri(n,t))return;e.uniform2fv(this.addr,t),ii(n,t)}}function li(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(ri(n,t))return;e.uniform3fv(this.addr,t),ii(n,t)}}function ui(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(ri(n,t))return;e.uniform4fv(this.addr,t),ii(n,t)}}function hi(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(ri(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),ii(n,t)}else{if(ri(n,r))return;ti.set(r),e.uniformMatrix2fv(this.addr,!1,ti),ii(n,r)}}function pi(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(ri(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),ii(n,t)}else{if(ri(n,r))return;ei.set(r),e.uniformMatrix3fv(this.addr,!1,ei),ii(n,r)}}function di(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(ri(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),ii(n,t)}else{if(ri(n,r))return;Qr.set(r),e.uniformMatrix4fv(this.addr,!1,Qr),ii(n,r)}}function fi(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.safeSetTexture2D(t||Xr,i)}function mi(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(t||Yr,i)}function gi(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(t||Kr,i)}function vi(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.safeSetTextureCube(t||$r,i)}function yi(e,t){var n=this.cache;ri(n,t)||(e.uniform2iv(this.addr,t),ii(n,t))}function bi(e,t){var n=this.cache;ri(n,t)||(e.uniform3iv(this.addr,t),ii(n,t))}function _i(e,t){var n=this.cache;ri(n,t)||(e.uniform4iv(this.addr,t),ii(n,t))}function wi(e,t){var n=this.cache;ri(n,t)||(e.uniform1fv(this.addr,t),ii(n,t))}function xi(e,t){var n=this.cache;ri(n,t)||(e.uniform1iv(this.addr,t),ii(n,t))}function Ei(e,t){var n=this.cache,r=ni(t,this.size,2);ri(n,r)||(e.uniform2fv(this.addr,r),this.updateCache(r))}function Mi(e,t){var n=this.cache,r=ni(t,this.size,3);ri(n,r)||(e.uniform3fv(this.addr,r),this.updateCache(r))}function Si(e,t){var n=this.cache,r=ni(t,this.size,4);ri(n,r)||(e.uniform4fv(this.addr,r),this.updateCache(r))}function Ti(e,t){var n=this.cache,r=ni(t,this.size,4);ri(n,r)||(e.uniformMatrix2fv(this.addr,!1,r),this.updateCache(r))}function Pi(e,t){var n=this.cache,r=ni(t,this.size,9);ri(n,r)||(e.uniformMatrix3fv(this.addr,!1,r),this.updateCache(r))}function Ai(e,t){var n=this.cache,r=ni(t,this.size,16);ri(n,r)||(e.uniformMatrix4fv(this.addr,!1,r),this.updateCache(r))}function Oi(e,t,n){var r=this.cache,i=t.length,a=ai(n,i);!1===ri(r,a)&&(e.uniform1iv(this.addr,a),ii(r,a));for(var o=0;o!==i;++o)n.safeSetTexture2D(t[o]||Xr,a[o])}function Ci(e,t,n){var r=this.cache,i=t.length,a=ai(n,i);!1===ri(r,a)&&(e.uniform1iv(this.addr,a),ii(r,a));for(var o=0;o!==i;++o)n.safeSetTextureCube(t[o]||$r,a[o])}function Ri(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function(e){switch(e){case 5126:return oi;case 35664:return ci;case 35665:return li;case 35666:return ui;case 35674:return hi;case 35675:return pi;case 35676:return di;case 35678:case 36198:return fi;case 35679:return gi;case 35680:return vi;case 36289:return mi;case 5124:case 35670:return si;case 35667:case 35671:return yi;case 35668:case 35672:return bi;case 35669:case 35673:return _i}}(t.type)}function Li(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return wi;case 35664:return Ei;case 35665:return Mi;case 35666:return Si;case 35674:return Ti;case 35675:return Pi;case 35676:return Ai;case 35678:return Oi;case 35680:return Ci;case 5124:case 35670:return xi;case 35667:case 35671:return yi;case 35668:case 35672:return bi;case 35669:case 35673:return _i}}(t.type)}function Ii(e){this.id=e,this.seq=[],this.map={}}Li.prototype.updateCache=function(e){var t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),ii(t,e)},Ii.prototype.setValue=function(e,t,n){for(var r=this.seq,i=0,a=r.length;i!==a;++i){var o=r[i];o.setValue(e,t[o.id],n)}};var ki=/([\w\d_]+)(\])?(\[|\.)?/g;function Ni(e,t){e.seq.push(t),e.map[t.id]=t}function zi(e,t,n){var r=e.name,i=r.length;for(ki.lastIndex=0;;){var a=ki.exec(r),o=ki.lastIndex,s=a[1],c="]"===a[2],l=a[3];if(c&&(s|=0),void 0===l||"["===l&&o+2===i){Ni(n,void 0===l?new Ri(s,e,t):new Li(s,e,t));break}var u=n.map[s];void 0===u&&Ni(n,u=new Ii(s)),n=u}}function Di(e,t){this.seq=[],this.map={};for(var n=e.getProgramParameter(t,35718),r=0;r<n;++r){var i=e.getActiveUniform(t,r);zi(i,e.getUniformLocation(t,i.name),this)}}function Bi(e,t,n){var r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),!1===e.getShaderParameter(r,35713)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==e.getShaderInfoLog(r)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",35633===t?"vertex":"fragment",e.getShaderInfoLog(r),function(e){for(var t=e.split("\n"),n=0;n<t.length;n++)t[n]=n+1+": "+t[n];return t.join("\n")}(n)),r}Di.prototype.setValue=function(e,t,n,r){var i=this.map[t];void 0!==i&&i.setValue(e,n,r)},Di.prototype.setOptional=function(e,t,n){var r=t[n];void 0!==r&&this.setValue(e,n,r)},Di.upload=function(e,t,n,r){for(var i=0,a=t.length;i!==a;++i){var o=t[i],s=n[o.id];!1!==s.needsUpdate&&o.setValue(e,s.value,r)}},Di.seqWithValue=function(e,t){for(var n=[],r=0,i=e.length;r!==i;++r){var a=e[r];a.id in t&&n.push(a)}return n};var ji=0;function Fi(e){switch(e){case Lt:return["Linear","( value )"];case It:return["sRGB","( value )"];case Nt:return["RGBE","( value )"];case Dt:return["RGBM","( value, 7.0 )"];case Bt:return["RGBM","( value, 16.0 )"];case jt:return["RGBD","( value, 256.0 )"];case kt:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+e)}}function Ui(e,t){var n=Fi(t);return"vec4 "+e+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function Vi(e,t){var n;switch(t){case ce:n="Linear";break;case le:n="Reinhard";break;case ue:n="Uncharted2";break;case he:n="OptimizedCineon";break;case pe:n="ACESFilmic";break;default:throw new Error("unsupported toneMapping: "+t)}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function Hi(e){return""!==e}function Gi(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights)}function Wi(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}function qi(e){return e.replace(/^[ \t]*#include +<([\w\d.\/]+)>/gm,function(e,t){var n=wn[t];if(void 0===n)throw new Error("Can not resolve #include <"+t+">");return qi(n)})}function Xi(e){return e.replace(/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(e,t,n,r){for(var i="",a=parseInt(t);a<parseInt(n);a++)i+=r.replace(/\[ i \]/g,"[ "+a+" ]");return i})}function Yi(e,t,n,r,i,a,o,s){var c=e.context,l=r.defines,u=i.vertexShader,h=i.fragmentShader,p="SHADOWMAP_TYPE_BASIC";a.shadowMapType===y?p="SHADOWMAP_TYPE_PCF":a.shadowMapType===b&&(p="SHADOWMAP_TYPE_PCF_SOFT");var d="ENVMAP_TYPE_CUBE",f="ENVMAP_MODE_REFLECTION",m="ENVMAP_BLENDING_MULTIPLY";if(a.envMap){switch(r.envMap.mapping){case fe:case me:d="ENVMAP_TYPE_CUBE";break;case be:case _e:d="ENVMAP_TYPE_CUBE_UV";break;case ge:case ve:d="ENVMAP_TYPE_EQUIREC";break;case ye:d="ENVMAP_TYPE_SPHERE"}switch(r.envMap.mapping){case me:case ve:f="ENVMAP_MODE_REFRACTION"}switch(r.combine){case ie:m="ENVMAP_BLENDING_MULTIPLY";break;case ae:m="ENVMAP_BLENDING_MIX";break;case oe:m="ENVMAP_BLENDING_ADD"}}var g,v,_,w,x,E=e.gammaFactor>0?e.gammaFactor:1,M=o.isWebGL2?"":function(e,t,n){return[(e=e||{}).derivatives||t.envMapCubeUV||t.bumpMap||t.normalMap&&!t.objectSpaceNormalMap||t.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(e.fragDepth||t.logarithmicDepthBuffer)&&n.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",e.drawBuffers&&n.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(e.shaderTextureLOD||t.envMap)&&n.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Hi).join("\n")}(r.extensions,a,t),S=function(e){var t=[];for(var n in e){var r=e[n];!1!==r&&t.push("#define "+n+" "+r)}return t.join("\n")}(l),T=c.createProgram();if(r.isRawShaderMaterial?((g=[S].filter(Hi).join("\n")).length>0&&(g+="\n"),(v=[M,S].filter(Hi).join("\n")).length>0&&(v+="\n")):(g=["precision "+a.precision+" float;","precision "+a.precision+" int;","#define SHADER_NAME "+i.name,S,a.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+E,"#define MAX_BONES "+a.maxBones,a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+f:"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.normalMap&&a.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",a.displacementMap&&a.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.roughnessMap?"#define USE_ROUGHNESSMAP":"",a.metalnessMap?"#define USE_METALNESSMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.vertexTangents?"#define USE_TANGENT":"",a.vertexColors?"#define USE_COLOR":"",a.flatShading?"#define FLAT_SHADED":"",a.skinning?"#define USE_SKINNING":"",a.useVertexTexture?"#define BONE_TEXTURE":"",a.morphTargets?"#define USE_MORPHTARGETS":"",a.morphNormals&&!1===a.flatShading?"#define USE_MORPHNORMALS":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+p:"",a.sizeAttenuation?"#define USE_SIZEATTENUATION":"",a.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",a.logarithmicDepthBuffer&&(o.isWebGL2||t.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Hi).join("\n"),v=[M,"precision "+a.precision+" float;","precision "+a.precision+" int;","#define SHADER_NAME "+i.name,S,a.alphaTest?"#define ALPHATEST "+a.alphaTest+(a.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+E,a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.matcap?"#define USE_MATCAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+d:"",a.envMap?"#define "+f:"",a.envMap?"#define "+m:"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.normalMap&&a.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.roughnessMap?"#define USE_ROUGHNESSMAP":"",a.metalnessMap?"#define USE_METALNESSMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.vertexTangents?"#define USE_TANGENT":"",a.vertexColors?"#define USE_COLOR":"",a.gradientMap?"#define USE_GRADIENTMAP":"",a.flatShading?"#define FLAT_SHADED":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+p:"",a.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",a.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",a.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",a.logarithmicDepthBuffer&&(o.isWebGL2||t.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"",a.envMap&&(o.isWebGL2||t.get("EXT_shader_texture_lod"))?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",a.toneMapping!==se?"#define TONE_MAPPING":"",a.toneMapping!==se?wn.tonemapping_pars_fragment:"",a.toneMapping!==se?Vi("toneMapping",a.toneMapping):"",a.dithering?"#define DITHERING":"",a.outputEncoding||a.mapEncoding||a.matcapEncoding||a.envMapEncoding||a.emissiveMapEncoding?wn.encodings_pars_fragment:"",a.mapEncoding?Ui("mapTexelToLinear",a.mapEncoding):"",a.matcapEncoding?Ui("matcapTexelToLinear",a.matcapEncoding):"",a.envMapEncoding?Ui("envMapTexelToLinear",a.envMapEncoding):"",a.emissiveMapEncoding?Ui("emissiveMapTexelToLinear",a.emissiveMapEncoding):"",a.outputEncoding?(_="linearToOutputTexel",w=a.outputEncoding,x=Fi(w),"vec4 "+_+"( vec4 value ) { return LinearTo"+x[0]+x[1]+"; }"):"",a.depthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(Hi).join("\n")),u=Wi(u=Gi(u=qi(u),a),a),h=Wi(h=Gi(h=qi(h),a),a),u=Xi(u),h=Xi(h),o.isWebGL2&&!r.isRawShaderMaterial){var P=!1,A=/^\s*#version\s+300\s+es\s*\n/;r.isShaderMaterial&&null!==u.match(A)&&null!==h.match(A)&&(P=!0,u=u.replace(A,""),h=h.replace(A,"")),g=["#version 300 es\n","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,v=["#version 300 es\n","#define varying in",P?"":"out highp vec4 pc_fragColor;",P?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+v}var O=v+h,C=Bi(c,35633,g+u),R=Bi(c,35632,O);c.attachShader(T,C),c.attachShader(T,R),void 0!==r.index0AttributeName?c.bindAttribLocation(T,0,r.index0AttributeName):!0===a.morphTargets&&c.bindAttribLocation(T,0,"position"),c.linkProgram(T);var L,I,k=c.getProgramInfoLog(T).trim(),N=c.getShaderInfoLog(C).trim(),z=c.getShaderInfoLog(R).trim(),D=!0,B=!0;return!1===c.getProgramParameter(T,35714)?(D=!1,console.error("THREE.WebGLProgram: shader error: ",c.getError(),"35715",c.getProgramParameter(T,35715),"gl.getProgramInfoLog",k,N,z)):""!==k?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",k):""!==N&&""!==z||(B=!1),B&&(this.diagnostics={runnable:D,material:r,programLog:k,vertexShader:{log:N,prefix:g},fragmentShader:{log:z,prefix:v}}),c.deleteShader(C),c.deleteShader(R),this.getUniforms=function(){return void 0===L&&(L=new Di(c,T,s)),L},this.getAttributes=function(){return void 0===I&&(I=function(e,t){for(var n={},r=e.getProgramParameter(t,35721),i=0;i<r;i++){var a=e.getActiveAttrib(t,i).name;n[a]=e.getAttribLocation(t,a)}return n}(c,T)),I},this.destroy=function(){c.deleteProgram(T),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.name=i.name,this.id=ji++,this.code=n,this.usedTimes=1,this.program=T,this.vertexShader=C,this.fragmentShader=R,this}function Ki(e,t,n,r){var i=[],a={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},o=["precision","supportsVertexTextures","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"];function s(e,t){var n;return e?e.isTexture?n=e.encoding:e.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),n=e.texture.encoding):n=Lt,n===Lt&&t&&(n=kt),n}this.getParameters=function(t,r,i,o,c,l,u){var h=a[t.type],p=u.isSkinnedMesh?function(e){var t=e.skeleton.bones;if(n.floatVertexTextures)return 1024;var r=n.maxVertexUniforms,i=Math.floor((r-20)/4),a=Math.min(i,t.length);return a<t.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+a+"."),0):a}(u):0,d=n.precision;null!==t.precision&&(d=n.getMaxPrecision(t.precision))!==t.precision&&console.warn("THREE.WebGLProgram.getParameters:",t.precision,"not supported, using",d,"instead.");var f=e.getRenderTarget();return{shaderID:h,precision:d,supportsVertexTextures:n.vertexTextures,outputEncoding:s(f?f.texture:null,e.gammaOutput),map:!!t.map,mapEncoding:s(t.map,e.gammaInput),matcap:!!t.matcap,matcapEncoding:s(t.matcap,e.gammaInput),envMap:!!t.envMap,envMapMode:t.envMap&&t.envMap.mapping,envMapEncoding:s(t.envMap,e.gammaInput),envMapCubeUV:!!t.envMap&&(t.envMap.mapping===be||t.envMap.mapping===_e),lightMap:!!t.lightMap,aoMap:!!t.aoMap,emissiveMap:!!t.emissiveMap,emissiveMapEncoding:s(t.emissiveMap,e.gammaInput),bumpMap:!!t.bumpMap,normalMap:!!t.normalMap,objectSpaceNormalMap:t.normalMapType===Ht,displacementMap:!!t.displacementMap,roughnessMap:!!t.roughnessMap,metalnessMap:!!t.metalnessMap,specularMap:!!t.specularMap,alphaMap:!!t.alphaMap,gradientMap:!!t.gradientMap,combine:t.combine,vertexTangents:t.normalMap&&t.vertexTangents,vertexColors:t.vertexColors,fog:!!o,useFog:t.fog,fogExp:o&&o.isFogExp2,flatShading:t.flatShading,sizeAttenuation:t.sizeAttenuation,logarithmicDepthBuffer:n.logarithmicDepthBuffer,skinning:t.skinning&&p>0,maxBones:p,useVertexTexture:n.floatVertexTextures,morphTargets:t.morphTargets,morphNormals:t.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:r.directional.length,numPointLights:r.point.length,numSpotLights:r.spot.length,numRectAreaLights:r.rectArea.length,numHemiLights:r.hemi.length,numClippingPlanes:c,numClipIntersection:l,dithering:t.dithering,shadowMapEnabled:e.shadowMap.enabled&&u.receiveShadow&&i.length>0,shadowMapType:e.shadowMap.type,toneMapping:e.toneMapping,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:t.premultipliedAlpha,alphaTest:t.alphaTest,doubleSided:t.side===x,flipSided:t.side===w,depthPacking:void 0!==t.depthPacking&&t.depthPacking}},this.getProgramCode=function(t,n){var r=[];if(n.shaderID?r.push(n.shaderID):(r.push(t.fragmentShader),r.push(t.vertexShader)),void 0!==t.defines)for(var i in t.defines)r.push(i),r.push(t.defines[i]);for(var a=0;a<o.length;a++)r.push(n[o[a]]);return r.push(t.onBeforeCompile.toString()),r.push(e.gammaOutput),r.push(e.gammaFactor),r.join()},this.acquireProgram=function(a,o,s,c){for(var l,u=0,h=i.length;u<h;u++){var p=i[u];if(p.code===c){++(l=p).usedTimes;break}}return void 0===l&&(l=new Yi(e,t,c,a,o,s,n,r),i.push(l)),l},this.releaseProgram=function(e){if(0==--e.usedTimes){var t=i.indexOf(e);i[t]=i[i.length-1],i.pop(),e.destroy()}},this.programs=i}function $i(){var e=new WeakMap;return{get:function(t){var n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,r){e.get(t)[n]=r},dispose:function(){e=new WeakMap}}}function Zi(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Ji(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function Qi(){var e=[],t=0,n=[],r=[],i={id:-1};function a(n,r,a,o,s,c){var l=e[t];return void 0===l?(l={id:n.id,object:n,geometry:r,material:a,program:a.program||i,groupOrder:o,renderOrder:n.renderOrder,z:s,group:c},e[t]=l):(l.id=n.id,l.object=n,l.geometry=r,l.material=a,l.program=a.program||i,l.groupOrder=o,l.renderOrder=n.renderOrder,l.z=s,l.group=c),t++,l}return{opaque:n,transparent:r,init:function(){t=0,n.length=0,r.length=0},push:function(e,t,i,o,s,c){var l=a(e,t,i,o,s,c);(!0===i.transparent?r:n).push(l)},unshift:function(e,t,i,o,s,c){var l=a(e,t,i,o,s,c);(!0===i.transparent?r:n).unshift(l)},sort:function(){n.length>1&&n.sort(Zi),r.length>1&&r.sort(Ji)}}}function ea(){var e={};function t(n){var r=n.target;r.removeEventListener("dispose",t),delete e[r.id]}return{get:function(n,r){var i,a=e[n.id];return void 0===a?(i=new Qi,e[n.id]={},e[n.id][r.id]=i,n.addEventListener("dispose",t)):void 0===(i=a[r.id])&&(i=new Qi,a[r.id]=i),i},dispose:function(){e={}}}}function ta(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var n;switch(t.type){case"DirectionalLight":n={direction:new Xt,color:new On,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Wt};break;case"SpotLight":n={position:new Xt,direction:new Xt,color:new On,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Wt};break;case"PointLight":n={position:new Xt,color:new On,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Wt,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":n={direction:new Xt,skyColor:new On,groundColor:new On};break;case"RectAreaLight":n={color:new On,position:new Xt,halfWidth:new Xt,halfHeight:new Xt}}return e[t.id]=n,n}}}var na=0;function ra(){var e=new ta,t={id:na++,hash:{stateID:-1,directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,shadowsLength:-1},ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},n=new Xt,r=new _n,i=new _n;return{setup:function(a,o,s){for(var c=0,l=0,u=0,h=0,p=0,d=0,f=0,m=0,g=s.matrixWorldInverse,v=0,y=a.length;v<y;v++){var b=a[v],_=b.color,w=b.intensity,x=b.distance,E=b.shadow&&b.shadow.map?b.shadow.map.texture:null;if(b.isAmbientLight)c+=_.r*w,l+=_.g*w,u+=_.b*w;else if(b.isDirectionalLight){if((S=e.get(b)).color.copy(b.color).multiplyScalar(b.intensity),S.direction.setFromMatrixPosition(b.matrixWorld),n.setFromMatrixPosition(b.target.matrixWorld),S.direction.sub(n),S.direction.transformDirection(g),S.shadow=b.castShadow,b.castShadow){var M=b.shadow;S.shadowBias=M.bias,S.shadowRadius=M.radius,S.shadowMapSize=M.mapSize}t.directionalShadowMap[h]=E,t.directionalShadowMatrix[h]=b.shadow.matrix,t.directional[h]=S,h++}else if(b.isSpotLight)(S=e.get(b)).position.setFromMatrixPosition(b.matrixWorld),S.position.applyMatrix4(g),S.color.copy(_).multiplyScalar(w),S.distance=x,S.direction.setFromMatrixPosition(b.matrixWorld),n.setFromMatrixPosition(b.target.matrixWorld),S.direction.sub(n),S.direction.transformDirection(g),S.coneCos=Math.cos(b.angle),S.penumbraCos=Math.cos(b.angle*(1-b.penumbra)),S.decay=b.decay,S.shadow=b.castShadow,b.castShadow&&(M=b.shadow,S.shadowBias=M.bias,S.shadowRadius=M.radius,S.shadowMapSize=M.mapSize),t.spotShadowMap[d]=E,t.spotShadowMatrix[d]=b.shadow.matrix,t.spot[d]=S,d++;else if(b.isRectAreaLight)(S=e.get(b)).color.copy(_).multiplyScalar(w),S.position.setFromMatrixPosition(b.matrixWorld),S.position.applyMatrix4(g),i.identity(),r.copy(b.matrixWorld),r.premultiply(g),i.extractRotation(r),S.halfWidth.set(.5*b.width,0,0),S.halfHeight.set(0,.5*b.height,0),S.halfWidth.applyMatrix4(i),S.halfHeight.applyMatrix4(i),t.rectArea[f]=S,f++;else if(b.isPointLight)(S=e.get(b)).position.setFromMatrixPosition(b.matrixWorld),S.position.applyMatrix4(g),S.color.copy(b.color).multiplyScalar(b.intensity),S.distance=b.distance,S.decay=b.decay,S.shadow=b.castShadow,b.castShadow&&(M=b.shadow,S.shadowBias=M.bias,S.shadowRadius=M.radius,S.shadowMapSize=M.mapSize,S.shadowCameraNear=M.camera.near,S.shadowCameraFar=M.camera.far),t.pointShadowMap[p]=E,t.pointShadowMatrix[p]=b.shadow.matrix,t.point[p]=S,p++;else if(b.isHemisphereLight){var S;(S=e.get(b)).direction.setFromMatrixPosition(b.matrixWorld),S.direction.transformDirection(g),S.direction.normalize(),S.skyColor.copy(b.color).multiplyScalar(w),S.groundColor.copy(b.groundColor).multiplyScalar(w),t.hemi[m]=S,m++}}t.ambient[0]=c,t.ambient[1]=l,t.ambient[2]=u,t.directional.length=h,t.spot.length=d,t.rectArea.length=f,t.point.length=p,t.hemi.length=m,t.hash.stateID=t.id,t.hash.directionalLength=h,t.hash.pointLength=p,t.hash.spotLength=d,t.hash.rectAreaLength=f,t.hash.hemiLength=m,t.hash.shadowsLength=o.length},state:t}}function ia(){var e=new ra,t=[],n=[];return{init:function(){t.length=0,n.length=0},state:{lightsArray:t,shadowsArray:n,lights:e},setupLights:function(r){e.setup(t,n,r)},pushLight:function(e){t.push(e)},pushShadow:function(e){n.push(e)}}}function aa(){var e={};function t(n){var r=n.target;r.removeEventListener("dispose",t),delete e[r.id]}return{get:function(n,r){var i;return void 0===e[n.id]?(i=new ia,e[n.id]={},e[n.id][r.id]=i,n.addEventListener("dispose",t)):void 0===e[n.id][r.id]?(i=new ia,e[n.id][r.id]=i):i=e[n.id][r.id],i},dispose:function(){e={}}}}function oa(e){dr.call(this),this.type="MeshDepthMaterial",this.depthPacking=Ft,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(e)}function sa(e){dr.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new Xt,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.lights=!1,this.setValues(e)}function ca(e,t,n){for(var r=new bn,i=new _n,a=new Wt,o=new Wt(n,n),s=new Xt,c=new Xt,l=1,u=2,h=1+(l|u),p=new Array(h),d=new Array(h),f={},m={0:w,1:_,2:x},g=[new Xt(1,0,0),new Xt(-1,0,0),new Xt(0,0,1),new Xt(0,0,-1),new Xt(0,1,0),new Xt(0,-1,0)],v=[new Xt(0,1,0),new Xt(0,1,0),new Xt(0,1,0),new Xt(0,1,0),new Xt(0,0,1),new Xt(0,0,-1)],b=[new hn,new hn,new hn,new hn,new hn,new hn],E=0;E!==h;++E){var M=0!=(E&l),S=0!=(E&u),T=new oa({depthPacking:Ut,morphTargets:M,skinning:S});p[E]=T;var P=new sa({morphTargets:M,skinning:S});d[E]=P}var O=this;function C(t,n,r,i,a,o){var s=t.geometry,c=null,h=p,g=t.customDepthMaterial;if(r&&(h=d,g=t.customDistanceMaterial),g)c=g;else{var v=!1;n.morphTargets&&(s&&s.isBufferGeometry?v=s.morphAttributes&&s.morphAttributes.position&&s.morphAttributes.position.length>0:s&&s.isGeometry&&(v=s.morphTargets&&s.morphTargets.length>0)),t.isSkinnedMesh&&!1===n.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t);var y=t.isSkinnedMesh&&n.skinning,b=0;v&&(b|=l),y&&(b|=u),c=h[b]}if(e.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length){var _=c.uuid,w=n.uuid,x=f[_];void 0===x&&(x={},f[_]=x);var E=x[w];void 0===E&&(E=c.clone(),x[w]=E),c=E}return c.visible=n.visible,c.wireframe=n.wireframe,c.side=null!=n.shadowSide?n.shadowSide:m[n.side],c.clipShadows=n.clipShadows,c.clippingPlanes=n.clippingPlanes,c.clipIntersection=n.clipIntersection,c.wireframeLinewidth=n.wireframeLinewidth,c.linewidth=n.linewidth,r&&c.isMeshDistanceMaterial&&(c.referencePosition.copy(i),c.nearDistance=a,c.farDistance=o),c}function R(n,i,a,o){if(!1!==n.visible){if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&n.castShadow&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,n.matrixWorld);var s=t.update(n),l=n.material;if(Array.isArray(l))for(var u=s.groups,h=0,p=u.length;h<p;h++){var d=u[h],f=l[d.materialIndex];if(f&&f.visible){var m=C(n,f,o,c,a.near,a.far);e.renderBufferDirect(a,null,s,m,n,d)}}else if(l.visible){m=C(n,l,o,c,a.near,a.far);e.renderBufferDirect(a,null,s,m,n,null)}}for(var g=n.children,v=0,y=g.length;v<y;v++)R(g[v],i,a,o)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=y,this.render=function(t,n,l){if(!1!==O.enabled&&(!1!==O.autoUpdate||!1!==O.needsUpdate)&&0!==t.length){var u,h=e.getRenderTarget(),p=e.state;p.setBlending(A),p.buffers.color.setClear(1,1,1,1),p.buffers.depth.setTest(!0),p.setScissorTest(!1);for(var d=0,f=t.length;d<f;d++){var m=t[d],y=m.shadow,_=m&&m.isPointLight;if(void 0!==y){var w=y.camera;if(a.copy(y.mapSize),a.min(o),_){var x=a.x,E=a.y;b[0].set(2*x,E,x,E),b[1].set(0,E,x,E),b[2].set(3*x,E,x,E),b[3].set(x,E,x,E),b[4].set(3*x,0,x,E),b[5].set(x,0,x,E),a.x*=4,a.y*=2}if(null===y.map){var M={minFilter:Me,magFilter:Me,format:Ge};y.map=new pn(a.x,a.y,M),y.map.texture.name=m.name+".shadowMap",w.updateProjectionMatrix()}y.isSpotLightShadow&&y.update(m);var S=y.map,T=y.matrix;c.setFromMatrixPosition(m.matrixWorld),w.position.copy(c),_?(u=6,T.makeTranslation(-c.x,-c.y,-c.z)):(u=1,s.setFromMatrixPosition(m.target.matrixWorld),w.lookAt(s),w.updateMatrixWorld(),T.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),T.multiply(w.projectionMatrix),T.multiply(w.matrixWorldInverse)),e.setRenderTarget(S),e.clear();for(var P=0;P<u;P++){if(_){s.copy(w.position),s.add(g[P]),w.up.copy(v[P]),w.lookAt(s),w.updateMatrixWorld();var C=b[P];p.viewport(C)}i.multiplyMatrices(w.projectionMatrix,w.matrixWorldInverse),r.setFromMatrix(i),R(n,l,w,_)}}else console.warn("THREE.WebGLShadowMap:",m,"has no shadow.")}O.needsUpdate=!1,e.setRenderTarget(h)}}}function la(e,t,n,r){var i=new function(){var t=!1,n=new hn,r=null,i=new hn(0,0,0,0);return{setMask:function(n){r===n||t||(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,r,a,o,s){!0===s&&(t*=o,r*=o,a*=o),n.set(t,r,a,o),!1===i.equals(n)&&(e.clearColor(t,r,a,o),i.copy(n))},reset:function(){t=!1,r=null,i.set(-1,0,0,0)}}},a=new function(){var t=!1,n=null,r=null,i=null;return{setTest:function(e){e?ae(2929):oe(2929)},setMask:function(r){n===r||t||(e.depthMask(r),n=r)},setFunc:function(t){if(r!==t){if(t)switch(t){case $:e.depthFunc(512);break;case Z:e.depthFunc(519);break;case J:e.depthFunc(513);break;case Q:e.depthFunc(515);break;case ee:e.depthFunc(514);break;case te:e.depthFunc(518);break;case ne:e.depthFunc(516);break;case re:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);r=t}},setLocked:function(e){t=e},setClear:function(t){i!==t&&(e.clearDepth(t),i=t)},reset:function(){t=!1,n=null,r=null,i=null}}},o=new function(){var t=!1,n=null,r=null,i=null,a=null,o=null,s=null,c=null,l=null;return{setTest:function(e){e?ae(2960):oe(2960)},setMask:function(r){n===r||t||(e.stencilMask(r),n=r)},setFunc:function(t,n,o){r===t&&i===n&&a===o||(e.stencilFunc(t,n,o),r=t,i=n,a=o)},setOp:function(t,n,r){o===t&&s===n&&c===r||(e.stencilOp(t,n,r),o=t,s=n,c=r)},setLocked:function(e){t=e},setClear:function(t){l!==t&&(e.clearStencil(t),l=t)},reset:function(){t=!1,n=null,r=null,i=null,a=null,o=null,s=null,c=null,l=null}}},s=e.getParameter(34921),c=new Uint8Array(s),l=new Uint8Array(s),u=new Uint8Array(s),f={},m=null,g=null,v=null,y=null,b=null,_=null,E=null,M=null,S=null,T=null,P=!1,N=null,z=null,D=null,B=null,j=null,F=e.getParameter(35661),U=!1,V=0,H=e.getParameter(7938);-1!==H.indexOf("WebGL")?(V=parseFloat(/^WebGL\ ([0-9])/.exec(H)[1]),U=V>=1):-1!==H.indexOf("OpenGL ES")&&(V=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(H)[1]),U=V>=2);var G=null,W={},q=new hn,X=new hn;function Y(t,n,r){var i=new Uint8Array(4),a=e.createTexture();e.bindTexture(t,a),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728);for(var o=0;o<r;o++)e.texImage2D(n+o,0,6408,1,1,0,6408,5121,i);return a}var K={};function ie(n,i){(c[n]=1,0===l[n]&&(e.enableVertexAttribArray(n),l[n]=1),u[n]!==i)&&((r.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,i),u[n]=i)}function ae(t){!0!==f[t]&&(e.enable(t),f[t]=!0)}function oe(t){!1!==f[t]&&(e.disable(t),f[t]=!1)}function se(t,r,i,a,o,s,c,l){if(t!==A){if(v||(ae(3042),v=!0),t===I)o=o||r,s=s||i,c=c||a,r===b&&o===M||(e.blendEquationSeparate(n.convert(r),n.convert(o)),b=r,M=o),i===_&&a===E&&s===S&&c===T||(e.blendFuncSeparate(n.convert(i),n.convert(a),n.convert(s),n.convert(c)),_=i,E=a,S=s,T=c),y=t,P=null;else if(t!==y||l!==P){if(b===k&&M===k||(e.blendEquation(32774),b=k,M=k),l)switch(t){case O:e.blendFuncSeparate(1,771,1,771);break;case C:e.blendFunc(1,1);break;case R:e.blendFuncSeparate(0,0,769,771);break;case L:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case O:e.blendFuncSeparate(770,771,1,771);break;case C:e.blendFunc(770,1);break;case R:e.blendFunc(0,769);break;case L:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}_=null,E=null,S=null,T=null,y=t,P=l}}else v&&(oe(3042),v=!1)}function ce(t){N!==t&&(t?e.frontFace(2304):e.frontFace(2305),N=t)}function le(t){t!==h?(ae(2884),t!==z&&(t===p?e.cullFace(1029):t===d?e.cullFace(1028):e.cullFace(1032))):oe(2884),z=t}function ue(t,n,r){t?(ae(32823),B===n&&j===r||(e.polygonOffset(n,r),B=n,j=r)):oe(32823)}function he(t){void 0===t&&(t=33984+F-1),G!==t&&(e.activeTexture(t),G=t)}return K[3553]=Y(3553,3553,1),K[34067]=Y(34067,34069,6),i.setClear(0,0,0,1),a.setClear(1),o.setClear(0),ae(2929),a.setFunc(Q),ce(!1),le(p),ae(2884),se(A),{buffers:{color:i,depth:a,stencil:o},initAttributes:function(){for(var e=0,t=c.length;e<t;e++)c[e]=0},enableAttribute:function(e){ie(e,0)},enableAttributeAndDivisor:ie,disableUnusedAttributes:function(){for(var t=0,n=l.length;t!==n;++t)l[t]!==c[t]&&(e.disableVertexAttribArray(t),l[t]=0)},enable:ae,disable:oe,getCompressedTextureFormats:function(){if(null===m&&(m=[],t.get("WEBGL_compressed_texture_pvrtc")||t.get("WEBGL_compressed_texture_s3tc")||t.get("WEBGL_compressed_texture_etc1")||t.get("WEBGL_compressed_texture_astc")))for(var n=e.getParameter(34467),r=0;r<n.length;r++)m.push(n[r]);return m},useProgram:function(t){return g!==t&&(e.useProgram(t),g=t,!0)},setBlending:se,setMaterial:function(e,t){e.side===x?oe(2884):ae(2884);var n=e.side===w;t&&(n=!n),ce(n),e.blending===O&&!1===e.transparent?se(A):se(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),a.setFunc(e.depthFunc),a.setTest(e.depthTest),a.setMask(e.depthWrite),i.setMask(e.colorWrite),ue(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)},setFlipSided:ce,setCullFace:le,setLineWidth:function(t){t!==D&&(U&&e.lineWidth(t),D=t)},setPolygonOffset:ue,setScissorTest:function(e){e?ae(3089):oe(3089)},activeTexture:he,bindTexture:function(t,n){null===G&&he();var r=W[G];void 0===r&&(r={type:void 0,texture:void 0},W[G]=r),r.type===t&&r.texture===n||(e.bindTexture(t,n||K[t]),r.type=t,r.texture=n)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===q.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),q.copy(t))},viewport:function(t){!1===X.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),X.copy(t))},reset:function(){for(var t=0;t<l.length;t++)1===l[t]&&(e.disableVertexAttribArray(t),l[t]=0);f={},m=null,G=null,W={},g=null,y=null,N=null,z=null,i.reset(),a.reset(),o.reset()}}}function ua(e,t,n,r,i,a,o){var s,c={},l="undefined"!=typeof OffscreenCanvas;function u(e,t){return l?new OffscreenCanvas(e,t):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function h(e,t,n,r){var i=1;if((e.width>r||e.height>r)&&(i=r/Math.max(e.width,e.height)),i<1||!0===t){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){var a=t?Gt.floorPowerOfTwo:Math.floor,o=a(i*e.width),c=a(i*e.height);void 0===s&&(s=u(o,c));var l=n?u(o,c):s;return l.width=o,l.height=c,l.getContext("2d").drawImage(e,0,0,o,c),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+o+"x"+c+")."),l}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function p(e){return Gt.isPowerOfTwo(e.width)&&Gt.isPowerOfTwo(e.height)}function d(e,t){return e.generateMipmaps&&t&&e.minFilter!==Me&&e.minFilter!==Pe}function f(t,n,i,a){e.generateMipmap(t),r.get(n).__maxMipLevel=Math.log(Math.max(i,a))*Math.LOG2E}function m(e,n){if(!i.isWebGL2)return e;var r=e;return 6403===e&&(5126===n&&(r=33326),5131===n&&(r=33325),5121===n&&(r=33321)),6407===e&&(5126===n&&(r=34837),5131===n&&(r=34843),5121===n&&(r=32849)),6408===e&&(5126===n&&(r=34836),5131===n&&(r=34842),5121===n&&(r=32856)),33325===r||33326===r||34842===r||34836===r?t.get("EXT_color_buffer_float"):34843!==r&&34837!==r||console.warn("THREE.WebGLRenderer: Floating point textures with RGB format not supported. Please use RGBA instead."),r}function g(e){return e===Me||e===Se||e===Te?9728:9729}function v(t){var n=t.target;n.removeEventListener("dispose",v),function(t){var n=r.get(t);if(void 0===n.__webglInit)return;e.deleteTexture(n.__webglTexture),r.remove(t)}(n),n.isVideoTexture&&delete c[n.id],o.memory.textures--}function y(t){var n=t.target;n.removeEventListener("dispose",y),function(t){var n=r.get(t),i=r.get(t.texture);if(!t)return;void 0!==i.__webglTexture&&e.deleteTexture(i.__webglTexture);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLRenderTargetCube)for(var a=0;a<6;a++)e.deleteFramebuffer(n.__webglFramebuffer[a]),n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer[a]);else e.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer);r.remove(t.texture),r.remove(t)}(n),o.memory.textures--}var b=0;function _(e,t){var i=r.get(e);if(e.isVideoTexture&&function(e){var t=e.id,n=o.render.frame;c[t]!==n&&(c[t]=n,e.update())}(e),e.version>0&&i.__version!==e.version){var a=e.image;if(void 0===a)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==a.complete)return void S(i,e,t);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+t),n.bindTexture(3553,i.__webglTexture)}function w(t,o){var s=r.get(t);if(6===t.image.length)if(t.version>0&&s.__version!==t.version){M(s,t),n.activeTexture(33984+o),n.bindTexture(34067,s.__webglTexture),e.pixelStorei(37440,t.flipY);for(var c=t&&t.isCompressedTexture,l=t.image[0]&&t.image[0].isDataTexture,u=[],g=0;g<6;g++)u[g]=c||l?l?t.image[g].image:t.image[g]:h(t.image[g],!1,!0,i.maxCubemapSize);var v=u[0],y=p(v)||i.isWebGL2,b=a.convert(t.format),_=a.convert(t.type),w=m(b,_);E(34067,t,y);for(g=0;g<6;g++)if(c)for(var x,S=u[g].mipmaps,T=0,P=S.length;T<P;T++)x=S[T],t.format!==Ge&&t.format!==He?n.getCompressedTextureFormats().indexOf(b)>-1?n.compressedTexImage2D(34069+g,T,w,x.width,x.height,0,x.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(34069+g,T,w,x.width,x.height,0,b,_,x.data);else l?n.texImage2D(34069+g,0,w,u[g].width,u[g].height,0,b,_,u[g].data):n.texImage2D(34069+g,0,w,b,_,u[g]);s.__maxMipLevel=c?S.length-1:0,d(t,y)&&f(34067,t,v.width,v.height),s.__version=t.version,t.onUpdate&&t.onUpdate(t)}else n.activeTexture(33984+o),n.bindTexture(34067,s.__webglTexture)}function x(e,t){n.activeTexture(33984+t),n.bindTexture(34067,r.get(e).__webglTexture)}function E(n,o,s){var c;if(s?(e.texParameteri(n,10242,a.convert(o.wrapS)),e.texParameteri(n,10243,a.convert(o.wrapT)),32879!==n&&35866!==n||e.texParameteri(n,32882,a.convert(o.wrapR)),e.texParameteri(n,10240,a.convert(o.magFilter)),e.texParameteri(n,10241,a.convert(o.minFilter))):(e.texParameteri(n,10242,33071),e.texParameteri(n,10243,33071),32879!==n&&35866!==n||e.texParameteri(n,32882,33071),o.wrapS===xe&&o.wrapT===xe||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(n,10240,g(o.magFilter)),e.texParameteri(n,10241,g(o.minFilter)),o.minFilter!==Me&&o.minFilter!==Pe&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),c=t.get("EXT_texture_filter_anisotropic")){if(o.type===ze&&null===t.get("OES_texture_float_linear"))return;if(o.type===De&&null===(i.isWebGL2||t.get("OES_texture_half_float_linear")))return;(o.anisotropy>1||r.get(o).__currentAnisotropy)&&(e.texParameterf(n,c.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(o.anisotropy,i.getMaxAnisotropy())),r.get(o).__currentAnisotropy=o.anisotropy)}}function M(t,n){void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",v),t.__webglTexture=e.createTexture(),o.memory.textures++)}function S(t,r,o){var s=3553;r.isDataTexture2DArray&&(s=35866),r.isDataTexture3D&&(s=32879),M(t,r),n.activeTexture(33984+o),n.bindTexture(s,t.__webglTexture),e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment);var c=function(e){return!i.isWebGL2&&(e.wrapS!==xe||e.wrapT!==xe||e.minFilter!==Me&&e.minFilter!==Pe)}(r)&&!1===p(r.image),l=h(r.image,c,!1,i.maxTextureSize),u=p(l)||i.isWebGL2,g=a.convert(r.format),v=a.convert(r.type),y=m(g,v);E(s,r,u);var b,_=r.mipmaps;if(r.isDepthTexture){if(y=6402,r.type===ze){if(!i.isWebGL2)throw new Error("Float Depth Texture only supported in WebGL2.0");y=36012}else i.isWebGL2&&(y=33189);r.format===Ye&&6402===y&&r.type!==Ie&&r.type!==Ne&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=Ie,v=a.convert(r.type)),r.format===Ke&&(y=34041,r.type!==Ue&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=Ue,v=a.convert(r.type))),n.texImage2D(3553,0,y,l.width,l.height,0,g,v,null)}else if(r.isDataTexture)if(_.length>0&&u){for(var w=0,x=_.length;w<x;w++)b=_[w],n.texImage2D(3553,w,y,b.width,b.height,0,g,v,b.data);r.generateMipmaps=!1,t.__maxMipLevel=_.length-1}else n.texImage2D(3553,0,y,l.width,l.height,0,g,v,l.data),t.__maxMipLevel=0;else if(r.isCompressedTexture){for(w=0,x=_.length;w<x;w++)b=_[w],r.format!==Ge&&r.format!==He?n.getCompressedTextureFormats().indexOf(g)>-1?n.compressedTexImage2D(3553,w,y,b.width,b.height,0,b.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(3553,w,y,b.width,b.height,0,g,v,b.data);t.__maxMipLevel=_.length-1}else if(r.isDataTexture2DArray)n.texImage3D(35866,0,y,l.width,l.height,l.depth,0,g,v,l.data),t.__maxMipLevel=0;else if(r.isDataTexture3D)n.texImage3D(32879,0,y,l.width,l.height,l.depth,0,g,v,l.data),t.__maxMipLevel=0;else if(_.length>0&&u){for(w=0,x=_.length;w<x;w++)b=_[w],n.texImage2D(3553,w,y,g,v,b);r.generateMipmaps=!1,t.__maxMipLevel=_.length-1}else n.texImage2D(3553,0,y,g,v,l),t.__maxMipLevel=0;d(r,u)&&f(3553,r,l.width,l.height),t.__version=r.version,r.onUpdate&&r.onUpdate(r)}function T(t,i,o,s){var c=a.convert(i.texture.format),l=a.convert(i.texture.type),u=m(c,l);n.texImage2D(s,0,u,i.width,i.height,0,c,l,null),e.bindFramebuffer(36160,t),e.framebufferTexture2D(36160,o,s,r.get(i.texture).__webglTexture,0),e.bindFramebuffer(36160,null)}function P(t,n,r){if(e.bindRenderbuffer(36161,t),n.depthBuffer&&!n.stencilBuffer){if(r){var i=O(n);e.renderbufferStorageMultisample(36161,i,33189,n.width,n.height)}else e.renderbufferStorage(36161,33189,n.width,n.height);e.framebufferRenderbuffer(36160,36096,36161,t)}else if(n.depthBuffer&&n.stencilBuffer){if(r){i=O(n);e.renderbufferStorageMultisample(36161,i,34041,n.width,n.height)}else e.renderbufferStorage(36161,34041,n.width,n.height);e.framebufferRenderbuffer(36160,33306,36161,t)}else{var o=m(a.convert(n.texture.format),a.convert(n.texture.type));if(r){i=O(n);e.renderbufferStorageMultisample(36161,i,o,n.width,n.height)}else e.renderbufferStorage(36161,o,n.width,n.height)}e.bindRenderbuffer(36161,null)}function A(t){var n=r.get(t),i=!0===t.isWebGLRenderTargetCube;if(t.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,n){if(n&&n.isWebGLRenderTargetCube)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(36160,t),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),_(n.depthTexture,0);var i=r.get(n.depthTexture).__webglTexture;if(n.depthTexture.format===Ye)e.framebufferTexture2D(36160,36096,3553,i,0);else{if(n.depthTexture.format!==Ke)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(36160,33306,3553,i,0)}}(n.__webglFramebuffer,t)}else if(i){n.__webglDepthbuffer=[];for(var a=0;a<6;a++)e.bindFramebuffer(36160,n.__webglFramebuffer[a]),n.__webglDepthbuffer[a]=e.createRenderbuffer(),P(n.__webglDepthbuffer[a],t)}else e.bindFramebuffer(36160,n.__webglFramebuffer),n.__webglDepthbuffer=e.createRenderbuffer(),P(n.__webglDepthbuffer,t);e.bindFramebuffer(36160,null)}function O(e){return i.isWebGL2&&e.isWebGLMultisampleRenderTarget?Math.min(i.maxSamples,e.samples):0}var C=!1,R=!1;this.allocateTextureUnit=function(){var e=b;return e>=i.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+i.maxTextures),b+=1,e},this.resetTextureUnits=function(){b=0},this.setTexture2D=_,this.setTexture2DArray=function(e,t){var i=r.get(e);e.version>0&&i.__version!==e.version?S(i,e,t):(n.activeTexture(33984+t),n.bindTexture(35866,i.__webglTexture))},this.setTexture3D=function(e,t){var i=r.get(e);e.version>0&&i.__version!==e.version?S(i,e,t):(n.activeTexture(33984+t),n.bindTexture(32879,i.__webglTexture))},this.setTextureCube=w,this.setTextureCubeDynamic=x,this.setupRenderTarget=function(t){var s=r.get(t),c=r.get(t.texture);t.addEventListener("dispose",y),c.__webglTexture=e.createTexture(),o.memory.textures++;var l=!0===t.isWebGLRenderTargetCube,u=!0===t.isWebGLMultisampleRenderTarget,h=p(t)||i.isWebGL2;if(l){s.__webglFramebuffer=[];for(var g=0;g<6;g++)s.__webglFramebuffer[g]=e.createFramebuffer()}else if(s.__webglFramebuffer=e.createFramebuffer(),u)if(i.isWebGL2){s.__webglMultisampledFramebuffer=e.createFramebuffer(),s.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,s.__webglColorRenderbuffer);var v=m(a.convert(t.texture.format),a.convert(t.texture.type)),b=O(t);e.renderbufferStorageMultisample(36161,b,v,t.width,t.height),e.bindFramebuffer(36160,s.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,s.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),t.depthBuffer&&(s.__webglDepthRenderbuffer=e.createRenderbuffer(),P(s.__webglDepthRenderbuffer,t,!0)),e.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(l){for(n.bindTexture(34067,c.__webglTexture),E(34067,t.texture,h),g=0;g<6;g++)T(s.__webglFramebuffer[g],t,36064,34069+g);d(t.texture,h)&&f(34067,t.texture,t.width,t.height),n.bindTexture(34067,null)}else n.bindTexture(3553,c.__webglTexture),E(3553,t.texture,h),T(s.__webglFramebuffer,t,36064,3553),d(t.texture,h)&&f(3553,t.texture,t.width,t.height),n.bindTexture(3553,null);t.depthBuffer&&A(t)},this.updateRenderTargetMipmap=function(e){var t=e.texture;if(d(t,p(e)||i.isWebGL2)){var a=e.isWebGLRenderTargetCube?34067:3553,o=r.get(t).__webglTexture;n.bindTexture(a,o),f(a,t,e.width,e.height),n.bindTexture(a,null)}},this.updateMultisampleRenderTarget=function(t){if(t.isWebGLMultisampleRenderTarget)if(i.isWebGL2){var n=r.get(t);e.bindFramebuffer(36008,n.__webglMultisampledFramebuffer),e.bindFramebuffer(36009,n.__webglFramebuffer);var a=t.width,o=t.height,s=16384;t.depthBuffer&&(s|=256),t.stencilBuffer&&(s|=1024),e.blitFramebuffer(0,0,a,o,0,0,a,o,s,9728)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(e,t){e&&e.isWebGLRenderTarget&&(!1===C&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),C=!0),e=e.texture),_(e,t)},this.safeSetTextureCube=function(e,t){e&&e.isWebGLRenderTargetCube&&(!1===R&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),R=!0),e=e.texture),e&&e.isCubeTexture||Array.isArray(e.image)&&6===e.image.length?w(e,t):x(e,t)}}function ha(e,t,n){return{convert:function(e){var r;if(e===we)return 10497;if(e===xe)return 33071;if(e===Ee)return 33648;if(e===Me)return 9728;if(e===Se)return 9984;if(e===Te)return 9986;if(e===Pe)return 9729;if(e===Ae)return 9985;if(e===Oe)return 9987;if(e===Ce)return 5121;if(e===Be)return 32819;if(e===je)return 32820;if(e===Fe)return 33635;if(e===Re)return 5120;if(e===Le)return 5122;if(e===Ie)return 5123;if(e===ke)return 5124;if(e===Ne)return 5125;if(e===ze)return 5126;if(e===De){if(n.isWebGL2)return 5131;if(null!==(r=t.get("OES_texture_half_float")))return r.HALF_FLOAT_OES}if(e===Ve)return 6406;if(e===He)return 6407;if(e===Ge)return 6408;if(e===We)return 6409;if(e===qe)return 6410;if(e===Ye)return 6402;if(e===Ke)return 34041;if(e===$e)return 6403;if(e===k)return 32774;if(e===N)return 32778;if(e===z)return 32779;if(e===j)return 0;if(e===F)return 1;if(e===U)return 768;if(e===V)return 769;if(e===H)return 770;if(e===G)return 771;if(e===W)return 772;if(e===q)return 773;if(e===X)return 774;if(e===Y)return 775;if(e===K)return 776;if((e===Ze||e===Je||e===Qe||e===et)&&null!==(r=t.get("WEBGL_compressed_texture_s3tc"))){if(e===Ze)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===Je)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===Qe)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===et)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((e===tt||e===nt||e===rt||e===it)&&null!==(r=t.get("WEBGL_compressed_texture_pvrtc"))){if(e===tt)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===nt)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===rt)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===it)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(e===at&&null!==(r=t.get("WEBGL_compressed_texture_etc1")))return r.COMPRESSED_RGB_ETC1_WEBGL;if((e===ot||e===st||e===ct||e===lt||e===ut||e===ht||e===pt||e===dt||e===ft||e===mt||e===gt||e===vt||e===yt||e===bt)&&null!==(r=t.get("WEBGL_compressed_texture_astc")))return e;if(e===D||e===B){if(n.isWebGL2){if(e===D)return 32775;if(e===B)return 32776}if(null!==(r=t.get("EXT_blend_minmax"))){if(e===D)return r.MIN_EXT;if(e===B)return r.MAX_EXT}}if(e===Ue){if(n.isWebGL2)return 34042;if(null!==(r=t.get("WEBGL_depth_texture")))return r.UNSIGNED_INT_24_8_WEBGL}return 0}}}function pa(){Hn.call(this),this.type="Group"}function da(){Hn.call(this),this.type="Camera",this.matrixWorldInverse=new _n,this.projectionMatrix=new _n,this.projectionMatrixInverse=new _n}function fa(e,t,n,r){da.call(this),this.type="PerspectiveCamera",this.fov=void 0!==e?e:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==r?r:2e3,this.focus=10,this.aspect=void 0!==t?t:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function ma(e){fa.call(this),this.cameras=e||[]}oa.prototype=Object.create(dr.prototype),oa.prototype.constructor=oa,oa.prototype.isMeshDepthMaterial=!0,oa.prototype.copy=function(e){return dr.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},sa.prototype=Object.create(dr.prototype),sa.prototype.constructor=sa,sa.prototype.isMeshDistanceMaterial=!0,sa.prototype.copy=function(e){return dr.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this},pa.prototype=Object.assign(Object.create(Hn.prototype),{constructor:pa,isGroup:!0}),da.prototype=Object.assign(Object.create(Hn.prototype),{constructor:da,isCamera:!0,copy:function(e,t){return Hn.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new Xt),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()},updateMatrixWorld:function(e){Hn.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),fa.prototype=Object.assign(Object.create(da.prototype),{constructor:fa,isPerspectiveCamera:!0,copy:function(e,t){return da.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*Gt.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*Gt.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*Gt.RAD2DEG*Math.atan(Math.tan(.5*Gt.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,n,r,i,a){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,t=e*Math.tan(.5*Gt.DEG2RAD*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r,a=this.view;if(null!==this.view&&this.view.enabled){var o=a.fullWidth,s=a.fullHeight;i+=a.offsetX*r/o,t-=a.offsetY*n/s,r*=a.width/o,n*=a.height/s}var c=this.filmOffset;0!==c&&(i+=e*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=Hn.prototype.toJSON.call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}),ma.prototype=Object.assign(Object.create(fa.prototype),{constructor:ma,isArrayCamera:!0});var ga,va,ya,ba,_a,wa,xa=new Xt,Ea=new Xt;function Ma(e,t,n){xa.setFromMatrixPosition(t.matrixWorld),Ea.setFromMatrixPosition(n.matrixWorld);var r=xa.distanceTo(Ea),i=t.projectionMatrix.elements,a=n.projectionMatrix.elements,o=i[14]/(i[10]-1),s=i[14]/(i[10]+1),c=(i[9]+1)/i[5],l=(i[9]-1)/i[5],u=(i[8]-1)/i[0],h=(a[8]+1)/a[0],p=o*u,d=o*h,f=r/(-u+h),m=f*-u;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(f),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.getInverse(e.matrixWorld);var g=o+f,v=s+f,y=p-m,b=d+(r-m),_=c*s/v*g,w=l*s/v*g;e.projectionMatrix.makePerspective(y,b,_,w,g,v)}function Sa(e){var t=this,n=null,r=null,i=null,a=[],o=new _n,s=new _n,c=1,l="stage";"undefined"!=typeof window&&"VRFrameData"in window&&(r=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",b,!1));var u=new _n,h=new qt,p=new Xt,d=new fa;d.bounds=new hn(0,0,.5,1),d.layers.enable(1);var f=new fa;f.bounds=new hn(.5,0,.5,1),f.layers.enable(2);var m=new ma([d,f]);function g(){return null!==n&&!0===n.isPresenting}m.layers.enable(1),m.layers.enable(2);var v,y=new Wt;function b(){if(g()){var r=n.getEyeParameters("left"),i=r.renderWidth*c,a=r.renderHeight*c;v=e.getPixelRatio(),e.getSize(y),e.setDrawingBufferSize(2*i,a,1),x.start()}else t.enabled&&e.setDrawingBufferSize(y.width,y.height,v),x.stop()}var _=[];function w(e){for(var t=navigator.getGamepads&&navigator.getGamepads(),n=0,r=0,i=t.length;n<i;n++){var a=t[n];if(a&&("Daydream Controller"===a.id||"Gear VR Controller"===a.id||"Oculus Go Controller"===a.id||"OpenVR Gamepad"===a.id||a.id.startsWith("Oculus Touch")||a.id.startsWith("Spatial Controller"))){if(r===e)return a;r++}}}this.enabled=!1,this.getController=function(e){var t=a[e];return void 0===t&&((t=new pa).matrixAutoUpdate=!1,t.visible=!1,a[e]=t),t},this.getDevice=function(){return n},this.setDevice=function(e){void 0!==e&&(n=e),x.setContext(e)},this.setFramebufferScaleFactor=function(e){c=e},this.setFrameOfReferenceType=function(e){l=e},this.setPoseTarget=function(e){void 0!==e&&(i=e)},this.getCamera=function(e){var t="stage"===l?1.6:0;if(!1===g())return e.position.set(0,t,0),e.rotation.set(0,0,0),e;if(n.depthNear=e.near,n.depthFar=e.far,n.getFrameData(r),"stage"===l){var c=n.stageParameters;c?o.fromArray(c.sittingToStandingTransform):o.makeTranslation(0,t,0)}var v=r.pose,y=null!==i?i:e;y.matrix.copy(o),y.matrix.decompose(y.position,y.quaternion,y.scale),null!==v.orientation&&(h.fromArray(v.orientation),y.quaternion.multiply(h)),null!==v.position&&(h.setFromRotationMatrix(o),p.fromArray(v.position),p.applyQuaternion(h),y.position.add(p)),y.updateMatrixWorld(),d.near=e.near,f.near=e.near,d.far=e.far,f.far=e.far,d.matrixWorldInverse.fromArray(r.leftViewMatrix),f.matrixWorldInverse.fromArray(r.rightViewMatrix),s.getInverse(o),"stage"===l&&(d.matrixWorldInverse.multiply(s),f.matrixWorldInverse.multiply(s));var b=y.parent;null!==b&&(u.getInverse(b.matrixWorld),d.matrixWorldInverse.multiply(u),f.matrixWorldInverse.multiply(u)),d.matrixWorld.getInverse(d.matrixWorldInverse),f.matrixWorld.getInverse(f.matrixWorldInverse),d.projectionMatrix.fromArray(r.leftProjectionMatrix),f.projectionMatrix.fromArray(r.rightProjectionMatrix),Ma(m,d,f);var x=n.getLayers();if(x.length){var E=x[0];null!==E.leftBounds&&4===E.leftBounds.length&&d.bounds.fromArray(E.leftBounds),null!==E.rightBounds&&4===E.rightBounds.length&&f.bounds.fromArray(E.rightBounds)}return function(){for(var e=0;e<a.length;e++){var t=a[e],n=w(e);if(void 0!==n&&void 0!==n.pose){if(null===n.pose)return;var r=n.pose;!1===r.hasPosition&&t.position.set(.2,-.6,-.05),null!==r.position&&t.position.fromArray(r.position),null!==r.orientation&&t.quaternion.fromArray(r.orientation),t.matrix.compose(t.position,t.quaternion,t.scale),t.matrix.premultiply(o),t.matrix.decompose(t.position,t.quaternion,t.scale),t.matrixWorldNeedsUpdate=!0,t.visible=!0;var i="Daydream Controller"===n.id?0:1;_[e]!==n.buttons[i].pressed&&(_[e]=n.buttons[i].pressed,!0===_[e]?t.dispatchEvent({type:"selectstart"}):(t.dispatchEvent({type:"selectend"}),t.dispatchEvent({type:"select"})))}else t.visible=!1}}(),m},this.getStandingMatrix=function(){return o},this.isPresenting=g;var x=new In;this.setAnimationLoop=function(e){x.setAnimationLoop(e),g()&&x.start()},this.submitFrame=function(){g()&&n.submitFrame()},this.dispose=function(){"undefined"!=typeof window&&window.removeEventListener("vrdisplaypresentchange",b)}}function Ta(e){var t=e.context,n=null,r=null,i=1,a=null,o="stage",s=null,c=[],l=[];function u(){return null!==r&&null!==a}var h=new fa;h.layers.enable(1),h.viewport=new hn;var p=new fa;p.layers.enable(2),p.viewport=new hn;var d=new ma([h,p]);function f(e){var t=c[l.indexOf(e.inputSource)];t&&t.dispatchEvent({type:e.type})}function m(){e.setFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),y.stop()}function g(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.getInverse(e.matrixWorld)}d.layers.enable(1),d.layers.enable(2),this.enabled=!1,this.getController=function(e){var t=c[e];return void 0===t&&((t=new pa).matrixAutoUpdate=!1,t.visible=!1,c[e]=t),t},this.getDevice=function(){return n},this.setDevice=function(e){void 0!==e&&(n=e),e instanceof XRDevice&&t.setCompatibleXRDevice(e)},this.setFramebufferScaleFactor=function(e){i=e},this.setFrameOfReferenceType=function(e){o=e},this.setSession=function(n){null!==(r=n)&&(r.addEventListener("select",f),r.addEventListener("selectstart",f),r.addEventListener("selectend",f),r.addEventListener("end",m),r.baseLayer=new XRWebGLLayer(r,t,{framebufferScaleFactor:i}),r.requestFrameOfReference(o).then(function(t){a=t,e.setFramebuffer(r.baseLayer.framebuffer),y.setContext(r),y.start()}),l=r.getInputSources(),r.addEventListener("inputsourceschange",function(){l=r.getInputSources(),console.log(l);for(var e=0;e<c.length;e++){c[e].userData.inputSource=l[e]}}))},this.getCamera=function(e){if(u()){var t=e.parent,n=d.cameras;g(d,t);for(var r=0;r<n.length;r++)g(n[r],t);e.matrixWorld.copy(d.matrixWorld);for(var i=e.children,a=(r=0,i.length);r<a;r++)i[r].updateMatrixWorld(!0);return Ma(d,h,p),d}return e},this.isPresenting=u;var v=null;var y=new In;y.setAnimationLoop(function(e,t){if(null!==(s=t.getDevicePose(a)))for(var n=r.baseLayer,i=t.views,o=0;o<i.length;o++){var u=i[o],h=n.getViewport(u),p=s.getViewMatrix(u),f=d.cameras[o];f.matrix.fromArray(p).getInverse(f.matrix),f.projectionMatrix.fromArray(u.projectionMatrix),f.viewport.set(h.x,h.y,h.width,h.height),0===o&&d.matrix.copy(f.matrix)}for(o=0;o<c.length;o++){var m=c[o],g=l[o];if(g){var y=t.getInputPose(g,a);if(null!==y){"targetRay"in y?m.matrix.elements=y.targetRay.transformMatrix:"pointerMatrix"in y&&(m.matrix.elements=y.pointerMatrix),m.matrix.decompose(m.position,m.rotation,m.scale),m.visible=!0;continue}}m.visible=!1}v&&v(e)}),this.setAnimationLoop=function(e){v=e},this.dispose=function(){},this.getStandingMatrix=function(){return console.warn("THREE.WebXRManager: getStandingMatrix() is no longer needed."),new _n},this.submitFrame=function(){}}function Pa(e){console.log("THREE.WebGLRenderer",l);var t=void 0!==(e=e||{}).canvas?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),n=void 0!==e.context?e.context:null,r=void 0!==e.alpha&&e.alpha,i=void 0===e.depth||e.depth,a=void 0===e.stencil||e.stencil,o=void 0!==e.antialias&&e.antialias,s=void 0===e.premultipliedAlpha||e.premultipliedAlpha,c=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,u=void 0!==e.powerPreference?e.powerPreference:"default",h=null,p=null;this.domElement=t,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=ce,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var d,f,m,g,v,y,b,_,x,E,M,S,T,P,A,O,C,R,L=this,I=!1,k=null,N=null,z=null,D=-1,B={geometry:null,program:null,wireframe:!1},j=null,F=null,U=new hn,V=new hn,H=null,G=t.width,W=t.height,q=1,X=new hn(0,0,G,W),Y=new hn(0,0,G,W),K=!1,$=new bn,Z=new zr,J=!1,Q=!1,ee=new _n,te=new Xt;function ne(){return null===N?q:1}try{var re={alpha:r,depth:i,stencil:a,antialias:o,premultipliedAlpha:s,preserveDrawingBuffer:c,powerPreference:u};if(t.addEventListener("webglcontextlost",se,!1),t.addEventListener("webglcontextrestored",le,!1),null===(d=n||t.getContext("webgl",re)||t.getContext("experimental-webgl",re)))throw null!==t.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===d.getShaderPrecisionFormat&&(d.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){throw console.error("THREE.WebGLRenderer: "+e.message),e}function ie(){f=new Dr(d),(m=new Nr(d,f,e)).isWebGL2||(f.get("WEBGL_depth_texture"),f.get("OES_texture_float"),f.get("OES_texture_half_float"),f.get("OES_texture_half_float_linear"),f.get("OES_standard_derivatives"),f.get("OES_element_index_uint"),f.get("ANGLE_instanced_arrays")),f.get("OES_texture_float_linear"),R=new ha(d,f,m),(g=new la(d,f,R,m)).scissor(V.copy(Y).multiplyScalar(q)),g.viewport(U.copy(X).multiplyScalar(q)),v=new Fr(d),y=new $i,b=new ua(d,f,g,y,m,R,v),_=new kn(d),x=new Br(d,_,v),E=new Hr(x,v),A=new Vr(d),M=new Ki(L,f,m,b),S=new ea,T=new aa,P=new Ir(L,g,E,s),O=new kr(d,f,v,m),C=new jr(d,f,v,m),v.programs=M.programs,L.context=d,L.capabilities=m,L.extensions=f,L.properties=y,L.renderLists=S,L.state=g,L.info=v}ie();var ae=null;"undefined"!=typeof navigator&&(ae="xr"in navigator?new Ta(L):new Sa(L)),this.vr=ae;var oe=new ca(L,E,m.maxTextureSize);function se(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),I=!0}function le(){console.log("THREE.WebGLRenderer: Context Restored."),I=!1,ie()}function ue(e){var t=e.target;t.removeEventListener("dispose",ue),function(e){he(e),y.remove(e)}(t)}function he(e){var t=y.get(e).program;e.program=void 0,void 0!==t&&M.releaseProgram(t)}this.shadowMap=oe,this.getContext=function(){return d},this.getContextAttributes=function(){return d.getContextAttributes()},this.forceContextLoss=function(){var e=f.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=f.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return q},this.setPixelRatio=function(e){void 0!==e&&(q=e,this.setSize(G,W,!1))},this.getSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),e=new Wt),e.set(G,W)},this.setSize=function(e,n,r){ae.isPresenting()?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(G=e,W=n,t.width=e*q,t.height=n*q,!1!==r&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),e=new Wt),e.set(G*q,W*q)},this.setDrawingBufferSize=function(e,n,r){G=e,W=n,q=r,t.width=e*r,t.height=n*r,this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),e=new hn),e.copy(U)},this.getViewport=function(e){return e.copy(X)},this.setViewport=function(e,t,n,r){e.isVector4?X.set(e.x,e.y,e.z,e.w):X.set(e,t,n,r),g.viewport(U.copy(X).multiplyScalar(q))},this.getScissor=function(e){return e.copy(Y)},this.setScissor=function(e,t,n,r){e.isVector4?Y.set(e.x,e.y,e.z,e.w):Y.set(e,t,n,r),g.scissor(V.copy(Y).multiplyScalar(q))},this.getScissorTest=function(){return K},this.setScissorTest=function(e){g.setScissorTest(K=e)},this.getClearColor=function(){return P.getClearColor()},this.setClearColor=function(){P.setClearColor.apply(P,arguments)},this.getClearAlpha=function(){return P.getClearAlpha()},this.setClearAlpha=function(){P.setClearAlpha.apply(P,arguments)},this.clear=function(e,t,n){var r=0;(void 0===e||e)&&(r|=16384),(void 0===t||t)&&(r|=256),(void 0===n||n)&&(r|=1024),d.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",se,!1),t.removeEventListener("webglcontextrestored",le,!1),S.dispose(),T.dispose(),y.dispose(),E.dispose(),ae.dispose(),de.stop()},this.renderBufferImmediate=function(e,t){g.initAttributes();var n=y.get(e);e.hasPositions&&!n.position&&(n.position=d.createBuffer()),e.hasNormals&&!n.normal&&(n.normal=d.createBuffer()),e.hasUvs&&!n.uv&&(n.uv=d.createBuffer()),e.hasColors&&!n.color&&(n.color=d.createBuffer());var r=t.getAttributes();e.hasPositions&&(d.bindBuffer(34962,n.position),d.bufferData(34962,e.positionArray,35048),g.enableAttribute(r.position),d.vertexAttribPointer(r.position,3,5126,!1,0,0)),e.hasNormals&&(d.bindBuffer(34962,n.normal),d.bufferData(34962,e.normalArray,35048),g.enableAttribute(r.normal),d.vertexAttribPointer(r.normal,3,5126,!1,0,0)),e.hasUvs&&(d.bindBuffer(34962,n.uv),d.bufferData(34962,e.uvArray,35048),g.enableAttribute(r.uv),d.vertexAttribPointer(r.uv,2,5126,!1,0,0)),e.hasColors&&(d.bindBuffer(34962,n.color),d.bufferData(34962,e.colorArray,35048),g.enableAttribute(r.color),d.vertexAttribPointer(r.color,3,5126,!1,0,0)),g.disableUnusedAttributes(),d.drawArrays(4,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,n,r,i,a){var o=i.isMesh&&i.matrixWorld.determinant()<0;g.setMaterial(r,o);var s=ye(e,t,r,i),c=!1;B.geometry===n.id&&B.program===s.id&&B.wireframe===(!0===r.wireframe)||(B.geometry=n.id,B.program=s.id,B.wireframe=!0===r.wireframe,c=!0),i.morphTargetInfluences&&(A.update(i,n,r,s),c=!0);var l,u=n.index,h=n.attributes.position,p=1;!0===r.wireframe&&(u=x.getWireframeAttribute(n),p=2);var v=O;null!==u&&(l=_.get(u),(v=C).setIndex(l)),c&&(!function(e,t,n){if(n&&n.isInstancedBufferGeometry&&!m.isWebGL2&&null===f.get("ANGLE_instanced_arrays"))return void console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");g.initAttributes();var r=n.attributes,i=t.getAttributes(),a=e.defaultAttributeValues;for(var o in i){var s=i[o];if(s>=0){var c=r[o];if(void 0!==c){var l=c.normalized,u=c.itemSize,h=_.get(c);if(void 0===h)continue;var p=h.buffer,v=h.type,y=h.bytesPerElement;if(c.isInterleavedBufferAttribute){var b=c.data,w=b.stride,x=c.offset;b&&b.isInstancedInterleavedBuffer?(g.enableAttributeAndDivisor(s,b.meshPerAttribute),void 0===n.maxInstancedCount&&(n.maxInstancedCount=b.meshPerAttribute*b.count)):g.enableAttribute(s),d.bindBuffer(34962,p),d.vertexAttribPointer(s,u,v,l,w*y,x*y)}else c.isInstancedBufferAttribute?(g.enableAttributeAndDivisor(s,c.meshPerAttribute),void 0===n.maxInstancedCount&&(n.maxInstancedCount=c.meshPerAttribute*c.count)):g.enableAttribute(s),d.bindBuffer(34962,p),d.vertexAttribPointer(s,u,v,l,0,0)}else if(void 0!==a){var E=a[o];if(void 0!==E)switch(E.length){case 2:d.vertexAttrib2fv(s,E);break;case 3:d.vertexAttrib3fv(s,E);break;case 4:d.vertexAttrib4fv(s,E);break;default:d.vertexAttrib1fv(s,E)}}}}g.disableUnusedAttributes()}(r,s,n),null!==u&&d.bindBuffer(34963,l.buffer));var y=1/0;null!==u?y=u.count:void 0!==h&&(y=h.count);var b=n.drawRange.start*p,w=n.drawRange.count*p,E=null!==a?a.start*p:0,M=null!==a?a.count*p:1/0,S=Math.max(b,E),T=Math.min(y,b+w,E+M)-1,P=Math.max(0,T-S+1);if(0!==P){if(i.isMesh)if(!0===r.wireframe)g.setLineWidth(r.wireframeLinewidth*ne()),v.setMode(1);else switch(i.drawMode){case Ot:v.setMode(4);break;case Ct:v.setMode(5);break;case Rt:v.setMode(6)}else if(i.isLine){var R=r.linewidth;void 0===R&&(R=1),g.setLineWidth(R*ne()),i.isLineSegments?v.setMode(1):i.isLineLoop?v.setMode(2):v.setMode(3)}else i.isPoints?v.setMode(0):i.isSprite&&v.setMode(4);n&&n.isInstancedBufferGeometry?n.maxInstancedCount>0&&v.renderInstances(n,S,P):v.render(S,P)}},this.compile=function(e,t){(p=T.get(e,t)).init(),e.traverse(function(e){e.isLight&&(p.pushLight(e),e.castShadow&&p.pushShadow(e))}),p.setupLights(t),e.traverse(function(t){if(t.material)if(Array.isArray(t.material))for(var n=0;n<t.material.length;n++)ve(t.material[n],e.fog,t);else ve(t.material,e.fog,t)})};var pe=null;var de=new In;function fe(e,t,n,r){if(!1!==e.visible){if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLight)p.pushLight(e),e.castShadow&&p.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||$.intersectsSprite(e)){r&&te.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ee);var i=E.update(e);(a=e.material).visible&&h.push(e,i,a,n,te.z,null)}}else if(e.isImmediateRenderObject)r&&te.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ee),h.push(e,null,e.material,n,te.z,null);else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.update(),!e.frustumCulled||$.intersectsObject(e))){r&&te.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ee);i=E.update(e);var a=e.material;if(Array.isArray(a))for(var o=i.groups,s=0,c=o.length;s<c;s++){var l=o[s],u=a[l.materialIndex];u&&u.visible&&h.push(e,i,u,n,te.z,l)}else a.visible&&h.push(e,i,a,n,te.z,null)}var d=e.children;for(s=0,c=d.length;s<c;s++)fe(d[s],t,n,r)}}function me(e,t,n,r){for(var i=0,a=e.length;i<a;i++){var o=e[i],s=o.object,c=o.geometry,l=void 0===r?o.material:r,u=o.group;if(n.isArrayCamera){F=n;for(var h=n.cameras,d=0,f=h.length;d<f;d++){var m=h[d];if(s.layers.test(m.layers)){if("viewport"in m)g.viewport(U.copy(m.viewport));else{var v=m.bounds,y=v.x*G,b=v.y*W,_=v.z*G,w=v.w*W;g.viewport(U.set(y,b,_,w).multiplyScalar(q))}p.setupLights(m),ge(s,t,m,c,l,u)}}}else F=null,ge(s,t,n,c,l,u)}}function ge(e,t,n,r,i,a){if(e.onBeforeRender(L,t,n,r,i,a),p=T.get(t,F||n),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.isImmediateRenderObject){g.setMaterial(i);var o=ye(n,t.fog,i,e);B.geometry=null,B.program=null,B.wireframe=!1,function(e,t){e.render(function(e){L.renderBufferImmediate(e,t)})}(e,o)}else L.renderBufferDirect(n,t.fog,r,i,e,a);e.onAfterRender(L,t,n,r,i,a),p=T.get(t,F||n)}function ve(e,t,n){var r=y.get(e),i=p.state.lights,a=p.state.shadowsArray,o=r.lightsHash,s=i.state.hash,c=M.getParameters(e,i.state,a,t,Z.numPlanes,Z.numIntersection,n),l=M.getProgramCode(e,c),u=r.program,h=!0;if(void 0===u)e.addEventListener("dispose",ue);else if(u.code!==l)he(e);else if(o.stateID!==s.stateID||o.directionalLength!==s.directionalLength||o.pointLength!==s.pointLength||o.spotLength!==s.spotLength||o.rectAreaLength!==s.rectAreaLength||o.hemiLength!==s.hemiLength||o.shadowsLength!==s.shadowsLength)o.stateID=s.stateID,o.directionalLength=s.directionalLength,o.pointLength=s.pointLength,o.spotLength=s.spotLength,o.rectAreaLength=s.rectAreaLength,o.hemiLength=s.hemiLength,o.shadowsLength=s.shadowsLength,h=!1;else{if(void 0!==c.shaderID)return;h=!1}if(h){if(c.shaderID){var d=Ln[c.shaderID];r.shader={name:e.type,uniforms:xn(d.uniforms),vertexShader:d.vertexShader,fragmentShader:d.fragmentShader}}else r.shader={name:e.type,uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};e.onBeforeCompile(r.shader,L),l=M.getProgramCode(e,c),u=M.acquireProgram(e,r.shader,c,l),r.program=u,e.program=u}var f=u.getAttributes();if(e.morphTargets){e.numSupportedMorphTargets=0;for(var m=0;m<L.maxMorphTargets;m++)f["morphTarget"+m]>=0&&e.numSupportedMorphTargets++}if(e.morphNormals){e.numSupportedMorphNormals=0;for(m=0;m<L.maxMorphNormals;m++)f["morphNormal"+m]>=0&&e.numSupportedMorphNormals++}var g=r.shader.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(r.numClippingPlanes=Z.numPlanes,r.numIntersection=Z.numIntersection,g.clippingPlanes=Z.uniform),r.fog=t,void 0===o&&(r.lightsHash=o={}),o.stateID=s.stateID,o.directionalLength=s.directionalLength,o.pointLength=s.pointLength,o.spotLength=s.spotLength,o.rectAreaLength=s.rectAreaLength,o.hemiLength=s.hemiLength,o.shadowsLength=s.shadowsLength,e.lights&&(g.ambientLightColor.value=i.state.ambient,g.directionalLights.value=i.state.directional,g.spotLights.value=i.state.spot,g.rectAreaLights.value=i.state.rectArea,g.pointLights.value=i.state.point,g.hemisphereLights.value=i.state.hemi,g.directionalShadowMap.value=i.state.directionalShadowMap,g.directionalShadowMatrix.value=i.state.directionalShadowMatrix,g.spotShadowMap.value=i.state.spotShadowMap,g.spotShadowMatrix.value=i.state.spotShadowMatrix,g.pointShadowMap.value=i.state.pointShadowMap,g.pointShadowMatrix.value=i.state.pointShadowMatrix);var v=r.program.getUniforms(),b=Di.seqWithValue(v.seq,g);r.uniformsList=b}function ye(e,t,n,r){b.resetTextureUnits();var i=y.get(n),a=p.state.lights,o=i.lightsHash,s=a.state.hash;if(J&&(Q||e!==j)){var c=e===j&&n.id===D;Z.setState(n.clippingPlanes,n.clipIntersection,n.clipShadows,e,i,c)}!1===n.needsUpdate&&(void 0===i.program?n.needsUpdate=!0:n.fog&&i.fog!==t?n.needsUpdate=!0:(!n.lights||o.stateID===s.stateID&&o.directionalLength===s.directionalLength&&o.pointLength===s.pointLength&&o.spotLength===s.spotLength&&o.rectAreaLength===s.rectAreaLength&&o.hemiLength===s.hemiLength&&o.shadowsLength===s.shadowsLength)&&(void 0===i.numClippingPlanes||i.numClippingPlanes===Z.numPlanes&&i.numIntersection===Z.numIntersection)||(n.needsUpdate=!0)),n.needsUpdate&&(ve(n,t,r),n.needsUpdate=!1);var l,u,h=!1,f=!1,v=!1,_=i.program,x=_.getUniforms(),E=i.shader.uniforms;if(g.useProgram(_.program)&&(h=!0,f=!0,v=!0),n.id!==D&&(D=n.id,f=!0),h||j!==e){if(x.setValue(d,"projectionMatrix",e.projectionMatrix),m.logarithmicDepthBuffer&&x.setValue(d,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),j!==e&&(j=e,f=!0,v=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshStandardMaterial||n.envMap){var M=x.map.cameraPosition;void 0!==M&&M.setValue(d,te.setFromMatrixPosition(e.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.skinning)&&x.setValue(d,"viewMatrix",e.matrixWorldInverse)}if(n.skinning){x.setOptional(d,r,"bindMatrix"),x.setOptional(d,r,"bindMatrixInverse");var S=r.skeleton;if(S){var T=S.bones;if(m.floatVertexTextures){if(void 0===S.boneTexture){var P=Math.sqrt(4*T.length);P=Gt.ceilPowerOfTwo(P),P=Math.max(P,4);var A=new Float32Array(P*P*4);A.set(S.boneMatrices);var O=new mn(A,P,P,Ge,ze);O.needsUpdate=!0,S.boneMatrices=A,S.boneTexture=O,S.boneTextureSize=P}x.setValue(d,"boneTexture",S.boneTexture,b),x.setValue(d,"boneTextureSize",S.boneTextureSize)}else x.setOptional(d,S,"boneMatrices")}}return f&&(x.setValue(d,"toneMappingExposure",L.toneMappingExposure),x.setValue(d,"toneMappingWhitePoint",L.toneMappingWhitePoint),n.lights&&(u=v,(l=E).ambientLightColor.needsUpdate=u,l.directionalLights.needsUpdate=u,l.pointLights.needsUpdate=u,l.spotLights.needsUpdate=u,l.rectAreaLights.needsUpdate=u,l.hemisphereLights.needsUpdate=u),t&&n.fog&&function(e,t){e.fogColor.value=t.color,t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)}(E,t),n.isMeshBasicMaterial?be(E,n):n.isMeshLambertMaterial?(be(E,n),function(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}(E,n)):n.isMeshPhongMaterial?(be(E,n),n.isMeshToonMaterial?function(e,t){_e(e,t),t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(E,n):_e(E,n)):n.isMeshStandardMaterial?(be(E,n),n.isMeshPhysicalMaterial?function(e,t){we(e,t),e.reflectivity.value=t.reflectivity,e.clearCoat.value=t.clearCoat,e.clearCoatRoughness.value=t.clearCoatRoughness}(E,n):we(E,n)):n.isMeshMatcapMaterial?(be(E,n),function(e,t){t.matcap&&(e.matcap.value=t.matcap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===w&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===w&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(E,n)):n.isMeshDepthMaterial?(be(E,n),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(E,n)):n.isMeshDistanceMaterial?(be(E,n),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias);e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(E,n)):n.isMeshNormalMaterial?(be(E,n),function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===w&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===w&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(E,n)):n.isLineBasicMaterial?(function(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity}(E,n),n.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(E,n)):n.isPointsMaterial?function(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity,e.size.value=t.size*q,e.scale.value=.5*W,e.map.value=t.map,null!==t.map&&(!0===t.map.matrixAutoUpdate&&t.map.updateMatrix(),e.uvTransform.value.copy(t.map.matrix))}(E,n):n.isSpriteMaterial?function(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity,e.rotation.value=t.rotation,e.map.value=t.map,null!==t.map&&(!0===t.map.matrixAutoUpdate&&t.map.updateMatrix(),e.uvTransform.value.copy(t.map.matrix))}(E,n):n.isShadowMaterial&&(E.color.value=n.color,E.opacity.value=n.opacity),void 0!==E.ltc_1&&(E.ltc_1.value=Rn.LTC_1),void 0!==E.ltc_2&&(E.ltc_2.value=Rn.LTC_2),Di.upload(d,i.uniformsList,E,b)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(Di.upload(d,i.uniformsList,E,b),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&x.setValue(d,"center",r.center),x.setValue(d,"modelViewMatrix",r.modelViewMatrix),x.setValue(d,"normalMatrix",r.normalMatrix),x.setValue(d,"modelMatrix",r.matrixWorld),_}function be(e,t){var n;e.opacity.value=t.opacity,t.color&&(e.diffuse.value=t.color),t.emissive&&e.emissive.value.copy(t.emissive).multiplyScalar(t.emissiveIntensity),t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.specularMap&&(e.specularMap.value=t.specularMap),t.envMap&&(e.envMap.value=t.envMap,e.flipEnvMap.value=t.envMap.isCubeTexture?-1:1,e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio,e.maxMipLevel.value=y.get(t.envMap).__maxMipLevel),t.lightMap&&(e.lightMap.value=t.lightMap,e.lightMapIntensity.value=t.lightMapIntensity),t.aoMap&&(e.aoMap.value=t.aoMap,e.aoMapIntensity.value=t.aoMapIntensity),t.map?n=t.map:t.specularMap?n=t.specularMap:t.displacementMap?n=t.displacementMap:t.normalMap?n=t.normalMap:t.bumpMap?n=t.bumpMap:t.roughnessMap?n=t.roughnessMap:t.metalnessMap?n=t.metalnessMap:t.alphaMap?n=t.alphaMap:t.emissiveMap&&(n=t.emissiveMap),void 0!==n&&(n.isWebGLRenderTarget&&(n=n.texture),!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}function _e(e,t){e.specular.value=t.specular,e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===w&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===w&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}function we(e,t){e.roughness.value=t.roughness,e.metalness.value=t.metalness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap),t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===w&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===w&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}de.setAnimationLoop(function(e){ae.isPresenting()||pe&&pe(e)}),"undefined"!=typeof window&&de.setContext(window),this.setAnimationLoop=function(e){pe=e,ae.setAnimationLoop(e),de.start()},this.render=function(e,t){var n,r;if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),n=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),r=arguments[3]),t&&t.isCamera){if(!I){B.geometry=null,B.program=null,B.wireframe=!1,D=-1,j=null,!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),ae.enabled&&(t=ae.getCamera(t)),(p=T.get(e,t)).init(),e.onBeforeRender(L,e,t,n||N),ee.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),$.setFromMatrix(ee),Q=this.localClippingEnabled,J=Z.init(this.clippingPlanes,Q,t),(h=S.get(e,t)).init(),fe(e,t,0,L.sortObjects),!0===L.sortObjects&&h.sort(),J&&Z.beginShadows();var i=p.state.shadowsArray;oe.render(i,e,t),p.setupLights(t),J&&Z.endShadows(),this.info.autoReset&&this.info.reset(),void 0!==n&&this.setRenderTarget(n),P.render(h,e,t,r);var a=h.opaque,o=h.transparent;if(e.overrideMaterial){var s=e.overrideMaterial;a.length&&me(a,e,t,s),o.length&&me(o,e,t,s)}else a.length&&me(a,e,t),o.length&&me(o,e,t);e.onAfterRender(L,e,t),null!==N&&(b.updateRenderTargetMipmap(N),b.updateMultisampleRenderTarget(N)),g.buffers.depth.setTest(!0),g.buffers.depth.setMask(!0),g.buffers.color.setMask(!0),g.setPolygonOffset(!1),ae.enabled&&ae.submitFrame(),h=null,p=null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFramebuffer=function(e){k=e},this.getRenderTarget=function(){return N},this.setRenderTarget=function(e,t,n){N=e,e&&void 0===y.get(e).__webglFramebuffer&&b.setupRenderTarget(e);var r=k,i=!1;if(e){var a=y.get(e).__webglFramebuffer;e.isWebGLRenderTargetCube?(r=a[t||0],i=!0):r=e.isWebGLMultisampleRenderTarget?y.get(e).__webglMultisampledFramebuffer:a,U.copy(e.viewport),V.copy(e.scissor),H=e.scissorTest}else U.copy(X).multiplyScalar(q),V.copy(Y).multiplyScalar(q),H=K;if(z!==r&&(d.bindFramebuffer(36160,r),z=r),g.viewport(U),g.scissor(V),g.setScissorTest(H),i){var o=y.get(e.texture);d.framebufferTexture2D(36160,36064,34069+(t||0),o.__webglTexture,n||0)}},this.readRenderTargetPixels=function(e,t,n,r,i,a){if(e&&e.isWebGLRenderTarget){var o=y.get(e).__webglFramebuffer;if(o){var s=!1;o!==z&&(d.bindFramebuffer(36160,o),s=!0);try{var c=e.texture,l=c.format,u=c.type;if(l!==Ge&&R.convert(l)!==d.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(u===Ce||R.convert(u)===d.getParameter(35738)||u===ze&&(m.isWebGL2||f.get("OES_texture_float")||f.get("WEBGL_color_buffer_float"))||u===De&&(m.isWebGL2?f.get("EXT_color_buffer_float"):f.get("EXT_color_buffer_half_float"))))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===d.checkFramebufferStatus(36160)?t>=0&&t<=e.width-r&&n>=0&&n<=e.height-i&&d.readPixels(t,n,r,i,R.convert(l),R.convert(u),a):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{s&&d.bindFramebuffer(36160,z)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(e,t,n){var r=t.image.width,i=t.image.height,a=R.convert(t.format);b.setTexture2D(t,0),d.copyTexImage2D(3553,n||0,a,e.x,e.y,r,i,0)},this.copyTextureToTexture=function(e,t,n,r){var i=t.image.width,a=t.image.height,o=R.convert(n.format),s=R.convert(n.type);b.setTexture2D(n,0),t.isDataTexture?d.texSubImage2D(3553,r||0,e.x,e.y,i,a,o,s,t.image.data):d.texSubImage2D(3553,r||0,e.x,e.y,o,s,t.image)}}function Aa(e,t){this.name="",this.color=new On(e),this.density=void 0!==t?t:25e-5}function Oa(e,t,n){this.name="",this.color=new On(e),this.near=void 0!==t?t:1,this.far=void 0!==n?n:1e3}function Ca(){Hn.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function Ra(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function La(e,t,n,r){this.data=e,this.itemSize=t,this.offset=n,this.normalized=!0===r}function Ia(e){dr.call(this),this.type="SpriteMaterial",this.color=new On(16777215),this.map=null,this.rotation=0,this.sizeAttenuation=!0,this.lights=!1,this.transparent=!0,this.setValues(e)}function ka(e){if(Hn.call(this),this.type="Sprite",void 0===ga){ga=new sr;var t=new Ra(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);ga.setIndex([0,1,2,0,2,3]),ga.addAttribute("position",new La(t,3,0,!1)),ga.addAttribute("uv",new La(t,2,3,!1))}this.geometry=ga,this.material=void 0!==e?e:new Ia,this.center=new Wt(.5,.5)}function Na(){Hn.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function za(e,t){e&&e.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Lr.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new _n,this.bindMatrixInverse=new _n}function Da(e,t){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new _n)}}function Ba(){Hn.call(this),this.type="Bone"}function ja(e){dr.call(this),this.type="LineBasicMaterial",this.color=new On(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(e)}function Fa(e,t,n){1===n&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),Hn.call(this),this.type="Line",this.geometry=void 0!==e?e:new sr,this.material=void 0!==t?t:new ja({color:16777215*Math.random()})}function Ua(e,t){Fa.call(this,e,t),this.type="LineSegments"}function Va(e,t){Fa.call(this,e,t),this.type="LineLoop"}function Ha(e){dr.call(this),this.type="PointsMaterial",this.color=new On(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.lights=!1,this.setValues(e)}function Ga(e,t){Hn.call(this),this.type="Points",this.geometry=void 0!==e?e:new sr,this.material=void 0!==t?t:new Ha({color:16777215*Math.random()})}function Wa(e,t,n,r,i,a,o,s,c){un.call(this,e,t,n,r,i,a,o,s,c),this.format=void 0!==o?o:He,this.minFilter=void 0!==a?a:Pe,this.magFilter=void 0!==i?i:Pe,this.generateMipmaps=!1}function qa(e,t,n,r,i,a,o,s,c,l,u,h){un.call(this,null,a,o,s,c,l,r,i,u,h),this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}function Xa(e,t,n,r,i,a,o,s,c){un.call(this,e,t,n,r,i,a,o,s,c),this.needsUpdate=!0}function Ya(e,t,n,r,i,a,o,s,c,l){if((l=void 0!==l?l:Ye)!==Ye&&l!==Ke)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&l===Ye&&(n=Ie),void 0===n&&l===Ke&&(n=Ue),un.call(this,null,r,i,a,o,s,l,n,c),this.image={width:e,height:t},this.magFilter=void 0!==o?o:Me,this.minFilter=void 0!==s?s:Me,this.flipY=!1,this.generateMipmaps=!1}function Ka(e){sr.call(this),this.type="WireframeGeometry";var t,n,r,i,a,o,s,c,l,u,h=[],p=[0,0],d={},f=["a","b","c"];if(e&&e.isGeometry){var m=e.faces;for(t=0,r=m.length;t<r;t++){var g=m[t];for(n=0;n<3;n++)s=g[f[n]],c=g[f[(n+1)%3]],p[0]=Math.min(s,c),p[1]=Math.max(s,c),void 0===d[l=p[0]+","+p[1]]&&(d[l]={index1:p[0],index2:p[1]})}for(l in d)o=d[l],u=e.vertices[o.index1],h.push(u.x,u.y,u.z),u=e.vertices[o.index2],h.push(u.x,u.y,u.z)}else if(e&&e.isBufferGeometry){var v,y,b,_,w,x,E;if(u=new Xt,null!==e.index){for(v=e.attributes.position,y=e.index,0===(b=e.groups).length&&(b=[{start:0,count:y.count,materialIndex:0}]),i=0,a=b.length;i<a;++i)for(t=w=(_=b[i]).start,r=w+_.count;t<r;t+=3)for(n=0;n<3;n++)s=y.getX(t+n),c=y.getX(t+(n+1)%3),p[0]=Math.min(s,c),p[1]=Math.max(s,c),void 0===d[l=p[0]+","+p[1]]&&(d[l]={index1:p[0],index2:p[1]});for(l in d)o=d[l],u.fromBufferAttribute(v,o.index1),h.push(u.x,u.y,u.z),u.fromBufferAttribute(v,o.index2),h.push(u.x,u.y,u.z)}else for(t=0,r=(v=e.attributes.position).count/3;t<r;t++)for(n=0;n<3;n++)x=3*t+n,u.fromBufferAttribute(v,x),h.push(u.x,u.y,u.z),E=3*t+(n+1)%3,u.fromBufferAttribute(v,E),h.push(u.x,u.y,u.z)}this.addAttribute("position",new nr(h,3))}function $a(e,t,n){Xn.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:n},this.fromBufferGeometry(new Za(e,t,n)),this.mergeVertices()}function Za(e,t,n){sr.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:t,stacks:n};var r,i,a=[],o=[],s=[],c=[],l=new Xt,u=new Xt,h=new Xt,p=new Xt,d=new Xt;e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");var f=t+1;for(r=0;r<=n;r++){var m=r/n;for(i=0;i<=t;i++){var g=i/t;e(g,m,u),o.push(u.x,u.y,u.z),g-1e-5>=0?(e(g-1e-5,m,h),p.subVectors(u,h)):(e(g+1e-5,m,h),p.subVectors(h,u)),m-1e-5>=0?(e(g,m-1e-5,h),d.subVectors(u,h)):(e(g,m+1e-5,h),d.subVectors(h,u)),l.crossVectors(p,d).normalize(),s.push(l.x,l.y,l.z),c.push(g,m)}}for(r=0;r<n;r++)for(i=0;i<t;i++){var v=r*f+i,y=r*f+i+1,b=(r+1)*f+i+1,_=(r+1)*f+i;a.push(v,y,_),a.push(y,b,_)}this.setIndex(a),this.addAttribute("position",new nr(o,3)),this.addAttribute("normal",new nr(s,3)),this.addAttribute("uv",new nr(c,2))}function Ja(e,t,n,r){Xn.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r},this.fromBufferGeometry(new Qa(e,t,n,r)),this.mergeVertices()}function Qa(e,t,n,r){sr.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r},n=n||1;var i=[],a=[];function o(e,t,n,r){var i,a,o=Math.pow(2,r),c=[];for(i=0;i<=o;i++){c[i]=[];var l=e.clone().lerp(n,i/o),u=t.clone().lerp(n,i/o),h=o-i;for(a=0;a<=h;a++)c[i][a]=0===a&&i===o?l:l.clone().lerp(u,a/h)}for(i=0;i<o;i++)for(a=0;a<2*(o-i)-1;a++){var p=Math.floor(a/2);a%2==0?(s(c[i][p+1]),s(c[i+1][p]),s(c[i][p])):(s(c[i][p+1]),s(c[i+1][p+1]),s(c[i+1][p]))}}function s(e){i.push(e.x,e.y,e.z)}function c(t,n){var r=3*t;n.x=e[r+0],n.y=e[r+1],n.z=e[r+2]}function l(e,t,n,r){r<0&&1===e.x&&(a[t]=e.x-1),0===n.x&&0===n.z&&(a[t]=r/2/Math.PI+.5)}function u(e){return Math.atan2(e.z,-e.x)}function h(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}!function(e){for(var n=new Xt,r=new Xt,i=new Xt,a=0;a<t.length;a+=3)c(t[a+0],n),c(t[a+1],r),c(t[a+2],i),o(n,r,i,e)}(r=r||0),function(e){for(var t=new Xt,n=0;n<i.length;n+=3)t.x=i[n+0],t.y=i[n+1],t.z=i[n+2],t.normalize().multiplyScalar(e),i[n+0]=t.x,i[n+1]=t.y,i[n+2]=t.z}(n),function(){for(var e=new Xt,t=0;t<i.length;t+=3){e.x=i[t+0],e.y=i[t+1],e.z=i[t+2];var n=u(e)/2/Math.PI+.5,r=h(e)/Math.PI+.5;a.push(n,1-r)}(function(){for(var e=new Xt,t=new Xt,n=new Xt,r=new Xt,o=new Wt,s=new Wt,c=new Wt,h=0,p=0;h<i.length;h+=9,p+=6){e.set(i[h+0],i[h+1],i[h+2]),t.set(i[h+3],i[h+4],i[h+5]),n.set(i[h+6],i[h+7],i[h+8]),o.set(a[p+0],a[p+1]),s.set(a[p+2],a[p+3]),c.set(a[p+4],a[p+5]),r.copy(e).add(t).add(n).divideScalar(3);var d=u(r);l(o,p+0,e,d),l(s,p+2,t,d),l(c,p+4,n,d)}})(),function(){for(var e=0;e<a.length;e+=6){var t=a[e+0],n=a[e+2],r=a[e+4],i=Math.max(t,n,r),o=Math.min(t,n,r);i>.9&&o<.1&&(t<.2&&(a[e+0]+=1),n<.2&&(a[e+2]+=1),r<.2&&(a[e+4]+=1))}}()}(),this.addAttribute("position",new nr(i,3)),this.addAttribute("normal",new nr(i.slice(),3)),this.addAttribute("uv",new nr(a,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}function eo(e,t){Xn.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new to(e,t)),this.mergeVertices()}function to(e,t){Qa.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:t}}function no(e,t){Xn.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new ro(e,t)),this.mergeVertices()}function ro(e,t){Qa.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:t}}function io(e,t){Xn.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new ao(e,t)),this.mergeVertices()}function ao(e,t){var n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1];Qa.call(this,r,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}function oo(e,t){Xn.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new so(e,t)),this.mergeVertices()}function so(e,t){var n=(1+Math.sqrt(5))/2,r=1/n,i=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r];Qa.call(this,i,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:t}}function co(e,t,n,r,i,a){Xn.call(this),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:i},void 0!==a&&console.warn("THREE.TubeGeometry: taper has been removed.");var o=new lo(e,t,n,r,i);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals,this.fromBufferGeometry(o),this.mergeVertices()}function lo(e,t,n,r,i){sr.call(this),this.type="TubeBufferGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:i},t=t||64,n=n||1,r=r||8,i=i||!1;var a=e.computeFrenetFrames(t,i);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;var o,s,c=new Xt,l=new Xt,u=new Wt,h=new Xt,p=[],d=[],f=[],m=[];function g(i){h=e.getPointAt(i/t,h);var o=a.normals[i],u=a.binormals[i];for(s=0;s<=r;s++){var f=s/r*Math.PI*2,m=Math.sin(f),g=-Math.cos(f);l.x=g*o.x+m*u.x,l.y=g*o.y+m*u.y,l.z=g*o.z+m*u.z,l.normalize(),d.push(l.x,l.y,l.z),c.x=h.x+n*l.x,c.y=h.y+n*l.y,c.z=h.z+n*l.z,p.push(c.x,c.y,c.z)}}!function(){for(o=0;o<t;o++)g(o);g(!1===i?t:0),function(){for(o=0;o<=t;o++)for(s=0;s<=r;s++)u.x=o/t,u.y=s/r,f.push(u.x,u.y)}(),function(){for(s=1;s<=t;s++)for(o=1;o<=r;o++){var e=(r+1)*(s-1)+(o-1),n=(r+1)*s+(o-1),i=(r+1)*s+o,a=(r+1)*(s-1)+o;m.push(e,n,a),m.push(n,i,a)}}()}(),this.setIndex(m),this.addAttribute("position",new nr(p,3)),this.addAttribute("normal",new nr(d,3)),this.addAttribute("uv",new nr(f,2))}function uo(e,t,n,r,i,a,o){Xn.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:i,q:a},void 0!==o&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new ho(e,t,n,r,i,a)),this.mergeVertices()}function ho(e,t,n,r,i,a){sr.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:i,q:a},e=e||1,t=t||.4,n=Math.floor(n)||64,r=Math.floor(r)||8,i=i||2,a=a||3;var o,s,c=[],l=[],u=[],h=[],p=new Xt,d=new Xt,f=new Xt,m=new Xt,g=new Xt,v=new Xt,y=new Xt;for(o=0;o<=n;++o){var b=o/n*i*Math.PI*2;for(P(b,i,a,e,f),P(b+.01,i,a,e,m),v.subVectors(m,f),y.addVectors(m,f),g.crossVectors(v,y),y.crossVectors(g,v),g.normalize(),y.normalize(),s=0;s<=r;++s){var _=s/r*Math.PI*2,w=-t*Math.cos(_),x=t*Math.sin(_);p.x=f.x+(w*y.x+x*g.x),p.y=f.y+(w*y.y+x*g.y),p.z=f.z+(w*y.z+x*g.z),l.push(p.x,p.y,p.z),d.subVectors(p,f).normalize(),u.push(d.x,d.y,d.z),h.push(o/n),h.push(s/r)}}for(s=1;s<=n;s++)for(o=1;o<=r;o++){var E=(r+1)*(s-1)+(o-1),M=(r+1)*s+(o-1),S=(r+1)*s+o,T=(r+1)*(s-1)+o;c.push(E,M,T),c.push(M,S,T)}function P(e,t,n,r,i){var a=Math.cos(e),o=Math.sin(e),s=n/t*e,c=Math.cos(s);i.x=r*(2+c)*.5*a,i.y=r*(2+c)*o*.5,i.z=r*Math.sin(s)*.5}this.setIndex(c),this.addAttribute("position",new nr(l,3)),this.addAttribute("normal",new nr(u,3)),this.addAttribute("uv",new nr(h,2))}function po(e,t,n,r,i){Xn.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:i},this.fromBufferGeometry(new fo(e,t,n,r,i)),this.mergeVertices()}function fo(e,t,n,r,i){sr.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:i},e=e||1,t=t||.4,n=Math.floor(n)||8,r=Math.floor(r)||6,i=i||2*Math.PI;var a,o,s=[],c=[],l=[],u=[],h=new Xt,p=new Xt,d=new Xt;for(a=0;a<=n;a++)for(o=0;o<=r;o++){var f=o/r*i,m=a/n*Math.PI*2;p.x=(e+t*Math.cos(m))*Math.cos(f),p.y=(e+t*Math.cos(m))*Math.sin(f),p.z=t*Math.sin(m),c.push(p.x,p.y,p.z),h.x=e*Math.cos(f),h.y=e*Math.sin(f),d.subVectors(p,h).normalize(),l.push(d.x,d.y,d.z),u.push(o/r),u.push(a/n)}for(a=1;a<=n;a++)for(o=1;o<=r;o++){var g=(r+1)*a+o-1,v=(r+1)*(a-1)+o-1,y=(r+1)*(a-1)+o,b=(r+1)*a+o;s.push(g,v,b),s.push(v,y,b)}this.setIndex(s),this.addAttribute("position",new nr(c,3)),this.addAttribute("normal",new nr(l,3)),this.addAttribute("uv",new nr(u,2))}Object.assign(Aa.prototype,{isFogExp2:!0,clone:function(){return new Aa(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),Object.assign(Oa.prototype,{isFog:!0,clone:function(){return new Oa(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),Ca.prototype=Object.assign(Object.create(Hn.prototype),{constructor:Ca,isScene:!0,copy:function(e,t){return Hn.prototype.copy.call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){var t=Hn.prototype.toJSON.call(this,e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(Ra.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(Ra.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=void 0!==e?e.length/this.stride:0,this.array=e,this},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.dynamic=e.dynamic,this},copyAt:function(e,t,n){e*=this.stride,n*=t.stride;for(var r=0,i=this.stride;r<i;r++)this.array[e+r]=t.array[n+r];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(e){return this.onUploadCallback=e,this}}),Object.defineProperties(La.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(La.prototype,{isInterleavedBufferAttribute:!0,setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this},setXYZ:function(e,t,n,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this},setXYZW:function(e,t,n,r,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=i,this}}),Ia.prototype=Object.create(dr.prototype),Ia.prototype.constructor=Ia,Ia.prototype.isSpriteMaterial=!0,Ia.prototype.copy=function(e){return dr.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this},ka.prototype=Object.assign(Object.create(Hn.prototype),{constructor:ka,isSprite:!0,raycast:function(){var e=new Xt,t=new Xt,n=new Xt,r=new Wt,i=new Wt,a=new _n,o=new Xt,s=new Xt,c=new Xt,l=new Wt,u=new Wt,h=new Wt;function p(e,t,n,o,s,c){r.subVectors(e,n).addScalar(.5).multiply(o),void 0!==s?(i.x=c*r.x-s*r.y,i.y=s*r.x+c*r.y):i.copy(r),e.copy(t),e.x+=i.x,e.y+=i.y,e.applyMatrix4(a)}return function(r,i){t.setFromMatrixScale(this.matrixWorld),a.getInverse(this.modelViewMatrix).premultiply(this.matrixWorld),n.setFromMatrixPosition(this.modelViewMatrix);var d,f,m=this.material.rotation;0!==m&&(f=Math.cos(m),d=Math.sin(m));var g=this.center;p(o.set(-.5,-.5,0),n,g,t,d,f),p(s.set(.5,-.5,0),n,g,t,d,f),p(c.set(.5,.5,0),n,g,t,d,f),l.set(0,0),u.set(1,0),h.set(1,1);var v=r.ray.intersectTriangle(o,s,c,!1,e);if(null!==v||(p(s.set(-.5,.5,0),n,g,t,d,f),u.set(0,1),null!==(v=r.ray.intersectTriangle(o,c,s,!1,e)))){var y=r.ray.origin.distanceTo(e);y<r.near||y>r.far||i.push({distance:y,point:e.clone(),uv:Cr.getUV(e,o,s,c,l,u,h,new Wt),face:null,object:this})}}}(),clone:function(){return new this.constructor(this.material).copy(this)},copy:function(e){return Hn.prototype.copy.call(this,e),void 0!==e.center&&this.center.copy(e.center),this}}),Na.prototype=Object.assign(Object.create(Hn.prototype),{constructor:Na,copy:function(e){Hn.prototype.copy.call(this,e,!1);for(var t=e.levels,n=0,r=t.length;n<r;n++){var i=t[n];this.addLevel(i.object.clone(),i.distance)}return this},addLevel:function(e,t){void 0===t&&(t=0),t=Math.abs(t);for(var n=this.levels,r=0;r<n.length&&!(t<n[r].distance);r++);n.splice(r,0,{distance:t,object:e}),this.add(e)},getObjectForDistance:function(e){for(var t=this.levels,n=1,r=t.length;n<r&&!(e<t[n].distance);n++);return t[n-1].object},raycast:(va=new Xt,function(e,t){va.setFromMatrixPosition(this.matrixWorld);var n=e.ray.origin.distanceTo(va);this.getObjectForDistance(n).raycast(e,t)}),update:function(){var e=new Xt,t=new Xt;return function(n){var r=this.levels;if(r.length>1){e.setFromMatrixPosition(n.matrixWorld),t.setFromMatrixPosition(this.matrixWorld);var i=e.distanceTo(t);r[0].object.visible=!0;for(var a=1,o=r.length;a<o&&i>=r[a].distance;a++)r[a-1].object.visible=!1,r[a].object.visible=!0;for(;a<o;a++)r[a].object.visible=!1}}}(),toJSON:function(e){var t=Hn.prototype.toJSON.call(this,e);t.object.levels=[];for(var n=this.levels,r=0,i=n.length;r<i;r++){var a=n[r];t.object.levels.push({object:a.object.uuid,distance:a.distance})}return t}}),za.prototype=Object.assign(Object.create(Lr.prototype),{constructor:za,isSkinnedMesh:!0,bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var e=new hn,t=this.geometry.attributes.skinWeight,n=0,r=t.count;n<r;n++){e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.w=t.getW(n);var i=1/e.manhattanLength();i!==1/0?e.multiplyScalar(i):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}},updateMatrixWorld:function(e){Lr.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Object.assign(Da.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,t=this.bones.length;e<t;e++){var n=new _n;this.bones[e]&&n.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(n)}},pose:function(){var e,t,n;for(t=0,n=this.bones.length;t<n;t++)(e=this.bones[t])&&e.matrixWorld.getInverse(this.boneInverses[t]);for(t=0,n=this.bones.length;t<n;t++)(e=this.bones[t])&&(e.parent&&e.parent.isBone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},update:(ya=new _n,ba=new _n,function(){for(var e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture,i=0,a=e.length;i<a;i++){var o=e[i]?e[i].matrixWorld:ba;ya.multiplyMatrices(o,t[i]),ya.toArray(n,16*i)}void 0!==r&&(r.needsUpdate=!0)}),clone:function(){return new Da(this.bones,this.boneInverses)},getBoneByName:function(e){for(var t=0,n=this.bones.length;t<n;t++){var r=this.bones[t];if(r.name===e)return r}}}),Ba.prototype=Object.assign(Object.create(Hn.prototype),{constructor:Ba,isBone:!0}),ja.prototype=Object.create(dr.prototype),ja.prototype.constructor=ja,ja.prototype.isLineBasicMaterial=!0,ja.prototype.copy=function(e){return dr.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this},Fa.prototype=Object.assign(Object.create(Hn.prototype),{constructor:Fa,isLine:!0,computeLineDistances:(_a=new Xt,wa=new Xt,function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,n=[0],r=1,i=t.count;r<i;r++)_a.fromBufferAttribute(t,r-1),wa.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=_a.distanceTo(wa);e.addAttribute("lineDistance",new nr(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry){var a=e.vertices;for((n=e.lineDistances)[0]=0,r=1,i=a.length;r<i;r++)n[r]=n[r-1],n[r]+=a[r-1].distanceTo(a[r])}return this}),raycast:function(){var e=new _n,t=new Or,n=new vn;return function(r,i){var a=r.linePrecision,o=this.geometry,s=this.matrixWorld;if(null===o.boundingSphere&&o.computeBoundingSphere(),n.copy(o.boundingSphere),n.applyMatrix4(s),n.radius+=a,!1!==r.ray.intersectsSphere(n)){e.getInverse(s),t.copy(r.ray).applyMatrix4(e);var c=a/((this.scale.x+this.scale.y+this.scale.z)/3),l=c*c,u=new Xt,h=new Xt,p=new Xt,d=new Xt,f=this&&this.isLineSegments?2:1;if(o.isBufferGeometry){var m=o.index,g=o.attributes.position.array;if(null!==m)for(var v=m.array,y=0,b=v.length-1;y<b;y+=f){var _=v[y],w=v[y+1];if(u.fromArray(g,3*_),h.fromArray(g,3*w),!(t.distanceSqToSegment(u,h,d,p)>l))d.applyMatrix4(this.matrixWorld),(M=r.ray.origin.distanceTo(d))<r.near||M>r.far||i.push({distance:M,point:p.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}else for(y=0,b=g.length/3-1;y<b;y+=f){if(u.fromArray(g,3*y),h.fromArray(g,3*y+3),!(t.distanceSqToSegment(u,h,d,p)>l))d.applyMatrix4(this.matrixWorld),(M=r.ray.origin.distanceTo(d))<r.near||M>r.far||i.push({distance:M,point:p.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}else if(o.isGeometry){var x=o.vertices,E=x.length;for(y=0;y<E-1;y+=f){var M;if(!(t.distanceSqToSegment(x[y],x[y+1],d,p)>l))d.applyMatrix4(this.matrixWorld),(M=r.ray.origin.distanceTo(d))<r.near||M>r.far||i.push({distance:M,point:p.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Ua.prototype=Object.assign(Object.create(Fa.prototype),{constructor:Ua,isLineSegments:!0,computeLineDistances:function(){var e=new Xt,t=new Xt;return function(){var n=this.geometry;if(n.isBufferGeometry)if(null===n.index){for(var r=n.attributes.position,i=[],a=0,o=r.count;a<o;a+=2)e.fromBufferAttribute(r,a),t.fromBufferAttribute(r,a+1),i[a]=0===a?0:i[a-1],i[a+1]=i[a]+e.distanceTo(t);n.addAttribute("lineDistance",new nr(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(n.isGeometry){var s=n.vertices;for(i=n.lineDistances,a=0,o=s.length;a<o;a+=2)e.copy(s[a]),t.copy(s[a+1]),i[a]=0===a?0:i[a-1],i[a+1]=i[a]+e.distanceTo(t)}return this}}()}),Va.prototype=Object.assign(Object.create(Fa.prototype),{constructor:Va,isLineLoop:!0}),Ha.prototype=Object.create(dr.prototype),Ha.prototype.constructor=Ha,Ha.prototype.isPointsMaterial=!0,Ha.prototype.copy=function(e){return dr.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this},Ga.prototype=Object.assign(Object.create(Hn.prototype),{constructor:Ga,isPoints:!0,raycast:function(){var e=new _n,t=new Or,n=new vn;return function(r,i){var a=this,o=this.geometry,s=this.matrixWorld,c=r.params.Points.threshold;if(null===o.boundingSphere&&o.computeBoundingSphere(),n.copy(o.boundingSphere),n.applyMatrix4(s),n.radius+=c,!1!==r.ray.intersectsSphere(n)){e.getInverse(s),t.copy(r.ray).applyMatrix4(e);var l=c/((this.scale.x+this.scale.y+this.scale.z)/3),u=l*l,h=new Xt,p=new Xt;if(o.isBufferGeometry){var d=o.index,f=o.attributes.position.array;if(null!==d)for(var m=d.array,g=0,v=m.length;g<v;g++){var y=m[g];h.fromArray(f,3*y),w(h,y)}else{g=0;for(var b=f.length/3;g<b;g++)h.fromArray(f,3*g),w(h,g)}}else{var _=o.vertices;for(g=0,b=_.length;g<b;g++)w(_[g],g)}}function w(e,n){var o=t.distanceSqToPoint(e);if(o<u){t.closestPointToPoint(e,p),p.applyMatrix4(s);var c=r.ray.origin.distanceTo(p);if(c<r.near||c>r.far)return;i.push({distance:c,distanceToRay:Math.sqrt(o),point:p.clone(),index:n,face:null,object:a})}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Wa.prototype=Object.assign(Object.create(un.prototype),{constructor:Wa,isVideoTexture:!0,update:function(){var e=this.image;e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),qa.prototype=Object.create(un.prototype),qa.prototype.constructor=qa,qa.prototype.isCompressedTexture=!0,Xa.prototype=Object.create(un.prototype),Xa.prototype.constructor=Xa,Xa.prototype.isCanvasTexture=!0,Ya.prototype=Object.create(un.prototype),Ya.prototype.constructor=Ya,Ya.prototype.isDepthTexture=!0,Ka.prototype=Object.create(sr.prototype),Ka.prototype.constructor=Ka,$a.prototype=Object.create(Xn.prototype),$a.prototype.constructor=$a,Za.prototype=Object.create(sr.prototype),Za.prototype.constructor=Za,Ja.prototype=Object.create(Xn.prototype),Ja.prototype.constructor=Ja,Qa.prototype=Object.create(sr.prototype),Qa.prototype.constructor=Qa,eo.prototype=Object.create(Xn.prototype),eo.prototype.constructor=eo,to.prototype=Object.create(Qa.prototype),to.prototype.constructor=to,no.prototype=Object.create(Xn.prototype),no.prototype.constructor=no,ro.prototype=Object.create(Qa.prototype),ro.prototype.constructor=ro,io.prototype=Object.create(Xn.prototype),io.prototype.constructor=io,ao.prototype=Object.create(Qa.prototype),ao.prototype.constructor=ao,oo.prototype=Object.create(Xn.prototype),oo.prototype.constructor=oo,so.prototype=Object.create(Qa.prototype),so.prototype.constructor=so,co.prototype=Object.create(Xn.prototype),co.prototype.constructor=co,lo.prototype=Object.create(sr.prototype),lo.prototype.constructor=lo,lo.prototype.toJSON=function(){var e=sr.prototype.toJSON.call(this);return e.path=this.parameters.path.toJSON(),e},uo.prototype=Object.create(Xn.prototype),uo.prototype.constructor=uo,ho.prototype=Object.create(sr.prototype),ho.prototype.constructor=ho,po.prototype=Object.create(Xn.prototype),po.prototype.constructor=po,fo.prototype=Object.create(sr.prototype),fo.prototype.constructor=fo;var mo=function(e,t,n){n=n||2;var r,i,a,o,s,c,l,u=t&&t.length,h=u?t[0]*n:e.length,p=go(e,0,h,n,!0),d=[];if(!p)return d;if(u&&(p=function(e,t,n,r){var i,a,o,s,c,l=[];for(i=0,a=t.length;i<a;i++)o=t[i]*r,s=i<a-1?t[i+1]*r:e.length,(c=go(e,o,s,r,!1))===c.next&&(c.steiner=!0),l.push(To(c));for(l.sort(Eo),i=0;i<l.length;i++)Mo(l[i],n),n=vo(n,n.next);return n}(e,t,p,n)),e.length>80*n){r=a=e[0],i=o=e[1];for(var f=n;f<h;f+=n)(s=e[f])<r&&(r=s),(c=e[f+1])<i&&(i=c),s>a&&(a=s),c>o&&(o=c);l=0!==(l=Math.max(a-r,o-i))?1/l:0}return yo(p,d,n,r,i,l),d};function go(e,t,n,r,i){var a,o;if(i===function(e,t,n,r){for(var i=0,a=t,o=n-r;a<n;a+=r)i+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return i}(e,t,n,r)>0)for(a=t;a<n;a+=r)o=ko(a,e[a],e[a+1],o);else for(a=n-r;a>=t;a-=r)o=ko(a,e[a],e[a+1],o);return o&&Co(o,o.next)&&(No(o),o=o.next),o}function vo(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!Co(r,r.next)&&0!==Oo(r.prev,r,r.next))r=r.next;else{if(No(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function yo(e,t,n,r,i,a,o){if(e){!o&&a&&function(e,t,n,r){var i=e;do{null===i.z&&(i.z=So(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,n,r,i,a,o,s,c,l=1;do{for(n=e,e=null,a=null,o=0;n;){for(o++,r=n,s=0,t=0;t<l&&(s++,r=r.nextZ);t++);for(c=l;s>0||c>0&&r;)0!==s&&(0===c||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,c--),a?a.nextZ=i:e=i,i.prevZ=a,a=i;n=r}a.nextZ=null,l*=2}while(o>1)}(i)}(e,r,i,a);for(var s,c,l=e;e.prev!==e.next;)if(s=e.prev,c=e.next,a?_o(e,r,i,a):bo(e))t.push(s.i/n),t.push(e.i/n),t.push(c.i/n),No(e),e=c.next,l=c.next;else if((e=c)===l){o?1===o?yo(e=wo(e,t,n),t,n,r,i,a,2):2===o&&xo(e,t,n,r,i,a):yo(vo(e),t,n,r,i,a,1);break}}}function bo(e){var t=e.prev,n=e,r=e.next;if(Oo(t,n,r)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(Po(t.x,t.y,n.x,n.y,r.x,r.y,i.x,i.y)&&Oo(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function _o(e,t,n,r){var i=e.prev,a=e,o=e.next;if(Oo(i,a,o)>=0)return!1;for(var s=i.x<a.x?i.x<o.x?i.x:o.x:a.x<o.x?a.x:o.x,c=i.y<a.y?i.y<o.y?i.y:o.y:a.y<o.y?a.y:o.y,l=i.x>a.x?i.x>o.x?i.x:o.x:a.x>o.x?a.x:o.x,u=i.y>a.y?i.y>o.y?i.y:o.y:a.y>o.y?a.y:o.y,h=So(s,c,t,n,r),p=So(l,u,t,n,r),d=e.nextZ;d&&d.z<=p;){if(d!==e.prev&&d!==e.next&&Po(i.x,i.y,a.x,a.y,o.x,o.y,d.x,d.y)&&Oo(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(d=e.prevZ;d&&d.z>=h;){if(d!==e.prev&&d!==e.next&&Po(i.x,i.y,a.x,a.y,o.x,o.y,d.x,d.y)&&Oo(d.prev,d,d.next)>=0)return!1;d=d.prevZ}return!0}function wo(e,t,n){var r=e;do{var i=r.prev,a=r.next.next;!Co(i,a)&&Ro(i,r,r.next,a)&&Lo(i,a)&&Lo(a,i)&&(t.push(i.i/n),t.push(r.i/n),t.push(a.i/n),No(r),No(r.next),r=e=a),r=r.next}while(r!==e);return r}function xo(e,t,n,r,i,a){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&Ao(o,s)){var c=Io(o,s);return o=vo(o,o.next),c=vo(c,c.next),yo(o,t,n,r,i,a),void yo(c,t,n,r,i,a)}s=s.next}o=o.next}while(o!==e)}function Eo(e,t){return e.x-t.x}function Mo(e,t){if(t=function(e,t){var n,r=t,i=e.x,a=e.y,o=-1/0;do{if(a<=r.y&&a>=r.next.y&&r.next.y!==r.y){var s=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>o){if(o=s,s===i){if(a===r.y)return r;if(a===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!n)return null;if(i===o)return n.prev;var c,l=n,u=n.x,h=n.y,p=1/0;r=n.next;for(;r!==l;)i>=r.x&&r.x>=u&&i!==r.x&&Po(a<h?i:o,a,u,h,a<h?o:i,a,r.x,r.y)&&((c=Math.abs(a-r.y)/(i-r.x))<p||c===p&&r.x>n.x)&&Lo(r,e)&&(n=r,p=c),r=r.next;return n}(e,t)){var n=Io(t,e);vo(n,n.next)}}function So(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function To(e){var t=e,n=e;do{t.x<n.x&&(n=t),t=t.next}while(t!==e);return n}function Po(e,t,n,r,i,a,o,s){return(i-o)*(t-s)-(e-o)*(a-s)>=0&&(e-o)*(r-s)-(n-o)*(t-s)>=0&&(n-o)*(a-s)-(i-o)*(r-s)>=0}function Ao(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&Ro(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&Lo(e,t)&&Lo(t,e)&&function(e,t){var n=e,r=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do{n.y>a!=n.next.y>a&&n.next.y!==n.y&&i<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)}function Oo(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function Co(e,t){return e.x===t.x&&e.y===t.y}function Ro(e,t,n,r){return!!(Co(e,t)&&Co(n,r)||Co(e,r)&&Co(n,t))||Oo(e,t,n)>0!=Oo(e,t,r)>0&&Oo(n,r,e)>0!=Oo(n,r,t)>0}function Lo(e,t){return Oo(e.prev,e,e.next)<0?Oo(e,t,e.next)>=0&&Oo(e,e.prev,t)>=0:Oo(e,t,e.prev)<0||Oo(e,e.next,t)<0}function Io(e,t){var n=new zo(e.i,e.x,e.y),r=new zo(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function ko(e,t,n,r){var i=new zo(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function No(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function zo(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var Do={area:function(e){for(var t=e.length,n=0,r=t-1,i=0;i<t;r=i++)n+=e[r].x*e[i].y-e[i].x*e[r].y;return.5*n},isClockWise:function(e){return Do.area(e)<0},triangulateShape:function(e,t){var n=[],r=[],i=[];Bo(e),jo(n,e);var a=e.length;t.forEach(Bo);for(var o=0;o<t.length;o++)r.push(a),a+=t[o].length,jo(n,t[o]);var s=mo(n,r);for(o=0;o<s.length;o+=3)i.push(s.slice(o,o+3));return i}};function Bo(e){var t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function jo(e,t){for(var n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}function Fo(e,t){Xn.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},this.fromBufferGeometry(new Uo(e,t)),this.mergeVertices()}function Uo(e,t){sr.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];for(var n=this,r=[],i=[],a=0,o=e.length;a<o;a++){s(e[a])}function s(e){var a=[],o=void 0!==t.curveSegments?t.curveSegments:12,s=void 0!==t.steps?t.steps:1,c=void 0!==t.depth?t.depth:100,l=void 0===t.bevelEnabled||t.bevelEnabled,u=void 0!==t.bevelThickness?t.bevelThickness:6,h=void 0!==t.bevelSize?t.bevelSize:u-2,p=void 0!==t.bevelSegments?t.bevelSegments:3,d=t.extrudePath,f=void 0!==t.UVGenerator?t.UVGenerator:Vo;void 0!==t.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),c=t.amount);var m,g,v,y,b,_,w,x,E=!1;d&&(m=d.getSpacedPoints(s),E=!0,l=!1,g=d.computeFrenetFrames(s,!1),v=new Xt,y=new Xt,b=new Xt),l||(p=0,u=0,h=0);var M=e.extractPoints(o),S=M.shape,T=M.holes;if(!Do.isClockWise(S))for(S=S.reverse(),w=0,x=T.length;w<x;w++)_=T[w],Do.isClockWise(_)&&(T[w]=_.reverse());var P=Do.triangulateShape(S,T),A=S;for(w=0,x=T.length;w<x;w++)_=T[w],S=S.concat(_);function O(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(n).add(e)}var C,R,L,I,k,N,z=S.length,D=P.length;function B(e,t,n){var r,i,a,o=e.x-t.x,s=e.y-t.y,c=n.x-e.x,l=n.y-e.y,u=o*o+s*s,h=o*l-s*c;if(Math.abs(h)>Number.EPSILON){var p=Math.sqrt(u),d=Math.sqrt(c*c+l*l),f=t.x-s/p,m=t.y+o/p,g=((n.x-l/d-f)*l-(n.y+c/d-m)*c)/(o*l-s*c),v=(r=f+o*g-e.x)*r+(i=m+s*g-e.y)*i;if(v<=2)return new Wt(r,i);a=Math.sqrt(v/2)}else{var y=!1;o>Number.EPSILON?c>Number.EPSILON&&(y=!0):o<-Number.EPSILON?c<-Number.EPSILON&&(y=!0):Math.sign(s)===Math.sign(l)&&(y=!0),y?(r=-s,i=o,a=Math.sqrt(u)):(r=o,i=s,a=Math.sqrt(u/2))}return new Wt(r/a,i/a)}for(var j=[],F=0,U=A.length,V=U-1,H=F+1;F<U;F++,V++,H++)V===U&&(V=0),H===U&&(H=0),j[F]=B(A[F],A[V],A[H]);var G,W,q=[],X=j.concat();for(w=0,x=T.length;w<x;w++){for(_=T[w],G=[],F=0,V=(U=_.length)-1,H=F+1;F<U;F++,V++,H++)V===U&&(V=0),H===U&&(H=0),G[F]=B(_[F],_[V],_[H]);q.push(G),X=X.concat(G)}for(C=0;C<p;C++){for(L=C/p,I=u*Math.cos(L*Math.PI/2),R=h*Math.sin(L*Math.PI/2),F=0,U=A.length;F<U;F++)K((k=O(A[F],j[F],R)).x,k.y,-I);for(w=0,x=T.length;w<x;w++)for(_=T[w],G=q[w],F=0,U=_.length;F<U;F++)K((k=O(_[F],G[F],R)).x,k.y,-I)}for(R=h,F=0;F<z;F++)k=l?O(S[F],X[F],R):S[F],E?(y.copy(g.normals[0]).multiplyScalar(k.x),v.copy(g.binormals[0]).multiplyScalar(k.y),b.copy(m[0]).add(y).add(v),K(b.x,b.y,b.z)):K(k.x,k.y,0);for(W=1;W<=s;W++)for(F=0;F<z;F++)k=l?O(S[F],X[F],R):S[F],E?(y.copy(g.normals[W]).multiplyScalar(k.x),v.copy(g.binormals[W]).multiplyScalar(k.y),b.copy(m[W]).add(y).add(v),K(b.x,b.y,b.z)):K(k.x,k.y,c/s*W);for(C=p-1;C>=0;C--){for(L=C/p,I=u*Math.cos(L*Math.PI/2),R=h*Math.sin(L*Math.PI/2),F=0,U=A.length;F<U;F++)K((k=O(A[F],j[F],R)).x,k.y,c+I);for(w=0,x=T.length;w<x;w++)for(_=T[w],G=q[w],F=0,U=_.length;F<U;F++)k=O(_[F],G[F],R),E?K(k.x,k.y+m[s-1].y,m[s-1].x+I):K(k.x,k.y,c+I)}function Y(e,t){var n,r;for(F=e.length;--F>=0;){n=F,(r=F-1)<0&&(r=e.length-1);var i=0,a=s+2*p;for(i=0;i<a;i++){var o=z*i,c=z*(i+1);Z(t+n+o,t+r+o,t+r+c,t+n+c)}}}function K(e,t,n){a.push(e),a.push(t),a.push(n)}function $(e,t,i){J(e),J(t),J(i);var a=r.length/3,o=f.generateTopUV(n,r,a-3,a-2,a-1);Q(o[0]),Q(o[1]),Q(o[2])}function Z(e,t,i,a){J(e),J(t),J(a),J(t),J(i),J(a);var o=r.length/3,s=f.generateSideWallUV(n,r,o-6,o-3,o-2,o-1);Q(s[0]),Q(s[1]),Q(s[3]),Q(s[1]),Q(s[2]),Q(s[3])}function J(e){r.push(a[3*e+0]),r.push(a[3*e+1]),r.push(a[3*e+2])}function Q(e){i.push(e.x),i.push(e.y)}!function(){var e=r.length/3;if(l){var t=0,i=z*t;for(F=0;F<D;F++)$((N=P[F])[2]+i,N[1]+i,N[0]+i);for(i=z*(t=s+2*p),F=0;F<D;F++)$((N=P[F])[0]+i,N[1]+i,N[2]+i)}else{for(F=0;F<D;F++)$((N=P[F])[2],N[1],N[0]);for(F=0;F<D;F++)$((N=P[F])[0]+z*s,N[1]+z*s,N[2]+z*s)}n.addGroup(e,r.length/3-e,0)}(),function(){var e=r.length/3,t=0;for(Y(A,t),t+=A.length,w=0,x=T.length;w<x;w++)Y(_=T[w],t),t+=_.length;n.addGroup(e,r.length/3-e,1)}()}this.addAttribute("position",new nr(r,3)),this.addAttribute("uv",new nr(i,2)),this.computeVertexNormals()}Fo.prototype=Object.create(Xn.prototype),Fo.prototype.constructor=Fo,Fo.prototype.toJSON=function(){var e=Xn.prototype.toJSON.call(this);return Ho(this.parameters.shapes,this.parameters.options,e)},Uo.prototype=Object.create(sr.prototype),Uo.prototype.constructor=Uo,Uo.prototype.toJSON=function(){var e=sr.prototype.toJSON.call(this);return Ho(this.parameters.shapes,this.parameters.options,e)};var Vo={generateTopUV:function(e,t,n,r,i){var a=t[3*n],o=t[3*n+1],s=t[3*r],c=t[3*r+1],l=t[3*i],u=t[3*i+1];return[new Wt(a,o),new Wt(s,c),new Wt(l,u)]},generateSideWallUV:function(e,t,n,r,i,a){var o=t[3*n],s=t[3*n+1],c=t[3*n+2],l=t[3*r],u=t[3*r+1],h=t[3*r+2],p=t[3*i],d=t[3*i+1],f=t[3*i+2],m=t[3*a],g=t[3*a+1],v=t[3*a+2];return Math.abs(s-u)<.01?[new Wt(o,1-c),new Wt(l,1-h),new Wt(p,1-f),new Wt(m,1-v)]:[new Wt(s,1-c),new Wt(u,1-h),new Wt(d,1-f),new Wt(g,1-v)]}};function Ho(e,t,n){if(n.shapes=[],Array.isArray(e))for(var r=0,i=e.length;r<i;r++){var a=e[r];n.shapes.push(a.uuid)}else n.shapes.push(e.uuid);return void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON()),n}function Go(e,t){Xn.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:t},this.fromBufferGeometry(new Wo(e,t)),this.mergeVertices()}function Wo(e,t){var n=(t=t||{}).font;if(!n||!n.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new Xn;var r=n.generateShapes(e,t.size);t.depth=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),Uo.call(this,r,t),this.type="TextBufferGeometry"}function qo(e,t,n,r,i,a,o){Xn.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:a,thetaLength:o},this.fromBufferGeometry(new Xo(e,t,n,r,i,a,o)),this.mergeVertices()}function Xo(e,t,n,r,i,a,o){sr.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:a,thetaLength:o},e=e||1,t=Math.max(3,Math.floor(t)||8),n=Math.max(2,Math.floor(n)||6),r=void 0!==r?r:0,i=void 0!==i?i:2*Math.PI;var s,c,l=(a=void 0!==a?a:0)+(o=void 0!==o?o:Math.PI),u=0,h=[],p=new Xt,d=new Xt,f=[],m=[],g=[],v=[];for(c=0;c<=n;c++){var y=[],b=c/n,_=0==c?.5/t:c==n?-.5/t:0;for(s=0;s<=t;s++){var w=s/t;p.x=-e*Math.cos(r+w*i)*Math.sin(a+b*o),p.y=e*Math.cos(a+b*o),p.z=e*Math.sin(r+w*i)*Math.sin(a+b*o),m.push(p.x,p.y,p.z),d.copy(p).normalize(),g.push(d.x,d.y,d.z),v.push(w+_,1-b),y.push(u++)}h.push(y)}for(c=0;c<n;c++)for(s=0;s<t;s++){var x=h[c][s+1],E=h[c][s],M=h[c+1][s],S=h[c+1][s+1];(0!==c||a>0)&&f.push(x,E,S),(c!==n-1||l<Math.PI)&&f.push(E,M,S)}this.setIndex(f),this.addAttribute("position",new nr(m,3)),this.addAttribute("normal",new nr(g,3)),this.addAttribute("uv",new nr(v,2))}function Yo(e,t,n,r,i,a){Xn.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:a},this.fromBufferGeometry(new Ko(e,t,n,r,i,a)),this.mergeVertices()}function Ko(e,t,n,r,i,a){sr.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:a},e=e||.5,t=t||1,i=void 0!==i?i:0,a=void 0!==a?a:2*Math.PI,n=void 0!==n?Math.max(3,n):8;var o,s,c,l=[],u=[],h=[],p=[],d=e,f=(t-e)/(r=void 0!==r?Math.max(1,r):1),m=new Xt,g=new Wt;for(s=0;s<=r;s++){for(c=0;c<=n;c++)o=i+c/n*a,m.x=d*Math.cos(o),m.y=d*Math.sin(o),u.push(m.x,m.y,m.z),h.push(0,0,1),g.x=(m.x/t+1)/2,g.y=(m.y/t+1)/2,p.push(g.x,g.y);d+=f}for(s=0;s<r;s++){var v=s*(n+1);for(c=0;c<n;c++){var y=o=c+v,b=o+n+1,_=o+n+2,w=o+1;l.push(y,b,w),l.push(b,_,w)}}this.setIndex(l),this.addAttribute("position",new nr(u,3)),this.addAttribute("normal",new nr(h,3)),this.addAttribute("uv",new nr(p,2))}function $o(e,t,n,r){Xn.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},this.fromBufferGeometry(new Zo(e,t,n,r)),this.mergeVertices()}function Zo(e,t,n,r){sr.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},t=Math.floor(t)||12,n=n||0,r=r||2*Math.PI,r=Gt.clamp(r,0,2*Math.PI);var i,a,o,s=[],c=[],l=[],u=1/t,h=new Xt,p=new Wt;for(a=0;a<=t;a++){var d=n+a*u*r,f=Math.sin(d),m=Math.cos(d);for(o=0;o<=e.length-1;o++)h.x=e[o].x*f,h.y=e[o].y,h.z=e[o].x*m,c.push(h.x,h.y,h.z),p.x=a/t,p.y=o/(e.length-1),l.push(p.x,p.y)}for(a=0;a<t;a++)for(o=0;o<e.length-1;o++){var g=i=o+a*e.length,v=i+e.length,y=i+e.length+1,b=i+1;s.push(g,v,b),s.push(v,y,b)}if(this.setIndex(s),this.addAttribute("position",new nr(c,3)),this.addAttribute("uv",new nr(l,2)),this.computeVertexNormals(),r===2*Math.PI){var _=this.attributes.normal.array,w=new Xt,x=new Xt,E=new Xt;for(i=t*e.length*3,a=0,o=0;a<e.length;a++,o+=3)w.x=_[o+0],w.y=_[o+1],w.z=_[o+2],x.x=_[i+o+0],x.y=_[i+o+1],x.z=_[i+o+2],E.addVectors(w,x).normalize(),_[o+0]=_[i+o+0]=E.x,_[o+1]=_[i+o+1]=E.y,_[o+2]=_[i+o+2]=E.z}}function Jo(e,t){Xn.call(this),this.type="ShapeGeometry","object"==typeof t&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),t=t.curveSegments),this.parameters={shapes:e,curveSegments:t},this.fromBufferGeometry(new Qo(e,t)),this.mergeVertices()}function Qo(e,t){sr.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:t},t=t||12;var n=[],r=[],i=[],a=[],o=0,s=0;if(!1===Array.isArray(e))l(e);else for(var c=0;c<e.length;c++)l(e[c]),this.addGroup(o,s,c),o+=s,s=0;function l(e){var o,c,l,u=r.length/3,h=e.extractPoints(t),p=h.shape,d=h.holes;for(!1===Do.isClockWise(p)&&(p=p.reverse()),o=0,c=d.length;o<c;o++)l=d[o],!0===Do.isClockWise(l)&&(d[o]=l.reverse());var f=Do.triangulateShape(p,d);for(o=0,c=d.length;o<c;o++)l=d[o],p=p.concat(l);for(o=0,c=p.length;o<c;o++){var m=p[o];r.push(m.x,m.y,0),i.push(0,0,1),a.push(m.x,m.y)}for(o=0,c=f.length;o<c;o++){var g=f[o],v=g[0]+u,y=g[1]+u,b=g[2]+u;n.push(v,y,b),s+=3}}this.setIndex(n),this.addAttribute("position",new nr(r,3)),this.addAttribute("normal",new nr(i,3)),this.addAttribute("uv",new nr(a,2))}function es(e,t){if(t.shapes=[],Array.isArray(e))for(var n=0,r=e.length;n<r;n++){var i=e[n];t.shapes.push(i.uuid)}else t.shapes.push(e.uuid);return t}function ts(e,t){sr.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:t},t=void 0!==t?t:1;var n,r,i,a,o=[],s=Math.cos(Gt.DEG2RAD*t),c=[0,0],l={},u=["a","b","c"];e.isBufferGeometry?(a=new Xn).fromBufferGeometry(e):a=e.clone(),a.mergeVertices(),a.computeFaceNormals();for(var h=a.vertices,p=a.faces,d=0,f=p.length;d<f;d++)for(var m=p[d],g=0;g<3;g++)n=m[u[g]],r=m[u[(g+1)%3]],c[0]=Math.min(n,r),c[1]=Math.max(n,r),void 0===l[i=c[0]+","+c[1]]?l[i]={index1:c[0],index2:c[1],face1:d,face2:void 0}:l[i].face2=d;for(i in l){var v=l[i];if(void 0===v.face2||p[v.face1].normal.dot(p[v.face2].normal)<=s){var y=h[v.index1];o.push(y.x,y.y,y.z),y=h[v.index2],o.push(y.x,y.y,y.z)}}this.addAttribute("position",new nr(o,3))}function ns(e,t,n,r,i,a,o,s){Xn.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:i,openEnded:a,thetaStart:o,thetaLength:s},this.fromBufferGeometry(new rs(e,t,n,r,i,a,o,s)),this.mergeVertices()}function rs(e,t,n,r,i,a,o,s){sr.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:i,openEnded:a,thetaStart:o,thetaLength:s};var c=this;e=void 0!==e?e:1,t=void 0!==t?t:1,n=n||1,r=Math.floor(r)||8,i=Math.floor(i)||1,a=void 0!==a&&a,o=void 0!==o?o:0,s=void 0!==s?s:2*Math.PI;var l=[],u=[],h=[],p=[],d=0,f=[],m=n/2,g=0;function v(n){var i,a,f,v=new Wt,y=new Xt,b=0,_=!0===n?e:t,w=!0===n?1:-1;for(a=d,i=1;i<=r;i++)u.push(0,m*w,0),h.push(0,w,0),p.push(.5,.5),d++;for(f=d,i=0;i<=r;i++){var x=i/r*s+o,E=Math.cos(x),M=Math.sin(x);y.x=_*M,y.y=m*w,y.z=_*E,u.push(y.x,y.y,y.z),h.push(0,w,0),v.x=.5*E+.5,v.y=.5*M*w+.5,p.push(v.x,v.y),d++}for(i=0;i<r;i++){var S=a+i,T=f+i;!0===n?l.push(T,T+1,S):l.push(T+1,T,S),b+=3}c.addGroup(g,b,!0===n?1:2),g+=b}!function(){var a,v,y=new Xt,b=new Xt,_=0,w=(t-e)/n;for(v=0;v<=i;v++){var x=[],E=v/i,M=E*(t-e)+e;for(a=0;a<=r;a++){var S=a/r,T=S*s+o,P=Math.sin(T),A=Math.cos(T);b.x=M*P,b.y=-E*n+m,b.z=M*A,u.push(b.x,b.y,b.z),y.set(P,w,A).normalize(),h.push(y.x,y.y,y.z),p.push(S,1-E),x.push(d++)}f.push(x)}for(a=0;a<r;a++)for(v=0;v<i;v++){var O=f[v][a],C=f[v+1][a],R=f[v+1][a+1],L=f[v][a+1];l.push(O,C,L),l.push(C,R,L),_+=6}c.addGroup(g,_,0),g+=_}(),!1===a&&(e>0&&v(!0),t>0&&v(!1)),this.setIndex(l),this.addAttribute("position",new nr(u,3)),this.addAttribute("normal",new nr(h,3)),this.addAttribute("uv",new nr(p,2))}function is(e,t,n,r,i,a,o){ns.call(this,0,e,t,n,r,i,a,o),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:a,thetaLength:o}}function as(e,t,n,r,i,a,o){rs.call(this,0,e,t,n,r,i,a,o),this.type="ConeBufferGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:a,thetaLength:o}}function os(e,t,n,r){Xn.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},this.fromBufferGeometry(new ss(e,t,n,r)),this.mergeVertices()}function ss(e,t,n,r){sr.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},e=e||1,t=void 0!==t?Math.max(3,t):8,n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI;var i,a,o=[],s=[],c=[],l=[],u=new Xt,h=new Wt;for(s.push(0,0,0),c.push(0,0,1),l.push(.5,.5),a=0,i=3;a<=t;a++,i+=3){var p=n+a/t*r;u.x=e*Math.cos(p),u.y=e*Math.sin(p),s.push(u.x,u.y,u.z),c.push(0,0,1),h.x=(s[i]/e+1)/2,h.y=(s[i+1]/e+1)/2,l.push(h.x,h.y)}for(i=1;i<=t;i++)o.push(i,i+1,0);this.setIndex(o),this.addAttribute("position",new nr(s,3)),this.addAttribute("normal",new nr(c,3)),this.addAttribute("uv",new nr(l,2))}Go.prototype=Object.create(Xn.prototype),Go.prototype.constructor=Go,Wo.prototype=Object.create(Uo.prototype),Wo.prototype.constructor=Wo,qo.prototype=Object.create(Xn.prototype),qo.prototype.constructor=qo,Xo.prototype=Object.create(sr.prototype),Xo.prototype.constructor=Xo,Yo.prototype=Object.create(Xn.prototype),Yo.prototype.constructor=Yo,Ko.prototype=Object.create(sr.prototype),Ko.prototype.constructor=Ko,$o.prototype=Object.create(Xn.prototype),$o.prototype.constructor=$o,Zo.prototype=Object.create(sr.prototype),Zo.prototype.constructor=Zo,Jo.prototype=Object.create(Xn.prototype),Jo.prototype.constructor=Jo,Jo.prototype.toJSON=function(){var e=Xn.prototype.toJSON.call(this);return es(this.parameters.shapes,e)},Qo.prototype=Object.create(sr.prototype),Qo.prototype.constructor=Qo,Qo.prototype.toJSON=function(){var e=sr.prototype.toJSON.call(this);return es(this.parameters.shapes,e)},ts.prototype=Object.create(sr.prototype),ts.prototype.constructor=ts,ns.prototype=Object.create(Xn.prototype),ns.prototype.constructor=ns,rs.prototype=Object.create(sr.prototype),rs.prototype.constructor=rs,is.prototype=Object.create(ns.prototype),is.prototype.constructor=is,as.prototype=Object.create(rs.prototype),as.prototype.constructor=as,os.prototype=Object.create(Xn.prototype),os.prototype.constructor=os,ss.prototype=Object.create(sr.prototype),ss.prototype.constructor=ss;var cs=Object.freeze({WireframeGeometry:Ka,ParametricGeometry:$a,ParametricBufferGeometry:Za,TetrahedronGeometry:eo,TetrahedronBufferGeometry:to,OctahedronGeometry:no,OctahedronBufferGeometry:ro,IcosahedronGeometry:io,IcosahedronBufferGeometry:ao,DodecahedronGeometry:oo,DodecahedronBufferGeometry:so,PolyhedronGeometry:Ja,PolyhedronBufferGeometry:Qa,TubeGeometry:co,TubeBufferGeometry:lo,TorusKnotGeometry:uo,TorusKnotBufferGeometry:ho,TorusGeometry:po,TorusBufferGeometry:fo,TextGeometry:Go,TextBufferGeometry:Wo,SphereGeometry:qo,SphereBufferGeometry:Xo,RingGeometry:Yo,RingBufferGeometry:Ko,PlaneGeometry:ur,PlaneBufferGeometry:hr,LatheGeometry:$o,LatheBufferGeometry:Zo,ShapeGeometry:Jo,ShapeBufferGeometry:Qo,ExtrudeGeometry:Fo,ExtrudeBufferGeometry:Uo,EdgesGeometry:ts,ConeGeometry:is,ConeBufferGeometry:as,CylinderGeometry:ns,CylinderBufferGeometry:rs,CircleGeometry:os,CircleBufferGeometry:ss,BoxGeometry:cr,BoxBufferGeometry:lr});function ls(e){dr.call(this),this.type="ShadowMaterial",this.color=new On(0),this.transparent=!0,this.setValues(e)}function us(e){Ar.call(this,e),this.type="RawShaderMaterial"}function hs(e){dr.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new On(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new On(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Vt,this.normalScale=new Wt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function ps(e){hs.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(e)}function ds(e){dr.call(this),this.type="MeshPhongMaterial",this.color=new On(16777215),this.specular=new On(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new On(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Vt,this.normalScale=new Wt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ie,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function fs(e){ds.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(e)}function ms(e){dr.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Vt,this.normalScale=new Wt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function gs(e){dr.call(this),this.type="MeshLambertMaterial",this.color=new On(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new On(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ie,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function vs(e){dr.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new On(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Vt,this.normalScale=new Wt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.lights=!1,this.setValues(e)}function ys(e){ja.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}ls.prototype=Object.create(dr.prototype),ls.prototype.constructor=ls,ls.prototype.isShadowMaterial=!0,ls.prototype.copy=function(e){return dr.prototype.copy.call(this,e),this.color.copy(e.color),this},us.prototype=Object.create(Ar.prototype),us.prototype.constructor=us,us.prototype.isRawShaderMaterial=!0,hs.prototype=Object.create(dr.prototype),hs.prototype.constructor=hs,hs.prototype.isMeshStandardMaterial=!0,hs.prototype.copy=function(e){return dr.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},ps.prototype=Object.create(hs.prototype),ps.prototype.constructor=ps,ps.prototype.isMeshPhysicalMaterial=!0,ps.prototype.copy=function(e){return hs.prototype.copy.call(this,e),this.defines={PHYSICAL:""},this.reflectivity=e.reflectivity,this.clearCoat=e.clearCoat,this.clearCoatRoughness=e.clearCoatRoughness,this},ds.prototype=Object.create(dr.prototype),ds.prototype.constructor=ds,ds.prototype.isMeshPhongMaterial=!0,ds.prototype.copy=function(e){return dr.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},fs.prototype=Object.create(ds.prototype),fs.prototype.constructor=fs,fs.prototype.isMeshToonMaterial=!0,fs.prototype.copy=function(e){return ds.prototype.copy.call(this,e),this.gradientMap=e.gradientMap,this},ms.prototype=Object.create(dr.prototype),ms.prototype.constructor=ms,ms.prototype.isMeshNormalMaterial=!0,ms.prototype.copy=function(e){return dr.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},gs.prototype=Object.create(dr.prototype),gs.prototype.constructor=gs,gs.prototype.isMeshLambertMaterial=!0,gs.prototype.copy=function(e){return dr.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},vs.prototype=Object.create(dr.prototype),vs.prototype.constructor=vs,vs.prototype.isMeshMatcapMaterial=!0,vs.prototype.copy=function(e){return dr.prototype.copy.call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},ys.prototype=Object.create(ja.prototype),ys.prototype.constructor=ys,ys.prototype.isLineDashedMaterial=!0,ys.prototype.copy=function(e){return ja.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var bs=Object.freeze({ShadowMaterial:ls,SpriteMaterial:Ia,RawShaderMaterial:us,ShaderMaterial:Ar,PointsMaterial:Ha,MeshPhysicalMaterial:ps,MeshStandardMaterial:hs,MeshPhongMaterial:ds,MeshToonMaterial:fs,MeshNormalMaterial:ms,MeshLambertMaterial:gs,MeshDepthMaterial:oa,MeshDistanceMaterial:sa,MeshBasicMaterial:Rr,MeshMatcapMaterial:vs,LineDashedMaterial:ys,LineBasicMaterial:ja,Material:dr}),_s={arraySlice:function(e,t,n){return _s.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)},convertArray:function(e,t,n){return!e||!n&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var t=e.length,n=new Array(t),r=0;r!==t;++r)n[r]=r;return n.sort(function(t,n){return e[t]-e[n]}),n},sortedArray:function(e,t,n){for(var r=e.length,i=new e.constructor(r),a=0,o=0;o!==r;++a)for(var s=n[a]*t,c=0;c!==t;++c)i[o++]=e[s+c];return i},flattenJSON:function(e,t,n,r){for(var i=1,a=e[0];void 0!==a&&void 0===a[r];)a=e[i++];if(void 0!==a){var o=a[r];if(void 0!==o)if(Array.isArray(o))do{void 0!==(o=a[r])&&(t.push(a.time),n.push.apply(n,o)),a=e[i++]}while(void 0!==a);else if(void 0!==o.toArray)do{void 0!==(o=a[r])&&(t.push(a.time),o.toArray(n,n.length)),a=e[i++]}while(void 0!==a);else do{void 0!==(o=a[r])&&(t.push(a.time),n.push(o)),a=e[i++]}while(void 0!==a)}}};function ws(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n}function xs(e,t,n,r){ws.call(this,e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function Es(e,t,n,r){ws.call(this,e,t,n,r)}function Ms(e,t,n,r){ws.call(this,e,t,n,r)}function Ss(e,t,n,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=_s.convertArray(t,this.TimeBufferType),this.values=_s.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}function Ts(e,t,n){Ss.call(this,e,t,n)}function Ps(e,t,n,r){Ss.call(this,e,t,n,r)}function As(e,t,n,r){Ss.call(this,e,t,n,r)}function Os(e,t,n,r){ws.call(this,e,t,n,r)}function Cs(e,t,n,r){Ss.call(this,e,t,n,r)}function Rs(e,t,n,r){Ss.call(this,e,t,n,r)}function Ls(e,t,n,r){Ss.call(this,e,t,n,r)}function Is(e,t,n){this.name=e,this.tracks=n,this.duration=void 0!==t?t:-1,this.uuid=Gt.generateUUID(),this.duration<0&&this.resetDuration()}function ks(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return As;case"vector":case"vector2":case"vector3":case"vector4":return Ls;case"color":return Ps;case"quaternion":return Cs;case"bool":case"boolean":return Ts;case"string":return Rs}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){var n=[],r=[];_s.flattenJSON(e.keys,n,r,"value"),e.times=n,e.values=r}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}Object.assign(ws.prototype,{evaluate:function(e){var t=this.parameterPositions,n=this._cachedIndex,r=t[n],i=t[n-1];e:{t:{var a;n:{r:if(!(e<r)){for(var o=n+2;;){if(void 0===r){if(e<i)break r;return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,e,i)}if(n===o)break;if(i=r,e<(r=t[++n]))break t}a=t.length;break n}if(e>=i)break e;var s=t[1];e<s&&(n=2,i=s);for(o=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(n===o)break;if(r=i,e>=(i=t[--n-1]))break t}a=n,n=0}for(;n<a;){var c=n+a>>>1;e<t[c]?a=c:n=c+1}if(r=t[n],void 0===(i=t[n-1]))return this._cachedIndex=0,this.beforeStart_(0,e,r);if(void 0===r)return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,i,e)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,e,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r,a=0;a!==r;++a)t[a]=n[i+a];return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),
//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(ws.prototype,{beforeStart_:ws.prototype.copySampleValue_,afterEnd_:ws.prototype.copySampleValue_}),xs.prototype=Object.assign(Object.create(ws.prototype),{constructor:xs,DefaultSettings_:{endingStart:Tt,endingEnd:Tt},intervalChanged_:function(e,t,n){var r=this.parameterPositions,i=e-2,a=e+1,o=r[i],s=r[a];if(void 0===o)switch(this.getSettings_().endingStart){case Pt:i=e,o=2*t-n;break;case At:o=t+r[i=r.length-2]-r[i+1];break;default:i=e,o=n}if(void 0===s)switch(this.getSettings_().endingEnd){case Pt:a=e,s=2*n-t;break;case At:a=1,s=n+r[1]-r[0];break;default:a=e-1,s=t}var c=.5*(n-t),l=this.valueSize;this._weightPrev=c/(t-o),this._weightNext=c/(s-n),this._offsetPrev=i*l,this._offsetNext=a*l},interpolate_:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,c=s-o,l=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,p=this._weightNext,d=(n-t)/(r-t),f=d*d,m=f*d,g=-h*m+2*h*f-h*d,v=(1+h)*m+(-1.5-2*h)*f+(-.5+h)*d+1,y=(-1-p)*m+(1.5+p)*f+.5*d,b=p*m-p*f,_=0;_!==o;++_)i[_]=g*a[l+_]+v*a[c+_]+y*a[s+_]+b*a[u+_];return i}}),Es.prototype=Object.assign(Object.create(ws.prototype),{constructor:Es,interpolate_:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,c=s-o,l=(n-t)/(r-t),u=1-l,h=0;h!==o;++h)i[h]=a[c+h]*u+a[s+h]*l;return i}}),Ms.prototype=Object.assign(Object.create(ws.prototype),{constructor:Ms,interpolate_:function(e){return this.copySampleValue_(e-1)}}),Object.assign(Ss,{toJSON:function(e){var t,n=e.constructor;if(void 0!==n.toJSON)t=n.toJSON(e);else{t={name:e.name,times:_s.convertArray(e.times,Array),values:_s.convertArray(e.values,Array)};var r=e.getInterpolation();r!==e.DefaultInterpolation&&(t.interpolation=r)}return t.type=e.ValueTypeName,t}}),Object.assign(Ss.prototype,{constructor:Ss,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:Mt,InterpolantFactoryMethodDiscrete:function(e){return new Ms(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new Es(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new xs(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var t;switch(e){case Et:t=this.InterpolantFactoryMethodDiscrete;break;case Mt:t=this.InterpolantFactoryMethodLinear;break;case St:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Et;case this.InterpolantFactoryMethodLinear:return Mt;case this.InterpolantFactoryMethodSmooth:return St}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(0!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]+=e;return this},scale:function(e){if(1!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]*=e;return this},trim:function(e,t){for(var n=this.times,r=n.length,i=0,a=r-1;i!==r&&n[i]<e;)++i;for(;-1!==a&&n[a]>t;)--a;if(++a,0!==i||a!==r){i>=a&&(i=(a=Math.max(a,1))-1);var o=this.getValueSize();this.times=_s.arraySlice(n,i,a),this.values=_s.arraySlice(this.values,i*o,a*o)}return this},validate:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var a=null,o=0;o!==i;o++){var s=n[o];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,s),e=!1;break}if(null!==a&&a>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,s,a),e=!1;break}a=s}if(void 0!==r&&_s.isTypedArray(r)){o=0;for(var c=r.length;o!==c;++o){var l=r[o];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,l),e=!1;break}}}return e},optimize:function(){for(var e=this.times,t=this.values,n=this.getValueSize(),r=this.getInterpolation()===St,i=1,a=e.length-1,o=1;o<a;++o){var s=!1,c=e[o];if(c!==e[o+1]&&(1!==o||c!==c[0]))if(r)s=!0;else for(var l=o*n,u=l-n,h=l+n,p=0;p!==n;++p){var d=t[l+p];if(d!==t[u+p]||d!==t[h+p]){s=!0;break}}if(s){if(o!==i){e[i]=e[o];var f=o*n,m=i*n;for(p=0;p!==n;++p)t[m+p]=t[f+p]}++i}}if(a>0){e[i]=e[a];for(f=a*n,m=i*n,p=0;p!==n;++p)t[m+p]=t[f+p];++i}return i!==e.length&&(this.times=_s.arraySlice(e,0,i),this.values=_s.arraySlice(t,0,i*n)),this},clone:function(){var e=_s.arraySlice(this.times,0),t=_s.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}),Ts.prototype=Object.assign(Object.create(Ss.prototype),{constructor:Ts,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:Et,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Ps.prototype=Object.assign(Object.create(Ss.prototype),{constructor:Ps,ValueTypeName:"color"}),As.prototype=Object.assign(Object.create(Ss.prototype),{constructor:As,ValueTypeName:"number"}),Os.prototype=Object.assign(Object.create(ws.prototype),{constructor:Os,interpolate_:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,c=(n-t)/(r-t),l=s+o;s!==l;s+=4)qt.slerpFlat(i,0,a,s-o,a,s,c);return i}}),Cs.prototype=Object.assign(Object.create(Ss.prototype),{constructor:Cs,ValueTypeName:"quaternion",DefaultInterpolation:Mt,InterpolantFactoryMethodLinear:function(e){return new Os(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),Rs.prototype=Object.assign(Object.create(Ss.prototype),{constructor:Rs,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:Et,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Ls.prototype=Object.assign(Object.create(Ss.prototype),{constructor:Ls,ValueTypeName:"vector"}),Object.assign(Is,{parse:function(e){for(var t=[],n=e.tracks,r=1/(e.fps||1),i=0,a=n.length;i!==a;++i)t.push(ks(n[i]).scale(r));return new Is(e.name,e.duration,t)},toJSON:function(e){for(var t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid},i=0,a=n.length;i!==a;++i)t.push(Ss.toJSON(n[i]));return r},CreateFromMorphTargetSequence:function(e,t,n,r){for(var i=t.length,a=[],o=0;o<i;o++){var s=[],c=[];s.push((o+i-1)%i,o,(o+1)%i),c.push(0,1,0);var l=_s.getKeyframeOrder(s);s=_s.sortedArray(s,1,l),c=_s.sortedArray(c,1,l),r||0!==s[0]||(s.push(i),c.push(c[0])),a.push(new As(".morphTargetInfluences["+t[o].name+"]",s,c).scale(1/n))}return new Is(e,-1,a)},findByName:function(e,t){var n=e;if(!Array.isArray(e)){var r=e;n=r.geometry&&r.geometry.animations||r.animations}for(var i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null},CreateClipsFromMorphTargetSequences:function(e,t,n){for(var r={},i=/^([\w-]*?)([\d]+)$/,a=0,o=e.length;a<o;a++){var s=e[a],c=s.name.match(i);if(c&&c.length>1){var l=r[h=c[1]];l||(r[h]=l=[]),l.push(s)}}var u=[];for(var h in r)u.push(Is.CreateFromMorphTargetSequence(h,r[h],t,n));return u},parseAnimation:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(e,t,n,r,i){if(0!==n.length){var a=[],o=[];_s.flattenJSON(n,a,o,r),0!==a.length&&i.push(new e(t,a,o))}},r=[],i=e.name||"default",a=e.length||-1,o=e.fps||30,s=e.hierarchy||[],c=0;c<s.length;c++){var l=s[c].keys;if(l&&0!==l.length)if(l[0].morphTargets){for(var u={},h=0;h<l.length;h++)if(l[h].morphTargets)for(var p=0;p<l[h].morphTargets.length;p++)u[l[h].morphTargets[p]]=-1;for(var d in u){var f=[],m=[];for(p=0;p!==l[h].morphTargets.length;++p){var g=l[h];f.push(g.time),m.push(g.morphTarget===d?1:0)}r.push(new As(".morphTargetInfluence["+d+"]",f,m))}a=u.length*(o||1)}else{var v=".bones["+t[c].name+"]";n(Ls,v+".position",l,"pos",r),n(Cs,v+".quaternion",l,"rot",r),n(Ls,v+".scale",l,"scl",r)}}return 0===r.length?null:new Is(i,a,r)}}),Object.assign(Is.prototype,{resetDuration:function(){for(var e=0,t=0,n=this.tracks.length;t!==n;++t){var r=this.tracks[t];e=Math.max(e,r.times[r.times.length-1])}return this.duration=e,this},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},validate:function(){for(var e=!0,t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this},clone:function(){for(var e=[],t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new Is(this.name,this.duration,e)}});var Ns={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function zs(e,t,n){var r=this,i=!1,a=0,o=0,s=void 0;this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){o++,!1===i&&void 0!==r.onStart&&r.onStart(e,a,o),i=!0},this.itemEnd=function(e){a++,void 0!==r.onProgress&&r.onProgress(e,a,o),a===o&&(i=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(e){void 0!==r.onError&&r.onError(e)},this.resolveURL=function(e){return s?s(e):e},this.setURLModifier=function(e){return s=e,this}}var Ds=new zs,Bs={};function js(e){this.manager=void 0!==e?e:Ds}function Fs(e){this.manager=void 0!==e?e:Ds}function Us(e){this.manager=void 0!==e?e:Ds,this._parser=null}function Vs(e){this.manager=void 0!==e?e:Ds,this._parser=null}function Hs(e){this.manager=void 0!==e?e:Ds}function Gs(e){this.manager=void 0!==e?e:Ds}function Ws(e){this.manager=void 0!==e?e:Ds}function qs(){this.type="Curve",this.arcLengthDivisions=200}function Xs(e,t,n,r,i,a,o,s){qs.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=t||0,this.xRadius=n||1,this.yRadius=r||1,this.aStartAngle=i||0,this.aEndAngle=a||2*Math.PI,this.aClockwise=o||!1,this.aRotation=s||0}function Ys(e,t,n,r,i,a){Xs.call(this,e,t,n,n,r,i,a),this.type="ArcCurve"}function Ks(){var e=0,t=0,n=0,r=0;function i(i,a,o,s){e=i,t=o,n=-3*i+3*a-2*o-s,r=2*i-2*a+o+s}return{initCatmullRom:function(e,t,n,r,a){i(t,n,a*(n-e),a*(r-t))},initNonuniformCatmullRom:function(e,t,n,r,a,o,s){var c=(t-e)/a-(n-e)/(a+o)+(n-t)/o,l=(n-t)/o-(r-t)/(o+s)+(r-n)/s;i(t,n,c*=o,l*=o)},calc:function(i){var a=i*i;return e+t*i+n*a+r*(a*i)}}}Object.assign(js.prototype,{load:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,a=Ns.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout(function(){t&&t(a),i.manager.itemEnd(e)},0),a;if(void 0===Bs[e]){var o=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(o){var s=o[1],c=!!o[2],l=o[3];l=decodeURIComponent(l),c&&(l=atob(l));try{var u,h=(this.responseType||"").toLowerCase();switch(h){case"arraybuffer":case"blob":for(var p=new Uint8Array(l.length),d=0;d<l.length;d++)p[d]=l.charCodeAt(d);u="blob"===h?new Blob([p.buffer],{type:s}):p.buffer;break;case"document":var f=new DOMParser;u=f.parseFromString(l,s);break;case"json":u=JSON.parse(l);break;default:u=l}setTimeout(function(){t&&t(u),i.manager.itemEnd(e)},0)}catch(t){setTimeout(function(){r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)},0)}}else{Bs[e]=[],Bs[e].push({onLoad:t,onProgress:n,onError:r});var m=new XMLHttpRequest;for(var g in m.open("GET",e,!0),m.addEventListener("load",function(t){var n=this.response;Ns.add(e,n);var r=Bs[e];if(delete Bs[e],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received.");for(var a=0,o=r.length;a<o;a++){(s=r[a]).onLoad&&s.onLoad(n)}i.manager.itemEnd(e)}else{for(a=0,o=r.length;a<o;a++){var s;(s=r[a]).onError&&s.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)}},!1),m.addEventListener("progress",function(t){for(var n=Bs[e],r=0,i=n.length;r<i;r++){var a=n[r];a.onProgress&&a.onProgress(t)}},!1),m.addEventListener("error",function(t){var n=Bs[e];delete Bs[e];for(var r=0,a=n.length;r<a;r++){var o=n[r];o.onError&&o.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)},!1),m.addEventListener("abort",function(t){var n=Bs[e];delete Bs[e];for(var r=0,a=n.length;r<a;r++){var o=n[r];o.onError&&o.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)},!1),void 0!==this.responseType&&(m.responseType=this.responseType),void 0!==this.withCredentials&&(m.withCredentials=this.withCredentials),m.overrideMimeType&&m.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)m.setRequestHeader(g,this.requestHeader[g]);m.send(null)}return i.manager.itemStart(e),m}Bs[e].push({onLoad:t,onProgress:n,onError:r})},setPath:function(e){return this.path=e,this},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}}),Object.assign(Fs.prototype,{load:function(e,t,n,r){var i=this,a=new js(i.manager);a.setPath(i.path),a.load(e,function(e){t(i.parse(JSON.parse(e)))},n,r)},parse:function(e){for(var t=[],n=0;n<e.length;n++){var r=Is.parse(e[n]);t.push(r)}return t},setPath:function(e){return this.path=e,this}}),Object.assign(Us.prototype,{load:function(e,t,n,r){var i=this,a=[],o=new qa;o.image=a;var s=new js(this.manager);function c(c){s.load(e[c],function(e){var n=i._parser(e,!0);a[c]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},6===(l+=1)&&(1===n.mipmapCount&&(o.minFilter=Pe),o.format=n.format,o.needsUpdate=!0,t&&t(o))},n,r)}if(s.setPath(this.path),s.setResponseType("arraybuffer"),Array.isArray(e))for(var l=0,u=0,h=e.length;u<h;++u)c(u);else s.load(e,function(e){var n=i._parser(e,!0);if(n.isCubemap)for(var r=n.mipmaps.length/n.mipmapCount,s=0;s<r;s++){a[s]={mipmaps:[]};for(var c=0;c<n.mipmapCount;c++)a[s].mipmaps.push(n.mipmaps[s*n.mipmapCount+c]),a[s].format=n.format,a[s].width=n.width,a[s].height=n.height}else o.image.width=n.width,o.image.height=n.height,o.mipmaps=n.mipmaps;1===n.mipmapCount&&(o.minFilter=Pe),o.format=n.format,o.needsUpdate=!0,t&&t(o)},n,r);return o},setPath:function(e){return this.path=e,this}}),Object.assign(Vs.prototype,{load:function(e,t,n,r){var i=this,a=new mn,o=new js(this.manager);return o.setResponseType("arraybuffer"),o.setPath(this.path),o.load(e,function(e){var n=i._parser(e);n&&(void 0!==n.image?a.image=n.image:void 0!==n.data&&(a.image.width=n.width,a.image.height=n.height,a.image.data=n.data),a.wrapS=void 0!==n.wrapS?n.wrapS:xe,a.wrapT=void 0!==n.wrapT?n.wrapT:xe,a.magFilter=void 0!==n.magFilter?n.magFilter:Pe,a.minFilter=void 0!==n.minFilter?n.minFilter:Oe,a.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.format&&(a.format=n.format),void 0!==n.type&&(a.type=n.type),void 0!==n.mipmaps&&(a.mipmaps=n.mipmaps),1===n.mipmapCount&&(a.minFilter=Pe),a.needsUpdate=!0,t&&t(a,n))},n,r),a},setPath:function(e){return this.path=e,this}}),Object.assign(Hs.prototype,{crossOrigin:"anonymous",load:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,a=Ns.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout(function(){t&&t(a),i.manager.itemEnd(e)},0),a;var o=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){o.removeEventListener("load",s,!1),o.removeEventListener("error",c,!1),Ns.add(e,this),t&&t(this),i.manager.itemEnd(e)}function c(t){o.removeEventListener("load",s,!1),o.removeEventListener("error",c,!1),r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}return o.addEventListener("load",s,!1),o.addEventListener("error",c,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),i.manager.itemStart(e),o.src=e,o},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(Gs.prototype,{crossOrigin:"anonymous",load:function(e,t,n,r){var i=new Gr,a=new Hs(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);var o=0;function s(n){a.load(e[n],function(e){i.images[n]=e,6===++o&&(i.needsUpdate=!0,t&&t(i))},void 0,r)}for(var c=0;c<e.length;++c)s(c);return i},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(Ws.prototype,{crossOrigin:"anonymous",load:function(e,t,n,r){var i=new un,a=new Hs(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(n){i.image=n;var r=e.search(/\.jpe?g($|\?)/i)>0||0===e.search(/^data\:image\/jpeg/);i.format=r?He:Ge,i.needsUpdate=!0,void 0!==t&&t(i)},n,r),i},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(qs.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){var n=this.getUtoTmapping(e);return this.getPoint(n,t)},getPoints:function(e){void 0===e&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return t},getSpacedPoints:function(e){void 0===e&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,n,r=[],i=this.getPoint(0),a=0;for(r.push(0),n=1;n<=e;n++)a+=(t=this.getPoint(n/e)).distanceTo(i),r.push(a),i=t;return this.cacheArcLengths=r,r},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){var n,r=this.getLengths(),i=0,a=r.length;n=t||e*r[a-1];for(var o,s=0,c=a-1;s<=c;)if((o=r[i=Math.floor(s+(c-s)/2)]-n)<0)s=i+1;else{if(!(o>0)){c=i;break}c=i-1}if(r[i=c]===n)return i/(a-1);var l=r[i];return(i+(n-l)/(r[i+1]-l))/(a-1)},getTangent:function(e){var t=e-1e-4,n=e+1e-4;t<0&&(t=0),n>1&&(n=1);var r=this.getPoint(t);return this.getPoint(n).clone().sub(r).normalize()},getTangentAt:function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)},computeFrenetFrames:function(e,t){var n,r,i,a=new Xt,o=[],s=[],c=[],l=new Xt,u=new _n;for(n=0;n<=e;n++)r=n/e,o[n]=this.getTangentAt(r),o[n].normalize();s[0]=new Xt,c[0]=new Xt;var h=Number.MAX_VALUE,p=Math.abs(o[0].x),d=Math.abs(o[0].y),f=Math.abs(o[0].z);for(p<=h&&(h=p,a.set(1,0,0)),d<=h&&(h=d,a.set(0,1,0)),f<=h&&a.set(0,0,1),l.crossVectors(o[0],a).normalize(),s[0].crossVectors(o[0],l),c[0].crossVectors(o[0],s[0]),n=1;n<=e;n++)s[n]=s[n-1].clone(),c[n]=c[n-1].clone(),l.crossVectors(o[n-1],o[n]),l.length()>Number.EPSILON&&(l.normalize(),i=Math.acos(Gt.clamp(o[n-1].dot(o[n]),-1,1)),s[n].applyMatrix4(u.makeRotationAxis(l,i))),c[n].crossVectors(o[n],s[n]);if(!0===t)for(i=Math.acos(Gt.clamp(s[0].dot(s[e]),-1,1)),i/=e,o[0].dot(l.crossVectors(s[0],s[e]))>0&&(i=-i),n=1;n<=e;n++)s[n].applyMatrix4(u.makeRotationAxis(o[n],i*n)),c[n].crossVectors(o[n],s[n]);return{tangents:o,normals:s,binormals:c}},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}),Xs.prototype=Object.create(qs.prototype),Xs.prototype.constructor=Xs,Xs.prototype.isEllipseCurve=!0,Xs.prototype.getPoint=function(e,t){for(var n=t||new Wt,r=2*Math.PI,i=this.aEndAngle-this.aStartAngle,a=Math.abs(i)<Number.EPSILON;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=a?0:r),!0!==this.aClockwise||a||(i===r?i=-r:i-=r);var o=this.aStartAngle+e*i,s=this.aX+this.xRadius*Math.cos(o),c=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){var l=Math.cos(this.aRotation),u=Math.sin(this.aRotation),h=s-this.aX,p=c-this.aY;s=h*l-p*u+this.aX,c=h*u+p*l+this.aY}return n.set(s,c)},Xs.prototype.copy=function(e){return qs.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},Xs.prototype.toJSON=function(){var e=qs.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},Xs.prototype.fromJSON=function(e){return qs.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},Ys.prototype=Object.create(Xs.prototype),Ys.prototype.constructor=Ys,Ys.prototype.isArcCurve=!0;var $s=new Xt,Zs=new Ks,Js=new Ks,Qs=new Ks;function ec(e,t,n,r){qs.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=t||!1,this.curveType=n||"centripetal",this.tension=r||.5}function tc(e,t,n,r,i){var a=.5*(r-t),o=.5*(i-n),s=e*e;return(2*n-2*r+a+o)*(e*s)+(-3*n+3*r-2*a-o)*s+a*e+n}function nc(e,t,n,r){return function(e,t){var n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,r)}function rc(e,t,n,r,i){return function(e,t){var n=1-e;return n*n*n*t}(e,t)+function(e,t){var n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,r)+function(e,t){return e*e*e*t}(e,i)}function ic(e,t,n,r){qs.call(this),this.type="CubicBezierCurve",this.v0=e||new Wt,this.v1=t||new Wt,this.v2=n||new Wt,this.v3=r||new Wt}function ac(e,t,n,r){qs.call(this),this.type="CubicBezierCurve3",this.v0=e||new Xt,this.v1=t||new Xt,this.v2=n||new Xt,this.v3=r||new Xt}function oc(e,t){qs.call(this),this.type="LineCurve",this.v1=e||new Wt,this.v2=t||new Wt}function sc(e,t){qs.call(this),this.type="LineCurve3",this.v1=e||new Xt,this.v2=t||new Xt}function cc(e,t,n){qs.call(this),this.type="QuadraticBezierCurve",this.v0=e||new Wt,this.v1=t||new Wt,this.v2=n||new Wt}function lc(e,t,n){qs.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new Xt,this.v1=t||new Xt,this.v2=n||new Xt}function uc(e){qs.call(this),this.type="SplineCurve",this.points=e||[]}ec.prototype=Object.create(qs.prototype),ec.prototype.constructor=ec,ec.prototype.isCatmullRomCurve3=!0,ec.prototype.getPoint=function(e,t){var n,r,i,a,o=t||new Xt,s=this.points,c=s.length,l=(c-(this.closed?0:1))*e,u=Math.floor(l),h=l-u;if(this.closed?u+=u>0?0:(Math.floor(Math.abs(u)/c)+1)*c:0===h&&u===c-1&&(u=c-2,h=1),this.closed||u>0?n=s[(u-1)%c]:($s.subVectors(s[0],s[1]).add(s[0]),n=$s),r=s[u%c],i=s[(u+1)%c],this.closed||u+2<c?a=s[(u+2)%c]:($s.subVectors(s[c-1],s[c-2]).add(s[c-1]),a=$s),"centripetal"===this.curveType||"chordal"===this.curveType){var p="chordal"===this.curveType?.5:.25,d=Math.pow(n.distanceToSquared(r),p),f=Math.pow(r.distanceToSquared(i),p),m=Math.pow(i.distanceToSquared(a),p);f<1e-4&&(f=1),d<1e-4&&(d=f),m<1e-4&&(m=f),Zs.initNonuniformCatmullRom(n.x,r.x,i.x,a.x,d,f,m),Js.initNonuniformCatmullRom(n.y,r.y,i.y,a.y,d,f,m),Qs.initNonuniformCatmullRom(n.z,r.z,i.z,a.z,d,f,m)}else"catmullrom"===this.curveType&&(Zs.initCatmullRom(n.x,r.x,i.x,a.x,this.tension),Js.initCatmullRom(n.y,r.y,i.y,a.y,this.tension),Qs.initCatmullRom(n.z,r.z,i.z,a.z,this.tension));return o.set(Zs.calc(h),Js.calc(h),Qs.calc(h)),o},ec.prototype.copy=function(e){qs.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},ec.prototype.toJSON=function(){var e=qs.prototype.toJSON.call(this);e.points=[];for(var t=0,n=this.points.length;t<n;t++){var r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},ec.prototype.fromJSON=function(e){qs.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push((new Xt).fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},ic.prototype=Object.create(qs.prototype),ic.prototype.constructor=ic,ic.prototype.isCubicBezierCurve=!0,ic.prototype.getPoint=function(e,t){var n=t||new Wt,r=this.v0,i=this.v1,a=this.v2,o=this.v3;return n.set(rc(e,r.x,i.x,a.x,o.x),rc(e,r.y,i.y,a.y,o.y)),n},ic.prototype.copy=function(e){return qs.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},ic.prototype.toJSON=function(){var e=qs.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},ic.prototype.fromJSON=function(e){return qs.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},ac.prototype=Object.create(qs.prototype),ac.prototype.constructor=ac,ac.prototype.isCubicBezierCurve3=!0,ac.prototype.getPoint=function(e,t){var n=t||new Xt,r=this.v0,i=this.v1,a=this.v2,o=this.v3;return n.set(rc(e,r.x,i.x,a.x,o.x),rc(e,r.y,i.y,a.y,o.y),rc(e,r.z,i.z,a.z,o.z)),n},ac.prototype.copy=function(e){return qs.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},ac.prototype.toJSON=function(){var e=qs.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},ac.prototype.fromJSON=function(e){return qs.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},oc.prototype=Object.create(qs.prototype),oc.prototype.constructor=oc,oc.prototype.isLineCurve=!0,oc.prototype.getPoint=function(e,t){var n=t||new Wt;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},oc.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},oc.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},oc.prototype.copy=function(e){return qs.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},oc.prototype.toJSON=function(){var e=qs.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},oc.prototype.fromJSON=function(e){return qs.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},sc.prototype=Object.create(qs.prototype),sc.prototype.constructor=sc,sc.prototype.isLineCurve3=!0,sc.prototype.getPoint=function(e,t){var n=t||new Xt;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},sc.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},sc.prototype.copy=function(e){return qs.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},sc.prototype.toJSON=function(){var e=qs.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},sc.prototype.fromJSON=function(e){return qs.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},cc.prototype=Object.create(qs.prototype),cc.prototype.constructor=cc,cc.prototype.isQuadraticBezierCurve=!0,cc.prototype.getPoint=function(e,t){var n=t||new Wt,r=this.v0,i=this.v1,a=this.v2;return n.set(nc(e,r.x,i.x,a.x),nc(e,r.y,i.y,a.y)),n},cc.prototype.copy=function(e){return qs.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},cc.prototype.toJSON=function(){var e=qs.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},cc.prototype.fromJSON=function(e){return qs.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},lc.prototype=Object.create(qs.prototype),lc.prototype.constructor=lc,lc.prototype.isQuadraticBezierCurve3=!0,lc.prototype.getPoint=function(e,t){var n=t||new Xt,r=this.v0,i=this.v1,a=this.v2;return n.set(nc(e,r.x,i.x,a.x),nc(e,r.y,i.y,a.y),nc(e,r.z,i.z,a.z)),n},lc.prototype.copy=function(e){return qs.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},lc.prototype.toJSON=function(){var e=qs.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},lc.prototype.fromJSON=function(e){return qs.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},uc.prototype=Object.create(qs.prototype),uc.prototype.constructor=uc,uc.prototype.isSplineCurve=!0,uc.prototype.getPoint=function(e,t){var n=t||new Wt,r=this.points,i=(r.length-1)*e,a=Math.floor(i),o=i-a,s=r[0===a?a:a-1],c=r[a],l=r[a>r.length-2?r.length-1:a+1],u=r[a>r.length-3?r.length-1:a+2];return n.set(tc(o,s.x,c.x,l.x,u.x),tc(o,s.y,c.y,l.y,u.y)),n},uc.prototype.copy=function(e){qs.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push(r.clone())}return this},uc.prototype.toJSON=function(){var e=qs.prototype.toJSON.call(this);e.points=[];for(var t=0,n=this.points.length;t<n;t++){var r=this.points[t];e.points.push(r.toArray())}return e},uc.prototype.fromJSON=function(e){qs.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push((new Wt).fromArray(r))}return this};var hc=Object.freeze({ArcCurve:Ys,CatmullRomCurve3:ec,CubicBezierCurve:ic,CubicBezierCurve3:ac,EllipseCurve:Xs,LineCurve:oc,LineCurve3:sc,QuadraticBezierCurve:cc,QuadraticBezierCurve3:lc,SplineCurve:uc});function pc(){qs.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function dc(e){pc.call(this),this.type="Path",this.currentPoint=new Wt,e&&this.setFromPoints(e)}function fc(e){dc.call(this,e),this.uuid=Gt.generateUUID(),this.type="Shape",this.holes=[]}function mc(e,t){Hn.call(this),this.type="Light",this.color=new On(e),this.intensity=void 0!==t?t:1,this.receiveShadow=void 0}function gc(e,t,n){mc.call(this,e,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(Hn.DefaultUp),this.updateMatrix(),this.groundColor=new On(t)}function vc(e){this.camera=e,this.bias=0,this.radius=1,this.mapSize=new Wt(512,512),this.map=null,this.matrix=new _n}function yc(){vc.call(this,new fa(50,1,.5,500))}function bc(e,t,n,r,i,a){mc.call(this,e,t),this.type="SpotLight",this.position.copy(Hn.DefaultUp),this.updateMatrix(),this.target=new Hn,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==r?r:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==a?a:1,this.shadow=new yc}function _c(e,t,n,r){mc.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==r?r:1,this.shadow=new vc(new fa(90,1,.5,500))}function wc(e,t,n,r,i,a){da.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==e?e:-1,this.right=void 0!==t?t:1,this.top=void 0!==n?n:1,this.bottom=void 0!==r?r:-1,this.near=void 0!==i?i:.1,this.far=void 0!==a?a:2e3,this.updateProjectionMatrix()}function xc(){vc.call(this,new wc(-5,5,5,-5,.5,500))}function Ec(e,t){mc.call(this,e,t),this.type="DirectionalLight",this.position.copy(Hn.DefaultUp),this.updateMatrix(),this.target=new Hn,this.shadow=new xc}function Mc(e,t){mc.call(this,e,t),this.type="AmbientLight",this.castShadow=void 0}function Sc(e,t,n,r){mc.call(this,e,t),this.type="RectAreaLight",this.width=void 0!==n?n:10,this.height=void 0!==r?r:10}function Tc(e){this.manager=void 0!==e?e:Ds,this.textures={}}pc.prototype=Object.assign(Object.create(qs.prototype),{constructor:pc,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new oc(t,e))},getPoint:function(e){for(var t=e*this.getLength(),n=this.getCurveLengths(),r=0;r<n.length;){if(n[r]>=t){var i=n[r]-t,a=this.curves[r],o=a.getLength(),s=0===o?0:1-i/o;return a.getPointAt(s)}r++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e},getSpacedPoints:function(e){void 0===e&&(e=40);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(e){e=e||12;for(var t,n=[],r=0,i=this.curves;r<i.length;r++)for(var a=i[r],o=a&&a.isEllipseCurve?2*e:a&&(a.isLineCurve||a.isLineCurve3)?1:a&&a.isSplineCurve?e*a.points.length:e,s=a.getPoints(o),c=0;c<s.length;c++){var l=s[c];t&&t.equals(l)||(n.push(l),t=l)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},copy:function(e){qs.prototype.copy.call(this,e),this.curves=[];for(var t=0,n=e.curves.length;t<n;t++){var r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this},toJSON:function(){var e=qs.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(var t=0,n=this.curves.length;t<n;t++){var r=this.curves[t];e.curves.push(r.toJSON())}return e},fromJSON:function(e){qs.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var t=0,n=e.curves.length;t<n;t++){var r=e.curves[t];this.curves.push((new hc[r.type]).fromJSON(r))}return this}}),dc.prototype=Object.assign(Object.create(pc.prototype),{constructor:dc,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y)},moveTo:function(e,t){this.currentPoint.set(e,t)},lineTo:function(e,t){var n=new oc(this.currentPoint.clone(),new Wt(e,t));this.curves.push(n),this.currentPoint.set(e,t)},quadraticCurveTo:function(e,t,n,r){var i=new cc(this.currentPoint.clone(),new Wt(e,t),new Wt(n,r));this.curves.push(i),this.currentPoint.set(n,r)},bezierCurveTo:function(e,t,n,r,i,a){var o=new ic(this.currentPoint.clone(),new Wt(e,t),new Wt(n,r),new Wt(i,a));this.curves.push(o),this.currentPoint.set(i,a)},splineThru:function(e){var t=new uc([this.currentPoint.clone()].concat(e));this.curves.push(t),this.currentPoint.copy(e[e.length-1])},arc:function(e,t,n,r,i,a){var o=this.currentPoint.x,s=this.currentPoint.y;this.absarc(e+o,t+s,n,r,i,a)},absarc:function(e,t,n,r,i,a){this.absellipse(e,t,n,n,r,i,a)},ellipse:function(e,t,n,r,i,a,o,s){var c=this.currentPoint.x,l=this.currentPoint.y;this.absellipse(e+c,t+l,n,r,i,a,o,s)},absellipse:function(e,t,n,r,i,a,o,s){var c=new Xs(e,t,n,r,i,a,o,s);if(this.curves.length>0){var l=c.getPoint(0);l.equals(this.currentPoint)||this.lineTo(l.x,l.y)}this.curves.push(c);var u=c.getPoint(1);this.currentPoint.copy(u)},copy:function(e){return pc.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){var e=pc.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return pc.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}),fc.prototype=Object.assign(Object.create(dc.prototype),{constructor:fc,getPointsHoles:function(e){for(var t=[],n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){dc.prototype.copy.call(this,e),this.holes=[];for(var t=0,n=e.holes.length;t<n;t++){var r=e.holes[t];this.holes.push(r.clone())}return this},toJSON:function(){var e=dc.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(var t=0,n=this.holes.length;t<n;t++){var r=this.holes[t];e.holes.push(r.toJSON())}return e},fromJSON:function(e){dc.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(var t=0,n=e.holes.length;t<n;t++){var r=e.holes[t];this.holes.push((new dc).fromJSON(r))}return this}}),mc.prototype=Object.assign(Object.create(Hn.prototype),{constructor:mc,isLight:!0,copy:function(e){return Hn.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){var t=Hn.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),gc.prototype=Object.assign(Object.create(mc.prototype),{constructor:gc,isHemisphereLight:!0,copy:function(e){return mc.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),Object.assign(vc.prototype,{copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),yc.prototype=Object.assign(Object.create(vc.prototype),{constructor:yc,isSpotLightShadow:!0,update:function(e){var t=this.camera,n=2*Gt.RAD2DEG*e.angle,r=this.mapSize.width/this.mapSize.height,i=e.distance||t.far;n===t.fov&&r===t.aspect&&i===t.far||(t.fov=n,t.aspect=r,t.far=i,t.updateProjectionMatrix())}}),bc.prototype=Object.assign(Object.create(mc.prototype),{constructor:bc,isSpotLight:!0,copy:function(e){return mc.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),_c.prototype=Object.assign(Object.create(mc.prototype),{constructor:_c,isPointLight:!0,copy:function(e){return mc.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),wc.prototype=Object.assign(Object.create(da.prototype),{constructor:wc,isOrthographicCamera:!0,copy:function(e,t){return da.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this},setViewOffset:function(e,t,n,r,i,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,i=n-e,a=n+e,o=r+t,s=r-t;if(null!==this.view&&this.view.enabled){var c=this.zoom/(this.view.width/this.view.fullWidth),l=this.zoom/(this.view.height/this.view.fullHeight),u=(this.right-this.left)/this.view.width,h=(this.top-this.bottom)/this.view.height;a=(i+=u*(this.view.offsetX/c))+u*(this.view.width/c),s=(o-=h*(this.view.offsetY/l))-h*(this.view.height/l)}this.projectionMatrix.makeOrthographic(i,a,o,s,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=Hn.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}),xc.prototype=Object.assign(Object.create(vc.prototype),{constructor:xc}),Ec.prototype=Object.assign(Object.create(mc.prototype),{constructor:Ec,isDirectionalLight:!0,copy:function(e){return mc.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),Mc.prototype=Object.assign(Object.create(mc.prototype),{constructor:Mc,isAmbientLight:!0}),Sc.prototype=Object.assign(Object.create(mc.prototype),{constructor:Sc,isRectAreaLight:!0,copy:function(e){return mc.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){var t=mc.prototype.toJSON.call(this,e);return t.object.width=this.width,t.object.height=this.height,t}}),Object.assign(Tc.prototype,{load:function(e,t,n,r){var i=this,a=new js(i.manager);a.setPath(i.path),a.load(e,function(e){t(i.parse(JSON.parse(e)))},n,r)},parse:function(e){var t=this.textures;function n(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}var r=new bs[e.type];if(void 0!==e.uuid&&(r.uuid=e.uuid),void 0!==e.name&&(r.name=e.name),void 0!==e.color&&r.color.setHex(e.color),void 0!==e.roughness&&(r.roughness=e.roughness),void 0!==e.metalness&&(r.metalness=e.metalness),void 0!==e.emissive&&r.emissive.setHex(e.emissive),void 0!==e.specular&&r.specular.setHex(e.specular),void 0!==e.shininess&&(r.shininess=e.shininess),void 0!==e.clearCoat&&(r.clearCoat=e.clearCoat),void 0!==e.clearCoatRoughness&&(r.clearCoatRoughness=e.clearCoatRoughness),void 0!==e.vertexColors&&(r.vertexColors=e.vertexColors),void 0!==e.fog&&(r.fog=e.fog),void 0!==e.flatShading&&(r.flatShading=e.flatShading),void 0!==e.blending&&(r.blending=e.blending),void 0!==e.combine&&(r.combine=e.combine),void 0!==e.side&&(r.side=e.side),void 0!==e.opacity&&(r.opacity=e.opacity),void 0!==e.transparent&&(r.transparent=e.transparent),void 0!==e.alphaTest&&(r.alphaTest=e.alphaTest),void 0!==e.depthTest&&(r.depthTest=e.depthTest),void 0!==e.depthWrite&&(r.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(r.colorWrite=e.colorWrite),void 0!==e.wireframe&&(r.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(r.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(r.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(r.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(r.rotation=e.rotation),1!==e.linewidth&&(r.linewidth=e.linewidth),void 0!==e.dashSize&&(r.dashSize=e.dashSize),void 0!==e.gapSize&&(r.gapSize=e.gapSize),void 0!==e.scale&&(r.scale=e.scale),void 0!==e.polygonOffset&&(r.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(r.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(r.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.skinning&&(r.skinning=e.skinning),void 0!==e.morphTargets&&(r.morphTargets=e.morphTargets),void 0!==e.dithering&&(r.dithering=e.dithering),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.uniforms)for(var i in e.uniforms){var a=e.uniforms[i];switch(r.uniforms[i]={},a.type){case"t":r.uniforms[i].value=n(a.value);break;case"c":r.uniforms[i].value=(new On).setHex(a.value);break;case"v2":r.uniforms[i].value=(new Wt).fromArray(a.value);break;case"v3":r.uniforms[i].value=(new Xt).fromArray(a.value);break;case"v4":r.uniforms[i].value=(new hn).fromArray(a.value);break;case"m3":r.uniforms[i].value=(new Yt).fromArray(a.value);case"m4":r.uniforms[i].value=(new _n).fromArray(a.value);break;default:r.uniforms[i].value=a.value}}if(void 0!==e.defines&&(r.defines=e.defines),void 0!==e.vertexShader&&(r.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(r.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(var o in e.extensions)r.extensions[o]=e.extensions[o];if(void 0!==e.shading&&(r.flatShading=1===e.shading),void 0!==e.size&&(r.size=e.size),void 0!==e.sizeAttenuation&&(r.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(r.map=n(e.map)),void 0!==e.alphaMap&&(r.alphaMap=n(e.alphaMap),r.transparent=!0),void 0!==e.bumpMap&&(r.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(r.bumpScale=e.bumpScale),void 0!==e.normalMap&&(r.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(r.normalMapType=e.normalMapType),void 0!==e.normalScale){var s=e.normalScale;!1===Array.isArray(s)&&(s=[s,s]),r.normalScale=(new Wt).fromArray(s)}return void 0!==e.displacementMap&&(r.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(r.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(r.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(r.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(r.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(r.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(r.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(r.specularMap=n(e.specularMap)),void 0!==e.envMap&&(r.envMap=n(e.envMap)),void 0!==e.envMapIntensity&&(r.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(r.reflectivity=e.reflectivity),void 0!==e.lightMap&&(r.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(r.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(r.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(r.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(r.gradientMap=n(e.gradientMap)),r},setPath:function(e){return this.path=e,this},setTextures:function(e){return this.textures=e,this}});var Pc={decodeText:function(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);for(var t="",n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);return decodeURIComponent(escape(t))},extractUrlBase:function(e){var t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)}};function Ac(e){this.manager=void 0!==e?e:Ds}Object.assign(Ac.prototype,{load:function(e,t,n,r){var i=this,a=new js(i.manager);a.setPath(i.path),a.load(e,function(e){t(i.parse(JSON.parse(e)))},n,r)},parse:function(e){var t=new sr,n=e.data.index;if(void 0!==n){var r=new Oc[n.type](n.array);t.setIndex(new Yn(r,1))}var i=e.data.attributes;for(var a in i){var o=i[a],s=new Yn(r=new Oc[o.type](o.array),o.itemSize,o.normalized);void 0!==o.name&&(s.name=o.name),t.addAttribute(a,s)}var c=e.data.morphAttributes;if(c)for(var a in c){for(var l=c[a],u=[],h=0,p=l.length;h<p;h++){o=l[h],s=new Yn(r=new Oc[o.type](o.array),o.itemSize,o.normalized);void 0!==o.name&&(s.name=o.name),u.push(s)}t.morphAttributes[a]=u}var d=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==d){h=0;for(var f=d.length;h!==f;++h){var m=d[h];t.addGroup(m.start,m.count,m.materialIndex)}}var g=e.data.boundingSphere;if(void 0!==g){var v=new Xt;void 0!==g.center&&v.fromArray(g.center),t.boundingSphere=new vn(v,g.radius)}return e.name&&(t.name=e.name),e.userData&&(t.userData=e.userData),t},setPath:function(e){return this.path=e,this}});var Oc={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function Cc(e){this.manager=void 0!==e?e:Ds,this.resourcePath=""}Object.assign(Cc.prototype,{crossOrigin:"anonymous",load:function(e,t,n,r){var i=this,a=void 0===this.path?Pc.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;var o=new js(i.manager);o.setPath(this.path),o.load(e,function(n){var a=null;try{a=JSON.parse(n)}catch(t){return void 0!==r&&r(t),void console.error("THREE:ObjectLoader: Can't parse "+e+".",t.message)}var o=a.metadata;void 0!==o&&void 0!==o.type&&"geometry"!==o.type.toLowerCase()?i.parse(a,t):console.error("THREE.ObjectLoader: Can't load "+e)},n,r)},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setCrossOrigin:function(e){return this.crossOrigin=e,this},parse:function(e,t){var n=this.parseShape(e.shapes),r=this.parseGeometries(e.geometries,n),i=this.parseImages(e.images,function(){void 0!==t&&t(s)}),a=this.parseTextures(e.textures,i),o=this.parseMaterials(e.materials,a),s=this.parseObject(e.object,r,o);return e.animations&&(s.animations=this.parseAnimations(e.animations)),void 0!==e.images&&0!==e.images.length||void 0!==t&&t(s),s},parseShape:function(e){var t={};if(void 0!==e)for(var n=0,r=e.length;n<r;n++){var i=(new fc).fromJSON(e[n]);t[i.uuid]=i}return t},parseGeometries:function(e,t){var n={};if(void 0!==e)for(var r=new Ac,i=0,a=e.length;i<a;i++){var o,s=e[i];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":o=new cs[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":o=new cs[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":o=new cs[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":o=new cs[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":o=new cs[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":o=new cs[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":o=new cs[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":o=new cs[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":o=new cs[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":o=new cs[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"TubeGeometry":case"TubeBufferGeometry":o=new cs[s.type]((new hc[s.path.type]).fromJSON(s.path),s.tubularSegments,s.radius,s.radialSegments,s.closed);break;case"LatheGeometry":case"LatheBufferGeometry":o=new cs[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":o=new cs[s.type](s.vertices,s.indices,s.radius,s.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var c=[],l=0,u=s.shapes.length;l<u;l++){var h=t[s.shapes[l]];c.push(h)}o=new cs[s.type](c,s.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(c=[],l=0,u=s.shapes.length;l<u;l++){h=t[s.shapes[l]];c.push(h)}var p=s.options.extrudePath;void 0!==p&&(s.options.extrudePath=(new hc[p.type]).fromJSON(p)),o=new cs[s.type](c,s.options);break;case"BufferGeometry":o=r.parse(s);break;case"Geometry":if("THREE"in window&&"LegacyJSONLoader"in THREE)o=(new THREE.LegacyJSONLoader).parse(s,this.resourcePath).geometry;else console.error('THREE.ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}o.uuid=s.uuid,void 0!==s.name&&(o.name=s.name),!0===o.isBufferGeometry&&void 0!==s.userData&&(o.userData=s.userData),n[s.uuid]=o}return n},parseMaterials:function(e,t){var n={},r={};if(void 0!==e){var i=new Tc;i.setTextures(t);for(var a=0,o=e.length;a<o;a++){var s=e[a];if("MultiMaterial"===s.type){for(var c=[],l=0;l<s.materials.length;l++){var u=s.materials[l];void 0===n[u.uuid]&&(n[u.uuid]=i.parse(u)),c.push(n[u.uuid])}r[s.uuid]=c}else void 0===n[s.uuid]&&(n[s.uuid]=i.parse(s)),r[s.uuid]=n[s.uuid]}}return r},parseAnimations:function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n],i=Is.parse(r);void 0!==r.uuid&&(i.uuid=r.uuid),t.push(i)}return t},parseImages:function(e,t){var n=this,r={};function i(e){return n.manager.itemStart(e),a.load(e,function(){n.manager.itemEnd(e)},void 0,function(){n.manager.itemError(e),n.manager.itemEnd(e)})}if(void 0!==e&&e.length>0){var a=new Hs(new zs(t));a.setCrossOrigin(this.crossOrigin);for(var o=0,s=e.length;o<s;o++){var c=e[o],l=c.url;if(Array.isArray(l)){r[c.uuid]=[];for(var u=0,h=l.length;u<h;u++){var p=l[u],d=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(p)?p:n.resourcePath+p;r[c.uuid].push(i(d))}}else{d=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c.url)?c.url:n.resourcePath+c.url;r[c.uuid]=i(d)}}}return r},parseTextures:function(e,t){function n(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var r={};if(void 0!==e)for(var i=0,a=e.length;i<a;i++){var o,s=e[i];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===t[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image),(o=Array.isArray(t[s.image])?new Gr(t[s.image]):new un(t[s.image])).needsUpdate=!0,o.uuid=s.uuid,void 0!==s.name&&(o.name=s.name),void 0!==s.mapping&&(o.mapping=n(s.mapping,zc)),void 0!==s.offset&&o.offset.fromArray(s.offset),void 0!==s.repeat&&o.repeat.fromArray(s.repeat),void 0!==s.center&&o.center.fromArray(s.center),void 0!==s.rotation&&(o.rotation=s.rotation),void 0!==s.wrap&&(o.wrapS=n(s.wrap[0],Dc),o.wrapT=n(s.wrap[1],Dc)),void 0!==s.format&&(o.format=s.format),void 0!==s.type&&(o.type=s.type),void 0!==s.encoding&&(o.encoding=s.encoding),void 0!==s.minFilter&&(o.minFilter=n(s.minFilter,Bc)),void 0!==s.magFilter&&(o.magFilter=n(s.magFilter,Bc)),void 0!==s.anisotropy&&(o.anisotropy=s.anisotropy),void 0!==s.flipY&&(o.flipY=s.flipY),void 0!==s.premultiplyAlpha&&(o.premultiplyAlpha=s.premultiplyAlpha),void 0!==s.unpackAlignment&&(o.unpackAlignment=s.unpackAlignment),r[s.uuid]=o}return r},parseObject:function(e,t,n){var r;function i(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function a(e){if(void 0!==e){if(Array.isArray(e)){for(var t=[],r=0,i=e.length;r<i;r++){var a=e[r];void 0===n[a]&&console.warn("THREE.ObjectLoader: Undefined material",a),t.push(n[a])}return t}return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),n[e]}}switch(e.type){case"Scene":r=new Ca,void 0!==e.background&&Number.isInteger(e.background)&&(r.background=new On(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?r.fog=new Oa(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(r.fog=new Aa(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":r=new fa(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(r.focus=e.focus),void 0!==e.zoom&&(r.zoom=e.zoom),void 0!==e.filmGauge&&(r.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(r.filmOffset=e.filmOffset),void 0!==e.view&&(r.view=Object.assign({},e.view));break;case"OrthographicCamera":r=new wc(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(r.zoom=e.zoom),void 0!==e.view&&(r.view=Object.assign({},e.view));break;case"AmbientLight":r=new Mc(e.color,e.intensity);break;case"DirectionalLight":r=new Ec(e.color,e.intensity);break;case"PointLight":r=new _c(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":r=new Sc(e.color,e.intensity,e.width,e.height);break;case"SpotLight":r=new bc(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":r=new gc(e.color,e.groundColor,e.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var o=i(e.geometry),s=a(e.material);r=o.bones&&o.bones.length>0?new za(o,s):new Lr(o,s),void 0!==e.drawMode&&r.setDrawMode(e.drawMode);break;case"LOD":r=new Na;break;case"Line":r=new Fa(i(e.geometry),a(e.material),e.mode);break;case"LineLoop":r=new Va(i(e.geometry),a(e.material));break;case"LineSegments":r=new Ua(i(e.geometry),a(e.material));break;case"PointCloud":case"Points":r=new Ga(i(e.geometry),a(e.material));break;case"Sprite":r=new ka(a(e.material));break;case"Group":r=new pa;break;default:r=new Hn}if(r.uuid=e.uuid,void 0!==e.name&&(r.name=e.name),void 0!==e.matrix?(r.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(r.matrixAutoUpdate=e.matrixAutoUpdate),r.matrixAutoUpdate&&r.matrix.decompose(r.position,r.quaternion,r.scale)):(void 0!==e.position&&r.position.fromArray(e.position),void 0!==e.rotation&&r.rotation.fromArray(e.rotation),void 0!==e.quaternion&&r.quaternion.fromArray(e.quaternion),void 0!==e.scale&&r.scale.fromArray(e.scale)),void 0!==e.castShadow&&(r.castShadow=e.castShadow),void 0!==e.receiveShadow&&(r.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(r.shadow.bias=e.shadow.bias),void 0!==e.shadow.radius&&(r.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&r.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(r.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.frustumCulled&&(r.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(r.renderOrder=e.renderOrder),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.layers&&(r.layers.mask=e.layers),void 0!==e.children)for(var c=e.children,l=0;l<c.length;l++)r.add(this.parseObject(c[l],t,n));if("LOD"===e.type)for(var u=e.levels,h=0;h<u.length;h++){var p=u[h],d=r.getObjectByProperty("uuid",p.object);void 0!==d&&r.addLevel(d,p.distance)}return r}});var Rc,Lc,Ic,kc,Nc,zc={UVMapping:de,CubeReflectionMapping:fe,CubeRefractionMapping:me,EquirectangularReflectionMapping:ge,EquirectangularRefractionMapping:ve,SphericalReflectionMapping:ye,CubeUVReflectionMapping:be,CubeUVRefractionMapping:_e},Dc={RepeatWrapping:we,ClampToEdgeWrapping:xe,MirroredRepeatWrapping:Ee},Bc={NearestFilter:Me,NearestMipMapNearestFilter:Se,NearestMipMapLinearFilter:Te,LinearFilter:Pe,LinearMipMapNearestFilter:Ae,LinearMipMapLinearFilter:Oe};function jc(e){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.manager=void 0!==e?e:Ds,this.options=void 0}function Fc(){this.type="ShapePath",this.color=new On,this.subPaths=[],this.currentPath=null}function Uc(e){this.type="Font",this.data=e}function Vc(e,t,n,r,i){var a=i.glyphs[e]||i.glyphs["?"];if(a){var o,s,c,l,u,h,p,d,f=new Fc;if(a.o)for(var m=a._cachedOutline||(a._cachedOutline=a.o.split(" ")),g=0,v=m.length;g<v;){switch(m[g++]){case"m":o=m[g++]*t+n,s=m[g++]*t+r,f.moveTo(o,s);break;case"l":o=m[g++]*t+n,s=m[g++]*t+r,f.lineTo(o,s);break;case"q":c=m[g++]*t+n,l=m[g++]*t+r,u=m[g++]*t+n,h=m[g++]*t+r,f.quadraticCurveTo(u,h,c,l);break;case"b":c=m[g++]*t+n,l=m[g++]*t+r,u=m[g++]*t+n,h=m[g++]*t+r,p=m[g++]*t+n,d=m[g++]*t+r,f.bezierCurveTo(u,h,p,d,c,l)}}return{offsetX:a.ha*t,path:f}}}function Hc(e){this.manager=void 0!==e?e:Ds}function Gc(){}jc.prototype={constructor:jc,setOptions:function(e){return this.options=e,this},load:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,a=Ns.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout(function(){t&&t(a),i.manager.itemEnd(e)},0),a;fetch(e).then(function(e){return e.blob()}).then(function(e){return void 0===i.options?createImageBitmap(e):createImageBitmap(e,i.options)}).then(function(n){Ns.add(e,n),t&&t(n),i.manager.itemEnd(e)}).catch(function(t){r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}),i.manager.itemStart(e)},setCrossOrigin:function(){return this},setPath:function(e){return this.path=e,this}},Object.assign(Fc.prototype,{moveTo:function(e,t){this.currentPath=new dc,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t)},lineTo:function(e,t){this.currentPath.lineTo(e,t)},quadraticCurveTo:function(e,t,n,r){this.currentPath.quadraticCurveTo(e,t,n,r)},bezierCurveTo:function(e,t,n,r,i,a){this.currentPath.bezierCurveTo(e,t,n,r,i,a)},splineThru:function(e){this.currentPath.splineThru(e)},toShapes:function(e,t){function n(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n],a=new fc;a.curves=i.curves,t.push(a)}return t}function r(e,t){for(var n=t.length,r=!1,i=n-1,a=0;a<n;i=a++){var o=t[i],s=t[a],c=s.x-o.x,l=s.y-o.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(o=t[a],c=-c,s=t[i],l=-l),e.y<o.y||e.y>s.y)continue;if(e.y===o.y){if(e.x===o.x)return!0}else{var u=l*(e.x-o.x)-c*(e.y-o.y);if(0===u)return!0;if(u<0)continue;r=!r}}else{if(e.y!==o.y)continue;if(s.x<=e.x&&e.x<=o.x||o.x<=e.x&&e.x<=s.x)return!0}}return r}var i=Do.isClockWise,a=this.subPaths;if(0===a.length)return[];if(!0===t)return n(a);var o,s,c,l=[];if(1===a.length)return s=a[0],(c=new fc).curves=s.curves,l.push(c),l;var u=!i(a[0].getPoints());u=e?!u:u;var h,p,d=[],f=[],m=[],g=0;f[g]=void 0,m[g]=[];for(var v=0,y=a.length;v<y;v++)o=i(h=(s=a[v]).getPoints()),(o=e?!o:o)?(!u&&f[g]&&g++,f[g]={s:new fc,p:h},f[g].s.curves=s.curves,u&&g++,m[g]=[]):m[g].push({h:s,p:h[0]});if(!f[0])return n(a);if(f.length>1){for(var b=!1,_=[],w=0,x=f.length;w<x;w++)d[w]=[];for(w=0,x=f.length;w<x;w++)for(var E=m[w],M=0;M<E.length;M++){for(var S=E[M],T=!0,P=0;P<f.length;P++)r(S.p,f[P].p)&&(w!==P&&_.push({froms:w,tos:P,hole:M}),T?(T=!1,d[P].push(S)):b=!0);T&&d[w].push(S)}_.length>0&&(b||(m=d))}v=0;for(var A=f.length;v<A;v++){c=f[v].s,l.push(c);for(var O=0,C=(p=m[v]).length;O<C;O++)c.holes.push(p[O].h)}return l}}),Object.assign(Uc.prototype,{isFont:!0,generateShapes:function(e,t){void 0===t&&(t=100);for(var n=[],r=function(e,t,n){for(var r=Array.from?Array.from(e):String(e).split(""),i=t/n.resolution,a=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*i,o=[],s=0,c=0,l=0;l<r.length;l++){var u=r[l];if("\n"===u)s=0,c-=a;else{var h=Vc(u,i,s,c,n);s+=h.offsetX,o.push(h.path)}}return o}(e,t,this.data),i=0,a=r.length;i<a;i++)Array.prototype.push.apply(n,r[i].toShapes());return n}}),Object.assign(Hc.prototype,{load:function(e,t,n,r){var i=this,a=new js(this.manager);a.setPath(this.path),a.load(e,function(e){var n;try{n=JSON.parse(e)}catch(t){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(e.substring(65,e.length-2))}var r=i.parse(n);t&&t(r)},n,r)},parse:function(e){return new Uc(e)},setPath:function(e){return this.path=e,this}}),Gc.Handlers={handlers:[],add:function(e,t){this.handlers.push(e,t)},get:function(e){for(var t=this.handlers,n=0,r=t.length;n<r;n+=2){var i=t[n],a=t[n+1];if(i.test(e))return a}return null}},Object.assign(Gc.prototype,{crossOrigin:"anonymous",onLoadStart:function(){},onLoadProgress:function(){},onLoadComplete:function(){},initMaterials:function(e,t,n){for(var r=[],i=0;i<e.length;++i)r[i]=this.createMaterial(e[i],t,n);return r},createMaterial:(Rc={NoBlending:A,NormalBlending:O,AdditiveBlending:C,SubtractiveBlending:R,MultiplyBlending:L,CustomBlending:I},Lc=new On,Ic=new Ws,kc=new Tc,function(e,t,n){var r={};function i(e,i,a,o,s){var c,l=t+e,u=Gc.Handlers.get(l);null!==u?c=u.load(l):(Ic.setCrossOrigin(n),c=Ic.load(l)),void 0!==i&&(c.repeat.fromArray(i),1!==i[0]&&(c.wrapS=we),1!==i[1]&&(c.wrapT=we)),void 0!==a&&c.offset.fromArray(a),void 0!==o&&("repeat"===o[0]&&(c.wrapS=we),"mirror"===o[0]&&(c.wrapS=Ee),"repeat"===o[1]&&(c.wrapT=we),"mirror"===o[1]&&(c.wrapT=Ee)),void 0!==s&&(c.anisotropy=s);var h=Gt.generateUUID();return r[h]=c,h}var a={uuid:Gt.generateUUID(),type:"MeshLambertMaterial"};for(var o in e){var s=e[o];switch(o){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":a.name=s;break;case"blending":a.blending=Rc[s];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",o,"is no longer supported.");break;case"colorDiffuse":a.color=Lc.fromArray(s).getHex();break;case"colorSpecular":a.specular=Lc.fromArray(s).getHex();break;case"colorEmissive":a.emissive=Lc.fromArray(s).getHex();break;case"specularCoef":a.shininess=s;break;case"shading":"basic"===s.toLowerCase()&&(a.type="MeshBasicMaterial"),"phong"===s.toLowerCase()&&(a.type="MeshPhongMaterial"),"standard"===s.toLowerCase()&&(a.type="MeshStandardMaterial");break;case"mapDiffuse":a.map=i(s,e.mapDiffuseRepeat,e.mapDiffuseOffset,e.mapDiffuseWrap,e.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":a.emissiveMap=i(s,e.mapEmissiveRepeat,e.mapEmissiveOffset,e.mapEmissiveWrap,e.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":a.lightMap=i(s,e.mapLightRepeat,e.mapLightOffset,e.mapLightWrap,e.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":a.aoMap=i(s,e.mapAORepeat,e.mapAOOffset,e.mapAOWrap,e.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":a.bumpMap=i(s,e.mapBumpRepeat,e.mapBumpOffset,e.mapBumpWrap,e.mapBumpAnisotropy);break;case"mapBumpScale":a.bumpScale=s;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":a.normalMap=i(s,e.mapNormalRepeat,e.mapNormalOffset,e.mapNormalWrap,e.mapNormalAnisotropy);break;case"mapNormalFactor":a.normalScale=s;break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":a.specularMap=i(s,e.mapSpecularRepeat,e.mapSpecularOffset,e.mapSpecularWrap,e.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":a.metalnessMap=i(s,e.mapMetalnessRepeat,e.mapMetalnessOffset,e.mapMetalnessWrap,e.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":a.roughnessMap=i(s,e.mapRoughnessRepeat,e.mapRoughnessOffset,e.mapRoughnessWrap,e.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":a.alphaMap=i(s,e.mapAlphaRepeat,e.mapAlphaOffset,e.mapAlphaWrap,e.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":a.side=w;break;case"doubleSided":a.side=x;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),a.opacity=s;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":a[o]=s;break;case"vertexColors":!0===s&&(a.vertexColors=P),"face"===s&&(a.vertexColors=T);break;default:console.error("THREE.Loader.createMaterial: Unsupported",o,s)}}return"MeshBasicMaterial"===a.type&&delete a.emissive,"MeshPhongMaterial"!==a.type&&delete a.specular,a.opacity<1&&(a.transparent=!0),kc.setTextures(r),kc.parse(a)})});var Wc,qc,Xc,Yc,Kc,$c,Zc,Jc,Qc,el,tl={getContext:function(){return void 0===Nc&&(Nc=new(window.AudioContext||window.webkitAudioContext)),Nc},setContext:function(e){Nc=e}};function nl(e){this.manager=void 0!==e?e:Ds}function rl(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new fa,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new fa,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function il(e,t,n,r){Hn.call(this),this.type="CubeCamera";var i=new fa(90,1,e,t);i.up.set(0,-1,0),i.lookAt(new Xt(1,0,0)),this.add(i);var a=new fa(90,1,e,t);a.up.set(0,-1,0),a.lookAt(new Xt(-1,0,0)),this.add(a);var o=new fa(90,1,e,t);o.up.set(0,0,1),o.lookAt(new Xt(0,1,0)),this.add(o);var s=new fa(90,1,e,t);s.up.set(0,0,-1),s.lookAt(new Xt(0,-1,0)),this.add(s);var c=new fa(90,1,e,t);c.up.set(0,-1,0),c.lookAt(new Xt(0,0,1)),this.add(c);var l=new fa(90,1,e,t);l.up.set(0,-1,0),l.lookAt(new Xt(0,0,-1)),this.add(l),r=r||{format:He,magFilter:Pe,minFilter:Pe},this.renderTarget=new fn(n,n,r),this.renderTarget.texture.name="CubeCamera",this.update=function(e,t){null===this.parent&&this.updateMatrixWorld();var n=e.getRenderTarget(),r=this.renderTarget,u=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0),e.render(t,i),e.setRenderTarget(r,1),e.render(t,a),e.setRenderTarget(r,2),e.render(t,o),e.setRenderTarget(r,3),e.render(t,s),e.setRenderTarget(r,4),e.render(t,c),r.texture.generateMipmaps=u,e.setRenderTarget(r,5),e.render(t,l),e.setRenderTarget(n)},this.clear=function(e,t,n,r){for(var i=e.getRenderTarget(),a=this.renderTarget,o=0;o<6;o++)e.setRenderTarget(a,o),e.clear(t,n,r);e.setRenderTarget(i)}}function al(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function ol(){Hn.call(this),this.type="AudioListener",this.context=tl.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0}function sl(e){Hn.call(this),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.startTime=0,this.offset=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function cl(e){sl.call(this,e),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function ll(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=void 0!==t?t:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}function ul(e,t,n){this.binding=e,this.valueSize=n;var r,i=Float64Array;switch(t){case"quaternion":r=this._slerp;break;case"string":case"bool":i=Array,r=this._select;break;default:r=this._lerp}this.buffer=new i(4*n),this._mixBufferRegion=r,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}Object.assign(nl.prototype,{load:function(e,t,n,r){var i=new js(this.manager);i.setResponseType("arraybuffer"),i.setPath(this.path),i.load(e,function(e){var n=e.slice(0);tl.getContext().decodeAudioData(n,function(e){t(e)})},n,r)},setPath:function(e){return this.path=e,this}}),Object.assign(rl.prototype,{update:(Qc=new _n,el=new _n,function(e){if(Wc!==this||qc!==e.focus||Xc!==e.fov||Yc!==e.aspect*this.aspect||Kc!==e.near||$c!==e.far||Zc!==e.zoom||Jc!==this.eyeSep){Wc=this,qc=e.focus,Xc=e.fov,Yc=e.aspect*this.aspect,Kc=e.near,$c=e.far,Zc=e.zoom;var t,n,r=e.projectionMatrix.clone(),i=(Jc=this.eyeSep/2)*Kc/qc,a=Kc*Math.tan(Gt.DEG2RAD*Xc*.5)/Zc;el.elements[12]=-Jc,Qc.elements[12]=Jc,t=-a*Yc+i,n=a*Yc+i,r.elements[0]=2*Kc/(n-t),r.elements[8]=(n+t)/(n-t),this.cameraL.projectionMatrix.copy(r),t=-a*Yc-i,n=a*Yc-i,r.elements[0]=2*Kc/(n-t),r.elements[8]=(n+t)/(n-t),this.cameraR.projectionMatrix.copy(r)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(el),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(Qc)})}),il.prototype=Object.create(Hn.prototype),il.prototype.constructor=il,Object.assign(al.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=("undefined"==typeof performance?Date:performance).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}),ol.prototype=Object.assign(Object.create(Hn.prototype),{constructor:ol,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this},updateMatrixWorld:function(){var e=new Xt,t=new qt,n=new Xt,r=new Xt,i=new al;return function(a){Hn.prototype.updateMatrixWorld.call(this,a);var o=this.context.listener,s=this.up;if(this.timeDelta=i.getDelta(),this.matrixWorld.decompose(e,t,n),r.set(0,0,-1).applyQuaternion(t),o.positionX){var c=this.context.currentTime+this.timeDelta;o.positionX.linearRampToValueAtTime(e.x,c),o.positionY.linearRampToValueAtTime(e.y,c),o.positionZ.linearRampToValueAtTime(e.z,c),o.forwardX.linearRampToValueAtTime(r.x,c),o.forwardY.linearRampToValueAtTime(r.y,c),o.forwardZ.linearRampToValueAtTime(r.z,c),o.upX.linearRampToValueAtTime(s.x,c),o.upY.linearRampToValueAtTime(s.y,c),o.upZ.linearRampToValueAtTime(s.z,c)}else o.setPosition(e.x,e.y,e.z),o.setOrientation(r.x,r.y,r.z,s.x,s.y,s.z)}}()}),sl.prototype=Object.assign(Object.create(Hn.prototype),{constructor:sl,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setMediaElementSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){var e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.onended=this.onEnded.bind(this),this.startTime=this.context.currentTime,e.start(this.startTime,this.offset),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this.source.stop(),this.source.onended=null,this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.source.onended=null,this.offset=0,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e||(e=[]),!0===this.isPlaying?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},setDetune:function(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}),cl.prototype=Object.assign(Object.create(sl.prototype),{constructor:cl,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){return this.panner.refDistance=e,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){return this.panner.rolloffFactor=e,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){return this.panner.distanceModel=e,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){return this.panner.maxDistance=e,this},setDirectionalCone:function(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this},updateMatrixWorld:function(){var e=new Xt,t=new qt,n=new Xt,r=new Xt;return function(i){if(Hn.prototype.updateMatrixWorld.call(this,i),!0!==this.hasPlaybackControl||!1!==this.isPlaying){this.matrixWorld.decompose(e,t,n),r.set(0,0,1).applyQuaternion(t);var a=this.panner;if(a.positionX){var o=this.context.currentTime+this.listener.timeDelta;a.positionX.linearRampToValueAtTime(e.x,o),a.positionY.linearRampToValueAtTime(e.y,o),a.positionZ.linearRampToValueAtTime(e.z,o),a.orientationX.linearRampToValueAtTime(r.x,o),a.orientationY.linearRampToValueAtTime(r.y,o),a.orientationZ.linearRampToValueAtTime(r.z,o)}else a.setPosition(e.x,e.y,e.z),a.setOrientation(r.x,r.y,r.z)}}}()}),Object.assign(ll.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var e=0,t=this.getFrequencyData(),n=0;n<t.length;n++)e+=t[n];return e/t.length}}),Object.assign(ul.prototype,{accumulate:function(e,t){var n=this.buffer,r=this.valueSize,i=e*r+r,a=this.cumulativeWeight;if(0===a){for(var o=0;o!==r;++o)n[i+o]=n[o];a=t}else{var s=t/(a+=t);this._mixBufferRegion(n,i,0,s,r)}this.cumulativeWeight=a},apply:function(e){var t=this.valueSize,n=this.buffer,r=e*t+t,i=this.cumulativeWeight,a=this.binding;if(this.cumulativeWeight=0,i<1){var o=3*t;this._mixBufferRegion(n,r,o,1-i,t)}for(var s=t,c=t+t;s!==c;++s)if(n[s]!==n[s+t]){a.setValue(n,r);break}},saveOriginalState:function(){var e=this.binding,t=this.buffer,n=this.valueSize,r=3*n;e.getValue(t,r);for(var i=n,a=r;i!==a;++i)t[i]=t[r+i%n];this.cumulativeWeight=0},restoreOriginalState:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)},_select:function(e,t,n,r,i){if(r>=.5)for(var a=0;a!==i;++a)e[t+a]=e[n+a]},_slerp:function(e,t,n,r){qt.slerpFlat(e,t,e,t,e,n,r)},_lerp:function(e,t,n,r,i){for(var a=1-r,o=0;o!==i;++o){var s=t+o;e[s]=e[s]*a+e[n+o]*r}}});var hl,pl,dl,fl,ml,gl,vl,yl,bl,_l,wl,xl,El,Ml,Sl;function Tl(e,t,n){var r=n||Pl.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}function Pl(e,t,n){this.path=t,this.parsedPath=n||Pl.parseTrackName(t),this.node=Pl.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function Al(){this.uuid=Gt.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var t=0,n=arguments.length;t!==n;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}}function Ol(e,t,n){this._mixer=e,this._clip=t,this._localRoot=n||null;for(var r=t.tracks,i=r.length,a=new Array(i),o={endingStart:Tt,endingEnd:Tt},s=0;s!==i;++s){var c=r[s].createInterpolant(null);a[s]=c,c.settings=o}this._interpolantSettings=o,this._interpolants=a,this._propertyBindings=new Array(i),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=wt,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function Cl(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function Rl(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}function Ll(){sr.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function Il(e,t,n){Ra.call(this,e,t),this.meshPerAttribute=n||1}function kl(e,t,n,r){"number"==typeof n&&(r=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),Yn.call(this,e,t,n),this.meshPerAttribute=r||1}function Nl(e,t,n,r){this.ray=new Or(e,t),this.near=n||0,this.far=r||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function zl(e,t){return e.distance-t.distance}function Dl(e,t,n,r){if(!1!==e.visible&&(e.raycast(t,n),!0===r))for(var i=e.children,a=0,o=i.length;a<o;a++)Dl(i[a],t,n,!0)}function Bl(e,t,n){return this.radius=void 0!==e?e:1,this.phi=void 0!==t?t:0,this.theta=void 0!==n?n:0,this}function jl(e,t,n){return this.radius=void 0!==e?e:1,this.theta=void 0!==t?t:0,this.y=void 0!==n?n:0,this}function Fl(e,t){this.min=void 0!==e?e:new Wt(1/0,1/0),this.max=void 0!==t?t:new Wt(-1/0,-1/0)}function Ul(e,t){this.start=void 0!==e?e:new Xt,this.end=void 0!==t?t:new Xt}function Vl(e){Hn.call(this),this.material=e,this.render=function(){}}function Hl(e,t,n,r){this.object=e,this.size=void 0!==t?t:1;var i=void 0!==n?n:16711680,a=void 0!==r?r:1,o=0,s=this.object.geometry;s&&s.isGeometry?o=3*s.faces.length:s&&s.isBufferGeometry&&(o=s.attributes.normal.count);var c=new sr,l=new nr(2*o*3,3);c.addAttribute("position",l),Ua.call(this,c,new ja({color:i,linewidth:a})),this.matrixAutoUpdate=!1,this.update()}function Gl(e,t){Hn.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;for(var n=new sr,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],i=0,a=1;i<32;i++,a++){var o=i/32*Math.PI*2,s=a/32*Math.PI*2;r.push(Math.cos(o),Math.sin(o),1,Math.cos(s),Math.sin(s),1)}n.addAttribute("position",new nr(r,3));var c=new ja({fog:!1});this.cone=new Ua(n,c),this.add(this.cone),this.update()}function Wl(e){for(var t=function e(t){var n=[];t&&t.isBone&&n.push(t);for(var r=0;r<t.children.length;r++)n.push.apply(n,e(t.children[r]));return n}(e),n=new sr,r=[],i=[],a=new On(0,0,1),o=new On(0,1,0),s=0;s<t.length;s++){var c=t[s];c.parent&&c.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(a.r,a.g,a.b),i.push(o.r,o.g,o.b))}n.addAttribute("position",new nr(r,3)),n.addAttribute("color",new nr(i,3));var l=new ja({vertexColors:P,depthTest:!1,depthWrite:!1,transparent:!0});Ua.call(this,n,l),this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}function ql(e,t,n){this.light=e,this.light.updateMatrixWorld(),this.color=n;var r=new Xo(t,4,2),i=new Rr({wireframe:!0,fog:!1});Lr.call(this,r,i),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function Xl(e,t){this.type="RectAreaLightHelper",this.light=e,this.color=t;var n=new sr;n.addAttribute("position",new nr([1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),n.computeBoundingSphere();var r=new ja({fog:!1});Fa.call(this,n,r);var i=new sr;i.addAttribute("position",new nr([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),i.computeBoundingSphere(),this.add(new Lr(i,new Rr({side:w,fog:!1}))),this.update()}function Yl(e,t,n){Hn.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;var r=new ro(t);r.rotateY(.5*Math.PI),this.material=new Rr({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=P);var i=r.getAttribute("position"),a=new Float32Array(3*i.count);r.addAttribute("color",new Yn(a,3)),this.add(new Lr(r,this.material)),this.update()}function Kl(e,t,n,r){e=e||10,t=t||10,n=new On(void 0!==n?n:4473924),r=new On(void 0!==r?r:8947848);for(var i=t/2,a=e/t,o=e/2,s=[],c=[],l=0,u=0,h=-o;l<=t;l++,h+=a){s.push(-o,0,h,o,0,h),s.push(h,0,-o,h,0,o);var p=l===i?n:r;p.toArray(c,u),u+=3,p.toArray(c,u),u+=3,p.toArray(c,u),u+=3,p.toArray(c,u),u+=3}var d=new sr;d.addAttribute("position",new nr(s,3)),d.addAttribute("color",new nr(c,3));var f=new ja({vertexColors:P});Ua.call(this,d,f)}function $l(e,t,n,r,i,a){e=e||10,t=t||16,n=n||8,r=r||64,i=new On(void 0!==i?i:4473924),a=new On(void 0!==a?a:8947848);var o,s,c,l,u,h,p,d=[],f=[];for(l=0;l<=t;l++)c=l/t*(2*Math.PI),o=Math.sin(c)*e,s=Math.cos(c)*e,d.push(0,0,0),d.push(o,0,s),p=1&l?i:a,f.push(p.r,p.g,p.b),f.push(p.r,p.g,p.b);for(l=0;l<=n;l++)for(p=1&l?i:a,h=e-e/n*l,u=0;u<r;u++)c=u/r*(2*Math.PI),o=Math.sin(c)*h,s=Math.cos(c)*h,d.push(o,0,s),f.push(p.r,p.g,p.b),c=(u+1)/r*(2*Math.PI),o=Math.sin(c)*h,s=Math.cos(c)*h,d.push(o,0,s),f.push(p.r,p.g,p.b);var m=new sr;m.addAttribute("position",new nr(d,3)),m.addAttribute("color",new nr(f,3));var g=new ja({vertexColors:P});Ua.call(this,m,g)}function Zl(e,t,n,r){this.audio=e,this.range=t||1,this.divisionsInnerAngle=n||16,this.divisionsOuterAngle=r||2;var i=new sr,a=this.divisionsInnerAngle+2*this.divisionsOuterAngle,o=new Float32Array(3*(3*a+3));i.addAttribute("position",new Yn(o,3));var s=new ja({color:65280}),c=new ja({color:16776960});Fa.call(this,i,[c,s]),this.update()}function Jl(e,t,n,r){this.object=e,this.size=void 0!==t?t:1;var i=void 0!==n?n:16776960,a=void 0!==r?r:1,o=0,s=this.object.geometry;s&&s.isGeometry?o=s.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var c=new sr,l=new nr(2*o*3,3);c.addAttribute("position",l),Ua.call(this,c,new ja({color:i,linewidth:a})),this.matrixAutoUpdate=!1,this.update()}function Ql(e,t,n){Hn.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===t&&(t=1);var r=new sr;r.addAttribute("position",new nr([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));var i=new ja({fog:!1});this.lightPlane=new Fa(r,i),this.add(this.lightPlane),(r=new sr).addAttribute("position",new nr([0,0,0,0,0,1],3)),this.targetLine=new Fa(r,i),this.add(this.targetLine),this.update()}function eu(e){var t=new sr,n=new ja({color:16777215,vertexColors:T}),r=[],i=[],a={},o=new On(16755200),s=new On(16711680),c=new On(43775),l=new On(16777215),u=new On(3355443);function h(e,t,n){p(e,n),p(t,n)}function p(e,t){r.push(0,0,0),i.push(t.r,t.g,t.b),void 0===a[e]&&(a[e]=[]),a[e].push(r.length/3-1)}h("n1","n2",o),h("n2","n4",o),h("n4","n3",o),h("n3","n1",o),h("f1","f2",o),h("f2","f4",o),h("f4","f3",o),h("f3","f1",o),h("n1","f1",o),h("n2","f2",o),h("n3","f3",o),h("n4","f4",o),h("p","n1",s),h("p","n2",s),h("p","n3",s),h("p","n4",s),h("u1","u2",c),h("u2","u3",c),h("u3","u1",c),h("c","t",l),h("p","c",u),h("cn1","cn2",u),h("cn3","cn4",u),h("cf1","cf2",u),h("cf3","cf4",u),t.addAttribute("position",new nr(r,3)),t.addAttribute("color",new nr(i,3)),Ua.call(this,t,n),this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update()}function tu(e,t){this.object=e,void 0===t&&(t=16776960);var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),i=new sr;i.setIndex(new Yn(n,1)),i.addAttribute("position",new Yn(r,3)),Ua.call(this,i,new ja({color:t})),this.matrixAutoUpdate=!1,this.update()}function nu(e,t){this.type="Box3Helper",this.box=e;var n=void 0!==t?t:16776960,r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new sr;i.setIndex(new Yn(r,1)),i.addAttribute("position",new nr([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),Ua.call(this,i,new ja({color:n})),this.geometry.computeBoundingSphere()}function ru(e,t,n){this.type="PlaneHelper",this.plane=e,this.size=void 0===t?1:t;var r=void 0!==n?n:16776960,i=new sr;i.addAttribute("position",new nr([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),i.computeBoundingSphere(),Fa.call(this,i,new ja({color:r}));var a=new sr;a.addAttribute("position",new nr([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),a.computeBoundingSphere(),this.add(new Lr(a,new Rr({color:r,opacity:.2,transparent:!0,depthWrite:!1})))}function iu(e,t,n,r,i,a){Hn.call(this),void 0===e&&(e=new Xt(0,0,1)),void 0===t&&(t=new Xt(0,0,0)),void 0===n&&(n=1),void 0===r&&(r=16776960),void 0===i&&(i=.2*n),void 0===a&&(a=.2*i),void 0===xl&&((xl=new sr).addAttribute("position",new nr([0,0,0,0,1,0],3)),(El=new rs(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(t),this.line=new Fa(xl,new ja({color:r})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Lr(El,new Rr({color:r})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,i,a)}function au(e){var t=[0,0,0,e=e||1,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=new sr;n.addAttribute("position",new nr(t,3)),n.addAttribute("color",new nr([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var r=new ja({vertexColors:P});Ua.call(this,n,r)}function ou(e,t,n,r,i,a,o){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new Nn(e,t,n,i,a,o)}Object.assign(Tl.prototype,{getValue:function(e,t){this.bind();var n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(e,t)},setValue:function(e,t){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(e,t)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}),Object.assign(Pl,{Composite:Tl,create:function(e,t,n){return e&&e.isAnimationObjectGroup?new Pl.Composite(e,t,n):new Pl(e,t,n)},sanitizeNodeName:(bl=new RegExp("[\\[\\]\\.:\\/]","g"),function(e){return e.replace(/\s/g,"_").replace(bl,"")}),parseTrackName:(hl="[^\\[\\]\\.:\\/]",pl="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",dl=/((?:WC+[\/:])*)/.source.replace("WC",hl),fl=/(WCOD+)?/.source.replace("WCOD",pl),ml=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",hl),gl=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",hl),vl=new RegExp("^"+dl+fl+ml+gl+"$"),yl=["material","materials","bones"],function(e){var t=vl.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var i=n.nodeName.substring(r+1);-1!==yl.indexOf(i)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=i)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}),findNode:function(e,t){if(!t||""===t||"root"===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){var r=function(e){for(var n=0;n<e.length;n++){var i=e[n];if(i.name===t||i.uuid===t)return i;var a=r(i.children);if(a)return a}return null},i=r(e.children);if(i)return i}return null}}),Object.assign(Pl.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)e[t++]=n[r]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.targetObject[this.propertyName]=e[t]},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++]},function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){var e=this.node,t=this.parsedPath,n=t.objectName,r=t.propertyName,i=t.propertyIndex;if(e||(e=Pl.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(n){var a=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(var o=0;o<e.length;o++)if(e[o].name===a){a=o;break}break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==a){if(void 0===e[a])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[a]}}var s=e[r];if(void 0!==s){var c=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?c=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(c=this.Versioning.MatrixWorldNeedsUpdate);var l=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(o=0;o<this.node.geometry.morphAttributes.position.length;o++)if(e.geometry.morphAttributes.position[o].name===i){i=o;break}}else{if(!e.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(o=0;o<this.node.geometry.morphTargets.length;o++)if(e.geometry.morphTargets[o].name===i){i=o;break}}}l=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(l=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(l=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=r;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][c]}else{var u=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+u+"."+r+" but it wasn't found.",e)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),
//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(Pl.prototype,{_getValue_unbound:Pl.prototype.getValue,_setValue_unbound:Pl.prototype.setValue}),Object.assign(Al.prototype,{isAnimationObjectGroup:!0,add:function(){for(var e=this._objects,t=e.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._paths,a=this._parsedPaths,o=this._bindings,s=o.length,c=void 0,l=0,u=arguments.length;l!==u;++l){var h=arguments[l],p=h.uuid,d=r[p];if(void 0===d){d=t++,r[p]=d,e.push(h);for(var f=0,m=s;f!==m;++f)o[f].push(new Pl(h,i[f],a[f]))}else if(d<n){c=e[d];var g=--n,v=e[g];r[v.uuid]=d,e[d]=v,r[p]=g,e[g]=h;for(f=0,m=s;f!==m;++f){var y=o[f],b=y[g],_=y[d];y[d]=b,void 0===_&&(_=new Pl(h,i[f],a[f])),y[g]=_}}else e[d]!==c&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=n},remove:function(){for(var e=this._objects,t=this.nCachedObjects_,n=this._indicesByUUID,r=this._bindings,i=r.length,a=0,o=arguments.length;a!==o;++a){var s=arguments[a],c=s.uuid,l=n[c];if(void 0!==l&&l>=t){var u=t++,h=e[u];n[h.uuid]=l,e[l]=h,n[c]=u,e[u]=s;for(var p=0,d=i;p!==d;++p){var f=r[p],m=f[u],g=f[l];f[l]=m,f[u]=g}}}this.nCachedObjects_=t},uncache:function(){for(var e=this._objects,t=e.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._bindings,a=i.length,o=0,s=arguments.length;o!==s;++o){var c=arguments[o],l=c.uuid,u=r[l];if(void 0!==u)if(delete r[l],u<n){var h=--n,p=e[h],d=e[y=--t];r[p.uuid]=u,e[u]=p,r[d.uuid]=h,e[h]=d,e.pop();for(var f=0,m=a;f!==m;++f){var g=(b=i[f])[h],v=b[y];b[u]=g,b[h]=v,b.pop()}}else{var y;r[(d=e[y=--t]).uuid]=u,e[u]=d,e.pop();for(f=0,m=a;f!==m;++f){var b;(b=i[f])[u]=b[y],b.pop()}}}this.nCachedObjects_=n},subscribe_:function(e,t){var n=this._bindingsIndicesByPath,r=n[e],i=this._bindings;if(void 0!==r)return i[r];var a=this._paths,o=this._parsedPaths,s=this._objects,c=s.length,l=this.nCachedObjects_,u=new Array(c);r=i.length,n[e]=r,a.push(e),o.push(t),i.push(u);for(var h=l,p=s.length;h!==p;++h){var d=s[h];u[h]=new Pl(d,e,t)}return u},unsubscribe_:function(e){var t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){var r=this._paths,i=this._parsedPaths,a=this._bindings,o=a.length-1,s=a[o];t[e[o]]=n,a[n]=s,a.pop(),i[n]=i[o],i.pop(),r[n]=r[o],r.pop()}}}),Object.assign(Ol.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,t){return this.loop=e,this.repetitions=t,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){var r=this._clip.duration,i=e._clip.duration,a=i/r,o=r/i;e.warp(1,a,t),this.warp(o,1,t)}return this},crossFadeTo:function(e,t,n){return e.crossFadeFrom(this,t,n)},stopFading:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,t,n){var r=this._mixer,i=r.time,a=this._timeScaleInterpolant,o=this.timeScale;null===a&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);var s=a.parameterPositions,c=a.sampleValues;return s[0]=i,s[1]=i+n,c[0]=e/o,c[1]=t/o,this},stopWarping:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,n,r){if(this.enabled){var i=this._startTime;if(null!==i){var a=(e-i)*n;if(a<0||0===n)return;this._startTime=null,t=n*a}t*=this._updateTimeScale(e);var o=this._updateTime(t),s=this._updateWeight(e);if(s>0)for(var c=this._interpolants,l=this._propertyBindings,u=0,h=c.length;u!==h;++u)c[u].evaluate(o),l[u].accumulate(r,s)}else this._updateWeight(e)},_updateWeight:function(e){var t=0;if(this.enabled){t=this.weight;var n=this._weightInterpolant;if(null!==n){var r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t},_updateTimeScale:function(e){var t=0;if(!this.paused){t=this.timeScale;var n=this._timeScaleInterpolant;if(null!==n)t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}return this._effectiveTimeScale=t,t},_updateTime:function(e){var t=this.time+e,n=this._clip.duration,r=this.loop,i=this._loopCount,a=r===xt;if(0===e)return-1===i?t:a&&1==(1&i)?n-t:t;if(r===_t){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(t>=n)t=n;else{if(!(t<0))break e;t=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===i&&(e>=0?(i=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),t>=n||t<0){var o=Math.floor(t/n);t-=n*o,i+=Math.abs(o);var s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,t=e>0?n:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===s){var c=e<0;this._setEndings(c,!c,a)}else this._setEndings(!1,!1,a);this._loopCount=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}if(a&&1==(1&i))return this.time=t,n-t}return this.time=t,t},_setEndings:function(e,t,n){var r=this._interpolantSettings;n?(r.endingStart=Pt,r.endingEnd=Pt):(r.endingStart=e?this.zeroSlopeAtStart?Pt:Tt:At,r.endingEnd=t?this.zeroSlopeAtEnd?Pt:Tt:At)},_scheduleFading:function(e,t,n){var r=this._mixer,i=r.time,a=this._weightInterpolant;null===a&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);var o=a.parameterPositions,s=a.sampleValues;return o[0]=i,s[0]=t,o[1]=i+e,s[1]=n,this}}),Cl.prototype=Object.assign(Object.create(r.prototype),{constructor:Cl,_bindAction:function(e,t){var n=e._localRoot||this._root,r=e._clip.tracks,i=r.length,a=e._propertyBindings,o=e._interpolants,s=n.uuid,c=this._bindingsByRootAndName,l=c[s];void 0===l&&(l={},c[s]=l);for(var u=0;u!==i;++u){var h=r[u],p=h.name,d=l[p];if(void 0!==d)a[u]=d;else{if(void 0!==(d=a[u])){null===d._cacheIndex&&(++d.referenceCount,this._addInactiveBinding(d,s,p));continue}var f=t&&t._propertyBindings[u].binding.parsedPath;++(d=new ul(Pl.create(n,p,f),h.ValueTypeName,h.getValueSize())).referenceCount,this._addInactiveBinding(d,s,p),a[u]=d}o[u].resultBuffer=d.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var t=(e._localRoot||this._root).uuid,n=e._clip.uuid,r=this._actionsByClip[n];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,n,t)}for(var i=e._propertyBindings,a=0,o=i.length;a!==o;++a){var s=i[a];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var i=t[n];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){var t=e._cacheIndex;return null!==t&&t<this._nActiveActions},_addInactiveAction:function(e,t,n){var r=this._actions,i=this._actionsByClip,a=i[t];if(void 0===a)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=a;else{var o=a.knownActions;e._byClipCacheIndex=o.length,o.push(e)}e._cacheIndex=r.length,r.push(e),a.actionByRoot[n]=e},_removeInactiveAction:function(e){var t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;var i=e._clip.uuid,a=this._actionsByClip,o=a[i],s=o.knownActions,c=s[s.length-1],l=e._byClipCacheIndex;c._byClipCacheIndex=l,s[l]=c,s.pop(),e._byClipCacheIndex=null,delete o.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete a[i],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var i=t[n];0==--i.referenceCount&&this._removeInactiveBinding(i)}},_lendAction:function(e){var t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_takeBackAction:function(e){var t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_addInactiveBinding:function(e,t,n){var r=this._bindingsByRootAndName,i=r[t],a=this._bindings;void 0===i&&(i={},r[t]=i),i[n]=e,e._cacheIndex=a.length,a.push(e)},_removeInactiveBinding:function(e){var t=this._bindings,n=e.binding,r=n.rootNode.uuid,i=n.path,a=this._bindingsByRootAndName,o=a[r],s=t[t.length-1],c=e._cacheIndex;s._cacheIndex=c,t[c]=s,t.pop(),delete o[i];e:{for(var l in o)break e;delete a[r]}},_lendBinding:function(e){var t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_takeBackBinding:function(e){var t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_lendControlInterpolant:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,n=e[t];return void 0===n&&((n=new Es(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t,e[t]=n),n},_takeBackControlInterpolant:function(e){var t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,i=t[r];e.__cacheIndex=r,t[r]=e,i.__cacheIndex=n,t[n]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t){var n=t||this._root,r=n.uuid,i="string"==typeof e?Is.findByName(n,e):e,a=null!==i?i.uuid:e,o=this._actionsByClip[a],s=null;if(void 0!==o){var c=o.actionByRoot[r];if(void 0!==c)return c;s=o.knownActions[0],null===i&&(i=s._clip)}if(null===i)return null;var l=new Ol(this,i,t);return this._bindAction(l,s),this._addInactiveAction(l,a,r),l},existingAction:function(e,t){var n=t||this._root,r=n.uuid,i="string"==typeof e?Is.findByName(n,e):e,a=i?i.uuid:e,o=this._actionsByClip[a];return void 0!==o&&o.actionByRoot[r]||null},stopAllAction:function(){var e=this._actions,t=this._nActiveActions,n=this._bindings,r=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var i=0;i!==t;++i)e[i].reset();for(i=0;i!==r;++i)n[i].useCount=0;return this},update:function(e){e*=this.timeScale;for(var t=this._actions,n=this._nActiveActions,r=this.time+=e,i=Math.sign(e),a=this._accuIndex^=1,o=0;o!==n;++o){t[o]._update(r,e,i,a)}var s=this._bindings,c=this._nActiveBindings;for(o=0;o!==c;++o)s[o].apply(a);return this},getRoot:function(){return this._root},uncacheClip:function(e){var t=this._actions,n=e.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){for(var a=i.knownActions,o=0,s=a.length;o!==s;++o){var c=a[o];this._deactivateAction(c);var l=c._cacheIndex,u=t[t.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,u._cacheIndex=l,t[l]=u,t.pop(),this._removeInactiveBindingsForAction(c)}delete r[n]}},uncacheRoot:function(e){var t=e.uuid,n=this._actionsByClip;for(var r in n){var i=n[r].actionByRoot[t];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var a=this._bindingsByRootAndName[t];if(void 0!==a)for(var o in a){var s=a[o];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(e,t){var n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}),Rl.prototype.clone=function(){return new Rl(void 0===this.value.clone?this.value:this.value.clone())},Ll.prototype=Object.assign(Object.create(sr.prototype),{constructor:Ll,isInstancedBufferGeometry:!0,copy:function(e){return sr.prototype.copy.call(this,e),this.maxInstancedCount=e.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)}}),Il.prototype=Object.assign(Object.create(Ra.prototype),{constructor:Il,isInstancedInterleavedBuffer:!0,copy:function(e){return Ra.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),kl.prototype=Object.assign(Object.create(Yn.prototype),{constructor:kl,isInstancedBufferAttribute:!0,copy:function(e){return Yn.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Object.assign(Nl.prototype,{linePrecision:1,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize()):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,t,n){var r=n||[];return Dl(e,this,r,t),r.sort(zl),r},intersectObjects:function(e,t,n){var r=n||[];if(!1===Array.isArray(e))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),r;for(var i=0,a=e.length;i<a;i++)Dl(e[i],this,r,t);return r.sort(zl),r}}),Object.assign(Bl.prototype,{set:function(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Gt.clamp(t/this.radius,-1,1))),this}}),Object.assign(jl.prototype,{set:function(e,t,n){return this.radius=e,this.theta=t,this.y=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}}),Object.assign(Fl.prototype,{set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new Wt;return function(t,n){var r=e.copy(n).multiplyScalar(.5);return this.min.copy(t).sub(r),this.max.copy(t).add(r),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new Wt),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new Wt),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .getParameter() target is now required"),t=new Wt),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .clampPoint() target is now required"),t=new Wt),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new Wt;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),Object.assign(Ul.prototype,{set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return void 0===e&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new Xt),e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return void 0===e&&(console.warn("THREE.Line3: .delta() target is now required"),e=new Xt),e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){return void 0===t&&(console.warn("THREE.Line3: .at() target is now required"),t=new Xt),this.delta(t).multiplyScalar(e).add(this.start)},closestPointToPointParameter:(_l=new Xt,wl=new Xt,function(e,t){_l.subVectors(e,this.start),wl.subVectors(this.end,this.start);var n=wl.dot(wl),r=wl.dot(_l)/n;return t&&(r=Gt.clamp(r,0,1)),r}),closestPointToPoint:function(e,t,n){var r=this.closestPointToPointParameter(e,t);return void 0===n&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new Xt),this.delta(n).multiplyScalar(r).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}}),Vl.prototype=Object.create(Hn.prototype),Vl.prototype.constructor=Vl,Vl.prototype.isImmediateRenderObject=!0,Hl.prototype=Object.create(Ua.prototype),Hl.prototype.constructor=Hl,Hl.prototype.update=function(){var e=new Xt,t=new Xt,n=new Yt;return function(){var r=["a","b","c"];this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);var i=this.object.matrixWorld,a=this.geometry.attributes.position,o=this.object.geometry;if(o&&o.isGeometry)for(var s=o.vertices,c=o.faces,l=0,u=0,h=c.length;u<h;u++)for(var p=c[u],d=0,f=p.vertexNormals.length;d<f;d++){var m=s[p[r[d]]],g=p.vertexNormals[d];e.copy(m).applyMatrix4(i),t.copy(g).applyMatrix3(n).normalize().multiplyScalar(this.size).add(e),a.setXYZ(l,e.x,e.y,e.z),l+=1,a.setXYZ(l,t.x,t.y,t.z),l+=1}else if(o&&o.isBufferGeometry){var v=o.attributes.position,y=o.attributes.normal;for(l=0,d=0,f=v.count;d<f;d++)e.set(v.getX(d),v.getY(d),v.getZ(d)).applyMatrix4(i),t.set(y.getX(d),y.getY(d),y.getZ(d)),t.applyMatrix3(n).normalize().multiplyScalar(this.size).add(e),a.setXYZ(l,e.x,e.y,e.z),l+=1,a.setXYZ(l,t.x,t.y,t.z),l+=1}a.needsUpdate=!0}}(),Gl.prototype=Object.create(Hn.prototype),Gl.prototype.constructor=Gl,Gl.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Gl.prototype.update=function(){var e=new Xt;return function(){this.light.updateMatrixWorld();var t=this.light.distance?this.light.distance:1e3,n=t*Math.tan(this.light.angle);this.cone.scale.set(n,n,t),e.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(e),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}(),Wl.prototype=Object.create(Ua.prototype),Wl.prototype.constructor=Wl,Wl.prototype.updateMatrixWorld=function(){var e=new Xt,t=new _n,n=new _n;return function(r){var i=this.bones,a=this.geometry,o=a.getAttribute("position");n.getInverse(this.root.matrixWorld);for(var s=0,c=0;s<i.length;s++){var l=i[s];l.parent&&l.parent.isBone&&(t.multiplyMatrices(n,l.matrixWorld),e.setFromMatrixPosition(t),o.setXYZ(c,e.x,e.y,e.z),t.multiplyMatrices(n,l.parent.matrixWorld),e.setFromMatrixPosition(t),o.setXYZ(c+1,e.x,e.y,e.z),c+=2)}a.getAttribute("position").needsUpdate=!0,Hn.prototype.updateMatrixWorld.call(this,r)}}(),ql.prototype=Object.create(Lr.prototype),ql.prototype.constructor=ql,ql.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},ql.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},Xl.prototype=Object.create(Fa.prototype),Xl.prototype.constructor=Xl,Xl.prototype.update=function(){if(this.scale.set(.5*this.light.width,.5*this.light.height,1),void 0!==this.color)this.material.color.set(this.color),this.children[0].material.color.set(this.color);else{this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);var e=this.material.color,t=Math.max(e.r,e.g,e.b);t>1&&e.multiplyScalar(1/t),this.children[0].material.color.copy(this.material.color)}},Xl.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()},Yl.prototype=Object.create(Hn.prototype),Yl.prototype.constructor=Yl,Yl.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Yl.prototype.update=function(){var e=new Xt,t=new On,n=new On;return function(){var r=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var i=r.geometry.getAttribute("color");t.copy(this.light.color),n.copy(this.light.groundColor);for(var a=0,o=i.count;a<o;a++){var s=a<o/2?t:n;i.setXYZ(a,s.r,s.g,s.b)}i.needsUpdate=!0}r.lookAt(e.setFromMatrixPosition(this.light.matrixWorld).negate())}}(),Kl.prototype=Object.assign(Object.create(Ua.prototype),{constructor:Kl,copy:function(e){return Ua.prototype.copy.call(this,e),this.geometry.copy(e.geometry),this.material.copy(e.material),this},clone:function(){return(new this.constructor).copy(this)}}),$l.prototype=Object.create(Ua.prototype),$l.prototype.constructor=$l,Zl.prototype=Object.create(Fa.prototype),Zl.prototype.constructor=Zl,Zl.prototype.update=function(){var e,t,n=this.audio,r=this.range,i=this.divisionsInnerAngle,a=this.divisionsOuterAngle,o=Gt.degToRad(n.panner.coneInnerAngle),s=Gt.degToRad(n.panner.coneOuterAngle),c=o/2,l=s/2,u=0,h=0,p=this.geometry,d=p.attributes.position;function f(n,i,a,o){var s=(i-n)/a;for(d.setXYZ(u,0,0,0),h++,e=n;e<i;e+=s)t=u+h,d.setXYZ(t,Math.sin(e)*r,0,Math.cos(e)*r),d.setXYZ(t+1,Math.sin(Math.min(e+s,i))*r,0,Math.cos(Math.min(e+s,i))*r),d.setXYZ(t+2,0,0,0),h+=3;p.addGroup(u,h,o),u+=h,h=0}p.clearGroups(),f(-l,-c,a,0),f(-c,c,i,1),f(c,l,a,0),d.needsUpdate=!0,o===s&&(this.material[0].visible=!1)},Zl.prototype.dispose=function(){this.geometry.dispose(),this.material[0].dispose(),this.material[1].dispose()},Jl.prototype=Object.create(Ua.prototype),Jl.prototype.constructor=Jl,Jl.prototype.update=function(){var e=new Xt,t=new Xt,n=new Yt;return function(){this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);for(var r=this.object.matrixWorld,i=this.geometry.attributes.position,a=this.object.geometry,o=a.vertices,s=a.faces,c=0,l=0,u=s.length;l<u;l++){var h=s[l],p=h.normal;e.copy(o[h.a]).add(o[h.b]).add(o[h.c]).divideScalar(3).applyMatrix4(r),t.copy(p).applyMatrix3(n).normalize().multiplyScalar(this.size).add(e),i.setXYZ(c,e.x,e.y,e.z),c+=1,i.setXYZ(c,t.x,t.y,t.z),c+=1}i.needsUpdate=!0}}(),Ql.prototype=Object.create(Hn.prototype),Ql.prototype.constructor=Ql,Ql.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},Ql.prototype.update=function(){var e=new Xt,t=new Xt,n=new Xt;return function(){e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),n.subVectors(t,e),this.lightPlane.lookAt(t),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(t),this.targetLine.scale.z=n.length()}}(),eu.prototype=Object.create(Ua.prototype),eu.prototype.constructor=eu,eu.prototype.update=function(){var e,t,n=new Xt,r=new da;function i(i,a,o,s){n.set(a,o,s).unproject(r);var c=t[i];if(void 0!==c)for(var l=e.getAttribute("position"),u=0,h=c.length;u<h;u++)l.setXYZ(c[u],n.x,n.y,n.z)}return function(){e=this.geometry,t=this.pointMap;r.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),i("c",0,0,-1),i("t",0,0,1),i("n1",-1,-1,-1),i("n2",1,-1,-1),i("n3",-1,1,-1),i("n4",1,1,-1),i("f1",-1,-1,1),i("f2",1,-1,1),i("f3",-1,1,1),i("f4",1,1,1),i("u1",.7,1.1,-1),i("u2",-.7,1.1,-1),i("u3",0,2,-1),i("cf1",-1,0,1),i("cf2",1,0,1),i("cf3",0,-1,1),i("cf4",0,1,1),i("cn1",-1,0,-1),i("cn2",1,0,-1),i("cn3",0,-1,-1),i("cn4",0,1,-1),e.getAttribute("position").needsUpdate=!0}}(),tu.prototype=Object.create(Ua.prototype),tu.prototype.constructor=tu,tu.prototype.update=function(){var e=new gn;return function(t){if(void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&e.setFromObject(this.object),!e.isEmpty()){var n=e.min,r=e.max,i=this.geometry.attributes.position,a=i.array;a[0]=r.x,a[1]=r.y,a[2]=r.z,a[3]=n.x,a[4]=r.y,a[5]=r.z,a[6]=n.x,a[7]=n.y,a[8]=r.z,a[9]=r.x,a[10]=n.y,a[11]=r.z,a[12]=r.x,a[13]=r.y,a[14]=n.z,a[15]=n.x,a[16]=r.y,a[17]=n.z,a[18]=n.x,a[19]=n.y,a[20]=n.z,a[21]=r.x,a[22]=n.y,a[23]=n.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),tu.prototype.setFromObject=function(e){return this.object=e,this.update(),this},tu.prototype.copy=function(e){return Ua.prototype.copy.call(this,e),this.object=e.object,this},tu.prototype.clone=function(){return(new this.constructor).copy(this)},nu.prototype=Object.create(Ua.prototype),nu.prototype.constructor=nu,nu.prototype.updateMatrixWorld=function(e){var t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),Hn.prototype.updateMatrixWorld.call(this,e))},ru.prototype=Object.create(Fa.prototype),ru.prototype.constructor=ru,ru.prototype.updateMatrixWorld=function(e){var t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?w:_,this.lookAt(this.plane.normal),Hn.prototype.updateMatrixWorld.call(this,e)},iu.prototype=Object.create(Hn.prototype),iu.prototype.constructor=iu,iu.prototype.setDirection=(Sl=new Xt,function(e){e.y>.99999?this.quaternion.set(0,0,0,1):e.y<-.99999?this.quaternion.set(1,0,0,0):(Sl.set(e.z,0,-e.x).normalize(),Ml=Math.acos(e.y),this.quaternion.setFromAxisAngle(Sl,Ml))}),iu.prototype.setLength=function(e,t,n){void 0===t&&(t=.2*e),void 0===n&&(n=.2*t),this.line.scale.set(1,Math.max(0,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()},iu.prototype.setColor=function(e){this.line.material.color.copy(e),this.cone.material.color.copy(e)},iu.prototype.copy=function(e){return Hn.prototype.copy.call(this,e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this},iu.prototype.clone=function(){return(new this.constructor).copy(this)},au.prototype=Object.create(Ua.prototype),au.prototype.constructor=au;var su=0,cu=1;function lu(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e}function uu(e){return void 0===e&&(e=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,e.materials=e,e.clone=function(){return e.slice()},e}function hu(e,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new Ga(e,t)}function pu(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new ka(e)}function du(e,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new Ga(e,t)}function fu(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Ha(e)}function mu(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Ha(e)}function gu(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Ha(e)}function vu(e,t,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new Xt(e,t,n)}function yu(e,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new Yn(e,t).setDynamic(!0)}function bu(e,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new Kn(e,t)}function _u(e,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new $n(e,t)}function wu(e,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new Zn(e,t)}function xu(e,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new Jn(e,t)}function Eu(e,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new Qn(e,t)}function Mu(e,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new er(e,t)}function Su(e,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new tr(e,t)}function Tu(e,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new nr(e,t)}function Pu(e,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new rr(e,t)}function Au(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),ec.call(this,e),this.type="catmullrom",this.closed=!0}function Ou(e){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),ec.call(this,e),this.type="catmullrom"}function Cu(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),ec.call(this,e),this.type="catmullrom"}function Ru(e){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new au(e)}function Lu(e,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new tu(e,t)}function Iu(e,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Ua(new ts(e.geometry),new ja({color:void 0!==t?t:16777215}))}function ku(e,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Ua(new Ka(e.geometry),new ja({color:void 0!==t?t:16777215}))}function Nu(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new js(e)}function zu(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Vs(e)}qs.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(qs.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},Object.assign(pc.prototype,{createPointsGeometry:function(e){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getPoints(e);return this.createGeometry(t)},createSpacedPointsGeometry:function(e){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getSpacedPoints(e);return this.createGeometry(t)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var t=new Xn,n=0,r=e.length;n<r;n++){var i=e[n];t.vertices.push(new Xt(i.x,i.y,i.z||0))}return t}}),Object.assign(dc.prototype,{fromPoints:function(e){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}}),Au.prototype=Object.create(ec.prototype),Ou.prototype=Object.create(ec.prototype),Cu.prototype=Object.create(ec.prototype),Object.assign(Cu.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),Kl.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Wl.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(Gc.prototype,{extractUrlBase:function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Pc.extractUrlBase(e)}}),Object.assign(Cc.prototype,{setTexturePath:function(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}),Object.assign(Fl.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(gn.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),Ul.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Object.assign(Gt,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),Gt.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),Gt.ceilPowerOfTwo(e)}}),Object.assign(Yt.prototype,{flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(_n.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},getPosition:function(){var e;return function(){return void 0===e&&(e=new Xt),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),e.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,t,n,r,i,a){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,r,n,i,a)}}),yn.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},qt.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Object.assign(Or.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(Cr.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},midpoint:function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},normal:function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},plane:function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)}}),Object.assign(Cr,{barycoordFromPoint:function(e,t,n,r,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Cr.getBarycoord(e,t,n,r,i)},normal:function(e,t,n,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Cr.getNormal(e,t,n,r)}}),Object.assign(fc.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Fo(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Jo(this,e)}}),Object.assign(Wt.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Xt.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,t,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(hn.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Xn.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}}),Object.assign(Hn.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")}}),Object.defineProperties(Hn.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(Na.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Da.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),za.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(qs.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),fa.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(mc.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(Yn.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")}}),Object.assign(sr.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addDrawCall:function(e,t,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(sr.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.assign(Uo.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(Rl.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(dr.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new On}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=e===E}}}),Object.defineProperties(ds.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(Ar.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(Pa.prototype,{clearTarget:function(e,t,n,r){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,n,r)},animate:function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")}}),Object.defineProperties(Pa.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(ca.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(fn.prototype,{activeCubeFace:{set:function(){console.warn("THREE.WebGLRenderTargetCube: .activeCubeFace has been removed. It is now the second parameter of WebGLRenderer.setRenderTarget().")}},activeMipMapLevel:{set:function(){console.warn("THREE.WebGLRenderTargetCube: .activeMipMapLevel has been removed. It is now the third parameter of WebGLRenderer.setRenderTarget().")}}}),Object.defineProperties(pn.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Object.defineProperties(Sa.prototype,{standing:{set:function(){console.warn("THREE.WebVRManager: .standing has been removed.")}},userHeight:{set:function(){console.warn("THREE.WebVRManager: .userHeight has been removed.")}}}),sl.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;return(new nl).load(e,function(e){t.setBuffer(e)}),this},ll.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},il.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)};var Du={merge:function(e,t,n){var r;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),t.isMesh&&(t.matrixAutoUpdate&&t.updateMatrix(),r=t.matrix,t=t.geometry),e.merge(t,r,n)},center:function(e){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}};function Bu(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(e,t){console.warn("THREE.Projector: .projectVector() is now vector.project()."),e.project(t)},this.unprojectVector=function(e,t){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),e.unproject(t)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}}function ju(){console.error("THREE.CanvasRenderer has been removed")}function Fu(){console.error("THREE.JSONLoader has been removed.")}cn.crossOrigin=void 0,cn.loadTexture=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new Ws;i.setCrossOrigin(this.crossOrigin);var a=i.load(e,n,void 0,r);return t&&(a.mapping=t),a},cn.loadTextureCube=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new Gs;i.setCrossOrigin(this.crossOrigin);var a=i.load(e,n,void 0,r);return t&&(a.mapping=t),a},cn.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},cn.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};var Uu={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")}};function Vu(){console.error("THREE.LensFlare has been moved to /examples/js/objects/Lensflare.js")}},function(e,t,n){e.exports=n(111)()},function(e,t,n){var r;
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
!function(){"use strict";var n={}.hasOwnProperty;function i(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var a=typeof r;if("string"===a||"number"===a)e.push(r);else if(Array.isArray(r)&&r.length){var o=i.apply(null,r);o&&e.push(o)}else if("object"===a)for(var s in r)n.call(r,s)&&r[s]&&e.push(s)}}return e.join(" ")}e.exports?(i.default=i,e.exports=i):void 0===(r=function(){return i}.apply(t,[]))||(e.exports=r)}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(12),i=n(283),a=n(102);let o;const s={};var c;t.translated=function(e,t){if(void 0===o)throw new Error("forgot to initialize i18n");const n=void 0===t;if(n){const t=s[e];if(t)return t}const r=o.t(e,t);return n&&r!==e&&(s[e]=r),r},function(e){e.en="en",e.test="test"}(c=t.Language||(t.Language={})),t.init=function(e){return new Promise((t,n)=>{o=i.use(a).init({lng:e.locale,fallbackLng:e.locale,ns:["common","envelopes","lesson-visualizations","rnbo-test-instrument","playground","presets"],load:"currentOnly",debug:!1,appendNamespaceToMissingKey:!0,backend:{loadPath:r.urlForFile("content/texts/{{lng}}/{{ns}}.json")}},(e,r)=>{e?n(e):t()})})},t.changeLanguage=function(e){return new Promise((t,n)=>{if(void 0===o)throw new Error("Forgot to initialize i18n");o.changeLanguage(e,e=>{e?n(e):t()})})},t.allLanguages=function(){const e=[];for(const t in c)c.hasOwnProperty(t)&&e.push(t);return e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(34);t.SizeObserver=class{constructor(){this.cachedWidth=0,this.cachedHeight=0,this.onResize=this.onResize.bind(this),this.debouncedResize=r.debounce(this.onResize,200)}startObserving(e,t){if(null===e.current)throw new Error("Ref element is null. Call startObserving() from componentDidMount().");this.setElement(e.current),this.callback=t,this.callback&&this.callback(),window.addEventListener("resize",this.debouncedResize)}stopObserving(){this.callback=void 0,this.element=void 0,window.removeEventListener("resize",this.debouncedResize)}getWidth(){return this.cachedWidth}getHeight(){return this.cachedHeight}setElement(e){this.element=e,this.updateDimensions()}onResize(){this.updateDimensions(),void 0!==this.callback&&this.callback()}updateDimensions(){this.cachedWidth=this.element?this.element.clientWidth:0,this.cachedHeight=this.element?this.element.clientHeight:0}}},function(e,t,n){"use strict";function r(e,t,n){return Math.max(t,Math.min(e,n))}function i(e,t,n,i,a){return i+((e=r(e,t,n))-t)/(n-t)*(a-i)}Object.defineProperty(t,"__esModule",{value:!0}),t.clamp=r,t.normalize=function(e,t,n){return i(e,t,n,0,1)},t.lerp=function(e,t,n){return e+n*(t-e)},t.mapValueToRange=i,t.mapNormalizedValueToRange=function(e,t,n){return i(e,0,1,t,n)},t.euclideanDistance=function(e,t,n,r){return Math.hypot(n-e,r-t)},t.inRange=function(e,t,n,r=!0){return r?e>=t&&e<=n:e>t&&e<n}},function(e,t,n){"use strict";var r=function(){};e.exports=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(12),i=n(31),a=n(25);let o,s,c,l,u;function h(){return t.audioContext.audioWorklet}function p(){return h()&&("high"===a.getAudioQualitySetting()||"medium"===a.getAudioQualitySetting())}t.audioContext=i.isRunningInBrowser()?new AudioContext:{},i.isRunningInBrowser()&&(document.addEventListener("DOMContentLoaded",()=>{!function(e){function n(){t.audioContext.resume().then(()=>{e.removeEventListener("touchstart",n,!0),e.removeEventListener("touchend",n,!0),e.removeEventListener("mousedown",n,!0),e.removeEventListener("mouseup",n,!0),e.removeEventListener("click",n,!0)})}e.addEventListener("touchstart",n,!0),e.addEventListener("touchend",n,!0),e.addEventListener("mousedown",n,!0),e.addEventListener("mouseup",n,!0),e.addEventListener("click",n,!0)}(document.body)}),document.addEventListener("visibilitychange",function(){const e="hidden"===document.visibilityState?0:1;s.gain.linearRampToValueAtTime(e,t.audioContext.currentTime+.1)})),t.connectToPreFxOutput=function(e){e.connect(o)},t.connectToPostFxOutput=function(e){e.connect(s)},t.init=function(){switch(window.Tone.setContext(t.audioContext),i.isRunningInFirefox()&&(window.Tone.context.latencyHint="balanced"),o=t.audioContext.createGain(),(s=t.audioContext.createGain()).connect(t.audioContext.destination),a.getAudioQualitySetting()){case"high":c=t.audioContext.createConvolver(),l=t.audioContext.createGain(),u=t.audioContext.createGain(),c.normalize=!1,e=.05,l.gain.value=1-e,u.gain.value=e,o.connect(l),o.connect(c),c.connect(u),l.connect(s),u.connect(s);break;case"medium":case"low":o.connect(s);break;default:throw new Error("Unknown audio quality setting")}var e;return fetch(r.urlForFile("content/assets/sounds/impulseresponse.wav")).then(e=>e.arrayBuffer()).then(e=>t.audioContext.decodeAudioData(e)).then(e=>{c&&(c.buffer=e)})},t.browserSupportsAudioWorklet=h,t.isUsingAudioWorklet=p,t.recommendedBufferSize=function(){switch(a.getAudioQualitySetting()){case"high":return p()?128:512;case"medium":return p()?128:1024;case"low":return 2048}}},function(e,t,n){"use strict";function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function i(e){return"/"===e.charAt(0)}function a(e,t){for(var n=t,r=n+1,i=e.length;r<i;n+=1,r+=1)e[n]=e[r];e.pop()}n.r(t);var o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=e&&e.split("/")||[],r=t&&t.split("/")||[],o=e&&i(e),s=t&&i(t),c=o||s;if(e&&i(e)?r=n:n.length&&(r.pop(),r=r.concat(n)),!r.length)return"/";var l=void 0;if(r.length){var u=r[r.length-1];l="."===u||".."===u||""===u}else l=!1;for(var h=0,p=r.length;p>=0;p--){var d=r[p];"."===d?a(r,p):".."===d?(a(r,p),h++):h&&(a(r,p),h--)}if(!c)for(;h--;h)r.unshift("..");!c||""===r[0]||r[0]&&i(r[0])||r.unshift("");var f=r.join("/");return l&&"/"!==f.substr(-1)&&(f+="/"),f},s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var c=function e(t,n){if(t===n)return!0;if(null==t||null==n)return!1;if(Array.isArray(t))return Array.isArray(n)&&t.length===n.length&&t.every(function(t,r){return e(t,n[r])});var r=void 0===t?"undefined":s(t);if(r!==(void 0===n?"undefined":s(n)))return!1;if("object"===r){var i=t.valueOf(),a=n.valueOf();if(i!==t||a!==n)return e(i,a);var o=Object.keys(t),c=Object.keys(n);return o.length===c.length&&o.every(function(r){return e(t[r],n[r])})}return!1},l=!0,u="Invariant failed";var h=function(e,t){if(!e)throw l?new Error(u):new Error(u+": "+(t||""))};function p(e){return"/"===e.charAt(0)?e:"/"+e}function d(e){return"/"===e.charAt(0)?e.substr(1):e}function f(e,t){return function(e,t){return new RegExp("^"+t+"(\\/|\\?|#|$)","i").test(e)}(e,t)?e.substr(t.length):e}function m(e){return"/"===e.charAt(e.length-1)?e.slice(0,-1):e}function g(e){var t=e||"/",n="",r="",i=t.indexOf("#");-1!==i&&(r=t.substr(i),t=t.substr(0,i));var a=t.indexOf("?");return-1!==a&&(n=t.substr(a),t=t.substr(0,a)),{pathname:t,search:"?"===n?"":n,hash:"#"===r?"":r}}function v(e){var t=e.pathname,n=e.search,r=e.hash,i=t||"/";return n&&"?"!==n&&(i+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(i+="#"===r.charAt(0)?r:"#"+r),i}function y(e,t,n,i){var a;"string"==typeof e?(a=g(e)).state=t:(void 0===(a=r({},e)).pathname&&(a.pathname=""),a.search?"?"!==a.search.charAt(0)&&(a.search="?"+a.search):a.search="",a.hash?"#"!==a.hash.charAt(0)&&(a.hash="#"+a.hash):a.hash="",void 0!==t&&void 0===a.state&&(a.state=t));try{a.pathname=decodeURI(a.pathname)}catch(e){throw e instanceof URIError?new URIError('Pathname "'+a.pathname+'" could not be decoded. This is likely caused by an invalid percent-encoding.'):e}return n&&(a.key=n),i?a.pathname?"/"!==a.pathname.charAt(0)&&(a.pathname=o(a.pathname,i.pathname)):a.pathname=i.pathname:a.pathname||(a.pathname="/"),a}function b(e,t){return e.pathname===t.pathname&&e.search===t.search&&e.hash===t.hash&&e.key===t.key&&c(e.state,t.state)}function _(){var e=null;var t=[];return{setPrompt:function(t){return e=t,function(){e===t&&(e=null)}},confirmTransitionTo:function(t,n,r,i){if(null!=e){var a="function"==typeof e?e(t,n):e;"string"==typeof a?"function"==typeof r?r(a,i):i(!0):i(!1!==a)}else i(!0)},appendListener:function(e){var n=!0;function r(){n&&e.apply(void 0,arguments)}return t.push(r),function(){n=!1,t=t.filter(function(e){return e!==r})}},notifyListeners:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.forEach(function(e){return e.apply(void 0,n)})}}}n.d(t,"createBrowserHistory",function(){return T}),n.d(t,"createHashHistory",function(){return R}),n.d(t,"createMemoryHistory",function(){return I}),n.d(t,"createLocation",function(){return y}),n.d(t,"locationsAreEqual",function(){return b}),n.d(t,"parsePath",function(){return g}),n.d(t,"createPath",function(){return v});var w=!("undefined"==typeof window||!window.document||!window.document.createElement);function x(e,t){t(window.confirm(e))}var E="popstate",M="hashchange";function S(){try{return window.history.state||{}}catch(e){return{}}}function T(e){void 0===e&&(e={}),w||h(!1);var t,n=window.history,i=(-1===(t=window.navigator.userAgent).indexOf("Android 2.")&&-1===t.indexOf("Android 4.0")||-1===t.indexOf("Mobile Safari")||-1!==t.indexOf("Chrome")||-1!==t.indexOf("Windows Phone"))&&window.history&&"pushState"in window.history,a=!(-1===window.navigator.userAgent.indexOf("Trident")),o=e,s=o.forceRefresh,c=void 0!==s&&s,l=o.getUserConfirmation,u=void 0===l?x:l,d=o.keyLength,g=void 0===d?6:d,b=e.basename?m(p(e.basename)):"";function T(e){var t=e||{},n=t.key,r=t.state,i=window.location,a=i.pathname+i.search+i.hash;return b&&(a=f(a,b)),y(a,r,n)}function P(){return Math.random().toString(36).substr(2,g)}var A=_();function O(e){r(U,e),U.length=n.length,A.notifyListeners(U.location,U.action)}function C(e){(function(e){void 0===e.state&&navigator.userAgent.indexOf("CriOS")})(e)||I(T(e.state))}function R(){I(T(S()))}var L=!1;function I(e){if(L)L=!1,O();else{A.confirmTransitionTo(e,"POP",u,function(t){t?O({action:"POP",location:e}):function(e){var t=U.location,n=N.indexOf(t.key);-1===n&&(n=0);var r=N.indexOf(e.key);-1===r&&(r=0);var i=n-r;i&&(L=!0,D(i))}(e)})}}var k=T(S()),N=[k.key];function z(e){return b+v(e)}function D(e){n.go(e)}var B=0;function j(e){1===(B+=e)&&1===e?(window.addEventListener(E,C),a&&window.addEventListener(M,R)):0===B&&(window.removeEventListener(E,C),a&&window.removeEventListener(M,R))}var F=!1;var U={length:n.length,action:"POP",location:k,createHref:z,push:function(e,t){var r=y(e,t,P(),U.location);A.confirmTransitionTo(r,"PUSH",u,function(e){if(e){var t=z(r),a=r.key,o=r.state;if(i)if(n.pushState({key:a,state:o},null,t),c)window.location.href=t;else{var s=N.indexOf(U.location.key),l=N.slice(0,-1===s?0:s+1);l.push(r.key),N=l,O({action:"PUSH",location:r})}else window.location.href=t}})},replace:function(e,t){var r=y(e,t,P(),U.location);A.confirmTransitionTo(r,"REPLACE",u,function(e){if(e){var t=z(r),a=r.key,o=r.state;if(i)if(n.replaceState({key:a,state:o},null,t),c)window.location.replace(t);else{var s=N.indexOf(U.location.key);-1!==s&&(N[s]=r.key),O({action:"REPLACE",location:r})}else window.location.replace(t)}})},go:D,goBack:function(){D(-1)},goForward:function(){D(1)},block:function(e){void 0===e&&(e=!1);var t=A.setPrompt(e);return F||(j(1),F=!0),function(){return F&&(F=!1,j(-1)),t()}},listen:function(e){var t=A.appendListener(e);return j(1),function(){j(-1),t()}}};return U}var P="hashchange",A={hashbang:{encodePath:function(e){return"!"===e.charAt(0)?e:"!/"+d(e)},decodePath:function(e){return"!"===e.charAt(0)?e.substr(1):e}},noslash:{encodePath:d,decodePath:p},slash:{encodePath:p,decodePath:p}};function O(){var e=window.location.href,t=e.indexOf("#");return-1===t?"":e.substring(t+1)}function C(e){var t=window.location.href.indexOf("#");window.location.replace(window.location.href.slice(0,t>=0?t:0)+"#"+e)}function R(e){void 0===e&&(e={}),w||h(!1);var t=window.history,n=(window.navigator.userAgent.indexOf("Firefox"),e),i=n.getUserConfirmation,a=void 0===i?x:i,o=n.hashType,s=void 0===o?"slash":o,c=e.basename?m(p(e.basename)):"",l=A[s],u=l.encodePath,d=l.decodePath;function g(){var e=d(O());return c&&(e=f(e,c)),y(e)}var E=_();function M(e){r(F,e),F.length=t.length,E.notifyListeners(F.location,F.action)}var S=!1,T=null;function R(){var e=O(),t=u(e);if(e!==t)C(t);else{var n=g(),r=F.location;if(!S&&b(r,n))return;if(T===v(n))return;T=null,function(e){if(S)S=!1,M();else{E.confirmTransitionTo(e,"POP",a,function(t){t?M({action:"POP",location:e}):function(e){var t=F.location,n=N.lastIndexOf(v(t));-1===n&&(n=0);var r=N.lastIndexOf(v(e));-1===r&&(r=0);var i=n-r;i&&(S=!0,z(i))}(e)})}}(n)}}var L=O(),I=u(L);L!==I&&C(I);var k=g(),N=[v(k)];function z(e){t.go(e)}var D=0;function B(e){1===(D+=e)&&1===e?window.addEventListener(P,R):0===D&&window.removeEventListener(P,R)}var j=!1;var F={length:t.length,action:"POP",location:k,createHref:function(e){return"#"+u(c+v(e))},push:function(e,t){var n=y(e,void 0,void 0,F.location);E.confirmTransitionTo(n,"PUSH",a,function(e){if(e){var t=v(n),r=u(c+t);if(O()!==r){T=t,function(e){window.location.hash=e}(r);var i=N.lastIndexOf(v(F.location)),a=N.slice(0,-1===i?0:i+1);a.push(t),N=a,M({action:"PUSH",location:n})}else M()}})},replace:function(e,t){var n=y(e,void 0,void 0,F.location);E.confirmTransitionTo(n,"REPLACE",a,function(e){if(e){var t=v(n),r=u(c+t);O()!==r&&(T=t,C(r));var i=N.indexOf(v(F.location));-1!==i&&(N[i]=t),M({action:"REPLACE",location:n})}})},go:z,goBack:function(){z(-1)},goForward:function(){z(1)},block:function(e){void 0===e&&(e=!1);var t=E.setPrompt(e);return j||(B(1),j=!0),function(){return j&&(j=!1,B(-1)),t()}},listen:function(e){var t=E.appendListener(e);return B(1),function(){B(-1),t()}}};return F}function L(e,t,n){return Math.min(Math.max(e,t),n)}function I(e){void 0===e&&(e={});var t=e,n=t.getUserConfirmation,i=t.initialEntries,a=void 0===i?["/"]:i,o=t.initialIndex,s=void 0===o?0:o,c=t.keyLength,l=void 0===c?6:c,u=_();function h(e){r(b,e),b.length=b.entries.length,u.notifyListeners(b.location,b.action)}function p(){return Math.random().toString(36).substr(2,l)}var d=L(s,0,a.length-1),f=a.map(function(e){return y(e,void 0,"string"==typeof e?p():e.key||p())}),m=v;function g(e){var t=L(b.index+e,0,b.entries.length-1),r=b.entries[t];u.confirmTransitionTo(r,"POP",n,function(e){e?h({action:"POP",location:r,index:t}):h()})}var b={length:f.length,action:"POP",location:f[d],index:d,entries:f,createHref:m,push:function(e,t){var r=y(e,t,p(),b.location);u.confirmTransitionTo(r,"PUSH",n,function(e){if(e){var t=b.index+1,n=b.entries.slice(0);n.length>t?n.splice(t,n.length-t,r):n.push(r),h({action:"PUSH",location:r,index:t,entries:n})}})},replace:function(e,t){var r=y(e,t,p(),b.location);u.confirmTransitionTo(r,"REPLACE",n,function(e){e&&(b.entries[b.index]=r,h({action:"REPLACE",location:r}))})},go:g,goBack:function(){g(-1)},goForward:function(){g(1)},canGo:function(e){var t=b.index+e;return t>=0&&t<b.entries.length},block:function(e){return void 0===e&&(e=!1),u.setPrompt(e)},listen:function(e){return u.appendListener(e)}};return b}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(8);function i(){a.forEach(e=>e.onAnimationFrame()),requestAnimationFrame(i)}t.init=function(){return requestAnimationFrame(i),Promise.resolve()};const a=new Set;t.AnimationFramer=class{constructor(e){this.allowThrottling=!1,this.renderThrottleSwitch=!1,this.allowThrottling=void 0!==e&&!0===e.allowThrottling}startAnimating(e){this.callback=e,a.add(this)}stopAnimating(){a.delete(this),this.callback=void 0}onAnimationFrame(){this.allowThrottling&&!r.isUsingAudioWorklet()?(this.renderThrottleSwitch=!this.renderThrottleSwitch,this.renderThrottleSwitch&&this.callback()):this.callback()}}},function(e,t,n){"use strict";e.exports=function(e,t,n,r,i,a,o,s){if(!e){var c;if(void 0===t)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=[n,r,i,a,o,s],u=0;(c=new Error(t.replace(/%s/g,function(){return l[u++]}))).name="Invariant Violation"}throw c.framesToPop=1,c}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let r="";t.setStaticURL=function(e){r=e},t.urlForFile=function(e){return`${r}/${e}`}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(6);t.PointerObserver=class{constructor(){this.onMouseDown=this.onMouseDown.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.reportTouch=this.reportTouch.bind(this),this.reportMouse=this.reportMouse.bind(this),this.onOrientationChange=this.onOrientationChange.bind(this)}startObserving(e,t,n){this.element||(this.element=e,this.callback=t,this.options=n,this.element.addEventListener("mousedown",this.onMouseDown),this.element.addEventListener("touchstart",this.onTouchStart))}stopObserving(){this.element&&(this.element.removeEventListener("mousedown",this.onMouseDown),this.element.removeEventListener("touchstart",this.onTouchStart))}onMouseDown(e){e.button>0||(e.preventDefault(),this.reportMouse(e,0),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("touchmove",this.onTouchMove),document.addEventListener("mouseup",this.onMouseUp),document.addEventListener("touchend",this.onTouchEnd))}onTouchStart(e){e.preventDefault(),void 0===this.currentTouchId&&(this.currentTouchId=e.changedTouches[0].identifier,this.reportTouch(e.changedTouches[0],0),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("touchmove",this.onTouchMove),document.addEventListener("mouseup",this.onMouseUp),document.addEventListener("touchend",this.onTouchEnd),window.addEventListener("orientationchange",this.onOrientationChange))}onMouseUp(e){e.button>0||(this.reportMouse(e,2),document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("touchend",this.onTouchEnd),this.clientRectCached=void 0)}onTouchEnd(e){const t=this.changedTouchWithId(e,this.currentTouchId);void 0!==t&&(this.reportTouch(t,2),this.cleanupAfterTouch())}onOrientationChange(){this.reportTouch({},2),this.cleanupAfterTouch()}cleanupAfterTouch(){document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("touchend",this.onTouchEnd),window.removeEventListener("orientationchange",this.onOrientationChange),this.clientRectCached=void 0,this.currentTouchId=void 0}onMouseMove(e){this.reportMouse(e,1)}onTouchMove(e){const t=this.changedTouchWithId(e,this.currentTouchId);void 0!==t&&this.reportTouch(t,1)}changedTouchWithId(e,t){for(const n of e.changedTouches)if(n.identifier===t)return n}reportTouch(e,t){if(2===t)return void this.callback({type:t,xPct:void 0!==this.lastX?this.lastX:0,yPct:void 0!==this.lastY?this.lastY:0,xDelta:0,yDelta:0});const n=this.clientRect(),i=e.clientX-n.left,a=e.clientY-n.top,o=i/n.width,s=a/n.height,c=this.options.clampX?r.clamp(o,0,1):o,l=this.options.clampY?r.clamp(s,0,1):s,u=this.lastX?c-this.lastX:0,h=this.lastY?l-this.lastY:0;this.lastX=c,this.lastY=l,this.callback({type:t,xPct:c,yPct:l,xDelta:u,yDelta:h})}reportMouse(e,t){const n=this.clientRect(),i=e.clientX-n.left,a=e.clientY-n.top,o=i/n.width,s=a/n.height,c=this.options.clampX?r.clamp(o,0,1):o,l=this.options.clampY?r.clamp(s,0,1):s,u=this.lastX?c-this.lastX:0,h=this.lastY?l-this.lastY:0;this.lastX=c,this.lastY=l,this.callback({type:t,xPct:c,yPct:l,xDelta:u,yDelta:h})}clientRect(){return void 0===this.clientRectCached&&(this.clientRectCached=this.element.getBoundingClientRect()),this.clientRectCached}}},function(e,t,n){"use strict";e.exports=function(e){return i.test("number"==typeof e?r(e):e.charAt(0))};var r=String.fromCharCode,i=/\s/},function(e,t,n){(function(n){var r,i,a,o={scope:{}};o.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){if(n.get||n.set)throw new TypeError("ES3 does not support getters and setters.");e!=Array.prototype&&e!=Object.prototype&&(e[t]=n.value)},o.getGlobal=function(e){return"undefined"!=typeof window&&window===e?e:void 0!==n&&null!=n?n:e},o.global=o.getGlobal(this),o.SYMBOL_PREFIX="jscomp_symbol_",o.initSymbol=function(){o.initSymbol=function(){},o.global.Symbol||(o.global.Symbol=o.Symbol)},o.symbolCounter_=0,o.Symbol=function(e){return o.SYMBOL_PREFIX+(e||"")+o.symbolCounter_++},o.initSymbolIterator=function(){o.initSymbol();var e=o.global.Symbol.iterator;e||(e=o.global.Symbol.iterator=o.global.Symbol("iterator")),"function"!=typeof Array.prototype[e]&&o.defineProperty(Array.prototype,e,{configurable:!0,writable:!0,value:function(){return o.arrayIterator(this)}}),o.initSymbolIterator=function(){}},o.arrayIterator=function(e){var t=0;return o.iteratorPrototype(function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}})},o.iteratorPrototype=function(e){return o.initSymbolIterator(),(e={next:e})[o.global.Symbol.iterator]=function(){return this},e},o.array=o.array||{},o.iteratorFromArray=function(e,t){o.initSymbolIterator(),e instanceof String&&(e+="");var n=0,r={next:function(){if(n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r.next=function(){return{done:!0,value:void 0}},r.next()}};return r[Symbol.iterator]=function(){return r},r},o.polyfill=function(e,t,n,r){if(t){for(n=o.global,e=e.split("."),r=0;r<e.length-1;r++){var i=e[r];i in n||(n[i]={}),n=n[i]}(t=t(r=n[e=e[e.length-1]]))!=r&&null!=t&&o.defineProperty(n,e,{configurable:!0,writable:!0,value:t})}},o.polyfill("Array.prototype.keys",function(e){return e||function(){return o.iteratorFromArray(this,function(e){return e})}},"es6-impl","es3");var s=this;i=[],void 0===(a="function"==typeof(r=function(){function e(e){if(!C.col(e))try{return document.querySelectorAll(e)}catch(e){}}function t(e,t){for(var n=e.length,r=2<=arguments.length?arguments[1]:void 0,i=[],a=0;a<n;a++)if(a in e){var o=e[a];t.call(r,o,a,e)&&i.push(o)}return i}function n(e){return e.reduce(function(e,t){return e.concat(C.arr(t)?n(t):t)},[])}function r(t){return C.arr(t)?t:(C.str(t)&&(t=e(t)||t),t instanceof NodeList||t instanceof HTMLCollection?[].slice.call(t):[t])}function i(e,t){return e.some(function(e){return e===t})}function a(e){var t,n={};for(t in e)n[t]=e[t];return n}function o(e,t){var n,r=a(e);for(n in e)r[n]=t.hasOwnProperty(n)?t[n]:e[n];return r}function c(e,t){var n,r=a(e);for(n in t)r[n]=C.und(e[n])?t[n]:e[n];return r}function l(e){if(e=/([\+\-]?[0-9#\.]+)(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(e))return e[2]}function u(e,t){return C.fnc(e)?e(t.target,t.id,t.total):e}function h(e,t){if(t in e.style)return getComputedStyle(e).getPropertyValue(t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase())||"0"}function p(e,t){return C.dom(e)&&i(O,t)?"transform":C.dom(e)&&(e.getAttribute(t)||C.svg(e)&&e[t])?"attribute":C.dom(e)&&"transform"!==t&&h(e,t)?"css":null!=e[t]?"object":void 0}function d(e,n){switch(p(e,n)){case"transform":return function(e,n){var r=function(e){return-1<e.indexOf("translate")||"perspective"===e?"px":-1<e.indexOf("rotate")||-1<e.indexOf("skew")?"deg":void 0}(n),r=-1<n.indexOf("scale")?1:0+r;if(!(e=e.style.transform))return r;for(var i=[],a=[],o=[],s=/(\w+)\((.+?)\)/g;i=s.exec(e);)a.push(i[1]),o.push(i[2]);return(e=t(o,function(e,t){return a[t]===n})).length?e[0]:r}(e,n);case"css":return h(e,n);case"attribute":return e.getAttribute(n)}return e[n]||0}function f(e,t){var n=/^(\*=|\+=|-=)/.exec(e);if(!n)return e;var r=l(e)||0;switch(t=parseFloat(t),e=parseFloat(e.replace(n[0],"")),n[0][0]){case"+":return t+e+r;case"-":return t-e+r;case"*":return t*e+r}}function m(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function g(e){e=e.points;for(var t,n=0,r=0;r<e.numberOfItems;r++){var i=e.getItem(r);0<r&&(n+=m(t,i)),t=i}return n}function v(e){if(e.getTotalLength)return e.getTotalLength();switch(e.tagName.toLowerCase()){case"circle":return 2*Math.PI*e.getAttribute("r");case"rect":return 2*e.getAttribute("width")+2*e.getAttribute("height");case"line":return m({x:e.getAttribute("x1"),y:e.getAttribute("y1")},{x:e.getAttribute("x2"),y:e.getAttribute("y2")});case"polyline":return g(e);case"polygon":var t=e.points;return g(e)+m(t.getItem(t.numberOfItems-1),t.getItem(0))}}function y(e,t){function n(n){return n=void 0===n?0:n,e.el.getPointAtLength(1<=t+n?t+n:0)}var r=n(),i=n(-1),a=n(1);switch(e.property){case"x":return r.x;case"y":return r.y;case"angle":return 180*Math.atan2(a.y-i.y,a.x-i.x)/Math.PI}}function b(e,t){var n,r=/-?\d*\.?\d+/g;if(n=C.pth(e)?e.totalLength:e,C.col(n))if(C.rgb(n)){var i=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(n);n=i?"rgba("+i[1]+",1)":n}else n=C.hex(n)?function(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(e,t,n,r){return t+t+n+n+r+r});var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);e=parseInt(t[1],16);var n=parseInt(t[2],16),t=parseInt(t[3],16);return"rgba("+e+","+n+","+t+",1)"}(n):C.hsl(n)?function(e){function t(e,t,n){return 0>n&&(n+=1),1<n&&--n,n<1/6?e+6*(t-e)*n:.5>n?t:n<2/3?e+(t-e)*(2/3-n)*6:e}var n=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(e)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(e);e=parseInt(n[1])/360;var r=parseInt(n[2])/100,i=parseInt(n[3])/100,n=n[4]||1;if(0==r)i=r=e=i;else{var a=.5>i?i*(1+r):i+r-i*r,o=2*i-a,i=t(o,a,e+1/3),r=t(o,a,e);e=t(o,a,e-1/3)}return"rgba("+255*i+","+255*r+","+255*e+","+n+")"}(n):void 0;else i=(i=l(n))?n.substr(0,n.length-i.length):n,n=t&&!/\s/g.test(n)?i+t:i;return{original:n+="",numbers:n.match(r)?n.match(r).map(Number):[0],strings:C.str(e)||t?n.split(r):[]}}function _(e){return t(e=e?n(C.arr(e)?e.map(r):r(e)):[],function(e,t,n){return n.indexOf(e)===t})}function w(e,t){var n=a(t);if(C.arr(e)){var i=e.length;2!==i||C.obj(e[0])?C.fnc(t.duration)||(n.duration=t.duration/i):e={value:e}}return r(e).map(function(e,n){return n=n?0:t.delay,e=C.obj(e)&&!C.pth(e)?e:{value:e},C.und(e.delay)&&(e.delay=n),e}).map(function(e){return c(e,n)})}function x(e,t){var n;return e.tweens.map(function(r){var i=(r=function(e,t){var n,r={};for(n in e){var i=u(e[n],t);C.arr(i)&&1===(i=i.map(function(e){return u(e,t)})).length&&(i=i[0]),r[n]=i}return r.duration=parseFloat(r.duration),r.delay=parseFloat(r.delay),r}(r,t)).value,a=d(t.target,e.name),o=n?n.to.original:a,o=C.arr(i)?i[0]:o,s=f(C.arr(i)?i[1]:i,o),a=l(s)||l(o)||l(a);return r.from=b(o,a),r.to=b(s,a),r.start=n?n.end:e.offset,r.end=r.start+r.delay+r.duration,r.easing=function(e){return C.arr(e)?R.apply(this,e):L[e]}(r.easing),r.elasticity=(1e3-Math.min(Math.max(r.elasticity,1),999))/1e3,r.isPath=C.pth(i),r.isColor=C.col(r.from.original),r.isColor&&(r.round=1),n=r})}function E(e,t,n,r){var i="delay"===e;return t.length?(i?Math.min:Math.max).apply(Math,t.map(function(t){return t[e]})):i?r.delay:n.offset+r.delay+r.duration}function M(e){var r,i=o(P,e),a=o(A,e),s=function(e){var t=_(e);return t.map(function(e,n){return{target:e,id:n,total:t.length}})}(e.targets),l=[],u=c(i,a);for(r in e)u.hasOwnProperty(r)||"targets"===r||l.push({name:r,offset:u.offset,tweens:w(e[r],a)});return e=function(e,r){return t(n(e.map(function(e){return r.map(function(t){var n=p(e.target,t.name);if(n){var r=x(t,e);t={type:n,property:t.name,animatable:e,tweens:r,duration:r[r.length-1].end,delay:r[0].delay}}else t=void 0;return t})})),function(e){return!C.und(e)})}(s,l),c(i,{children:[],animatables:s,animations:e,duration:E("duration",e,i,a),delay:E("delay",e,i,a)})}function S(e){function n(){return window.Promise&&new Promise(function(e){return p=e})}function r(e){return f.reversed?f.duration-e:e}function i(e){for(var n=0,r={},i=f.animations,a=i.length;n<a;){var o=i[n],s=o.animatable,c=o.tweens,l=c.length-1,u=c[l];l&&(u=t(c,function(t){return e<t.end})[0]||u);for(var c=Math.min(Math.max(e-u.start-u.delay,0),u.duration)/u.duration,p=isNaN(c)?1:u.easing(c,u.elasticity),c=u.to.strings,d=u.round,l=[],m=void 0,m=u.to.numbers.length,g=0;g<m;g++){var v=void 0,v=u.to.numbers[g],b=u.from.numbers[g],v=u.isPath?y(u.value,p*v):b+p*(v-b);d&&(u.isColor&&2<g||(v=Math.round(v*d)/d)),l.push(v)}if(u=c.length)for(m=c[0],p=0;p<u;p++)d=c[p+1],g=l[p],isNaN(g)||(m=d?m+(g+d):m+(g+" "));else m=l[0];I[o.type](s.target,o.property,m,r,s.id),o.currentValue=m,n++}if(n=Object.keys(r).length)for(i=0;i<n;i++)T||(T=h(document.body,"transform")?"transform":"-webkit-transform"),f.animatables[i].target.style[T]=r[i].join(" ");f.currentTime=e,f.progress=e/f.duration*100}function a(e){f[e]&&f[e](f)}function o(){f.remaining&&!0!==f.remaining&&f.remaining--}function s(e){var t=f.duration,s=f.offset,h=s+f.delay,m=f.currentTime,g=f.reversed,v=r(e);if(f.children.length){var y=f.children,b=y.length;if(v>=f.currentTime)for(var _=0;_<b;_++)y[_].seek(v);else for(;b--;)y[b].seek(v)}(v>=h||!t)&&(f.began||(f.began=!0,a("begin")),a("run")),v>s&&v<t?i(v):(v<=s&&0!==m&&(i(0),g&&o()),(v>=t&&m!==t||!t)&&(i(t),g||o())),a("update"),e>=t&&(f.remaining?(l=c,"alternate"===f.direction&&(f.reversed=!f.reversed)):(f.pause(),f.completed||(f.completed=!0,a("complete"),"Promise"in window&&(p(),d=n()))),u=0)}e=void 0===e?{}:e;var c,l,u=0,p=null,d=n(),f=M(e);return f.reset=function(){var e=f.direction,t=f.loop;for(f.currentTime=0,f.progress=0,f.paused=!0,f.began=!1,f.completed=!1,f.reversed="reverse"===e,f.remaining="alternate"===e&&1===t?2:t,i(0),e=f.children.length;e--;)f.children[e].reset()},f.tick=function(e){c=e,l||(l=c),s((u+c-l)*S.speed)},f.seek=function(e){s(r(e))},f.pause=function(){var e=k.indexOf(f);-1<e&&k.splice(e,1),f.paused=!0},f.play=function(){f.paused&&(f.paused=!1,l=0,u=r(f.currentTime),k.push(f),N||z())},f.reverse=function(){f.reversed=!f.reversed,l=0,u=r(f.currentTime)},f.restart=function(){f.pause(),f.reset(),f.play()},f.finished=d,f.reset(),f.autoplay&&f.play(),f}var T,P={update:void 0,begin:void 0,run:void 0,complete:void 0,loop:1,direction:"normal",autoplay:!0,offset:0},A={duration:1e3,delay:0,easing:"easeOutElastic",elasticity:500,round:0},O="translateX translateY translateZ rotate rotateX rotateY rotateZ scale scaleX scaleY scaleZ skewX skewY perspective".split(" "),C={arr:function(e){return Array.isArray(e)},obj:function(e){return-1<Object.prototype.toString.call(e).indexOf("Object")},pth:function(e){return C.obj(e)&&e.hasOwnProperty("totalLength")},svg:function(e){return e instanceof SVGElement},dom:function(e){return e.nodeType||C.svg(e)},str:function(e){return"string"==typeof e},fnc:function(e){return"function"==typeof e},und:function(e){return void 0===e},hex:function(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)},rgb:function(e){return/^rgb/.test(e)},hsl:function(e){return/^hsl/.test(e)},col:function(e){return C.hex(e)||C.rgb(e)||C.hsl(e)}},R=function(){function e(e,t,n){return(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e}return function(t,n,r,i){if(0<=t&&1>=t&&0<=r&&1>=r){var a=new Float32Array(11);if(t!==n||r!==i)for(var o=0;11>o;++o)a[o]=e(.1*o,t,r);return function(o){if(t===n&&r===i)return o;if(0===o)return 0;if(1===o)return 1;for(var s=0,c=1;10!==c&&a[c]<=o;++c)s+=.1;var c=s+(o-a[--c])/(a[c+1]-a[c])*.1,l=3*(1-3*r+3*t)*c*c+2*(3*r-6*t)*c+3*t;if(.001<=l){for(s=0;4>s&&0!=(l=3*(1-3*r+3*t)*c*c+2*(3*r-6*t)*c+3*t);++s)var u=e(c,t,r)-o,c=c-u/l;o=c}else if(0===l)o=c;else{var c=s,s=s+.1,h=0;do{0<(l=e(u=c+(s-c)/2,t,r)-o)?s=u:c=u}while(1e-7<Math.abs(l)&&10>++h);o=u}return e(o,n,i)}}}}(),L=function(){function e(e,t){return 0===e||1===e?e:-Math.pow(2,10*(e-1))*Math.sin(2*(e-1-t/(2*Math.PI)*Math.asin(1))*Math.PI/t)}var t,n="Quad Cubic Quart Quint Sine Expo Circ Back Elastic".split(" "),r={In:[[.55,.085,.68,.53],[.55,.055,.675,.19],[.895,.03,.685,.22],[.755,.05,.855,.06],[.47,0,.745,.715],[.95,.05,.795,.035],[.6,.04,.98,.335],[.6,-.28,.735,.045],e],Out:[[.25,.46,.45,.94],[.215,.61,.355,1],[.165,.84,.44,1],[.23,1,.32,1],[.39,.575,.565,1],[.19,1,.22,1],[.075,.82,.165,1],[.175,.885,.32,1.275],function(t,n){return 1-e(1-t,n)}],InOut:[[.455,.03,.515,.955],[.645,.045,.355,1],[.77,0,.175,1],[.86,0,.07,1],[.445,.05,.55,.95],[1,0,0,1],[.785,.135,.15,.86],[.68,-.55,.265,1.55],function(t,n){return.5>t?e(2*t,n)/2:1-e(-2*t+2,n)/2}]},i={linear:R(.25,.25,.75,.75)},a={};for(t in r)a.type=t,r[a.type].forEach(function(e){return function(t,r){i["ease"+e.type+n[r]]=C.fnc(t)?t:R.apply(s,t)}}(a)),a={type:a.type};return i}(),I={css:function(e,t,n){return e.style[t]=n},attribute:function(e,t,n){return e.setAttribute(t,n)},object:function(e,t,n){return e[t]=n},transform:function(e,t,n,r,i){r[i]||(r[i]=[]),r[i].push(t+"("+n+")")}},k=[],N=0,z=function(){function e(){N=requestAnimationFrame(t)}function t(t){var n=k.length;if(n){for(var r=0;r<n;)k[r]&&k[r].tick(t),r++;e()}else cancelAnimationFrame(N),N=0}return e}();return S.version="2.2.0",S.speed=1,S.running=k,S.remove=function(e){e=_(e);for(var t=k.length;t--;)for(var n=k[t],r=n.animations,a=r.length;a--;)i(e,r[a].animatable.target)&&(r.splice(a,1),r.length||n.pause())},S.getValue=d,S.path=function(t,n){var r=C.str(t)?e(t)[0]:t,i=n||100;return function(e){return{el:r,property:e,totalLength:v(r)*(i/100)}}},S.setDashoffset=function(e){var t=v(e);return e.setAttribute("stroke-dasharray",t),t},S.bezier=R,S.easings=L,S.timeline=function(e){var t=S(e);return t.pause(),t.duration=0,t.add=function(n){return t.children.forEach(function(e){e.began=!0,e.completed=!0}),r(n).forEach(function(n){var r=c(n,o(A,e||{}));r.targets=r.targets||e.targets,n=t.duration;var i=r.offset;r.autoplay=!1,r.direction=t.direction,r.offset=C.und(i)?n:f(i,n),t.began=!0,t.completed=!0,t.seek(r.offset),(r=S(r)).began=!0,r.completed=!0,r.duration>n&&(t.duration=r.duration),t.children.push(r)}),t.seek(0),t.reset(),t.autoplay&&t.restart(),t},t},S.random=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},S})?r.apply(t,i):r)||(e.exports=a)}).call(this,n(45))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(){this.subscriptions=[]}publish(e,t){this.subscriptions.filter(t=>t.type===e||"all"===t.type).forEach(e=>{e.callback(t)})}subscribe(e,t){this.subscriptions.push({type:e,callback:t})}unsubscribe(e,t){this.subscriptions=this.subscriptions.filter(n=>!(n.type===e&&n.callback===t))}}t.PubSub=r;const i=new r;t.subscribe=function(e,t){i.subscribe(e,t)},t.unsubscribe=function(e,t){i.unsubscribe(e,t)},t.publish=function(e,t){i.publish(e,t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0);t.AbletonLogo=class extends r.Component{render(){return r.createElement("svg",{className:"components_images__ableton-logo",viewBox:"0 0 45 21"},r.createElement("rect",{width:"3",height:"21"}),r.createElement("rect",{x:"6",width:"3",height:"21"}),r.createElement("rect",{x:"12",width:"3",height:"21"}),r.createElement("rect",{x:"18",width:"3",height:"21"}),r.createElement("rect",{x:"24",y:"18",width:"21",height:"3"}),r.createElement("rect",{x:"24",y:"12",width:"21",height:"3"}),r.createElement("rect",{x:"24",y:"6",width:"21",height:"3"}),r.createElement("rect",{x:"24",width:"21",height:"3"}))}};t.LessonTocMenuClosed=class extends r.Component{render(){return r.createElement("svg",{className:"icon menu rtl",viewBox:"0 0 29 29"},r.createElement("path",{d:"M5,9.0  L24,9.0"}),r.createElement("path",{d:"M5,14.5 L24,14.5"}),r.createElement("path",{d:"M5,20.0 L24,20.0"}))}};t.LessonTocMenuOpen=class extends r.Component{render(){return r.createElement("svg",{className:"icon close",viewBox:"0 0 29 29"},r.createElement("path",{d:"M8,21 L21,8"}),r.createElement("path",{d:"M8,8 L21,21"}))}};t.FootnoteCloseIcon=class extends r.Component{render(){return r.createElement("svg",{width:"16px",height:"16px",viewBox:"0 0 16 16"},r.createElement("path",{d:"M1.34170876,2.99162458 C0.886097082,2.5360129 0.886097082,1.79732043 1.34170876,1.34170876 C1.79732043,0.886097082 2.5360129,0.886097082 2.99162458,1.34170876 L14.6582912,13.0083754 C15.1139029,13.4639871 15.1139029,14.2026796 14.6582912,14.6582912 C14.2026796,15.1139029 13.4639871,15.1139029 13.0083754,14.6582912 L1.34170876,2.99162458 Z"}),r.createElement("path",{d:"M14.6582912,2.99162458 L2.99162458,14.6582912 C2.5360129,15.1139029 1.79732043,15.1139029 1.34170876,14.6582912 C0.886097082,14.2026796 0.886097082,13.4639871 1.34170876,13.0083754 L13.0083754,1.34170876 C13.4639871,0.886097082 14.2026796,0.886097082 14.6582912,1.34170876 C15.1139029,1.79732043 15.1139029,2.5360129 14.6582912,2.99162458 Z"}))}},t.PlayIcon=r.forwardRef((e,t)=>r.createElement("svg",{ref:t,className:"components_images__icon-play",width:"48px",height:"48px",viewBox:"0 0 48 48"},r.createElement("polygon",{points:"13 10 39 24 13 38"}))),t.StopIcon=r.forwardRef((e,t)=>r.createElement("svg",{ref:t,className:"components_images__icon-stop",width:"48px",height:"48px",viewBox:"0 0 48 48"},r.createElement("polygon",{points:"13 13 35 13 35 35 13 35"})));t.LFOWaveShapeSine=class extends r.Component{render(){return r.createElement("svg",{className:"lfo-wave-shape lfo-wave-shape-sine",viewBox:"0 0 64 64"},r.createElement("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M10,33.2068966 C13.3978466,19.0689655 17.0063122,12 20.8253968,12 C24.6444815,12 28.3693492,19.0689655 32,33.2068966 C36.0985182,46.4022989 40.0561901,53 43.8730159,53 C47.6898416,53 51.065503,46.4022989 54,33.2068966"}))}};t.LFOWaveShapeSquare=class extends r.Component{render(){return r.createElement("svg",{className:"lfo-wave-shape lfo-wave-shape-square",viewBox:"0 0 64 64"},r.createElement("polyline",{"stroke-linecap":"round","stroke-linejoin":"round",points:"10 13 32 13 32 52 54 52"}))}};t.LFOWaveShapeSaw=class extends r.Component{render(){return r.createElement("svg",{className:"lfo-wave-shape lfo-wave-shape-saw",viewBox:"0 0 64 64"},r.createElement("polyline",{"stroke-linecap":"round","stroke-linejoin":"round",points:"54 32 32 12 32 53 10 32"}))}};t.DownwardArrow=class extends r.Component{render(){return r.createElement("svg",{className:"downward_arrow",viewBox:"0 0 10 10"},r.createElement("polyline",{points:"1 5 5 9 9 5"}))}};t.ShareIcon=class extends r.Component{render(){return r.createElement("svg",{className:"share_icon",viewBox:"0 0 28 28"},r.createElement("polyline",{points:"5 17 5 24 23 24 23 17"}),r.createElement("path",{d:"M14,18 L14,6.5"}),r.createElement("polyline",{points:"9 9 14 4 19 9"}))}};t.LessonNextChapterArrow=class extends r.Component{render(){return r.createElement("svg",{className:"components_lesson-viewer__next-chapter-arrow",viewBox:"0 0 50 50"},r.createElement("polygon",{points:"36 24.5 27 14.5 23.75 14.5 31.5 23.25 13.5 23.25 13.5 25.75 31.5 25.75 23.75 34.5 27 34.5"}))}};t.LessonOvalBackground=class extends r.Component{render(){return r.createElement("svg",{className:"components_lesson-viewer__oval-background",viewBox:"0 0 50 50"},r.createElement("path",{d:"M23.1595144,-5.80393373e-16 L26.8404856,5.80393373e-16 C32.7804679,-5.10763662e-16 36.5091978,0.928256111 39.768457,2.67132704 C43.0277163,4.41439796 45.585602,6.97228371 47.328673,10.231543 C49.0717439,13.4908022 50,17.2195321 50,23.1595144 L50,26.8404856 C50,32.7804679 49.0717439,36.5091978 47.328673,39.768457 C45.585602,43.0277163 43.0277163,45.585602 39.768457,47.328673 C36.5091978,49.0717439 32.7804679,50 26.8404856,50 L23.1595144,50 C17.2195321,50 13.4908022,49.0717439 10.231543,47.328673 C6.97228371,45.585602 4.41439796,43.0277163 2.67132704,39.768457 C0.928256111,36.5091978 3.40509108e-16,32.7804679 -3.86928916e-16,26.8404856 L3.86928916e-16,23.1595144 C-3.40509108e-16,17.2195321 0.928256111,13.4908022 2.67132704,10.231543 C4.41439796,6.97228371 6.97228371,4.41439796 10.231543,2.67132704 C13.4908022,0.928256111 17.2195321,5.10763662e-16 23.1595144,-5.80393373e-16 Z"}))}};t.LessonPlayIcon=class extends r.Component{render(){return r.createElement("svg",{className:"components_lesson-viewer__icon-play",width:"50px",height:"50px",viewBox:"0 0 50 50"},r.createElement("polygon",{points:"18 13.5 40 25 18 36.5"}))}},t.LessonStopIcon=r.forwardRef((e,t)=>r.createElement("svg",{ref:t,className:"components_lesson-viewer__icon-stop",width:"50px",height:"50px",viewBox:"0 0 50 50"},r.createElement("polygon",{points:"17 17 33 17 33 33 17 33"})));t.PressIcon=class extends r.Component{render(){return r.createElement("svg",{className:"press_icon",viewBox:"0 0 50 50"},r.createElement("circle",{cx:25,cy:25,r:3}))}};t.PencilIcon=class extends r.Component{render(){return r.createElement("svg",{className:"pencil_icon",width:"48px",height:"48px",viewBox:"0 0 48 48"},r.createElement("polygon",{className:"outline",points:"18 6 31 6 31 39 24.5 48 18 39"}),r.createElement("ellipse",{className:"outline",cx:"24.5",cy:"5.5",rx:"6.5",ry:"5.5"}),r.createElement("rect",{className:"fill",x:"21",y:"7",width:"7",height:"31"}),r.createElement("circle",{className:"fill",cx:"24.5",cy:"7",r:"3.5"}))}};t.DirectionalArrowRight=class extends r.Component{render(){return r.createElement("svg",{className:"directional_arrow_right",viewBox:"0 0 48 48"},r.createElement("polygon",{points:"8 0 19 0 41 24 19 48 8 48 30 24"}))}};t.PresetsIcon=class extends r.Component{render(){return r.createElement("svg",{className:"presets-icon",viewBox:"0 0 50 50"},r.createElement("polygon",{points:"27 27 37 27 37 37 27 37"}),r.createElement("polygon",{points:"13 13 23 13 23 23 13 23"}),r.createElement("polygon",{points:"13 27 23 27 23 37 13 37"}),r.createElement("polygon",{points:"27 13 37 13 37 23 27 23"}))}};t.LFOPanelShapeSine=class extends r.Component{render(){return r.createElement("svg",{viewBox:"0 0 26 19"},r.createElement("path",{d:"M2,10.7931034 C3.69892328,4.93103448 5.50315608,2 7.41269841,2 C9.32224074,2 11.1846746,4.93103448 13,10.7931034 C15.0492591,16.2643678 17.0280951,19 18.9365079,19 C20.8449208,19 22.5327515,16.2643678 24,10.7931034"}))}};t.LFOPanelShapeSaw=class extends r.Component{render(){return r.createElement("svg",{viewBox:"0 0 26 19"},r.createElement("polyline",{points:"2 10.1594077 13 2 13 19 24 11.4033101"}))}};t.LFOPanelShapeSquare=class extends r.Component{render(){return r.createElement("svg",{viewBox:"0 0 26 19"},r.createElement("polyline",{points:"2 3 13 3 13 18 24 18"}))}};t.LFOPanelShapeSampleHold=class extends r.Component{render(){return r.createElement("svg",{viewBox:"0 0 26 19"},r.createElement("polyline",{points:"1 18 5 18 5 12 9 12 9 3 13 3 13 18 17 18 17 11 21 11 21 5 25 5"}))}}},function(e,t){e.exports=function(){for(var e={},t=0;t<arguments.length;t++){var r=arguments[t];for(var i in r)n.call(r,i)&&(e[i]=r[i])}return e};var n=Object.prototype.hasOwnProperty},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(4),a=n(54),o=n(10),s=n(37),c=n(16),l=n(55);t.NumberParameterSlider=class extends r.Component{constructor(e){super(e),this.animationFramer=new o.AnimationFramer,this.shouldSendNoteOff=!1,this.state={highlight:!1,modulatedControlValue:this.props.player.getParameterControlValue(this.props.paramName)},this.isModulated=this.props.player.isParameterModulationTarget(this.props.paramName),this.displayName=i.translated(`rnbo-test-instrument:parameter_names.${this.props.paramName}.label`),this.step=this.computeSliderStep(),this.fineStep=this.computeSliderFineStep(),this.updateModulationValue=this.updateModulationValue.bind(this),this.handleParameterInput=this.handleParameterInput.bind(this),this.onSliderChange=this.onSliderChange.bind(this),this.onReset=this.onReset.bind(this),this.onHighlightParamMessage=this.onHighlightParamMessage.bind(this)}render(){const e=this.props.player.getParameterByName(this.props.paramName),t=l.convertToControlValue(e.value,e);return r.createElement(s.SliderPad,{callback:this.onSliderChange,bipolar:a.isBipolar(e),resetCallback:this.onReset,step:this.step,fineStep:this.fineStep,targetValue:t,modulatedValue:this.isModulated?this.state.modulatedControlValue:void 0,labels:!0,labelName:this.displayName,labelValue:this.props.player.getParameterValueAsString(this.props.paramName),highlight:this.state.highlight})}componentDidMount(){this.isModulated&&this.animationFramer.startAnimating(this.updateModulationValue),this.props.player.addPlayerListener(this),c.subscribe("highlightParamMessage",this.onHighlightParamMessage)}componentWillUnmount(){this.animationFramer.stopAnimating(),this.props.player.removePlayerListener(this),c.unsubscribe("highlightParamMessage",this.onHighlightParamMessage)}onPresetEvent(e){this.forceUpdate()}onHighlightParamMessage(e){e.param===this.props.paramName&&this.setState({highlight:e.highlight})}onSliderChange(e){switch(this.props.player.setParameterControlValue(this.props.paramName,e.pctRaw),e.type){case 0:0===this.props.player.getHeldNotes().length?(this.shouldSendNoteOff=!0,c.publish("requestSharedSynthNoteOn",{noAdvance:!0})):this.shouldSendNoteOff=!1;break;case 1:break;case 2:this.shouldSendNoteOff&&c.publish("requestSharedSynthNoteOff",{noAdvance:!0})}this.forceUpdate()}onReset(){this.props.player.setParameterToDefaultValue(this.props.paramName),this.forceUpdate()}updateModulationValue(){const e=this.props.player.getModulatedParameterControlValue(this.props.paramName);e!==this.state.modulatedControlValue&&this.setState({modulatedControlValue:e})}handleParameterInput(e){this.props.player.setParameterControlValue(this.props.paramName,+e.target.value),this.forceUpdate()}computeSliderStep(){const e=this.props.player.getParameterByName(this.props.paramName);if(!e.unit)return.001;switch(e.unit.kind){case"pitch":return 1/(e.max-e.min);case"percent":return 1/(e.max-e.min)/100;default:return.001}}computeSliderFineStep(){const e=this.props.player.getParameterByName(this.props.paramName);if(!e.unit)return 1e-4;switch(e.unit.kind){case"pitch":return 1/(e.max-e.min)/100;case"percent":return 1/(e.max-e.min)/1e3;default:return 1e-4}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(59);t.ThemeContext=r.createContext({theme:{color:i.rgb(0,0,0),shade:i.rgb(0,0,0)},global:{foreground:i.rgb(0,0,0),background:i.rgb(0,0,0),shade:i.rgb(0,0,0)}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(6);function i(e){return e/2.5}t.cosinePolylinePoints=function(e,t,n,r,a,o){const s=t/2,c=r*i(t),l=2*Math.PI*a/e;let u="",h=n*Math.PI*2;for(let t=0;t<e;t++){const n=o?(p=t,d=e,Math.sin(Math.PI*p/d)):1;u+=`${t},${s-Math.cos(h)*c*n} `,h+=l}var p,d;return u},t.cosinePointAtPhase=function(e,t,n){const r=e/2,a=n*i(e);return r-Math.cos(t*Math.PI*2)*a},t.sawPolylinePoints=function(e,t,n,a,o){let s=n+1;const c=o/e;let l="";const u=t/2,h=a*i(t);for(let t=0;t<e;t++){const e=Math.abs(s)%1;l+=`${t},${u-h*r.mapNormalizedValueToRange(e,1,-1)} `,s+=c}return l},t.sawPointAtPhase=function(e,t,n){return e/2-r.mapNormalizedValueToRange(t,1,-1)*(n*i(e))},t.pulsePolylinePoints=function(e,t,n,a,o,s){const c=r.clamp(s,.01,.99);let l=n+1;const u=o/e;let h="";const p=t/2,d=a*i(t);for(let t=0;t<e;t++){const e=Math.abs(l)%1;h+=`${t},${p-r.mapNormalizedValueToRange(Math.round(e-(c-.5)),1,-1)*d} `,l+=u}return h},t.pulsePointAtPhase=function(e,t,n,a){return e/2-r.mapNormalizedValueToRange(Math.round(t-(a-.5)),1,-1)*(n*i(e))},t.sawPulseMixPolylinePoints=function(e,t,n,a,o,s,c){const l=r.clamp(s,.01,.99);let u=n+1;const h=o/e;let p="";const d=t/2,f=a*i(t);for(let t=0;t<e;t++){const e=Math.abs(u)%1;p+=`${t},${(d-r.mapNormalizedValueToRange(Math.round(e-(l-.5)),1,-1)*f)*(1-c)+(d-f*r.mapNormalizedValueToRange(e,1,-1))*c} `,u+=h}return p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(109);var i;!function(e){e[e.default=0]="default",e[e.rest=1]="rest",e[e.bd=2]="bd",e[e.sn=3]="sn",e[e.hh=4]="hh"}(i=t.Timbre||(t.Timbre={})),t.notationToMusicEvents=function(e){const t=[],n=r.parse(e);for(const e of n.voices){let r=0;for(const a of e){const e=a.rhythm*(60/n.header.tempo),o=r;for(const n of a.notes){const r=i[n.timbre],a=n.pitch;t.push({startTime:o,duration:e,timbre:r,pitch:a})}r+=e}}return t}},function(e,t){(t=e.exports=function(e){return e.replace(/^\s*|\s*$/g,"")}).left=function(e){return e.replace(/^\s*/,"")},t.right=function(e){return e.replace(/\s*$/,"")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(4);t.ButtonTooltip=class extends r.Component{constructor(e){super(e)}render(){return this.props.tooltipKey?r.createElement("div",{className:"button-tooltip"},r.createElement("div",{className:"button-tooltip__container"},r.createElement("h4",{className:"button-tooltip__label"},this.props.tooltipKey&&i.translated(this.props.tooltipKey)))):r.createElement(r.Fragment,null)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(8);let i="medium";const a="audioQuality";t.getAudioQualitySetting=function(){return i},t.setAudioQualitySetting=function(e){localStorage.setItem(a,e),location.reload()};let o="all";const s="midiInput";t.getMIDIInputSetting=function(){return o},t.setMIDIInputSetting=function(e){localStorage.setItem(s,e),location.reload()},t.init=function(){return new Promise((e,t)=>{const n=localStorage.getItem(a);switch(n){case"high":case"medium":case"low":i=n;break;default:i=r.browserSupportsAudioWorklet()?"high":"medium"}const c=localStorage.getItem(s);switch(c){case"none":o=c;break;default:o="all"}e()})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(128),a={link:n(208).CustomLink};t.renderMarkdown=function(e,t=""){return r.createElement(i,{className:t,source:e,renderers:a})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(6);t.ADSRHistory=class{constructor(){this.attack=0,this.decay=0,this.release=0,this.attackStartTime=void 0,this.releaseStartTime=void 0,this.attackPctAtRelease=0,this.decayPctAtRelease=0,this.sustainEnteredAtRelease=!1,this.finished=!1}setADR(e,t,n){this.attack=e,this.decay=t,this.release=n}startNote(e){this.attackStartTime=e,this.releaseStartTime=void 0,this.finished=!1,this.attackPctAtRelease=0,this.decayPctAtRelease=0,this.sustainEnteredAtRelease=!1}releaseNote(e){this.attackPctAtRelease=this.attackHistory(e),this.decayPctAtRelease=this.decayHistory(e),this.sustainEnteredAtRelease=this.sustainHistory(e),this.releaseStartTime=e}getHistory(e){return{attackPct:this.attackHistory(e),decayPct:this.decayHistory(e),sustain:this.sustainHistory(e),releasePct:this.releaseHistory(e)}}finish(){this.finished=!0}noteLength(){return void 0!==this.attackStartTime&&void 0!==this.releaseStartTime?this.releaseStartTime-this.attackStartTime:void 0}attackHistory(e){return this.finished?1:void 0===this.attackStartTime?0:0===this.attack?1:this.noteLength()?this.attackPctAtRelease:r.mapValueToRange(e-this.attackStartTime,0,this.attack,0,1)}decayHistory(e){return this.finished?1:void 0===this.attackStartTime?0:this.noteLength()?this.decayPctAtRelease:r.mapValueToRange(e-this.attackStartTime-this.attack,0,this.decay,0,1)}sustainHistory(e){return!!this.finished||void 0!==this.attackStartTime&&(this.noteLength()?this.sustainEnteredAtRelease:e-this.attackStartTime-(this.attack+this.decay)>0)}releaseHistory(e){return this.finished?1:void 0===this.releaseStartTime?0:r.mapValueToRange(e-this.releaseStartTime,0,this.release,0,1)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(10);t.AnimationFrameUpdater=class extends r.Component{constructor(e){super(e),this.animationFramer=new i.AnimationFramer,this.onAnimationFrame=this.onAnimationFrame.bind(this)}componentDidMount(){this.animationFramer.startAnimating(this.onAnimationFrame)}componentWillUnmount(){this.animationFramer.stopAnimating()}render(){return this.props.render()}onAnimationFrame(){this.forceUpdate()}}},function(e,t,n){"use strict";n.r(t);var r=n(7),i=n.n(r),a=n(0),o=n.n(a),s=n(2),c=n.n(s),l=n(9),u=n(11),h=n.n(u),p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var f=function(e){function t(){var n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,a=Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r=d(this,e.call.apply(e,[this].concat(a))),r.state={match:r.computeMatch(r.props.history.location.pathname)},d(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.getChildContext=function(){return{router:p({},this.context.router,{history:this.props.history,route:{location:this.props.history.location,match:this.state.match}})}},t.prototype.computeMatch=function(e){return{path:"/",url:"/",params:{},isExact:"/"===e}},t.prototype.componentWillMount=function(){var e=this,t=this.props,n=t.children,r=t.history;h()(null==n||1===o.a.Children.count(n),"A <Router> may have only one child element"),this.unlisten=r.listen(function(){e.setState({match:e.computeMatch(r.location.pathname)})})},t.prototype.componentWillReceiveProps=function(e){i()(this.props.history===e.history,"You cannot change <Router history>")},t.prototype.componentWillUnmount=function(){this.unlisten()},t.prototype.render=function(){var e=this.props.children;return e?o.a.Children.only(e):null},t}(o.a.Component);f.propTypes={history:c.a.object.isRequired,children:c.a.node},f.contextTypes={router:c.a.object},f.childContextTypes={router:c.a.object.isRequired};var m=f,g=m;function v(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var y=function(e){function t(){var n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,a=Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r=v(this,e.call.apply(e,[this].concat(a))),r.history=Object(l.createBrowserHistory)(r.props),v(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentWillMount=function(){i()(!this.props.history,"<BrowserRouter> ignores the history prop. To use a custom history, use `import { Router }` instead of `import { BrowserRouter as Router }`.")},t.prototype.render=function(){return o.a.createElement(g,{history:this.history,children:this.props.children})},t}(o.a.Component);y.propTypes={basename:c.a.string,forceRefresh:c.a.bool,getUserConfirmation:c.a.func,keyLength:c.a.number,children:c.a.node};var b=y;function _(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var w=function(e){function t(){var n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,a=Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r=_(this,e.call.apply(e,[this].concat(a))),r.history=Object(l.createHashHistory)(r.props),_(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentWillMount=function(){i()(!this.props.history,"<HashRouter> ignores the history prop. To use a custom history, use `import { Router }` instead of `import { HashRouter as Router }`.")},t.prototype.render=function(){return o.a.createElement(g,{history:this.history,children:this.props.children})},t}(o.a.Component);w.propTypes={basename:c.a.string,getUserConfirmation:c.a.func,hashType:c.a.oneOf(["hashbang","noslash","slash"]),children:c.a.node};var x=w,E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function M(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var S=function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)},T=function(e){function t(){var n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,a=Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r=M(this,e.call.apply(e,[this].concat(a))),r.handleClick=function(e){if(r.props.onClick&&r.props.onClick(e),!e.defaultPrevented&&0===e.button&&!r.props.target&&!S(e)){e.preventDefault();var t=r.context.router.history,n=r.props,i=n.replace,a=n.to;i?t.replace(a):t.push(a)}},M(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.render=function(){var e=this.props,t=(e.replace,e.to),n=e.innerRef,r=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(e,["replace","to","innerRef"]);h()(this.context.router,"You should not use <Link> outside a <Router>"),h()(void 0!==t,'You must specify the "to" property');var i=this.context.router.history,a="string"==typeof t?Object(l.createLocation)(t,null,null,i.location):t,s=i.createHref(a);return o.a.createElement("a",E({},r,{onClick:this.handleClick,href:s,ref:n}))},t}(o.a.Component);T.propTypes={onClick:c.a.func,target:c.a.string,replace:c.a.bool,to:c.a.oneOfType([c.a.string,c.a.object]).isRequired,innerRef:c.a.oneOfType([c.a.string,c.a.func])},T.defaultProps={replace:!1},T.contextTypes={router:c.a.shape({history:c.a.shape({push:c.a.func.isRequired,replace:c.a.func.isRequired,createHref:c.a.func.isRequired}).isRequired}).isRequired};var P=T;function A(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var O=function(e){function t(){var n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,a=Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r=A(this,e.call.apply(e,[this].concat(a))),r.history=Object(l.createMemoryHistory)(r.props),A(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentWillMount=function(){i()(!this.props.history,"<MemoryRouter> ignores the history prop. To use a custom history, use `import { Router }` instead of `import { MemoryRouter as Router }`.")},t.prototype.render=function(){return o.a.createElement(m,{history:this.history,children:this.props.children})},t}(o.a.Component);O.propTypes={initialEntries:c.a.array,initialIndex:c.a.number,getUserConfirmation:c.a.func,keyLength:c.a.number,children:c.a.node};var C=O,R=n(41),L=n.n(R),I={},k=0,N=function(e,t){var n=""+t.end+t.strict+t.sensitive,r=I[n]||(I[n]={});if(r[e])return r[e];var i=[],a={re:L()(e,i,t),keys:i};return k<1e4&&(r[e]=a,k++),a},z=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments[2];"string"==typeof t&&(t={path:t});var r=t,i=r.path,a=r.exact,o=void 0!==a&&a,s=r.strict,c=void 0!==s&&s,l=r.sensitive,u=void 0!==l&&l;if(null==i)return n;var h=N(i,{end:o,strict:c,sensitive:u}),p=h.re,d=h.keys,f=p.exec(e);if(!f)return null;var m=f[0],g=f.slice(1),v=e===m;return o&&!v?null:{path:i,url:"/"===i&&""===m?"/":m,isExact:v,params:d.reduce(function(e,t,n){return e[t.name]=g[n],e},{})}},D=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function B(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var j=function(e){return 0===o.a.Children.count(e)},F=function(e){function t(){var n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,a=Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r=B(this,e.call.apply(e,[this].concat(a))),r.state={match:r.computeMatch(r.props,r.context.router)},B(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.getChildContext=function(){return{router:D({},this.context.router,{route:{location:this.props.location||this.context.router.route.location,match:this.state.match}})}},t.prototype.computeMatch=function(e,t){var n=e.computedMatch,r=e.location,i=e.path,a=e.strict,o=e.exact,s=e.sensitive;if(n)return n;h()(t,"You should not use <Route> or withRouter() outside a <Router>");var c=t.route,l=(r||c.location).pathname;return z(l,{path:i,strict:a,exact:o,sensitive:s},c.match)},t.prototype.componentWillMount=function(){i()(!(this.props.component&&this.props.render),"You should not use <Route component> and <Route render> in the same route; <Route render> will be ignored"),i()(!(this.props.component&&this.props.children&&!j(this.props.children)),"You should not use <Route component> and <Route children> in the same route; <Route children> will be ignored"),i()(!(this.props.render&&this.props.children&&!j(this.props.children)),"You should not use <Route render> and <Route children> in the same route; <Route children> will be ignored")},t.prototype.componentWillReceiveProps=function(e,t){i()(!(e.location&&!this.props.location),'<Route> elements should not change from uncontrolled to controlled (or vice versa). You initially used no "location" prop and then provided one on a subsequent render.'),i()(!(!e.location&&this.props.location),'<Route> elements should not change from controlled to uncontrolled (or vice versa). You provided a "location" prop initially but omitted it on a subsequent render.'),this.setState({match:this.computeMatch(e,t.router)})},t.prototype.render=function(){var e=this.state.match,t=this.props,n=t.children,r=t.component,i=t.render,a=this.context.router,s=a.history,c=a.route,l=a.staticContext,u={match:e,location:this.props.location||c.location,history:s,staticContext:l};return r?e?o.a.createElement(r,u):null:i?e?i(u):null:"function"==typeof n?n(u):n&&!j(n)?o.a.Children.only(n):null},t}(o.a.Component);F.propTypes={computedMatch:c.a.object,path:c.a.string,exact:c.a.bool,strict:c.a.bool,sensitive:c.a.bool,component:c.a.func,render:c.a.func,children:c.a.oneOfType([c.a.func,c.a.node]),location:c.a.object},F.contextTypes={router:c.a.shape({history:c.a.object.isRequired,route:c.a.object.isRequired,staticContext:c.a.object})},F.childContextTypes={router:c.a.object.isRequired};var U=F,V=U,H=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var W=function(e){var t=e.to,n=e.exact,r=e.strict,i=e.location,a=e.activeClassName,s=e.className,c=e.activeStyle,l=e.style,u=e.isActive,h=e["aria-current"],p=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(e,["to","exact","strict","location","activeClassName","className","activeStyle","style","isActive","aria-current"]),d="object"===(void 0===t?"undefined":G(t))?t.pathname:t,f=d&&d.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1");return o.a.createElement(V,{path:f,exact:n,strict:r,location:i,children:function(e){var n=e.location,r=e.match,i=!!(u?u(r,n):r);return o.a.createElement(P,H({to:t,className:i?[s,a].filter(function(e){return e}).join(" "):s,style:i?H({},l,c):l,"aria-current":i&&h||null},p))}})};W.propTypes={to:P.propTypes.to,exact:c.a.bool,strict:c.a.bool,location:c.a.object,activeClassName:c.a.string,className:c.a.string,activeStyle:c.a.object,style:c.a.object,isActive:c.a.func,"aria-current":c.a.oneOf(["page","step","location","date","time","true"])},W.defaultProps={activeClassName:"active","aria-current":"page"};var q=W;var X=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.enable=function(e){this.unblock&&this.unblock(),this.unblock=this.context.router.history.block(e)},t.prototype.disable=function(){this.unblock&&(this.unblock(),this.unblock=null)},t.prototype.componentWillMount=function(){h()(this.context.router,"You should not use <Prompt> outside a <Router>"),this.props.when&&this.enable(this.props.message)},t.prototype.componentWillReceiveProps=function(e){e.when?this.props.when&&this.props.message===e.message||this.enable(e.message):this.disable()},t.prototype.componentWillUnmount=function(){this.disable()},t.prototype.render=function(){return null},t}(o.a.Component);X.propTypes={when:c.a.bool,message:c.a.oneOfType([c.a.func,c.a.string]).isRequired},X.defaultProps={when:!0},X.contextTypes={router:c.a.shape({history:c.a.shape({block:c.a.func.isRequired}).isRequired}).isRequired};var Y=X,K={},$=0,Z=function(e){var t=e,n=K[t]||(K[t]={});if(n[e])return n[e];var r=L.a.compile(e);return $<1e4&&(n[e]=r,$++),r},J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("/"===e)return e;var n=Z(e);return n(t,{pretty:!0})},Q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var ee=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.isStatic=function(){return this.context.router&&this.context.router.staticContext},t.prototype.componentWillMount=function(){h()(this.context.router,"You should not use <Redirect> outside a <Router>"),this.isStatic()&&this.perform()},t.prototype.componentDidMount=function(){this.isStatic()||this.perform()},t.prototype.componentDidUpdate=function(e){var t=Object(l.createLocation)(e.to),n=Object(l.createLocation)(this.props.to);Object(l.locationsAreEqual)(t,n)?i()(!1,"You tried to redirect to the same route you're currently on: \""+n.pathname+n.search+'"'):this.perform()},t.prototype.computeTo=function(e){var t=e.computedMatch,n=e.to;return t?"string"==typeof n?J(n,t.params):Q({},n,{pathname:J(n.pathname,t.params)}):n},t.prototype.perform=function(){var e=this.context.router.history,t=this.props.push,n=this.computeTo(this.props);t?e.push(n):e.replace(n)},t.prototype.render=function(){return null},t}(o.a.Component);ee.propTypes={computedMatch:c.a.object,push:c.a.bool,from:c.a.string,to:c.a.oneOfType([c.a.string,c.a.object]).isRequired},ee.defaultProps={push:!1},ee.contextTypes={router:c.a.shape({history:c.a.shape({push:c.a.func.isRequired,replace:c.a.func.isRequired}).isRequired,staticContext:c.a.object}).isRequired};var te=ee,ne=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function re(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var ie=function(e){return"/"===e.charAt(0)?e:"/"+e},ae=function(e,t){return e?ne({},t,{pathname:ie(e)+t.pathname}):t},oe=function(e,t){if(!e)return t;var n=ie(e);return 0!==t.pathname.indexOf(n)?t:ne({},t,{pathname:t.pathname.substr(n.length)})},se=function(e){return"string"==typeof e?e:Object(l.createPath)(e)},ce=function(e){return function(){h()(!1,"You cannot %s with <StaticRouter>",e)}},le=function(){},ue=function(e){function t(){var n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,a=Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r=re(this,e.call.apply(e,[this].concat(a))),r.createHref=function(e){return ie(r.props.basename+se(e))},r.handlePush=function(e){var t=r.props,n=t.basename,i=t.context;i.action="PUSH",i.location=ae(n,Object(l.createLocation)(e)),i.url=se(i.location)},r.handleReplace=function(e){var t=r.props,n=t.basename,i=t.context;i.action="REPLACE",i.location=ae(n,Object(l.createLocation)(e)),i.url=se(i.location)},r.handleListen=function(){return le},r.handleBlock=function(){return le},re(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.getChildContext=function(){return{router:{staticContext:this.props.context}}},t.prototype.componentWillMount=function(){i()(!this.props.history,"<StaticRouter> ignores the history prop. To use a custom history, use `import { Router }` instead of `import { StaticRouter as Router }`.")},t.prototype.render=function(){var e=this.props,t=e.basename,n=(e.context,e.location),r=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(e,["basename","context","location"]),i={createHref:this.createHref,action:"POP",location:oe(t,Object(l.createLocation)(n)),push:this.handlePush,replace:this.handleReplace,go:ce("go"),goBack:ce("goBack"),goForward:ce("goForward"),listen:this.handleListen,block:this.handleBlock};return o.a.createElement(m,ne({},r,{history:i}))},t}(o.a.Component);ue.propTypes={basename:c.a.string,context:c.a.object.isRequired,location:c.a.oneOfType([c.a.string,c.a.object])},ue.defaultProps={basename:"",location:"/"},ue.childContextTypes={router:c.a.object.isRequired};var he=ue;var pe=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentWillMount=function(){h()(this.context.router,"You should not use <Switch> outside a <Router>")},t.prototype.componentWillReceiveProps=function(e){i()(!(e.location&&!this.props.location),'<Switch> elements should not change from uncontrolled to controlled (or vice versa). You initially used no "location" prop and then provided one on a subsequent render.'),i()(!(!e.location&&this.props.location),'<Switch> elements should not change from controlled to uncontrolled (or vice versa). You provided a "location" prop initially but omitted it on a subsequent render.')},t.prototype.render=function(){var e=this.context.router.route,t=this.props.children,n=this.props.location||e.location,r=void 0,i=void 0;return o.a.Children.forEach(t,function(t){if(null==r&&o.a.isValidElement(t)){var a=t.props,s=a.path,c=a.exact,l=a.strict,u=a.sensitive,h=a.from,p=s||h;i=t,r=z(n.pathname,{path:p,exact:c,strict:l,sensitive:u},e.match)}}),r?o.a.cloneElement(i,{location:n,computedMatch:r}):null},t}(o.a.Component);pe.contextTypes={router:c.a.shape({route:c.a.object.isRequired}).isRequired},pe.propTypes={children:c.a.node,location:c.a.object};var de=pe,fe=J,me=z,ge=n(99),ve=n.n(ge),ye=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var be=function(e){var t=function(t){var n=t.wrappedComponentRef,r=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(t,["wrappedComponentRef"]);return o.a.createElement(U,{children:function(t){return o.a.createElement(e,ye({},r,t,{ref:n}))}})};return t.displayName="withRouter("+(e.displayName||e.name)+")",t.WrappedComponent=e,t.propTypes={wrappedComponentRef:c.a.func},ve()(t,e)};n.d(t,"BrowserRouter",function(){return b}),n.d(t,"HashRouter",function(){return x}),n.d(t,"Link",function(){return P}),n.d(t,"MemoryRouter",function(){return C}),n.d(t,"NavLink",function(){return q}),n.d(t,"Prompt",function(){return Y}),n.d(t,"Redirect",function(){return te}),n.d(t,"Route",function(){return V}),n.d(t,"Router",function(){return g}),n.d(t,"StaticRouter",function(){return he}),n.d(t,"Switch",function(){return de}),n.d(t,"generatePath",function(){return fe}),n.d(t,"matchPath",function(){return me}),n.d(t,"withRouter",function(){return be})},function(e,t){e.exports=ReactDOM},function(e,t,n){"use strict";function r(){return"undefined"!=typeof window}Object.defineProperty(t,"__esModule",{value:!0}),t.isRunningInBrowser=r,t.isRunningInFirefox=function(){return r()&&navigator.userAgent.toLowerCase().indexOf("firefox")>-1},t.isRunningOnIPhone=function(){return/iPhone/.test(navigator.userAgent)&&!window.MSStream},t.isRunningLocally=function(){return r()&&("localhost"===location.hostname||"127.0.0.1"===location.hostname)}},function(e,t,n){t.__esModule=!0,t.Helmet=void 0;var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=h(n(0)),o=h(n(2)),s=h(n(119)),c=h(n(122)),l=n(123),u=n(64);function h(e){return e&&e.__esModule?e:{default:e}}function p(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}var d,f,m,g=(0,s.default)(l.reducePropsToState,l.handleClientStateChange,l.mapStateOnServer)(function(){return null}),v=(d=g,m=f=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.shouldComponentUpdate=function(e){return!(0,c.default)(this.props,e)},t.prototype.mapNestedChildrenToProps=function(e,t){if(!t)return null;switch(e.type){case u.TAG_NAMES.SCRIPT:case u.TAG_NAMES.NOSCRIPT:return{innerHTML:t};case u.TAG_NAMES.STYLE:return{cssText:t}}throw new Error("<"+e.type+" /> elements are self-closing and can not contain children. Refer to our API for more information.")},t.prototype.flattenArrayTypeChildren=function(e){var t,n=e.child,i=e.arrayTypeChildren,a=e.newChildProps,o=e.nestedChildren;return r({},i,((t={})[n.type]=[].concat(i[n.type]||[],[r({},a,this.mapNestedChildrenToProps(n,o))]),t))},t.prototype.mapObjectTypeChildren=function(e){var t,n,i=e.child,a=e.newProps,o=e.newChildProps,s=e.nestedChildren;switch(i.type){case u.TAG_NAMES.TITLE:return r({},a,((t={})[i.type]=s,t.titleAttributes=r({},o),t));case u.TAG_NAMES.BODY:return r({},a,{bodyAttributes:r({},o)});case u.TAG_NAMES.HTML:return r({},a,{htmlAttributes:r({},o)})}return r({},a,((n={})[i.type]=r({},o),n))},t.prototype.mapArrayTypeChildrenToProps=function(e,t){var n=r({},t);return Object.keys(e).forEach(function(t){var i;n=r({},n,((i={})[t]=e[t],i))}),n},t.prototype.warnOnInvalidChildren=function(e,t){return!0},t.prototype.mapChildrenToProps=function(e,t){var n=this,r={};return a.default.Children.forEach(e,function(e){if(e&&e.props){var i=e.props,a=i.children,o=p(i,["children"]),s=(0,l.convertReactPropstoHtmlAttributes)(o);switch(n.warnOnInvalidChildren(e,a),e.type){case u.TAG_NAMES.LINK:case u.TAG_NAMES.META:case u.TAG_NAMES.NOSCRIPT:case u.TAG_NAMES.SCRIPT:case u.TAG_NAMES.STYLE:r=n.flattenArrayTypeChildren({child:e,arrayTypeChildren:r,newChildProps:s,nestedChildren:a});break;default:t=n.mapObjectTypeChildren({child:e,newProps:t,newChildProps:s,nestedChildren:a})}}}),t=this.mapArrayTypeChildrenToProps(r,t)},t.prototype.render=function(){var e=this.props,t=e.children,n=p(e,["children"]),i=r({},n);return t&&(i=this.mapChildrenToProps(t,i)),a.default.createElement(d,i)},i(t,null,[{key:"canUseDOM",set:function(e){d.canUseDOM=e}}]),t}(a.default.Component),f.propTypes={base:o.default.object,bodyAttributes:o.default.object,children:o.default.oneOfType([o.default.arrayOf(o.default.node),o.default.node]),defaultTitle:o.default.string,defer:o.default.bool,encodeSpecialCharacters:o.default.bool,htmlAttributes:o.default.object,link:o.default.arrayOf(o.default.object),meta:o.default.arrayOf(o.default.object),noscript:o.default.arrayOf(o.default.object),onChangeClientState:o.default.func,script:o.default.arrayOf(o.default.object),style:o.default.arrayOf(o.default.object),title:o.default.string,titleAttributes:o.default.object,titleTemplate:o.default.string},f.defaultProps={defer:!0,encodeSpecialCharacters:!0},f.peek=d.peek,f.rewind=function(){var e=d.rewind();return e||(e=(0,l.mapStateOnServer)({baseTag:[],bodyAttributes:{},encodeSpecialCharacters:!0,htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}})),e},m);v.renderStatic=v.rewind,t.Helmet=v,t.default=v},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0);t.PageContext=r.createContext({id:"",name:"",chunks:[]})},function(e,t,n){(function(e,r){var i;
/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(){var a,o=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",c="Expected a function",l="__lodash_hash_undefined__",u=500,h="__lodash_placeholder__",p=1,d=2,f=4,m=1,g=2,v=1,y=2,b=4,_=8,w=16,x=32,E=64,M=128,S=256,T=512,P=30,A="...",O=800,C=16,R=1,L=2,I=1/0,k=9007199254740991,N=17976931348623157e292,z=NaN,D=4294967295,B=D-1,j=D>>>1,F=[["ary",M],["bind",v],["bindKey",y],["curry",_],["curryRight",w],["flip",T],["partial",x],["partialRight",E],["rearg",S]],U="[object Arguments]",V="[object Array]",H="[object AsyncFunction]",G="[object Boolean]",W="[object Date]",q="[object DOMException]",X="[object Error]",Y="[object Function]",K="[object GeneratorFunction]",$="[object Map]",Z="[object Number]",J="[object Null]",Q="[object Object]",ee="[object Proxy]",te="[object RegExp]",ne="[object Set]",re="[object String]",ie="[object Symbol]",ae="[object Undefined]",oe="[object WeakMap]",se="[object WeakSet]",ce="[object ArrayBuffer]",le="[object DataView]",ue="[object Float32Array]",he="[object Float64Array]",pe="[object Int8Array]",de="[object Int16Array]",fe="[object Int32Array]",me="[object Uint8Array]",ge="[object Uint8ClampedArray]",ve="[object Uint16Array]",ye="[object Uint32Array]",be=/\b__p \+= '';/g,_e=/\b(__p \+=) '' \+/g,we=/(__e\(.*?\)|\b__t\)) \+\n'';/g,xe=/&(?:amp|lt|gt|quot|#39);/g,Ee=/[&<>"']/g,Me=RegExp(xe.source),Se=RegExp(Ee.source),Te=/<%-([\s\S]+?)%>/g,Pe=/<%([\s\S]+?)%>/g,Ae=/<%=([\s\S]+?)%>/g,Oe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ce=/^\w*$/,Re=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Le=/[\\^$.*+?()[\]{}|]/g,Ie=RegExp(Le.source),ke=/^\s+|\s+$/g,Ne=/^\s+/,ze=/\s+$/,De=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Be=/\{\n\/\* \[wrapped with (.+)\] \*/,je=/,? & /,Fe=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ue=/\\(\\)?/g,Ve=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,He=/\w*$/,Ge=/^[-+]0x[0-9a-f]+$/i,We=/^0b[01]+$/i,qe=/^\[object .+?Constructor\]$/,Xe=/^0o[0-7]+$/i,Ye=/^(?:0|[1-9]\d*)$/,Ke=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,$e=/($^)/,Ze=/['\n\r\u2028\u2029\\]/g,Je="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Qe="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",et="[\\ud800-\\udfff]",tt="["+Qe+"]",nt="["+Je+"]",rt="\\d+",it="[\\u2700-\\u27bf]",at="[a-z\\xdf-\\xf6\\xf8-\\xff]",ot="[^\\ud800-\\udfff"+Qe+rt+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",st="\\ud83c[\\udffb-\\udfff]",ct="[^\\ud800-\\udfff]",lt="(?:\\ud83c[\\udde6-\\uddff]){2}",ut="[\\ud800-\\udbff][\\udc00-\\udfff]",ht="[A-Z\\xc0-\\xd6\\xd8-\\xde]",pt="(?:"+at+"|"+ot+")",dt="(?:"+ht+"|"+ot+")",ft="(?:"+nt+"|"+st+")"+"?",mt="[\\ufe0e\\ufe0f]?"+ft+("(?:\\u200d(?:"+[ct,lt,ut].join("|")+")[\\ufe0e\\ufe0f]?"+ft+")*"),gt="(?:"+[it,lt,ut].join("|")+")"+mt,vt="(?:"+[ct+nt+"?",nt,lt,ut,et].join("|")+")",yt=RegExp("[']","g"),bt=RegExp(nt,"g"),_t=RegExp(st+"(?="+st+")|"+vt+mt,"g"),wt=RegExp([ht+"?"+at+"+(?:['](?:d|ll|m|re|s|t|ve))?(?="+[tt,ht,"$"].join("|")+")",dt+"+(?:['](?:D|LL|M|RE|S|T|VE))?(?="+[tt,ht+pt,"$"].join("|")+")",ht+"?"+pt+"+(?:['](?:d|ll|m|re|s|t|ve))?",ht+"+(?:['](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",rt,gt].join("|"),"g"),xt=RegExp("[\\u200d\\ud800-\\udfff"+Je+"\\ufe0e\\ufe0f]"),Et=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Mt=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],St=-1,Tt={};Tt[ue]=Tt[he]=Tt[pe]=Tt[de]=Tt[fe]=Tt[me]=Tt[ge]=Tt[ve]=Tt[ye]=!0,Tt[U]=Tt[V]=Tt[ce]=Tt[G]=Tt[le]=Tt[W]=Tt[X]=Tt[Y]=Tt[$]=Tt[Z]=Tt[Q]=Tt[te]=Tt[ne]=Tt[re]=Tt[oe]=!1;var Pt={};Pt[U]=Pt[V]=Pt[ce]=Pt[le]=Pt[G]=Pt[W]=Pt[ue]=Pt[he]=Pt[pe]=Pt[de]=Pt[fe]=Pt[$]=Pt[Z]=Pt[Q]=Pt[te]=Pt[ne]=Pt[re]=Pt[ie]=Pt[me]=Pt[ge]=Pt[ve]=Pt[ye]=!0,Pt[X]=Pt[Y]=Pt[oe]=!1;var At={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ot=parseFloat,Ct=parseInt,Rt="object"==typeof e&&e&&e.Object===Object&&e,Lt="object"==typeof self&&self&&self.Object===Object&&self,It=Rt||Lt||Function("return this")(),kt=t&&!t.nodeType&&t,Nt=kt&&"object"==typeof r&&r&&!r.nodeType&&r,zt=Nt&&Nt.exports===kt,Dt=zt&&Rt.process,Bt=function(){try{var e=Nt&&Nt.require&&Nt.require("util").types;return e||Dt&&Dt.binding&&Dt.binding("util")}catch(e){}}(),jt=Bt&&Bt.isArrayBuffer,Ft=Bt&&Bt.isDate,Ut=Bt&&Bt.isMap,Vt=Bt&&Bt.isRegExp,Ht=Bt&&Bt.isSet,Gt=Bt&&Bt.isTypedArray;function Wt(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function qt(e,t,n,r){for(var i=-1,a=null==e?0:e.length;++i<a;){var o=e[i];t(r,o,n(o),e)}return r}function Xt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function Yt(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function Kt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function $t(e,t){for(var n=-1,r=null==e?0:e.length,i=0,a=[];++n<r;){var o=e[n];t(o,n,e)&&(a[i++]=o)}return a}function Zt(e,t){return!!(null==e?0:e.length)&&cn(e,t,0)>-1}function Jt(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}function Qt(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function en(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function tn(e,t,n,r){var i=-1,a=null==e?0:e.length;for(r&&a&&(n=e[++i]);++i<a;)n=t(n,e[i],i,e);return n}function nn(e,t,n,r){var i=null==e?0:e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n}function rn(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var an=pn("length");function on(e,t,n){var r;return n(e,function(e,n,i){if(t(e,n,i))return r=n,!1}),r}function sn(e,t,n,r){for(var i=e.length,a=n+(r?1:-1);r?a--:++a<i;)if(t(e[a],a,e))return a;return-1}function cn(e,t,n){return t==t?function(e,t,n){var r=n-1,i=e.length;for(;++r<i;)if(e[r]===t)return r;return-1}(e,t,n):sn(e,un,n)}function ln(e,t,n,r){for(var i=n-1,a=e.length;++i<a;)if(r(e[i],t))return i;return-1}function un(e){return e!=e}function hn(e,t){var n=null==e?0:e.length;return n?mn(e,t)/n:z}function pn(e){return function(t){return null==t?a:t[e]}}function dn(e){return function(t){return null==e?a:e[t]}}function fn(e,t,n,r,i){return i(e,function(e,i,a){n=r?(r=!1,e):t(n,e,i,a)}),n}function mn(e,t){for(var n,r=-1,i=e.length;++r<i;){var o=t(e[r]);o!==a&&(n=n===a?o:n+o)}return n}function gn(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function vn(e){return function(t){return e(t)}}function yn(e,t){return Qt(t,function(t){return e[t]})}function bn(e,t){return e.has(t)}function _n(e,t){for(var n=-1,r=e.length;++n<r&&cn(t,e[n],0)>-1;);return n}function wn(e,t){for(var n=e.length;n--&&cn(t,e[n],0)>-1;);return n}var xn=dn({"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss","":"A","":"A","":"A","":"a","":"a","":"a","":"C","":"C","":"C","":"C","":"c","":"c","":"c","":"c","":"D","":"D","":"d","":"d","":"E","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"e","":"G","":"G","":"G","":"G","":"g","":"g","":"g","":"g","":"H","":"H","":"h","":"h","":"I","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"i","":"J","":"j","":"K","":"k","":"k","":"L","":"L","":"L","":"L","":"L","":"l","":"l","":"l","":"l","":"l","":"N","":"N","":"N","":"N","":"n","":"n","":"n","":"n","":"O","":"O","":"O","":"o","":"o","":"o","":"R","":"R","":"R","":"r","":"r","":"r","":"S","":"S","":"S","":"S","":"s","":"s","":"s","":"s","":"T","":"T","":"T","":"t","":"t","":"t","":"U","":"U","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"u","":"u","":"W","":"w","":"Y","":"y","":"Y","":"Z","":"Z","":"Z","":"z","":"z","":"z","":"IJ","":"ij","":"Oe","":"oe","":"'n","":"s"}),En=dn({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Mn(e){return"\\"+At[e]}function Sn(e){return xt.test(e)}function Tn(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}function Pn(e,t){return function(n){return e(t(n))}}function An(e,t){for(var n=-1,r=e.length,i=0,a=[];++n<r;){var o=e[n];o!==t&&o!==h||(e[n]=h,a[i++]=n)}return a}function On(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}function Cn(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=[e,e]}),n}function Rn(e){return Sn(e)?function(e){var t=_t.lastIndex=0;for(;_t.test(e);)++t;return t}(e):an(e)}function Ln(e){return Sn(e)?function(e){return e.match(_t)||[]}(e):function(e){return e.split("")}(e)}var In=dn({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var kn=function e(t){var n,r=(t=null==t?It:kn.defaults(It.Object(),t,kn.pick(It,Mt))).Array,i=t.Date,Je=t.Error,Qe=t.Function,et=t.Math,tt=t.Object,nt=t.RegExp,rt=t.String,it=t.TypeError,at=r.prototype,ot=Qe.prototype,st=tt.prototype,ct=t["__core-js_shared__"],lt=ot.toString,ut=st.hasOwnProperty,ht=0,pt=(n=/[^.]+$/.exec(ct&&ct.keys&&ct.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",dt=st.toString,ft=lt.call(tt),mt=It._,gt=nt("^"+lt.call(ut).replace(Le,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),vt=zt?t.Buffer:a,_t=t.Symbol,xt=t.Uint8Array,At=vt?vt.allocUnsafe:a,Rt=Pn(tt.getPrototypeOf,tt),Lt=tt.create,kt=st.propertyIsEnumerable,Nt=at.splice,Dt=_t?_t.isConcatSpreadable:a,Bt=_t?_t.iterator:a,an=_t?_t.toStringTag:a,dn=function(){try{var e=Ba(tt,"defineProperty");return e({},"",{}),e}catch(e){}}(),Nn=t.clearTimeout!==It.clearTimeout&&t.clearTimeout,zn=i&&i.now!==It.Date.now&&i.now,Dn=t.setTimeout!==It.setTimeout&&t.setTimeout,Bn=et.ceil,jn=et.floor,Fn=tt.getOwnPropertySymbols,Un=vt?vt.isBuffer:a,Vn=t.isFinite,Hn=at.join,Gn=Pn(tt.keys,tt),Wn=et.max,qn=et.min,Xn=i.now,Yn=t.parseInt,Kn=et.random,$n=at.reverse,Zn=Ba(t,"DataView"),Jn=Ba(t,"Map"),Qn=Ba(t,"Promise"),er=Ba(t,"Set"),tr=Ba(t,"WeakMap"),nr=Ba(tt,"create"),rr=tr&&new tr,ir={},ar=uo(Zn),or=uo(Jn),sr=uo(Qn),cr=uo(er),lr=uo(tr),ur=_t?_t.prototype:a,hr=ur?ur.valueOf:a,pr=ur?ur.toString:a;function dr(e){if(As(e)&&!vs(e)&&!(e instanceof vr)){if(e instanceof gr)return e;if(ut.call(e,"__wrapped__"))return ho(e)}return new gr(e)}var fr=function(){function e(){}return function(t){if(!Ps(t))return{};if(Lt)return Lt(t);e.prototype=t;var n=new e;return e.prototype=a,n}}();function mr(){}function gr(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=a}function vr(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=D,this.__views__=[]}function yr(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function br(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function _r(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function wr(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new _r;++t<n;)this.add(e[t])}function xr(e){var t=this.__data__=new br(e);this.size=t.size}function Er(e,t){var n=vs(e),r=!n&&gs(e),i=!n&&!r&&ws(e),a=!n&&!r&&!i&&zs(e),o=n||r||i||a,s=o?gn(e.length,rt):[],c=s.length;for(var l in e)!t&&!ut.call(e,l)||o&&("length"==l||i&&("offset"==l||"parent"==l)||a&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||Wa(l,c))||s.push(l);return s}function Mr(e){var t=e.length;return t?e[wi(0,t-1)]:a}function Sr(e,t){return so(na(e),kr(t,0,e.length))}function Tr(e){return so(na(e))}function Pr(e,t,n){(n===a||ds(e[t],n))&&(n!==a||t in e)||Lr(e,t,n)}function Ar(e,t,n){var r=e[t];ut.call(e,t)&&ds(r,n)&&(n!==a||t in e)||Lr(e,t,n)}function Or(e,t){for(var n=e.length;n--;)if(ds(e[n][0],t))return n;return-1}function Cr(e,t,n,r){return jr(e,function(e,i,a){t(r,e,n(e),a)}),r}function Rr(e,t){return e&&ra(t,ic(t),e)}function Lr(e,t,n){"__proto__"==t&&dn?dn(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function Ir(e,t){for(var n=-1,i=t.length,o=r(i),s=null==e;++n<i;)o[n]=s?a:Qs(e,t[n]);return o}function kr(e,t,n){return e==e&&(n!==a&&(e=e<=n?e:n),t!==a&&(e=e>=t?e:t)),e}function Nr(e,t,n,r,i,o){var s,c=t&p,l=t&d,u=t&f;if(n&&(s=i?n(e,r,i,o):n(e)),s!==a)return s;if(!Ps(e))return e;var h=vs(e);if(h){if(s=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&ut.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!c)return na(e,s)}else{var m=Ua(e),g=m==Y||m==K;if(ws(e))return $i(e,c);if(m==Q||m==U||g&&!i){if(s=l||g?{}:Ha(e),!c)return l?function(e,t){return ra(e,Fa(e),t)}(e,function(e,t){return e&&ra(t,ac(t),e)}(s,e)):function(e,t){return ra(e,ja(e),t)}(e,Rr(s,e))}else{if(!Pt[m])return i?e:{};s=function(e,t,n){var r,i=e.constructor;switch(t){case ce:return Zi(e);case G:case W:return new i(+e);case le:return function(e,t){var n=t?Zi(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case ue:case he:case pe:case de:case fe:case me:case ge:case ve:case ye:return Ji(e,n);case $:return new i;case Z:case re:return new i(e);case te:return function(e){var t=new e.constructor(e.source,He.exec(e));return t.lastIndex=e.lastIndex,t}(e);case ne:return new i;case ie:return r=e,hr?tt(hr.call(r)):{}}}(e,m,c)}}o||(o=new xr);var v=o.get(e);if(v)return v;o.set(e,s),Is(e)?e.forEach(function(r){s.add(Nr(r,t,n,r,e,o))}):Os(e)&&e.forEach(function(r,i){s.set(i,Nr(r,t,n,i,e,o))});var y=h?a:(u?l?Ra:Ca:l?ac:ic)(e);return Xt(y||e,function(r,i){y&&(r=e[i=r]),Ar(s,i,Nr(r,t,n,i,e,o))}),s}function zr(e,t,n){var r=n.length;if(null==e)return!r;for(e=tt(e);r--;){var i=n[r],o=t[i],s=e[i];if(s===a&&!(i in e)||!o(s))return!1}return!0}function Dr(e,t,n){if("function"!=typeof e)throw new it(c);return ro(function(){e.apply(a,n)},t)}function Br(e,t,n,r){var i=-1,a=Zt,s=!0,c=e.length,l=[],u=t.length;if(!c)return l;n&&(t=Qt(t,vn(n))),r?(a=Jt,s=!1):t.length>=o&&(a=bn,s=!1,t=new wr(t));e:for(;++i<c;){var h=e[i],p=null==n?h:n(h);if(h=r||0!==h?h:0,s&&p==p){for(var d=u;d--;)if(t[d]===p)continue e;l.push(h)}else a(t,p,r)||l.push(h)}return l}dr.templateSettings={escape:Te,evaluate:Pe,interpolate:Ae,variable:"",imports:{_:dr}},dr.prototype=mr.prototype,dr.prototype.constructor=dr,gr.prototype=fr(mr.prototype),gr.prototype.constructor=gr,vr.prototype=fr(mr.prototype),vr.prototype.constructor=vr,yr.prototype.clear=function(){this.__data__=nr?nr(null):{},this.size=0},yr.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},yr.prototype.get=function(e){var t=this.__data__;if(nr){var n=t[e];return n===l?a:n}return ut.call(t,e)?t[e]:a},yr.prototype.has=function(e){var t=this.__data__;return nr?t[e]!==a:ut.call(t,e)},yr.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=nr&&t===a?l:t,this},br.prototype.clear=function(){this.__data__=[],this.size=0},br.prototype.delete=function(e){var t=this.__data__,n=Or(t,e);return!(n<0||(n==t.length-1?t.pop():Nt.call(t,n,1),--this.size,0))},br.prototype.get=function(e){var t=this.__data__,n=Or(t,e);return n<0?a:t[n][1]},br.prototype.has=function(e){return Or(this.__data__,e)>-1},br.prototype.set=function(e,t){var n=this.__data__,r=Or(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},_r.prototype.clear=function(){this.size=0,this.__data__={hash:new yr,map:new(Jn||br),string:new yr}},_r.prototype.delete=function(e){var t=za(this,e).delete(e);return this.size-=t?1:0,t},_r.prototype.get=function(e){return za(this,e).get(e)},_r.prototype.has=function(e){return za(this,e).has(e)},_r.prototype.set=function(e,t){var n=za(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},wr.prototype.add=wr.prototype.push=function(e){return this.__data__.set(e,l),this},wr.prototype.has=function(e){return this.__data__.has(e)},xr.prototype.clear=function(){this.__data__=new br,this.size=0},xr.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},xr.prototype.get=function(e){return this.__data__.get(e)},xr.prototype.has=function(e){return this.__data__.has(e)},xr.prototype.set=function(e,t){var n=this.__data__;if(n instanceof br){var r=n.__data__;if(!Jn||r.length<o-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new _r(r)}return n.set(e,t),this.size=n.size,this};var jr=oa(Xr),Fr=oa(Yr,!0);function Ur(e,t){var n=!0;return jr(e,function(e,r,i){return n=!!t(e,r,i)}),n}function Vr(e,t,n){for(var r=-1,i=e.length;++r<i;){var o=e[r],s=t(o);if(null!=s&&(c===a?s==s&&!Ns(s):n(s,c)))var c=s,l=o}return l}function Hr(e,t){var n=[];return jr(e,function(e,r,i){t(e,r,i)&&n.push(e)}),n}function Gr(e,t,n,r,i){var a=-1,o=e.length;for(n||(n=Ga),i||(i=[]);++a<o;){var s=e[a];t>0&&n(s)?t>1?Gr(s,t-1,n,r,i):en(i,s):r||(i[i.length]=s)}return i}var Wr=sa(),qr=sa(!0);function Xr(e,t){return e&&Wr(e,t,ic)}function Yr(e,t){return e&&qr(e,t,ic)}function Kr(e,t){return $t(t,function(t){return Ms(e[t])})}function $r(e,t){for(var n=0,r=(t=qi(t,e)).length;null!=e&&n<r;)e=e[lo(t[n++])];return n&&n==r?e:a}function Zr(e,t,n){var r=t(e);return vs(e)?r:en(r,n(e))}function Jr(e){return null==e?e===a?ae:J:an&&an in tt(e)?function(e){var t=ut.call(e,an),n=e[an];try{e[an]=a;var r=!0}catch(e){}var i=dt.call(e);return r&&(t?e[an]=n:delete e[an]),i}(e):function(e){return dt.call(e)}(e)}function Qr(e,t){return e>t}function ei(e,t){return null!=e&&ut.call(e,t)}function ti(e,t){return null!=e&&t in tt(e)}function ni(e,t,n){for(var i=n?Jt:Zt,o=e[0].length,s=e.length,c=s,l=r(s),u=1/0,h=[];c--;){var p=e[c];c&&t&&(p=Qt(p,vn(t))),u=qn(p.length,u),l[c]=!n&&(t||o>=120&&p.length>=120)?new wr(c&&p):a}p=e[0];var d=-1,f=l[0];e:for(;++d<o&&h.length<u;){var m=p[d],g=t?t(m):m;if(m=n||0!==m?m:0,!(f?bn(f,g):i(h,g,n))){for(c=s;--c;){var v=l[c];if(!(v?bn(v,g):i(e[c],g,n)))continue e}f&&f.push(g),h.push(m)}}return h}function ri(e,t,n){var r=null==(e=eo(e,t=qi(t,e)))?e:e[lo(Eo(t))];return null==r?a:Wt(r,e,n)}function ii(e){return As(e)&&Jr(e)==U}function ai(e,t,n,r,i){return e===t||(null==e||null==t||!As(e)&&!As(t)?e!=e&&t!=t:function(e,t,n,r,i,o){var s=vs(e),c=vs(t),l=s?V:Ua(e),u=c?V:Ua(t),h=(l=l==U?Q:l)==Q,p=(u=u==U?Q:u)==Q,d=l==u;if(d&&ws(e)){if(!ws(t))return!1;s=!0,h=!1}if(d&&!h)return o||(o=new xr),s||zs(e)?Aa(e,t,n,r,i,o):function(e,t,n,r,i,a,o){switch(n){case le:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case ce:return!(e.byteLength!=t.byteLength||!a(new xt(e),new xt(t)));case G:case W:case Z:return ds(+e,+t);case X:return e.name==t.name&&e.message==t.message;case te:case re:return e==t+"";case $:var s=Tn;case ne:var c=r&m;if(s||(s=On),e.size!=t.size&&!c)return!1;var l=o.get(e);if(l)return l==t;r|=g,o.set(e,t);var u=Aa(s(e),s(t),r,i,a,o);return o.delete(e),u;case ie:if(hr)return hr.call(e)==hr.call(t)}return!1}(e,t,l,n,r,i,o);if(!(n&m)){var f=h&&ut.call(e,"__wrapped__"),v=p&&ut.call(t,"__wrapped__");if(f||v){var y=f?e.value():e,b=v?t.value():t;return o||(o=new xr),i(y,b,n,r,o)}}return!!d&&(o||(o=new xr),function(e,t,n,r,i,o){var s=n&m,c=Ca(e),l=c.length,u=Ca(t).length;if(l!=u&&!s)return!1;for(var h=l;h--;){var p=c[h];if(!(s?p in t:ut.call(t,p)))return!1}var d=o.get(e);if(d&&o.get(t))return d==t;var f=!0;o.set(e,t),o.set(t,e);for(var g=s;++h<l;){p=c[h];var v=e[p],y=t[p];if(r)var b=s?r(y,v,p,t,e,o):r(v,y,p,e,t,o);if(!(b===a?v===y||i(v,y,n,r,o):b)){f=!1;break}g||(g="constructor"==p)}if(f&&!g){var _=e.constructor,w=t.constructor;_!=w&&"constructor"in e&&"constructor"in t&&!("function"==typeof _&&_ instanceof _&&"function"==typeof w&&w instanceof w)&&(f=!1)}return o.delete(e),o.delete(t),f}(e,t,n,r,i,o))}(e,t,n,r,ai,i))}function oi(e,t,n,r){var i=n.length,o=i,s=!r;if(null==e)return!o;for(e=tt(e);i--;){var c=n[i];if(s&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++i<o;){var l=(c=n[i])[0],u=e[l],h=c[1];if(s&&c[2]){if(u===a&&!(l in e))return!1}else{var p=new xr;if(r)var d=r(u,h,l,e,t,p);if(!(d===a?ai(h,u,m|g,r,p):d))return!1}}return!0}function si(e){return!(!Ps(e)||(t=e,pt&&pt in t))&&(Ms(e)?gt:qe).test(uo(e));var t}function ci(e){return"function"==typeof e?e:null==e?Cc:"object"==typeof e?vs(e)?fi(e[0],e[1]):di(e):jc(e)}function li(e){if(!$a(e))return Gn(e);var t=[];for(var n in tt(e))ut.call(e,n)&&"constructor"!=n&&t.push(n);return t}function ui(e){if(!Ps(e))return function(e){var t=[];if(null!=e)for(var n in tt(e))t.push(n);return t}(e);var t=$a(e),n=[];for(var r in e)("constructor"!=r||!t&&ut.call(e,r))&&n.push(r);return n}function hi(e,t){return e<t}function pi(e,t){var n=-1,i=bs(e)?r(e.length):[];return jr(e,function(e,r,a){i[++n]=t(e,r,a)}),i}function di(e){var t=Da(e);return 1==t.length&&t[0][2]?Ja(t[0][0],t[0][1]):function(n){return n===e||oi(n,e,t)}}function fi(e,t){return Xa(e)&&Za(t)?Ja(lo(e),t):function(n){var r=Qs(n,e);return r===a&&r===t?ec(n,e):ai(t,r,m|g)}}function mi(e,t,n,r,i){e!==t&&Wr(t,function(o,s){if(i||(i=new xr),Ps(o))!function(e,t,n,r,i,o,s){var c=to(e,n),l=to(t,n),u=s.get(l);if(u)Pr(e,n,u);else{var h=o?o(c,l,n+"",e,t,s):a,p=h===a;if(p){var d=vs(l),f=!d&&ws(l),m=!d&&!f&&zs(l);h=l,d||f||m?vs(c)?h=c:_s(c)?h=na(c):f?(p=!1,h=$i(l,!0)):m?(p=!1,h=Ji(l,!0)):h=[]:Rs(l)||gs(l)?(h=c,gs(c)?h=Gs(c):Ps(c)&&!Ms(c)||(h=Ha(l))):p=!1}p&&(s.set(l,h),i(h,l,r,o,s),s.delete(l)),Pr(e,n,h)}}(e,t,s,n,mi,r,i);else{var c=r?r(to(e,s),o,s+"",e,t,i):a;c===a&&(c=o),Pr(e,s,c)}},ac)}function gi(e,t){var n=e.length;if(n)return Wa(t+=t<0?n:0,n)?e[t]:a}function vi(e,t,n){var r=-1;return t=Qt(t.length?t:[Cc],vn(Na())),function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(pi(e,function(e,n,i){return{criteria:Qt(t,function(t){return t(e)}),index:++r,value:e}}),function(e,t){return function(e,t,n){for(var r=-1,i=e.criteria,a=t.criteria,o=i.length,s=n.length;++r<o;){var c=Qi(i[r],a[r]);if(c){if(r>=s)return c;var l=n[r];return c*("desc"==l?-1:1)}}return e.index-t.index}(e,t,n)})}function yi(e,t,n){for(var r=-1,i=t.length,a={};++r<i;){var o=t[r],s=$r(e,o);n(s,o)&&Ti(a,qi(o,e),s)}return a}function bi(e,t,n,r){var i=r?ln:cn,a=-1,o=t.length,s=e;for(e===t&&(t=na(t)),n&&(s=Qt(e,vn(n)));++a<o;)for(var c=0,l=t[a],u=n?n(l):l;(c=i(s,u,c,r))>-1;)s!==e&&Nt.call(s,c,1),Nt.call(e,c,1);return e}function _i(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==a){var a=i;Wa(i)?Nt.call(e,i,1):Bi(e,i)}}return e}function wi(e,t){return e+jn(Kn()*(t-e+1))}function xi(e,t){var n="";if(!e||t<1||t>k)return n;do{t%2&&(n+=e),(t=jn(t/2))&&(e+=e)}while(t);return n}function Ei(e,t){return io(Qa(e,t,Cc),e+"")}function Mi(e){return Mr(dc(e))}function Si(e,t){var n=dc(e);return so(n,kr(t,0,n.length))}function Ti(e,t,n,r){if(!Ps(e))return e;for(var i=-1,o=(t=qi(t,e)).length,s=o-1,c=e;null!=c&&++i<o;){var l=lo(t[i]),u=n;if(i!=s){var h=c[l];(u=r?r(h,l,c):a)===a&&(u=Ps(h)?h:Wa(t[i+1])?[]:{})}Ar(c,l,u),c=c[l]}return e}var Pi=rr?function(e,t){return rr.set(e,t),e}:Cc,Ai=dn?function(e,t){return dn(e,"toString",{configurable:!0,enumerable:!1,value:Pc(t),writable:!0})}:Cc;function Oi(e){return so(dc(e))}function Ci(e,t,n){var i=-1,a=e.length;t<0&&(t=-t>a?0:a+t),(n=n>a?a:n)<0&&(n+=a),a=t>n?0:n-t>>>0,t>>>=0;for(var o=r(a);++i<a;)o[i]=e[i+t];return o}function Ri(e,t){var n;return jr(e,function(e,r,i){return!(n=t(e,r,i))}),!!n}function Li(e,t,n){var r=0,i=null==e?r:e.length;if("number"==typeof t&&t==t&&i<=j){for(;r<i;){var a=r+i>>>1,o=e[a];null!==o&&!Ns(o)&&(n?o<=t:o<t)?r=a+1:i=a}return i}return Ii(e,t,Cc,n)}function Ii(e,t,n,r){t=n(t);for(var i=0,o=null==e?0:e.length,s=t!=t,c=null===t,l=Ns(t),u=t===a;i<o;){var h=jn((i+o)/2),p=n(e[h]),d=p!==a,f=null===p,m=p==p,g=Ns(p);if(s)var v=r||m;else v=u?m&&(r||d):c?m&&d&&(r||!f):l?m&&d&&!f&&(r||!g):!f&&!g&&(r?p<=t:p<t);v?i=h+1:o=h}return qn(o,B)}function ki(e,t){for(var n=-1,r=e.length,i=0,a=[];++n<r;){var o=e[n],s=t?t(o):o;if(!n||!ds(s,c)){var c=s;a[i++]=0===o?0:o}}return a}function Ni(e){return"number"==typeof e?e:Ns(e)?z:+e}function zi(e){if("string"==typeof e)return e;if(vs(e))return Qt(e,zi)+"";if(Ns(e))return pr?pr.call(e):"";var t=e+"";return"0"==t&&1/e==-I?"-0":t}function Di(e,t,n){var r=-1,i=Zt,a=e.length,s=!0,c=[],l=c;if(n)s=!1,i=Jt;else if(a>=o){var u=t?null:xa(e);if(u)return On(u);s=!1,i=bn,l=new wr}else l=t?[]:c;e:for(;++r<a;){var h=e[r],p=t?t(h):h;if(h=n||0!==h?h:0,s&&p==p){for(var d=l.length;d--;)if(l[d]===p)continue e;t&&l.push(p),c.push(h)}else i(l,p,n)||(l!==c&&l.push(p),c.push(h))}return c}function Bi(e,t){return null==(e=eo(e,t=qi(t,e)))||delete e[lo(Eo(t))]}function ji(e,t,n,r){return Ti(e,t,n($r(e,t)),r)}function Fi(e,t,n,r){for(var i=e.length,a=r?i:-1;(r?a--:++a<i)&&t(e[a],a,e););return n?Ci(e,r?0:a,r?a+1:i):Ci(e,r?a+1:0,r?i:a)}function Ui(e,t){var n=e;return n instanceof vr&&(n=n.value()),tn(t,function(e,t){return t.func.apply(t.thisArg,en([e],t.args))},n)}function Vi(e,t,n){var i=e.length;if(i<2)return i?Di(e[0]):[];for(var a=-1,o=r(i);++a<i;)for(var s=e[a],c=-1;++c<i;)c!=a&&(o[a]=Br(o[a]||s,e[c],t,n));return Di(Gr(o,1),t,n)}function Hi(e,t,n){for(var r=-1,i=e.length,o=t.length,s={};++r<i;){var c=r<o?t[r]:a;n(s,e[r],c)}return s}function Gi(e){return _s(e)?e:[]}function Wi(e){return"function"==typeof e?e:Cc}function qi(e,t){return vs(e)?e:Xa(e,t)?[e]:co(Ws(e))}var Xi=Ei;function Yi(e,t,n){var r=e.length;return n=n===a?r:n,!t&&n>=r?e:Ci(e,t,n)}var Ki=Nn||function(e){return It.clearTimeout(e)};function $i(e,t){if(t)return e.slice();var n=e.length,r=At?At(n):new e.constructor(n);return e.copy(r),r}function Zi(e){var t=new e.constructor(e.byteLength);return new xt(t).set(new xt(e)),t}function Ji(e,t){var n=t?Zi(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Qi(e,t){if(e!==t){var n=e!==a,r=null===e,i=e==e,o=Ns(e),s=t!==a,c=null===t,l=t==t,u=Ns(t);if(!c&&!u&&!o&&e>t||o&&s&&l&&!c&&!u||r&&s&&l||!n&&l||!i)return 1;if(!r&&!o&&!u&&e<t||u&&n&&i&&!r&&!o||c&&n&&i||!s&&i||!l)return-1}return 0}function ea(e,t,n,i){for(var a=-1,o=e.length,s=n.length,c=-1,l=t.length,u=Wn(o-s,0),h=r(l+u),p=!i;++c<l;)h[c]=t[c];for(;++a<s;)(p||a<o)&&(h[n[a]]=e[a]);for(;u--;)h[c++]=e[a++];return h}function ta(e,t,n,i){for(var a=-1,o=e.length,s=-1,c=n.length,l=-1,u=t.length,h=Wn(o-c,0),p=r(h+u),d=!i;++a<h;)p[a]=e[a];for(var f=a;++l<u;)p[f+l]=t[l];for(;++s<c;)(d||a<o)&&(p[f+n[s]]=e[a++]);return p}function na(e,t){var n=-1,i=e.length;for(t||(t=r(i));++n<i;)t[n]=e[n];return t}function ra(e,t,n,r){var i=!n;n||(n={});for(var o=-1,s=t.length;++o<s;){var c=t[o],l=r?r(n[c],e[c],c,n,e):a;l===a&&(l=e[c]),i?Lr(n,c,l):Ar(n,c,l)}return n}function ia(e,t){return function(n,r){var i=vs(n)?qt:Cr,a=t?t():{};return i(n,e,Na(r,2),a)}}function aa(e){return Ei(function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:a,s=i>2?n[2]:a;for(o=e.length>3&&"function"==typeof o?(i--,o):a,s&&qa(n[0],n[1],s)&&(o=i<3?a:o,i=1),t=tt(t);++r<i;){var c=n[r];c&&e(t,c,r,o)}return t})}function oa(e,t){return function(n,r){if(null==n)return n;if(!bs(n))return e(n,r);for(var i=n.length,a=t?i:-1,o=tt(n);(t?a--:++a<i)&&!1!==r(o[a],a,o););return n}}function sa(e){return function(t,n,r){for(var i=-1,a=tt(t),o=r(t),s=o.length;s--;){var c=o[e?s:++i];if(!1===n(a[c],c,a))break}return t}}function ca(e){return function(t){var n=Sn(t=Ws(t))?Ln(t):a,r=n?n[0]:t.charAt(0),i=n?Yi(n,1).join(""):t.slice(1);return r[e]()+i}}function la(e){return function(t){return tn(Mc(gc(t).replace(yt,"")),e,"")}}function ua(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=fr(e.prototype),r=e.apply(n,t);return Ps(r)?r:n}}function ha(e){return function(t,n,r){var i=tt(t);if(!bs(t)){var o=Na(n,3);t=ic(t),n=function(e){return o(i[e],e,i)}}var s=e(t,n,r);return s>-1?i[o?t[s]:s]:a}}function pa(e){return Oa(function(t){var n=t.length,r=n,i=gr.prototype.thru;for(e&&t.reverse();r--;){var o=t[r];if("function"!=typeof o)throw new it(c);if(i&&!s&&"wrapper"==Ia(o))var s=new gr([],!0)}for(r=s?r:n;++r<n;){var l=Ia(o=t[r]),u="wrapper"==l?La(o):a;s=u&&Ya(u[0])&&u[1]==(M|_|x|S)&&!u[4].length&&1==u[9]?s[Ia(u[0])].apply(s,u[3]):1==o.length&&Ya(o)?s[l]():s.thru(o)}return function(){var e=arguments,r=e[0];if(s&&1==e.length&&vs(r))return s.plant(r).value();for(var i=0,a=n?t[i].apply(this,e):r;++i<n;)a=t[i].call(this,a);return a}})}function da(e,t,n,i,o,s,c,l,u,h){var p=t&M,d=t&v,f=t&y,m=t&(_|w),g=t&T,b=f?a:ua(e);return function v(){for(var y=arguments.length,_=r(y),w=y;w--;)_[w]=arguments[w];if(m)var x=ka(v),E=function(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}(_,x);if(i&&(_=ea(_,i,o,m)),s&&(_=ta(_,s,c,m)),y-=E,m&&y<h){var M=An(_,x);return _a(e,t,da,v.placeholder,n,_,M,l,u,h-y)}var S=d?n:this,T=f?S[e]:e;return y=_.length,l?_=function(e,t){for(var n=e.length,r=qn(t.length,n),i=na(e);r--;){var o=t[r];e[r]=Wa(o,n)?i[o]:a}return e}(_,l):g&&y>1&&_.reverse(),p&&u<y&&(_.length=u),this&&this!==It&&this instanceof v&&(T=b||ua(T)),T.apply(S,_)}}function fa(e,t){return function(n,r){return function(e,t,n,r){return Xr(e,function(e,i,a){t(r,n(e),i,a)}),r}(n,e,t(r),{})}}function ma(e,t){return function(n,r){var i;if(n===a&&r===a)return t;if(n!==a&&(i=n),r!==a){if(i===a)return r;"string"==typeof n||"string"==typeof r?(n=zi(n),r=zi(r)):(n=Ni(n),r=Ni(r)),i=e(n,r)}return i}}function ga(e){return Oa(function(t){return t=Qt(t,vn(Na())),Ei(function(n){var r=this;return e(t,function(e){return Wt(e,r,n)})})})}function va(e,t){var n=(t=t===a?" ":zi(t)).length;if(n<2)return n?xi(t,e):t;var r=xi(t,Bn(e/Rn(t)));return Sn(t)?Yi(Ln(r),0,e).join(""):r.slice(0,e)}function ya(e){return function(t,n,i){return i&&"number"!=typeof i&&qa(t,n,i)&&(n=i=a),t=Fs(t),n===a?(n=t,t=0):n=Fs(n),function(e,t,n,i){for(var a=-1,o=Wn(Bn((t-e)/(n||1)),0),s=r(o);o--;)s[i?o:++a]=e,e+=n;return s}(t,n,i=i===a?t<n?1:-1:Fs(i),e)}}function ba(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=Hs(t),n=Hs(n)),e(t,n)}}function _a(e,t,n,r,i,o,s,c,l,u){var h=t&_;t|=h?x:E,(t&=~(h?E:x))&b||(t&=~(v|y));var p=[e,t,i,h?o:a,h?s:a,h?a:o,h?a:s,c,l,u],d=n.apply(a,p);return Ya(e)&&no(d,p),d.placeholder=r,ao(d,e,t)}function wa(e){var t=et[e];return function(e,n){if(e=Hs(e),(n=null==n?0:qn(Us(n),292))&&Vn(e)){var r=(Ws(e)+"e").split("e");return+((r=(Ws(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var xa=er&&1/On(new er([,-0]))[1]==I?function(e){return new er(e)}:Nc;function Ea(e){return function(t){var n=Ua(t);return n==$?Tn(t):n==ne?Cn(t):function(e,t){return Qt(t,function(t){return[t,e[t]]})}(t,e(t))}}function Ma(e,t,n,i,o,s,l,u){var p=t&y;if(!p&&"function"!=typeof e)throw new it(c);var d=i?i.length:0;if(d||(t&=~(x|E),i=o=a),l=l===a?l:Wn(Us(l),0),u=u===a?u:Us(u),d-=o?o.length:0,t&E){var f=i,m=o;i=o=a}var g=p?a:La(e),T=[e,t,n,i,o,f,m,s,l,u];if(g&&function(e,t){var n=e[1],r=t[1],i=n|r,a=i<(v|y|M),o=r==M&&n==_||r==M&&n==S&&e[7].length<=t[8]||r==(M|S)&&t[7].length<=t[8]&&n==_;if(!a&&!o)return e;r&v&&(e[2]=t[2],i|=n&v?0:b);var s=t[3];if(s){var c=e[3];e[3]=c?ea(c,s,t[4]):s,e[4]=c?An(e[3],h):t[4]}(s=t[5])&&(c=e[5],e[5]=c?ta(c,s,t[6]):s,e[6]=c?An(e[5],h):t[6]),(s=t[7])&&(e[7]=s),r&M&&(e[8]=null==e[8]?t[8]:qn(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=i}(T,g),e=T[0],t=T[1],n=T[2],i=T[3],o=T[4],!(u=T[9]=T[9]===a?p?0:e.length:Wn(T[9]-d,0))&&t&(_|w)&&(t&=~(_|w)),t&&t!=v)P=t==_||t==w?function(e,t,n){var i=ua(e);return function o(){for(var s=arguments.length,c=r(s),l=s,u=ka(o);l--;)c[l]=arguments[l];var h=s<3&&c[0]!==u&&c[s-1]!==u?[]:An(c,u);return(s-=h.length)<n?_a(e,t,da,o.placeholder,a,c,h,a,a,n-s):Wt(this&&this!==It&&this instanceof o?i:e,this,c)}}(e,t,u):t!=x&&t!=(v|x)||o.length?da.apply(a,T):function(e,t,n,i){var a=t&v,o=ua(e);return function t(){for(var s=-1,c=arguments.length,l=-1,u=i.length,h=r(u+c),p=this&&this!==It&&this instanceof t?o:e;++l<u;)h[l]=i[l];for(;c--;)h[l++]=arguments[++s];return Wt(p,a?n:this,h)}}(e,t,n,i);else var P=function(e,t,n){var r=t&v,i=ua(e);return function t(){return(this&&this!==It&&this instanceof t?i:e).apply(r?n:this,arguments)}}(e,t,n);return ao((g?Pi:no)(P,T),e,t)}function Sa(e,t,n,r){return e===a||ds(e,st[n])&&!ut.call(r,n)?t:e}function Ta(e,t,n,r,i,o){return Ps(e)&&Ps(t)&&(o.set(t,e),mi(e,t,a,Ta,o),o.delete(t)),e}function Pa(e){return Rs(e)?a:e}function Aa(e,t,n,r,i,o){var s=n&m,c=e.length,l=t.length;if(c!=l&&!(s&&l>c))return!1;var u=o.get(e);if(u&&o.get(t))return u==t;var h=-1,p=!0,d=n&g?new wr:a;for(o.set(e,t),o.set(t,e);++h<c;){var f=e[h],v=t[h];if(r)var y=s?r(v,f,h,t,e,o):r(f,v,h,e,t,o);if(y!==a){if(y)continue;p=!1;break}if(d){if(!rn(t,function(e,t){if(!bn(d,t)&&(f===e||i(f,e,n,r,o)))return d.push(t)})){p=!1;break}}else if(f!==v&&!i(f,v,n,r,o)){p=!1;break}}return o.delete(e),o.delete(t),p}function Oa(e){return io(Qa(e,a,yo),e+"")}function Ca(e){return Zr(e,ic,ja)}function Ra(e){return Zr(e,ac,Fa)}var La=rr?function(e){return rr.get(e)}:Nc;function Ia(e){for(var t=e.name+"",n=ir[t],r=ut.call(ir,t)?n.length:0;r--;){var i=n[r],a=i.func;if(null==a||a==e)return i.name}return t}function ka(e){return(ut.call(dr,"placeholder")?dr:e).placeholder}function Na(){var e=dr.iteratee||Rc;return e=e===Rc?ci:e,arguments.length?e(arguments[0],arguments[1]):e}function za(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function Da(e){for(var t=ic(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,Za(i)]}return t}function Ba(e,t){var n=function(e,t){return null==e?a:e[t]}(e,t);return si(n)?n:a}var ja=Fn?function(e){return null==e?[]:(e=tt(e),$t(Fn(e),function(t){return kt.call(e,t)}))}:Vc,Fa=Fn?function(e){for(var t=[];e;)en(t,ja(e)),e=Rt(e);return t}:Vc,Ua=Jr;function Va(e,t,n){for(var r=-1,i=(t=qi(t,e)).length,a=!1;++r<i;){var o=lo(t[r]);if(!(a=null!=e&&n(e,o)))break;e=e[o]}return a||++r!=i?a:!!(i=null==e?0:e.length)&&Ts(i)&&Wa(o,i)&&(vs(e)||gs(e))}function Ha(e){return"function"!=typeof e.constructor||$a(e)?{}:fr(Rt(e))}function Ga(e){return vs(e)||gs(e)||!!(Dt&&e&&e[Dt])}function Wa(e,t){var n=typeof e;return!!(t=null==t?k:t)&&("number"==n||"symbol"!=n&&Ye.test(e))&&e>-1&&e%1==0&&e<t}function qa(e,t,n){if(!Ps(n))return!1;var r=typeof t;return!!("number"==r?bs(n)&&Wa(t,n.length):"string"==r&&t in n)&&ds(n[t],e)}function Xa(e,t){if(vs(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!Ns(e))||Ce.test(e)||!Oe.test(e)||null!=t&&e in tt(t)}function Ya(e){var t=Ia(e),n=dr[t];if("function"!=typeof n||!(t in vr.prototype))return!1;if(e===n)return!0;var r=La(n);return!!r&&e===r[0]}(Zn&&Ua(new Zn(new ArrayBuffer(1)))!=le||Jn&&Ua(new Jn)!=$||Qn&&"[object Promise]"!=Ua(Qn.resolve())||er&&Ua(new er)!=ne||tr&&Ua(new tr)!=oe)&&(Ua=function(e){var t=Jr(e),n=t==Q?e.constructor:a,r=n?uo(n):"";if(r)switch(r){case ar:return le;case or:return $;case sr:return"[object Promise]";case cr:return ne;case lr:return oe}return t});var Ka=ct?Ms:Hc;function $a(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||st)}function Za(e){return e==e&&!Ps(e)}function Ja(e,t){return function(n){return null!=n&&n[e]===t&&(t!==a||e in tt(n))}}function Qa(e,t,n){return t=Wn(t===a?e.length-1:t,0),function(){for(var i=arguments,a=-1,o=Wn(i.length-t,0),s=r(o);++a<o;)s[a]=i[t+a];a=-1;for(var c=r(t+1);++a<t;)c[a]=i[a];return c[t]=n(s),Wt(e,this,c)}}function eo(e,t){return t.length<2?e:$r(e,Ci(t,0,-1))}function to(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var no=oo(Pi),ro=Dn||function(e,t){return It.setTimeout(e,t)},io=oo(Ai);function ao(e,t,n){var r=t+"";return io(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(De,"{\n/* [wrapped with "+t+"] */\n")}(r,function(e,t){return Xt(F,function(n){var r="_."+n[0];t&n[1]&&!Zt(e,r)&&e.push(r)}),e.sort()}(function(e){var t=e.match(Be);return t?t[1].split(je):[]}(r),n)))}function oo(e){var t=0,n=0;return function(){var r=Xn(),i=C-(r-n);if(n=r,i>0){if(++t>=O)return arguments[0]}else t=0;return e.apply(a,arguments)}}function so(e,t){var n=-1,r=e.length,i=r-1;for(t=t===a?r:t;++n<t;){var o=wi(n,i),s=e[o];e[o]=e[n],e[n]=s}return e.length=t,e}var co=function(e){var t=ss(e,function(e){return n.size===u&&n.clear(),e}),n=t.cache;return t}(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Re,function(e,n,r,i){t.push(r?i.replace(Ue,"$1"):n||e)}),t});function lo(e){if("string"==typeof e||Ns(e))return e;var t=e+"";return"0"==t&&1/e==-I?"-0":t}function uo(e){if(null!=e){try{return lt.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function ho(e){if(e instanceof vr)return e.clone();var t=new gr(e.__wrapped__,e.__chain__);return t.__actions__=na(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var po=Ei(function(e,t){return _s(e)?Br(e,Gr(t,1,_s,!0)):[]}),fo=Ei(function(e,t){var n=Eo(t);return _s(n)&&(n=a),_s(e)?Br(e,Gr(t,1,_s,!0),Na(n,2)):[]}),mo=Ei(function(e,t){var n=Eo(t);return _s(n)&&(n=a),_s(e)?Br(e,Gr(t,1,_s,!0),a,n):[]});function go(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:Us(n);return i<0&&(i=Wn(r+i,0)),sn(e,Na(t,3),i)}function vo(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r-1;return n!==a&&(i=Us(n),i=n<0?Wn(r+i,0):qn(i,r-1)),sn(e,Na(t,3),i,!0)}function yo(e){return null!=e&&e.length?Gr(e,1):[]}function bo(e){return e&&e.length?e[0]:a}var _o=Ei(function(e){var t=Qt(e,Gi);return t.length&&t[0]===e[0]?ni(t):[]}),wo=Ei(function(e){var t=Eo(e),n=Qt(e,Gi);return t===Eo(n)?t=a:n.pop(),n.length&&n[0]===e[0]?ni(n,Na(t,2)):[]}),xo=Ei(function(e){var t=Eo(e),n=Qt(e,Gi);return(t="function"==typeof t?t:a)&&n.pop(),n.length&&n[0]===e[0]?ni(n,a,t):[]});function Eo(e){var t=null==e?0:e.length;return t?e[t-1]:a}var Mo=Ei(So);function So(e,t){return e&&e.length&&t&&t.length?bi(e,t):e}var To=Oa(function(e,t){var n=null==e?0:e.length,r=Ir(e,t);return _i(e,Qt(t,function(e){return Wa(e,n)?+e:e}).sort(Qi)),r});function Po(e){return null==e?e:$n.call(e)}var Ao=Ei(function(e){return Di(Gr(e,1,_s,!0))}),Oo=Ei(function(e){var t=Eo(e);return _s(t)&&(t=a),Di(Gr(e,1,_s,!0),Na(t,2))}),Co=Ei(function(e){var t=Eo(e);return t="function"==typeof t?t:a,Di(Gr(e,1,_s,!0),a,t)});function Ro(e){if(!e||!e.length)return[];var t=0;return e=$t(e,function(e){if(_s(e))return t=Wn(e.length,t),!0}),gn(t,function(t){return Qt(e,pn(t))})}function Lo(e,t){if(!e||!e.length)return[];var n=Ro(e);return null==t?n:Qt(n,function(e){return Wt(t,a,e)})}var Io=Ei(function(e,t){return _s(e)?Br(e,t):[]}),ko=Ei(function(e){return Vi($t(e,_s))}),No=Ei(function(e){var t=Eo(e);return _s(t)&&(t=a),Vi($t(e,_s),Na(t,2))}),zo=Ei(function(e){var t=Eo(e);return t="function"==typeof t?t:a,Vi($t(e,_s),a,t)}),Do=Ei(Ro);var Bo=Ei(function(e){var t=e.length,n=t>1?e[t-1]:a;return n="function"==typeof n?(e.pop(),n):a,Lo(e,n)});function jo(e){var t=dr(e);return t.__chain__=!0,t}function Fo(e,t){return t(e)}var Uo=Oa(function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,i=function(t){return Ir(t,e)};return!(t>1||this.__actions__.length)&&r instanceof vr&&Wa(n)?((r=r.slice(n,+n+(t?1:0))).__actions__.push({func:Fo,args:[i],thisArg:a}),new gr(r,this.__chain__).thru(function(e){return t&&!e.length&&e.push(a),e})):this.thru(i)});var Vo=ia(function(e,t,n){ut.call(e,n)?++e[n]:Lr(e,n,1)});var Ho=ha(go),Go=ha(vo);function Wo(e,t){return(vs(e)?Xt:jr)(e,Na(t,3))}function qo(e,t){return(vs(e)?Yt:Fr)(e,Na(t,3))}var Xo=ia(function(e,t,n){ut.call(e,n)?e[n].push(t):Lr(e,n,[t])});var Yo=Ei(function(e,t,n){var i=-1,a="function"==typeof t,o=bs(e)?r(e.length):[];return jr(e,function(e){o[++i]=a?Wt(t,e,n):ri(e,t,n)}),o}),Ko=ia(function(e,t,n){Lr(e,n,t)});function $o(e,t){return(vs(e)?Qt:pi)(e,Na(t,3))}var Zo=ia(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]});var Jo=Ei(function(e,t){if(null==e)return[];var n=t.length;return n>1&&qa(e,t[0],t[1])?t=[]:n>2&&qa(t[0],t[1],t[2])&&(t=[t[0]]),vi(e,Gr(t,1),[])}),Qo=zn||function(){return It.Date.now()};function es(e,t,n){return t=n?a:t,t=e&&null==t?e.length:t,Ma(e,M,a,a,a,a,t)}function ts(e,t){var n;if("function"!=typeof t)throw new it(c);return e=Us(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=a),n}}var ns=Ei(function(e,t,n){var r=v;if(n.length){var i=An(n,ka(ns));r|=x}return Ma(e,r,t,n,i)}),rs=Ei(function(e,t,n){var r=v|y;if(n.length){var i=An(n,ka(rs));r|=x}return Ma(t,r,e,n,i)});function is(e,t,n){var r,i,o,s,l,u,h=0,p=!1,d=!1,f=!0;if("function"!=typeof e)throw new it(c);function m(t){var n=r,o=i;return r=i=a,h=t,s=e.apply(o,n)}function g(e){var n=e-u;return u===a||n>=t||n<0||d&&e-h>=o}function v(){var e=Qo();if(g(e))return y(e);l=ro(v,function(e){var n=t-(e-u);return d?qn(n,o-(e-h)):n}(e))}function y(e){return l=a,f&&r?m(e):(r=i=a,s)}function b(){var e=Qo(),n=g(e);if(r=arguments,i=this,u=e,n){if(l===a)return function(e){return h=e,l=ro(v,t),p?m(e):s}(u);if(d)return Ki(l),l=ro(v,t),m(u)}return l===a&&(l=ro(v,t)),s}return t=Hs(t)||0,Ps(n)&&(p=!!n.leading,o=(d="maxWait"in n)?Wn(Hs(n.maxWait)||0,t):o,f="trailing"in n?!!n.trailing:f),b.cancel=function(){l!==a&&Ki(l),h=0,r=u=i=l=a},b.flush=function(){return l===a?s:y(Qo())},b}var as=Ei(function(e,t){return Dr(e,1,t)}),os=Ei(function(e,t,n){return Dr(e,Hs(t)||0,n)});function ss(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new it(c);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],a=n.cache;if(a.has(i))return a.get(i);var o=e.apply(this,r);return n.cache=a.set(i,o)||a,o};return n.cache=new(ss.Cache||_r),n}function cs(e){if("function"!=typeof e)throw new it(c);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}ss.Cache=_r;var ls=Xi(function(e,t){var n=(t=1==t.length&&vs(t[0])?Qt(t[0],vn(Na())):Qt(Gr(t,1),vn(Na()))).length;return Ei(function(r){for(var i=-1,a=qn(r.length,n);++i<a;)r[i]=t[i].call(this,r[i]);return Wt(e,this,r)})}),us=Ei(function(e,t){var n=An(t,ka(us));return Ma(e,x,a,t,n)}),hs=Ei(function(e,t){var n=An(t,ka(hs));return Ma(e,E,a,t,n)}),ps=Oa(function(e,t){return Ma(e,S,a,a,a,t)});function ds(e,t){return e===t||e!=e&&t!=t}var fs=ba(Qr),ms=ba(function(e,t){return e>=t}),gs=ii(function(){return arguments}())?ii:function(e){return As(e)&&ut.call(e,"callee")&&!kt.call(e,"callee")},vs=r.isArray,ys=jt?vn(jt):function(e){return As(e)&&Jr(e)==ce};function bs(e){return null!=e&&Ts(e.length)&&!Ms(e)}function _s(e){return As(e)&&bs(e)}var ws=Un||Hc,xs=Ft?vn(Ft):function(e){return As(e)&&Jr(e)==W};function Es(e){if(!As(e))return!1;var t=Jr(e);return t==X||t==q||"string"==typeof e.message&&"string"==typeof e.name&&!Rs(e)}function Ms(e){if(!Ps(e))return!1;var t=Jr(e);return t==Y||t==K||t==H||t==ee}function Ss(e){return"number"==typeof e&&e==Us(e)}function Ts(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=k}function Ps(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function As(e){return null!=e&&"object"==typeof e}var Os=Ut?vn(Ut):function(e){return As(e)&&Ua(e)==$};function Cs(e){return"number"==typeof e||As(e)&&Jr(e)==Z}function Rs(e){if(!As(e)||Jr(e)!=Q)return!1;var t=Rt(e);if(null===t)return!0;var n=ut.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&lt.call(n)==ft}var Ls=Vt?vn(Vt):function(e){return As(e)&&Jr(e)==te};var Is=Ht?vn(Ht):function(e){return As(e)&&Ua(e)==ne};function ks(e){return"string"==typeof e||!vs(e)&&As(e)&&Jr(e)==re}function Ns(e){return"symbol"==typeof e||As(e)&&Jr(e)==ie}var zs=Gt?vn(Gt):function(e){return As(e)&&Ts(e.length)&&!!Tt[Jr(e)]};var Ds=ba(hi),Bs=ba(function(e,t){return e<=t});function js(e){if(!e)return[];if(bs(e))return ks(e)?Ln(e):na(e);if(Bt&&e[Bt])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[Bt]());var t=Ua(e);return(t==$?Tn:t==ne?On:dc)(e)}function Fs(e){return e?(e=Hs(e))===I||e===-I?(e<0?-1:1)*N:e==e?e:0:0===e?e:0}function Us(e){var t=Fs(e),n=t%1;return t==t?n?t-n:t:0}function Vs(e){return e?kr(Us(e),0,D):0}function Hs(e){if("number"==typeof e)return e;if(Ns(e))return z;if(Ps(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Ps(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(ke,"");var n=We.test(e);return n||Xe.test(e)?Ct(e.slice(2),n?2:8):Ge.test(e)?z:+e}function Gs(e){return ra(e,ac(e))}function Ws(e){return null==e?"":zi(e)}var qs=aa(function(e,t){if($a(t)||bs(t))ra(t,ic(t),e);else for(var n in t)ut.call(t,n)&&Ar(e,n,t[n])}),Xs=aa(function(e,t){ra(t,ac(t),e)}),Ys=aa(function(e,t,n,r){ra(t,ac(t),e,r)}),Ks=aa(function(e,t,n,r){ra(t,ic(t),e,r)}),$s=Oa(Ir);var Zs=Ei(function(e,t){e=tt(e);var n=-1,r=t.length,i=r>2?t[2]:a;for(i&&qa(t[0],t[1],i)&&(r=1);++n<r;)for(var o=t[n],s=ac(o),c=-1,l=s.length;++c<l;){var u=s[c],h=e[u];(h===a||ds(h,st[u])&&!ut.call(e,u))&&(e[u]=o[u])}return e}),Js=Ei(function(e){return e.push(a,Ta),Wt(sc,a,e)});function Qs(e,t,n){var r=null==e?a:$r(e,t);return r===a?n:r}function ec(e,t){return null!=e&&Va(e,t,ti)}var tc=fa(function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=dt.call(t)),e[t]=n},Pc(Cc)),nc=fa(function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=dt.call(t)),ut.call(e,t)?e[t].push(n):e[t]=[n]},Na),rc=Ei(ri);function ic(e){return bs(e)?Er(e):li(e)}function ac(e){return bs(e)?Er(e,!0):ui(e)}var oc=aa(function(e,t,n){mi(e,t,n)}),sc=aa(function(e,t,n,r){mi(e,t,n,r)}),cc=Oa(function(e,t){var n={};if(null==e)return n;var r=!1;t=Qt(t,function(t){return t=qi(t,e),r||(r=t.length>1),t}),ra(e,Ra(e),n),r&&(n=Nr(n,p|d|f,Pa));for(var i=t.length;i--;)Bi(n,t[i]);return n});var lc=Oa(function(e,t){return null==e?{}:function(e,t){return yi(e,t,function(t,n){return ec(e,n)})}(e,t)});function uc(e,t){if(null==e)return{};var n=Qt(Ra(e),function(e){return[e]});return t=Na(t),yi(e,n,function(e,n){return t(e,n[0])})}var hc=Ea(ic),pc=Ea(ac);function dc(e){return null==e?[]:yn(e,ic(e))}var fc=la(function(e,t,n){return t=t.toLowerCase(),e+(n?mc(t):t)});function mc(e){return Ec(Ws(e).toLowerCase())}function gc(e){return(e=Ws(e))&&e.replace(Ke,xn).replace(bt,"")}var vc=la(function(e,t,n){return e+(n?"-":"")+t.toLowerCase()}),yc=la(function(e,t,n){return e+(n?" ":"")+t.toLowerCase()}),bc=ca("toLowerCase");var _c=la(function(e,t,n){return e+(n?"_":"")+t.toLowerCase()});var wc=la(function(e,t,n){return e+(n?" ":"")+Ec(t)});var xc=la(function(e,t,n){return e+(n?" ":"")+t.toUpperCase()}),Ec=ca("toUpperCase");function Mc(e,t,n){return e=Ws(e),(t=n?a:t)===a?function(e){return Et.test(e)}(e)?function(e){return e.match(wt)||[]}(e):function(e){return e.match(Fe)||[]}(e):e.match(t)||[]}var Sc=Ei(function(e,t){try{return Wt(e,a,t)}catch(e){return Es(e)?e:new Je(e)}}),Tc=Oa(function(e,t){return Xt(t,function(t){t=lo(t),Lr(e,t,ns(e[t],e))}),e});function Pc(e){return function(){return e}}var Ac=pa(),Oc=pa(!0);function Cc(e){return e}function Rc(e){return ci("function"==typeof e?e:Nr(e,p))}var Lc=Ei(function(e,t){return function(n){return ri(n,e,t)}}),Ic=Ei(function(e,t){return function(n){return ri(e,n,t)}});function kc(e,t,n){var r=ic(t),i=Kr(t,r);null!=n||Ps(t)&&(i.length||!r.length)||(n=t,t=e,e=this,i=Kr(t,ic(t)));var a=!(Ps(n)&&"chain"in n&&!n.chain),o=Ms(e);return Xt(i,function(n){var r=t[n];e[n]=r,o&&(e.prototype[n]=function(){var t=this.__chain__;if(a||t){var n=e(this.__wrapped__),i=n.__actions__=na(this.__actions__);return i.push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,en([this.value()],arguments))})}),e}function Nc(){}var zc=ga(Qt),Dc=ga(Kt),Bc=ga(rn);function jc(e){return Xa(e)?pn(lo(e)):function(e){return function(t){return $r(t,e)}}(e)}var Fc=ya(),Uc=ya(!0);function Vc(){return[]}function Hc(){return!1}var Gc=ma(function(e,t){return e+t},0),Wc=wa("ceil"),qc=ma(function(e,t){return e/t},1),Xc=wa("floor");var Yc,Kc=ma(function(e,t){return e*t},1),$c=wa("round"),Zc=ma(function(e,t){return e-t},0);return dr.after=function(e,t){if("function"!=typeof t)throw new it(c);return e=Us(e),function(){if(--e<1)return t.apply(this,arguments)}},dr.ary=es,dr.assign=qs,dr.assignIn=Xs,dr.assignInWith=Ys,dr.assignWith=Ks,dr.at=$s,dr.before=ts,dr.bind=ns,dr.bindAll=Tc,dr.bindKey=rs,dr.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return vs(e)?e:[e]},dr.chain=jo,dr.chunk=function(e,t,n){t=(n?qa(e,t,n):t===a)?1:Wn(Us(t),0);var i=null==e?0:e.length;if(!i||t<1)return[];for(var o=0,s=0,c=r(Bn(i/t));o<i;)c[s++]=Ci(e,o,o+=t);return c},dr.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var a=e[t];a&&(i[r++]=a)}return i},dr.concat=function(){var e=arguments.length;if(!e)return[];for(var t=r(e-1),n=arguments[0],i=e;i--;)t[i-1]=arguments[i];return en(vs(n)?na(n):[n],Gr(t,1))},dr.cond=function(e){var t=null==e?0:e.length,n=Na();return e=t?Qt(e,function(e){if("function"!=typeof e[1])throw new it(c);return[n(e[0]),e[1]]}):[],Ei(function(n){for(var r=-1;++r<t;){var i=e[r];if(Wt(i[0],this,n))return Wt(i[1],this,n)}})},dr.conforms=function(e){return function(e){var t=ic(e);return function(n){return zr(n,e,t)}}(Nr(e,p))},dr.constant=Pc,dr.countBy=Vo,dr.create=function(e,t){var n=fr(e);return null==t?n:Rr(n,t)},dr.curry=function e(t,n,r){var i=Ma(t,_,a,a,a,a,a,n=r?a:n);return i.placeholder=e.placeholder,i},dr.curryRight=function e(t,n,r){var i=Ma(t,w,a,a,a,a,a,n=r?a:n);return i.placeholder=e.placeholder,i},dr.debounce=is,dr.defaults=Zs,dr.defaultsDeep=Js,dr.defer=as,dr.delay=os,dr.difference=po,dr.differenceBy=fo,dr.differenceWith=mo,dr.drop=function(e,t,n){var r=null==e?0:e.length;return r?Ci(e,(t=n||t===a?1:Us(t))<0?0:t,r):[]},dr.dropRight=function(e,t,n){var r=null==e?0:e.length;return r?Ci(e,0,(t=r-(t=n||t===a?1:Us(t)))<0?0:t):[]},dr.dropRightWhile=function(e,t){return e&&e.length?Fi(e,Na(t,3),!0,!0):[]},dr.dropWhile=function(e,t){return e&&e.length?Fi(e,Na(t,3),!0):[]},dr.fill=function(e,t,n,r){var i=null==e?0:e.length;return i?(n&&"number"!=typeof n&&qa(e,t,n)&&(n=0,r=i),function(e,t,n,r){var i=e.length;for((n=Us(n))<0&&(n=-n>i?0:i+n),(r=r===a||r>i?i:Us(r))<0&&(r+=i),r=n>r?0:Vs(r);n<r;)e[n++]=t;return e}(e,t,n,r)):[]},dr.filter=function(e,t){return(vs(e)?$t:Hr)(e,Na(t,3))},dr.flatMap=function(e,t){return Gr($o(e,t),1)},dr.flatMapDeep=function(e,t){return Gr($o(e,t),I)},dr.flatMapDepth=function(e,t,n){return n=n===a?1:Us(n),Gr($o(e,t),n)},dr.flatten=yo,dr.flattenDeep=function(e){return null!=e&&e.length?Gr(e,I):[]},dr.flattenDepth=function(e,t){return null!=e&&e.length?Gr(e,t=t===a?1:Us(t)):[]},dr.flip=function(e){return Ma(e,T)},dr.flow=Ac,dr.flowRight=Oc,dr.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r},dr.functions=function(e){return null==e?[]:Kr(e,ic(e))},dr.functionsIn=function(e){return null==e?[]:Kr(e,ac(e))},dr.groupBy=Xo,dr.initial=function(e){return null!=e&&e.length?Ci(e,0,-1):[]},dr.intersection=_o,dr.intersectionBy=wo,dr.intersectionWith=xo,dr.invert=tc,dr.invertBy=nc,dr.invokeMap=Yo,dr.iteratee=Rc,dr.keyBy=Ko,dr.keys=ic,dr.keysIn=ac,dr.map=$o,dr.mapKeys=function(e,t){var n={};return t=Na(t,3),Xr(e,function(e,r,i){Lr(n,t(e,r,i),e)}),n},dr.mapValues=function(e,t){var n={};return t=Na(t,3),Xr(e,function(e,r,i){Lr(n,r,t(e,r,i))}),n},dr.matches=function(e){return di(Nr(e,p))},dr.matchesProperty=function(e,t){return fi(e,Nr(t,p))},dr.memoize=ss,dr.merge=oc,dr.mergeWith=sc,dr.method=Lc,dr.methodOf=Ic,dr.mixin=kc,dr.negate=cs,dr.nthArg=function(e){return e=Us(e),Ei(function(t){return gi(t,e)})},dr.omit=cc,dr.omitBy=function(e,t){return uc(e,cs(Na(t)))},dr.once=function(e){return ts(2,e)},dr.orderBy=function(e,t,n,r){return null==e?[]:(vs(t)||(t=null==t?[]:[t]),vs(n=r?a:n)||(n=null==n?[]:[n]),vi(e,t,n))},dr.over=zc,dr.overArgs=ls,dr.overEvery=Dc,dr.overSome=Bc,dr.partial=us,dr.partialRight=hs,dr.partition=Zo,dr.pick=lc,dr.pickBy=uc,dr.property=jc,dr.propertyOf=function(e){return function(t){return null==e?a:$r(e,t)}},dr.pull=Mo,dr.pullAll=So,dr.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?bi(e,t,Na(n,2)):e},dr.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?bi(e,t,a,n):e},dr.pullAt=To,dr.range=Fc,dr.rangeRight=Uc,dr.rearg=ps,dr.reject=function(e,t){return(vs(e)?$t:Hr)(e,cs(Na(t,3)))},dr.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],a=e.length;for(t=Na(t,3);++r<a;){var o=e[r];t(o,r,e)&&(n.push(o),i.push(r))}return _i(e,i),n},dr.rest=function(e,t){if("function"!=typeof e)throw new it(c);return Ei(e,t=t===a?t:Us(t))},dr.reverse=Po,dr.sampleSize=function(e,t,n){return t=(n?qa(e,t,n):t===a)?1:Us(t),(vs(e)?Sr:Si)(e,t)},dr.set=function(e,t,n){return null==e?e:Ti(e,t,n)},dr.setWith=function(e,t,n,r){return r="function"==typeof r?r:a,null==e?e:Ti(e,t,n,r)},dr.shuffle=function(e){return(vs(e)?Tr:Oi)(e)},dr.slice=function(e,t,n){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&qa(e,t,n)?(t=0,n=r):(t=null==t?0:Us(t),n=n===a?r:Us(n)),Ci(e,t,n)):[]},dr.sortBy=Jo,dr.sortedUniq=function(e){return e&&e.length?ki(e):[]},dr.sortedUniqBy=function(e,t){return e&&e.length?ki(e,Na(t,2)):[]},dr.split=function(e,t,n){return n&&"number"!=typeof n&&qa(e,t,n)&&(t=n=a),(n=n===a?D:n>>>0)?(e=Ws(e))&&("string"==typeof t||null!=t&&!Ls(t))&&!(t=zi(t))&&Sn(e)?Yi(Ln(e),0,n):e.split(t,n):[]},dr.spread=function(e,t){if("function"!=typeof e)throw new it(c);return t=null==t?0:Wn(Us(t),0),Ei(function(n){var r=n[t],i=Yi(n,0,t);return r&&en(i,r),Wt(e,this,i)})},dr.tail=function(e){var t=null==e?0:e.length;return t?Ci(e,1,t):[]},dr.take=function(e,t,n){return e&&e.length?Ci(e,0,(t=n||t===a?1:Us(t))<0?0:t):[]},dr.takeRight=function(e,t,n){var r=null==e?0:e.length;return r?Ci(e,(t=r-(t=n||t===a?1:Us(t)))<0?0:t,r):[]},dr.takeRightWhile=function(e,t){return e&&e.length?Fi(e,Na(t,3),!1,!0):[]},dr.takeWhile=function(e,t){return e&&e.length?Fi(e,Na(t,3)):[]},dr.tap=function(e,t){return t(e),e},dr.throttle=function(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new it(c);return Ps(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),is(e,t,{leading:r,maxWait:t,trailing:i})},dr.thru=Fo,dr.toArray=js,dr.toPairs=hc,dr.toPairsIn=pc,dr.toPath=function(e){return vs(e)?Qt(e,lo):Ns(e)?[e]:na(co(Ws(e)))},dr.toPlainObject=Gs,dr.transform=function(e,t,n){var r=vs(e),i=r||ws(e)||zs(e);if(t=Na(t,4),null==n){var a=e&&e.constructor;n=i?r?new a:[]:Ps(e)&&Ms(a)?fr(Rt(e)):{}}return(i?Xt:Xr)(e,function(e,r,i){return t(n,e,r,i)}),n},dr.unary=function(e){return es(e,1)},dr.union=Ao,dr.unionBy=Oo,dr.unionWith=Co,dr.uniq=function(e){return e&&e.length?Di(e):[]},dr.uniqBy=function(e,t){return e&&e.length?Di(e,Na(t,2)):[]},dr.uniqWith=function(e,t){return t="function"==typeof t?t:a,e&&e.length?Di(e,a,t):[]},dr.unset=function(e,t){return null==e||Bi(e,t)},dr.unzip=Ro,dr.unzipWith=Lo,dr.update=function(e,t,n){return null==e?e:ji(e,t,Wi(n))},dr.updateWith=function(e,t,n,r){return r="function"==typeof r?r:a,null==e?e:ji(e,t,Wi(n),r)},dr.values=dc,dr.valuesIn=function(e){return null==e?[]:yn(e,ac(e))},dr.without=Io,dr.words=Mc,dr.wrap=function(e,t){return us(Wi(t),e)},dr.xor=ko,dr.xorBy=No,dr.xorWith=zo,dr.zip=Do,dr.zipObject=function(e,t){return Hi(e||[],t||[],Ar)},dr.zipObjectDeep=function(e,t){return Hi(e||[],t||[],Ti)},dr.zipWith=Bo,dr.entries=hc,dr.entriesIn=pc,dr.extend=Xs,dr.extendWith=Ys,kc(dr,dr),dr.add=Gc,dr.attempt=Sc,dr.camelCase=fc,dr.capitalize=mc,dr.ceil=Wc,dr.clamp=function(e,t,n){return n===a&&(n=t,t=a),n!==a&&(n=(n=Hs(n))==n?n:0),t!==a&&(t=(t=Hs(t))==t?t:0),kr(Hs(e),t,n)},dr.clone=function(e){return Nr(e,f)},dr.cloneDeep=function(e){return Nr(e,p|f)},dr.cloneDeepWith=function(e,t){return Nr(e,p|f,t="function"==typeof t?t:a)},dr.cloneWith=function(e,t){return Nr(e,f,t="function"==typeof t?t:a)},dr.conformsTo=function(e,t){return null==t||zr(e,t,ic(t))},dr.deburr=gc,dr.defaultTo=function(e,t){return null==e||e!=e?t:e},dr.divide=qc,dr.endsWith=function(e,t,n){e=Ws(e),t=zi(t);var r=e.length,i=n=n===a?r:kr(Us(n),0,r);return(n-=t.length)>=0&&e.slice(n,i)==t},dr.eq=ds,dr.escape=function(e){return(e=Ws(e))&&Se.test(e)?e.replace(Ee,En):e},dr.escapeRegExp=function(e){return(e=Ws(e))&&Ie.test(e)?e.replace(Le,"\\$&"):e},dr.every=function(e,t,n){var r=vs(e)?Kt:Ur;return n&&qa(e,t,n)&&(t=a),r(e,Na(t,3))},dr.find=Ho,dr.findIndex=go,dr.findKey=function(e,t){return on(e,Na(t,3),Xr)},dr.findLast=Go,dr.findLastIndex=vo,dr.findLastKey=function(e,t){return on(e,Na(t,3),Yr)},dr.floor=Xc,dr.forEach=Wo,dr.forEachRight=qo,dr.forIn=function(e,t){return null==e?e:Wr(e,Na(t,3),ac)},dr.forInRight=function(e,t){return null==e?e:qr(e,Na(t,3),ac)},dr.forOwn=function(e,t){return e&&Xr(e,Na(t,3))},dr.forOwnRight=function(e,t){return e&&Yr(e,Na(t,3))},dr.get=Qs,dr.gt=fs,dr.gte=ms,dr.has=function(e,t){return null!=e&&Va(e,t,ei)},dr.hasIn=ec,dr.head=bo,dr.identity=Cc,dr.includes=function(e,t,n,r){e=bs(e)?e:dc(e),n=n&&!r?Us(n):0;var i=e.length;return n<0&&(n=Wn(i+n,0)),ks(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&cn(e,t,n)>-1},dr.indexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:Us(n);return i<0&&(i=Wn(r+i,0)),cn(e,t,i)},dr.inRange=function(e,t,n){return t=Fs(t),n===a?(n=t,t=0):n=Fs(n),function(e,t,n){return e>=qn(t,n)&&e<Wn(t,n)}(e=Hs(e),t,n)},dr.invoke=rc,dr.isArguments=gs,dr.isArray=vs,dr.isArrayBuffer=ys,dr.isArrayLike=bs,dr.isArrayLikeObject=_s,dr.isBoolean=function(e){return!0===e||!1===e||As(e)&&Jr(e)==G},dr.isBuffer=ws,dr.isDate=xs,dr.isElement=function(e){return As(e)&&1===e.nodeType&&!Rs(e)},dr.isEmpty=function(e){if(null==e)return!0;if(bs(e)&&(vs(e)||"string"==typeof e||"function"==typeof e.splice||ws(e)||zs(e)||gs(e)))return!e.length;var t=Ua(e);if(t==$||t==ne)return!e.size;if($a(e))return!li(e).length;for(var n in e)if(ut.call(e,n))return!1;return!0},dr.isEqual=function(e,t){return ai(e,t)},dr.isEqualWith=function(e,t,n){var r=(n="function"==typeof n?n:a)?n(e,t):a;return r===a?ai(e,t,a,n):!!r},dr.isError=Es,dr.isFinite=function(e){return"number"==typeof e&&Vn(e)},dr.isFunction=Ms,dr.isInteger=Ss,dr.isLength=Ts,dr.isMap=Os,dr.isMatch=function(e,t){return e===t||oi(e,t,Da(t))},dr.isMatchWith=function(e,t,n){return n="function"==typeof n?n:a,oi(e,t,Da(t),n)},dr.isNaN=function(e){return Cs(e)&&e!=+e},dr.isNative=function(e){if(Ka(e))throw new Je(s);return si(e)},dr.isNil=function(e){return null==e},dr.isNull=function(e){return null===e},dr.isNumber=Cs,dr.isObject=Ps,dr.isObjectLike=As,dr.isPlainObject=Rs,dr.isRegExp=Ls,dr.isSafeInteger=function(e){return Ss(e)&&e>=-k&&e<=k},dr.isSet=Is,dr.isString=ks,dr.isSymbol=Ns,dr.isTypedArray=zs,dr.isUndefined=function(e){return e===a},dr.isWeakMap=function(e){return As(e)&&Ua(e)==oe},dr.isWeakSet=function(e){return As(e)&&Jr(e)==se},dr.join=function(e,t){return null==e?"":Hn.call(e,t)},dr.kebabCase=vc,dr.last=Eo,dr.lastIndexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r;return n!==a&&(i=(i=Us(n))<0?Wn(r+i,0):qn(i,r-1)),t==t?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,i):sn(e,un,i,!0)},dr.lowerCase=yc,dr.lowerFirst=bc,dr.lt=Ds,dr.lte=Bs,dr.max=function(e){return e&&e.length?Vr(e,Cc,Qr):a},dr.maxBy=function(e,t){return e&&e.length?Vr(e,Na(t,2),Qr):a},dr.mean=function(e){return hn(e,Cc)},dr.meanBy=function(e,t){return hn(e,Na(t,2))},dr.min=function(e){return e&&e.length?Vr(e,Cc,hi):a},dr.minBy=function(e,t){return e&&e.length?Vr(e,Na(t,2),hi):a},dr.stubArray=Vc,dr.stubFalse=Hc,dr.stubObject=function(){return{}},dr.stubString=function(){return""},dr.stubTrue=function(){return!0},dr.multiply=Kc,dr.nth=function(e,t){return e&&e.length?gi(e,Us(t)):a},dr.noConflict=function(){return It._===this&&(It._=mt),this},dr.noop=Nc,dr.now=Qo,dr.pad=function(e,t,n){e=Ws(e);var r=(t=Us(t))?Rn(e):0;if(!t||r>=t)return e;var i=(t-r)/2;return va(jn(i),n)+e+va(Bn(i),n)},dr.padEnd=function(e,t,n){e=Ws(e);var r=(t=Us(t))?Rn(e):0;return t&&r<t?e+va(t-r,n):e},dr.padStart=function(e,t,n){e=Ws(e);var r=(t=Us(t))?Rn(e):0;return t&&r<t?va(t-r,n)+e:e},dr.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),Yn(Ws(e).replace(Ne,""),t||0)},dr.random=function(e,t,n){if(n&&"boolean"!=typeof n&&qa(e,t,n)&&(t=n=a),n===a&&("boolean"==typeof t?(n=t,t=a):"boolean"==typeof e&&(n=e,e=a)),e===a&&t===a?(e=0,t=1):(e=Fs(e),t===a?(t=e,e=0):t=Fs(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var i=Kn();return qn(e+i*(t-e+Ot("1e-"+((i+"").length-1))),t)}return wi(e,t)},dr.reduce=function(e,t,n){var r=vs(e)?tn:fn,i=arguments.length<3;return r(e,Na(t,4),n,i,jr)},dr.reduceRight=function(e,t,n){var r=vs(e)?nn:fn,i=arguments.length<3;return r(e,Na(t,4),n,i,Fr)},dr.repeat=function(e,t,n){return t=(n?qa(e,t,n):t===a)?1:Us(t),xi(Ws(e),t)},dr.replace=function(){var e=arguments,t=Ws(e[0]);return e.length<3?t:t.replace(e[1],e[2])},dr.result=function(e,t,n){var r=-1,i=(t=qi(t,e)).length;for(i||(i=1,e=a);++r<i;){var o=null==e?a:e[lo(t[r])];o===a&&(r=i,o=n),e=Ms(o)?o.call(e):o}return e},dr.round=$c,dr.runInContext=e,dr.sample=function(e){return(vs(e)?Mr:Mi)(e)},dr.size=function(e){if(null==e)return 0;if(bs(e))return ks(e)?Rn(e):e.length;var t=Ua(e);return t==$||t==ne?e.size:li(e).length},dr.snakeCase=_c,dr.some=function(e,t,n){var r=vs(e)?rn:Ri;return n&&qa(e,t,n)&&(t=a),r(e,Na(t,3))},dr.sortedIndex=function(e,t){return Li(e,t)},dr.sortedIndexBy=function(e,t,n){return Ii(e,t,Na(n,2))},dr.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=Li(e,t);if(r<n&&ds(e[r],t))return r}return-1},dr.sortedLastIndex=function(e,t){return Li(e,t,!0)},dr.sortedLastIndexBy=function(e,t,n){return Ii(e,t,Na(n,2),!0)},dr.sortedLastIndexOf=function(e,t){if(null!=e&&e.length){var n=Li(e,t,!0)-1;if(ds(e[n],t))return n}return-1},dr.startCase=wc,dr.startsWith=function(e,t,n){return e=Ws(e),n=null==n?0:kr(Us(n),0,e.length),t=zi(t),e.slice(n,n+t.length)==t},dr.subtract=Zc,dr.sum=function(e){return e&&e.length?mn(e,Cc):0},dr.sumBy=function(e,t){return e&&e.length?mn(e,Na(t,2)):0},dr.template=function(e,t,n){var r=dr.templateSettings;n&&qa(e,t,n)&&(t=a),e=Ws(e),t=Ys({},t,r,Sa);var i,o,s=Ys({},t.imports,r.imports,Sa),c=ic(s),l=yn(s,c),u=0,h=t.interpolate||$e,p="__p += '",d=nt((t.escape||$e).source+"|"+h.source+"|"+(h===Ae?Ve:$e).source+"|"+(t.evaluate||$e).source+"|$","g"),f="//# sourceURL="+(ut.call(t,"sourceURL")?(t.sourceURL+"").replace(/[\r\n]/g," "):"lodash.templateSources["+ ++St+"]")+"\n";e.replace(d,function(t,n,r,a,s,c){return r||(r=a),p+=e.slice(u,c).replace(Ze,Mn),n&&(i=!0,p+="' +\n__e("+n+") +\n'"),s&&(o=!0,p+="';\n"+s+";\n__p += '"),r&&(p+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),u=c+t.length,t}),p+="';\n";var m=ut.call(t,"variable")&&t.variable;m||(p="with (obj) {\n"+p+"\n}\n"),p=(o?p.replace(be,""):p).replace(_e,"$1").replace(we,"$1;"),p="function("+(m||"obj")+") {\n"+(m?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+p+"return __p\n}";var g=Sc(function(){return Qe(c,f+"return "+p).apply(a,l)});if(g.source=p,Es(g))throw g;return g},dr.times=function(e,t){if((e=Us(e))<1||e>k)return[];var n=D,r=qn(e,D);t=Na(t),e-=D;for(var i=gn(r,t);++n<e;)t(n);return i},dr.toFinite=Fs,dr.toInteger=Us,dr.toLength=Vs,dr.toLower=function(e){return Ws(e).toLowerCase()},dr.toNumber=Hs,dr.toSafeInteger=function(e){return e?kr(Us(e),-k,k):0===e?e:0},dr.toString=Ws,dr.toUpper=function(e){return Ws(e).toUpperCase()},dr.trim=function(e,t,n){if((e=Ws(e))&&(n||t===a))return e.replace(ke,"");if(!e||!(t=zi(t)))return e;var r=Ln(e),i=Ln(t);return Yi(r,_n(r,i),wn(r,i)+1).join("")},dr.trimEnd=function(e,t,n){if((e=Ws(e))&&(n||t===a))return e.replace(ze,"");if(!e||!(t=zi(t)))return e;var r=Ln(e);return Yi(r,0,wn(r,Ln(t))+1).join("")},dr.trimStart=function(e,t,n){if((e=Ws(e))&&(n||t===a))return e.replace(Ne,"");if(!e||!(t=zi(t)))return e;var r=Ln(e);return Yi(r,_n(r,Ln(t))).join("")},dr.truncate=function(e,t){var n=P,r=A;if(Ps(t)){var i="separator"in t?t.separator:i;n="length"in t?Us(t.length):n,r="omission"in t?zi(t.omission):r}var o=(e=Ws(e)).length;if(Sn(e)){var s=Ln(e);o=s.length}if(n>=o)return e;var c=n-Rn(r);if(c<1)return r;var l=s?Yi(s,0,c).join(""):e.slice(0,c);if(i===a)return l+r;if(s&&(c+=l.length-c),Ls(i)){if(e.slice(c).search(i)){var u,h=l;for(i.global||(i=nt(i.source,Ws(He.exec(i))+"g")),i.lastIndex=0;u=i.exec(h);)var p=u.index;l=l.slice(0,p===a?c:p)}}else if(e.indexOf(zi(i),c)!=c){var d=l.lastIndexOf(i);d>-1&&(l=l.slice(0,d))}return l+r},dr.unescape=function(e){return(e=Ws(e))&&Me.test(e)?e.replace(xe,In):e},dr.uniqueId=function(e){var t=++ht;return Ws(e)+t},dr.upperCase=xc,dr.upperFirst=Ec,dr.each=Wo,dr.eachRight=qo,dr.first=bo,kc(dr,(Yc={},Xr(dr,function(e,t){ut.call(dr.prototype,t)||(Yc[t]=e)}),Yc),{chain:!1}),dr.VERSION="4.17.14",Xt(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){dr[e].placeholder=dr}),Xt(["drop","take"],function(e,t){vr.prototype[e]=function(n){n=n===a?1:Wn(Us(n),0);var r=this.__filtered__&&!t?new vr(this):this.clone();return r.__filtered__?r.__takeCount__=qn(n,r.__takeCount__):r.__views__.push({size:qn(n,D),type:e+(r.__dir__<0?"Right":"")}),r},vr.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}}),Xt(["filter","map","takeWhile"],function(e,t){var n=t+1,r=n==R||3==n;vr.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:Na(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}}),Xt(["head","last"],function(e,t){var n="take"+(t?"Right":"");vr.prototype[e]=function(){return this[n](1).value()[0]}}),Xt(["initial","tail"],function(e,t){var n="drop"+(t?"":"Right");vr.prototype[e]=function(){return this.__filtered__?new vr(this):this[n](1)}}),vr.prototype.compact=function(){return this.filter(Cc)},vr.prototype.find=function(e){return this.filter(e).head()},vr.prototype.findLast=function(e){return this.reverse().find(e)},vr.prototype.invokeMap=Ei(function(e,t){return"function"==typeof e?new vr(this):this.map(function(n){return ri(n,e,t)})}),vr.prototype.reject=function(e){return this.filter(cs(Na(e)))},vr.prototype.slice=function(e,t){e=Us(e);var n=this;return n.__filtered__&&(e>0||t<0)?new vr(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==a&&(n=(t=Us(t))<0?n.dropRight(-t):n.take(t-e)),n)},vr.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},vr.prototype.toArray=function(){return this.take(D)},Xr(vr.prototype,function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),i=dr[r?"take"+("last"==t?"Right":""):t],o=r||/^find/.test(t);i&&(dr.prototype[t]=function(){var t=this.__wrapped__,s=r?[1]:arguments,c=t instanceof vr,l=s[0],u=c||vs(t),h=function(e){var t=i.apply(dr,en([e],s));return r&&p?t[0]:t};u&&n&&"function"==typeof l&&1!=l.length&&(c=u=!1);var p=this.__chain__,d=!!this.__actions__.length,f=o&&!p,m=c&&!d;if(!o&&u){t=m?t:new vr(this);var g=e.apply(t,s);return g.__actions__.push({func:Fo,args:[h],thisArg:a}),new gr(g,p)}return f&&m?e.apply(this,s):(g=this.thru(h),f?r?g.value()[0]:g.value():g)})}),Xt(["pop","push","shift","sort","splice","unshift"],function(e){var t=at[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);dr.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var i=this.value();return t.apply(vs(i)?i:[],e)}return this[n](function(n){return t.apply(vs(n)?n:[],e)})}}),Xr(vr.prototype,function(e,t){var n=dr[t];if(n){var r=n.name+"";ut.call(ir,r)||(ir[r]=[]),ir[r].push({name:t,func:n})}}),ir[da(a,y).name]=[{name:"wrapper",func:a}],vr.prototype.clone=function(){var e=new vr(this.__wrapped__);return e.__actions__=na(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=na(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=na(this.__views__),e},vr.prototype.reverse=function(){if(this.__filtered__){var e=new vr(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},vr.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=vs(e),r=t<0,i=n?e.length:0,a=function(e,t,n){for(var r=-1,i=n.length;++r<i;){var a=n[r],o=a.size;switch(a.type){case"drop":e+=o;break;case"dropRight":t-=o;break;case"take":t=qn(t,e+o);break;case"takeRight":e=Wn(e,t-o)}}return{start:e,end:t}}(0,i,this.__views__),o=a.start,s=a.end,c=s-o,l=r?s:o-1,u=this.__iteratees__,h=u.length,p=0,d=qn(c,this.__takeCount__);if(!n||!r&&i==c&&d==c)return Ui(e,this.__actions__);var f=[];e:for(;c--&&p<d;){for(var m=-1,g=e[l+=t];++m<h;){var v=u[m],y=v.iteratee,b=v.type,_=y(g);if(b==L)g=_;else if(!_){if(b==R)continue e;break e}}f[p++]=g}return f},dr.prototype.at=Uo,dr.prototype.chain=function(){return jo(this)},dr.prototype.commit=function(){return new gr(this.value(),this.__chain__)},dr.prototype.next=function(){this.__values__===a&&(this.__values__=js(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?a:this.__values__[this.__index__++]}},dr.prototype.plant=function(e){for(var t,n=this;n instanceof mr;){var r=ho(n);r.__index__=0,r.__values__=a,t?i.__wrapped__=r:t=r;var i=r;n=n.__wrapped__}return i.__wrapped__=e,t},dr.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof vr){var t=e;return this.__actions__.length&&(t=new vr(this)),(t=t.reverse()).__actions__.push({func:Fo,args:[Po],thisArg:a}),new gr(t,this.__chain__)}return this.thru(Po)},dr.prototype.toJSON=dr.prototype.valueOf=dr.prototype.value=function(){return Ui(this.__wrapped__,this.__actions__)},dr.prototype.first=dr.prototype.head,Bt&&(dr.prototype[Bt]=function(){return this}),dr}();It._=kn,(i=function(){return kn}.call(t,n,t,r))===a||(r.exports=i)}).call(this)}).call(this,n(45),n(127)(e))},function(e,t,n){"use strict";e.exports=function(e){var t="string"==typeof e?e.charCodeAt(0):e;return t>=48&&t<=57}},function(e,t,n){"use strict";e.exports=s;var r=n(161),i=r.CONTINUE,a=r.SKIP,o=r.EXIT;function s(e,t,n,i){"function"==typeof t&&"function"!=typeof n&&(i=n,n=t,t=null),r(e,t,function(e,t){var r=t[t.length-1],i=r?r.children.indexOf(e):null;return n(e,i,r)},i)}s.CONTINUE=i,s.SKIP=a,s.EXIT=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(3),a=n(13),o=n(5),s=n(225),c=n(10),l=n(24),u=n(6);t.SliderPad=class extends r.Component{constructor(e){super(e),this.sizeObserver=new o.SizeObserver,this.pointerObserver=new a.PointerObserver,this.animationFramer=new c.AnimationFramer,this.wasActivated=!1,this.isInFineControlMode=!1,this.isPointerDown=!1;const t=void 0===this.props.initialPercent?.5:this.props.initialPercent,n=void 0===this.props.easing?2.5:this.props.easing,i=void 0!==this.props.restAtInitialPercent&&this.props.restAtInitialPercent,l=void 0===this.props.restEasing?n:this.props.restEasing;this.gesture=new s.SliderGesture(this.props.targetValue,t,n,i,l),this.hitAreaRef=r.createRef(),this.onResize=this.onResize.bind(this),this.onPointerChange=this.onPointerChange.bind(this),this.onAnimationFrame=this.onAnimationFrame.bind(this),this.onKeyDown=this.onKeyDown.bind(this)}render(){const e=i("components_control__slider",{"components_control__slider--show-labels":this.props.labels},{"components_control__slider--active":this.isPointerDown},{"components_control__slider--was-activated":this.wasActivated},{"components_control__slider--highlight":this.props.highlight}),t=this.sizeObserver.getWidth(),n=this.gesture.getPercent()*t,a=this.props.modulatedValue?this.props.modulatedValue*t:0;return r.createElement("div",{className:e},r.createElement("div",{className:"components_control__highlight_bg"}),this.props.labels&&this.props.labelName&&r.createElement("div",{className:"components_control__slider_labels"},r.createElement("div",{className:"components_control__slider_labels_name"},this.props.labelName),r.createElement("div",{className:"components_control__slider_labels_value"},this.props.labelValue)),r.createElement("div",{className:"components_control__slider_control",ref:this.hitAreaRef,tabIndex:0,onKeyDown:this.onKeyDown},r.createElement("div",{className:"components_control__slider_track"},this.renderSliderFill()),r.createElement("div",{className:"components_control__slider_handle_holder",style:{transform:`translate3D(${n}px, -50%, 0px)`}},r.createElement("div",{className:i("components_control__slider_handle",{"components_control__slider_handle--fine":this.isInFineControlMode})}),this.props.tooltipKey&&r.createElement(l.ButtonTooltip,{tooltipKey:this.props.tooltipKey})),void 0!==this.props.modulatedValue&&r.createElement("div",{className:"components_control__modulation_dot",style:{transform:`translate3D(${a}px, -50%, 0px)`}})))}componentDidUpdate(){this.gesture.setTargetPercent(this.props.targetValue)}componentDidMount(){this.pointerObserver.startObserving(this.hitAreaRef.current,this.onPointerChange,{clampX:!1,clampY:!1}),this.sizeObserver.startObserving(this.hitAreaRef,this.onResize),this.animationFramer.startAnimating(this.onAnimationFrame)}componentWillUnmount(){this.animationFramer.stopAnimating(),this.sizeObserver.stopObserving(),this.pointerObserver.stopObserving()}onResize(){this.forceUpdate()}onAnimationFrame(){this.gesture.tick()||(this.notifyStateChange(1,this.props.targetValue),this.forceUpdate())}renderSliderFill(){const e=this.gesture.getPercent();if(this.props.bipolar){const t=`scaleX(${2*(e-.5)})`;return r.createElement("div",{className:"components_control__slider_fill components_control__slider_fill--bipolar",style:{transform:t}})}return r.createElement("div",{className:"components_control__slider_fill",style:{transform:`scaleX(${e})`}})}onPointerChange(e){const t=Math.abs(e.xPct-this.props.targetValue)<.05,n=e.yPct<-.2,r=e.yPct>.75&&e.xPct>=0&&e.xPct<=1;if(this.isInFineControlMode){const t=this.props.fineStep?this.props.fineStep:.01,n=e.xDelta>0||0===e.xDelta&&e.yDelta<0,r=e.xDelta<0||0===e.xDelta&&e.yDelta>0,i=Math.round(e.xDelta*this.sizeObserver.getWidth());e.xPct=n||r?this.props.targetValue+t*i:this.props.targetValue}else this.props.step&&(e.xPct=Math.round(e.xPct/this.props.step)*this.props.step);switch(e.xPct=u.clamp(e.xPct,0,1),e.type){case 0:this.isPointerDown=!0,this.wasActivated=!0,null!==this.hitAreaRef.current&&this.hitAreaRef.current.focus(),t?this.notifyStateChange(e.type,this.props.targetValue):(this.gesture.start(e.xPct),this.notifyStateChange(e.type,e.xPct));break;case 1:this.gesture.getIsActive()||(this.gesture.start(e.xPct),this.notifyStateChange(e.type,e.xPct)),n?this.enterFineControlMode():r&&this.leaveFineControlMode(),this.notifyStateChange(e.type,e.xPct);break;case 2:this.isPointerDown=!1,this.gesture.end(),this.notifyStateChange(e.type,e.xPct),this.leaveFineControlMode(),this.forceUpdate()}}onKeyDown(e){switch(e.key){case"Backspace":this.notifyReset();break;case"ArrowRight":if(this.props.step){const e=this.props.targetValue+this.props.step,t=Math.round(e/this.props.step)*this.props.step;this.notifyStateChange(1,t)}break;case"ArrowLeft":if(this.props.step){const e=this.props.targetValue-this.props.step,t=Math.round(e/this.props.step)*this.props.step;this.notifyStateChange(1,t)}}}notifyStateChange(e,t){this.props.callback&&this.props.callback({type:e,pctEased:this.gesture.getPercent(),pctRaw:t})}notifyReset(){this.props.resetCallback&&this.props.resetCallback()}enterFineControlMode(){this.props.fineStep&&(this.isInFineControlMode=!0,this.forceUpdate())}leaveFineControlMode(){this.isInFineControlMode=!1,this.forceUpdate()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0);t.PlayerObserver=class extends r.Component{constructor(e){super(e)}componentDidMount(){this.props.player.addPlayerListener(this)}componentWillUnmount(){this.props.player.removePlayerListener(this)}render(){return this.props.render()}onParameterEvent(e,t){this.props.parameters.indexOf(t)>-1&&this.forceUpdate()}}},function(e,t,n){"use strict";n.r(t),n.d(t,"GLTFLoader",function(){return i});var r=n(1),i=function(){function e(e){this.manager=void 0!==e?e:r.DefaultLoadingManager,this.dracoLoader=null}function t(){var e={};return{get:function(t){return e[t]},add:function(t,n){e[t]=n},remove:function(t){delete e[t]},removeAll:function(){e={}}}}e.prototype={constructor:e,crossOrigin:"anonymous",load:function(e,t,n,i){var a,o=this;a=void 0!==this.resourcePath?this.resourcePath:void 0!==this.path?this.path:r.LoaderUtils.extractUrlBase(e),o.manager.itemStart(e);var s=function(t){i?i(t):console.error(t),o.manager.itemError(e),o.manager.itemEnd(e)},c=new r.FileLoader(o.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.load(e,function(n){try{o.parse(n,a,function(n){t(n),o.manager.itemEnd(e)},s)}catch(e){s(e)}},n,s)},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setDRACOLoader:function(e){return this.dracoLoader=e,this},parse:function(e,t,c,l){var f,m={};if("string"==typeof e)f=e;else if(r.LoaderUtils.decodeText(new Uint8Array(e,0,4))===s){try{m[n.KHR_BINARY_GLTF]=new u(e)}catch(e){return void(l&&l(e))}f=m[n.KHR_BINARY_GLTF].content}else f=r.LoaderUtils.decodeText(new Uint8Array(e));var g=JSON.parse(f);if(void 0===g.asset||g.asset.version[0]<2)l&&l(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported. Use LegacyGLTFLoader instead."));else{if(g.extensionsUsed)for(var v=0;v<g.extensionsUsed.length;++v){var y=g.extensionsUsed[v],b=g.extensionsRequired||[];switch(y){case n.KHR_LIGHTS_PUNCTUAL:m[y]=new a(g);break;case n.KHR_MATERIALS_UNLIT:m[y]=new o(g);break;case n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:m[y]=new d(g);break;case n.KHR_DRACO_MESH_COMPRESSION:m[y]=new h(g,this.dracoLoader);break;case n.MSFT_TEXTURE_DDS:m[n.MSFT_TEXTURE_DDS]=new i;break;case n.KHR_TEXTURE_TRANSFORM:m[n.KHR_TEXTURE_TRANSFORM]=new p(g);break;default:b.indexOf(y)>=0&&console.warn('THREE.GLTFLoader: Unknown extension "'+y+'".')}}new F(g,m,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager}).parse(c,l)}}};var n={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};function i(){if(!THREE.DDSLoader)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing THREE.DDSLoader");this.name=n.MSFT_TEXTURE_DDS,this.ddsLoader=new THREE.DDSLoader}function a(e){this.name=n.KHR_LIGHTS_PUNCTUAL;var t=e.extensions&&e.extensions[n.KHR_LIGHTS_PUNCTUAL]||{};this.lightDefs=t.lights||[]}function o(e){this.name=n.KHR_MATERIALS_UNLIT}a.prototype.loadLight=function(e){var t,n=this.lightDefs[e],i=new r.Color(16777215);void 0!==n.color&&i.fromArray(n.color);var a=void 0!==n.range?n.range:0;switch(n.type){case"directional":(t=new r.DirectionalLight(i)).target.position.set(0,0,-1),t.add(t.target);break;case"point":(t=new r.PointLight(i)).distance=a;break;case"spot":(t=new r.SpotLight(i)).distance=a,n.spot=n.spot||{},n.spot.innerConeAngle=void 0!==n.spot.innerConeAngle?n.spot.innerConeAngle:0,n.spot.outerConeAngle=void 0!==n.spot.outerConeAngle?n.spot.outerConeAngle:Math.PI/4,t.angle=n.spot.outerConeAngle,t.penumbra=1-n.spot.innerConeAngle/n.spot.outerConeAngle,t.target.position.set(0,0,-1),t.add(t.target);break;default:throw new Error('THREE.GLTFLoader: Unexpected light type, "'+n.type+'".')}return t.position.set(0,0,0),t.decay=2,void 0!==n.intensity&&(t.intensity=n.intensity),t.name=n.name||"light_"+e,Promise.resolve(t)},o.prototype.getMaterialType=function(e){return r.MeshBasicMaterial},o.prototype.extendParams=function(e,t,n){var i=[];e.color=new r.Color(1,1,1),e.opacity=1;var a=t.pbrMetallicRoughness;if(a){if(Array.isArray(a.baseColorFactor)){var o=a.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}void 0!==a.baseColorTexture&&i.push(n.assignTexture(e,"map",a.baseColorTexture))}return Promise.all(i)};var s="glTF",c=12,l={JSON:1313821514,BIN:5130562};function u(e){this.name=n.KHR_BINARY_GLTF,this.content=null,this.body=null;var t=new DataView(e,0,c);if(this.header={magic:r.LoaderUtils.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==s)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected. Use LegacyGLTFLoader instead.");for(var i=new DataView(e,c),a=0;a<i.byteLength;){var o=i.getUint32(a,!0);a+=4;var u=i.getUint32(a,!0);if(a+=4,u===l.JSON){var h=new Uint8Array(e,c+a,o);this.content=r.LoaderUtils.decodeText(h)}else if(u===l.BIN){var p=c+a;this.body=e.slice(p,p+o)}a+=o}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}function h(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=n.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t}function p(e){this.name=n.KHR_TEXTURE_TRANSFORM}function d(){return{name:n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return r.ShaderMaterial},extendParams:function(e,t,n){var i=t.extensions[this.name],a=r.ShaderLib.standard,o=r.UniformsUtils.clone(a.uniforms),s=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),c=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),l=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),u=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),h=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","material.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),p=a.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",s).replace("#include <metalnessmap_pars_fragment>",c).replace("#include <roughnessmap_fragment>",l).replace("#include <metalnessmap_fragment>",u).replace("#include <lights_physical_fragment>",h);delete o.roughness,delete o.metalness,delete o.roughnessMap,delete o.metalnessMap,o.specular={value:(new r.Color).setHex(1118481)},o.glossiness={value:.5},o.specularMap={value:null},o.glossinessMap={value:null},e.vertexShader=a.vertexShader,e.fragmentShader=p,e.uniforms=o,e.defines={STANDARD:""},e.color=new r.Color(1,1,1),e.opacity=1;var d=[];if(Array.isArray(i.diffuseFactor)){var f=i.diffuseFactor;e.color.fromArray(f),e.opacity=f[3]}if(void 0!==i.diffuseTexture&&d.push(n.assignTexture(e,"map",i.diffuseTexture)),e.emissive=new r.Color(0,0,0),e.glossiness=void 0!==i.glossinessFactor?i.glossinessFactor:1,e.specular=new r.Color(1,1,1),Array.isArray(i.specularFactor)&&e.specular.fromArray(i.specularFactor),void 0!==i.specularGlossinessTexture){var m=i.specularGlossinessTexture;d.push(n.assignTexture(e,"glossinessMap",m)),d.push(n.assignTexture(e,"specularMap",m))}return Promise.all(d)},createMaterial:function(e){var t=new r.ShaderMaterial({defines:e.defines,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms,fog:!0,lights:!0,opacity:e.opacity,transparent:e.transparent});return t.isGLTFSpecularGlossinessMaterial=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t.extensions.derivatives=!0,t},cloneMaterial:function(e){var t=e.clone();t.isGLTFSpecularGlossinessMaterial=!0;for(var n=this.specularGlossinessParams,r=0,i=n.length;r<i;r++)t[n[r]]=e[n[r]];return t},refreshUniforms:function(e,t,n,r,i,a){if(!0===i.isGLTFSpecularGlossinessMaterial){var o,s=i.uniforms,c=i.defines;s.opacity.value=i.opacity,s.diffuse.value.copy(i.color),s.emissive.value.copy(i.emissive).multiplyScalar(i.emissiveIntensity),s.map.value=i.map,s.specularMap.value=i.specularMap,s.alphaMap.value=i.alphaMap,s.lightMap.value=i.lightMap,s.lightMapIntensity.value=i.lightMapIntensity,s.aoMap.value=i.aoMap,s.aoMapIntensity.value=i.aoMapIntensity,i.map?o=i.map:i.specularMap?o=i.specularMap:i.displacementMap?o=i.displacementMap:i.normalMap?o=i.normalMap:i.bumpMap?o=i.bumpMap:i.glossinessMap?o=i.glossinessMap:i.alphaMap?o=i.alphaMap:i.emissiveMap&&(o=i.emissiveMap),void 0!==o&&(o.isWebGLRenderTarget&&(o=o.texture),!0===o.matrixAutoUpdate&&o.updateMatrix(),s.uvTransform.value.copy(o.matrix)),i.envMap&&(s.envMap.value=i.envMap,s.envMapIntensity.value=i.envMapIntensity,s.flipEnvMap.value=i.envMap.isCubeTexture?-1:1,s.reflectivity.value=i.reflectivity,s.refractionRatio.value=i.refractionRatio,s.maxMipLevel.value=e.properties.get(i.envMap).__maxMipLevel),s.specular.value.copy(i.specular),s.glossiness.value=i.glossiness,s.glossinessMap.value=i.glossinessMap,s.emissiveMap.value=i.emissiveMap,s.bumpMap.value=i.bumpMap,s.normalMap.value=i.normalMap,s.displacementMap.value=i.displacementMap,s.displacementScale.value=i.displacementScale,s.displacementBias.value=i.displacementBias,null!==s.glossinessMap.value&&void 0===c.USE_GLOSSINESSMAP&&(c.USE_GLOSSINESSMAP="",c.USE_ROUGHNESSMAP=""),null===s.glossinessMap.value&&void 0!==c.USE_GLOSSINESSMAP&&(delete c.USE_GLOSSINESSMAP,delete c.USE_ROUGHNESSMAP)}}}}function f(e,t,n,i){r.Interpolant.call(this,e,t,n,i)}h.prototype.decodePrimitive=function(e,t){var n=this.json,r=this.dracoLoader,i=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,o={},s={},c={};for(var l in a){var u=P[l]||l.toLowerCase();o[u]=a[l]}for(l in e.attributes){u=P[l]||l.toLowerCase();if(void 0!==a[l]){var h=n.accessors[e.attributes[l]],p=E[h.componentType];c[u]=p,s[u]=!0===h.normalized}}return t.getDependency("bufferView",i).then(function(e){return new Promise(function(t){r.decodeDracoFile(e,function(e){for(var n in e.attributes){var r=e.attributes[n],i=s[n];void 0!==i&&(r.normalized=i)}t(e)},o,c)})})},p.prototype.extendTexture=function(e,t){return e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),e.needsUpdate=!0,e},f.prototype=Object.create(r.Interpolant.prototype),f.prototype.constructor=f,f.prototype.copySampleValue_=function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r*3+r,a=0;a!==r;a++)t[a]=n[i+a];return t},f.prototype.beforeStart_=f.prototype.copySampleValue_,f.prototype.afterEnd_=f.prototype.copySampleValue_,f.prototype.interpolate_=function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=2*o,c=3*o,l=r-t,u=(n-t)/l,h=u*u,p=h*u,d=e*c,f=d-c,m=-2*p+3*h,g=p-h,v=1-m,y=g-h+u,b=0;b!==o;b++){var _=a[f+b+o],w=a[f+b+s]*l,x=a[d+b+o],E=a[d+b]*l;i[b]=v*_+y*w+m*x+g*E}return i};var m,g=0,v=1,y=2,b=3,_=4,w=5,x=6,E=(Number,r.Matrix3,r.Matrix4,r.Vector2,r.Vector3,r.Vector4,r.Texture,{5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array}),M={9728:r.NearestFilter,9729:r.LinearFilter,9984:r.NearestMipMapNearestFilter,9985:r.LinearMipMapNearestFilter,9986:r.NearestMipMapLinearFilter,9987:r.LinearMipMapLinearFilter},S={33071:r.ClampToEdgeWrapping,33648:r.MirroredRepeatWrapping,10497:r.RepeatWrapping},T=(r.BackSide,r.FrontSide,r.NeverDepth,r.LessDepth,r.EqualDepth,r.LessEqualDepth,r.GreaterEqualDepth,r.NotEqualDepth,r.GreaterEqualDepth,r.AlwaysDepth,r.AddEquation,r.SubtractEquation,r.ReverseSubtractEquation,r.ZeroFactor,r.OneFactor,r.SrcColorFactor,r.OneMinusSrcColorFactor,r.SrcAlphaFactor,r.OneMinusSrcAlphaFactor,r.DstAlphaFactor,r.OneMinusDstAlphaFactor,r.DstColorFactor,r.OneMinusDstColorFactor,r.SrcAlphaSaturateFactor,{SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16}),P={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},A={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},O={CUBICSPLINE:void 0,LINEAR:r.InterpolateLinear,STEP:r.InterpolateDiscrete},C="OPAQUE",R="MASK",L="BLEND",I={"image/png":r.RGBAFormat,"image/jpeg":r.RGBFormat};function k(e,t){return"string"!=typeof e||""===e?"":/^(https?:)?\/\//i.test(e)?e:/^data:.*,.*$/i.test(e)?e:/^blob:.*$/i.test(e)?e:t+e}function N(e,t,n){for(var r in n.extensions)void 0===e[r]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[r]=n.extensions[r])}function z(e,t){void 0!==t.extras&&("object"==typeof t.extras?e.userData=t.extras:console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function D(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var n=0,r=t.weights.length;n<r;n++)e.morphTargetInfluences[n]=t.weights[n];if(t.extras&&Array.isArray(t.extras.targetNames)){var i=t.extras.targetNames;if(e.morphTargetInfluences.length===i.length){e.morphTargetDictionary={};for(n=0,r=i.length;n<r;n++)e.morphTargetDictionary[i[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function B(e){for(var t="",n=Object.keys(e).sort(),r=0,i=n.length;r<i;r++)t+=n[r]+":"+e[n[r]]+";";return t}function j(e){if(e.isInterleavedBufferAttribute){for(var t=e.count,n=e.itemSize,i=e.array.slice(0,t*n),a=0,o=0;a<t;++a)i[o++]=e.getX(a),n>=2&&(i[o++]=e.getY(a)),n>=3&&(i[o++]=e.getZ(a)),n>=4&&(i[o++]=e.getW(a));return new r.BufferAttribute(i,n,e.normalized)}return e.clone()}function F(e,n,i){this.json=e||{},this.extensions=n||{},this.options=i||{},this.cache=new t,this.primitiveCache={},this.textureLoader=new r.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new r.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer")}function U(e,t,n){var r=t.attributes,i=[];function a(t,r){return n.getDependency("accessor",t).then(function(t){e.addAttribute(r,t)})}for(var o in r){var s=P[o]||o.toLowerCase();s in e.attributes||i.push(a(r[o],s))}if(void 0!==t.indices&&!e.index){var c=n.getDependency("accessor",t.indices).then(function(t){e.setIndex(t)});i.push(c)}return z(e,t),Promise.all(i).then(function(){return void 0!==t.targets?function(e,t,n){for(var r=!1,i=!1,a=0,o=t.length;a<o&&(void 0!==(l=t[a]).POSITION&&(r=!0),void 0!==l.NORMAL&&(i=!0),!r||!i);a++);if(!r&&!i)return Promise.resolve(e);var s=[],c=[];for(a=0,o=t.length;a<o;a++){var l=t[a];if(r){var u=void 0!==l.POSITION?n.getDependency("accessor",l.POSITION):e.attributes.position;s.push(u)}i&&(u=void 0!==l.NORMAL?n.getDependency("accessor",l.NORMAL):e.attributes.normal,c.push(u))}return Promise.all([Promise.all(s),Promise.all(c)]).then(function(n){for(var a=n[0],o=n[1],s=0,c=a.length;s<c;s++)e.attributes.position!==a[s]&&(a[s]=j(a[s]));for(s=0,c=o.length;s<c;s++)e.attributes.normal!==o[s]&&(o[s]=j(o[s]));for(s=0,c=t.length;s<c;s++){var l=t[s],u="morphTarget"+s;if(r&&void 0!==l.POSITION){var h=a[s];h.name=u;for(var p=e.attributes.position,d=0,f=h.count;d<f;d++)h.setXYZ(d,h.getX(d)+p.getX(d),h.getY(d)+p.getY(d),h.getZ(d)+p.getZ(d))}if(i&&void 0!==l.NORMAL){var m=o[s];m.name=u;var g=e.attributes.normal;for(d=0,f=m.count;d<f;d++)m.setXYZ(d,m.getX(d)+g.getX(d),m.getY(d)+g.getY(d),m.getZ(d)+g.getZ(d))}}return r&&(e.morphAttributes.position=a),i&&(e.morphAttributes.normal=o),e})}(e,t.targets,n):e})}return F.prototype.parse=function(e,t){var n=this,r=this.json,i=this.extensions;this.cache.removeAll(),this.markDefs(),Promise.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then(function(t){var a={scene:t[0][r.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:r.asset,parser:n,userData:{}};N(i,a,r),e(a)}).catch(t)},F.prototype.markDefs=function(){for(var e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[],r={},i={},a=0,o=t.length;a<o;a++)for(var s=t[a].joints,c=0,l=s.length;c<l;c++)e[s[c]].isBone=!0;for(var u=0,h=e.length;u<h;u++){var p=e[u];void 0!==p.mesh&&(void 0===r[p.mesh]&&(r[p.mesh]=i[p.mesh]=0),r[p.mesh]++,void 0!==p.skin&&(n[p.mesh].isSkinnedMesh=!0))}this.json.meshReferences=r,this.json.meshUses=i},F.prototype.getDependency=function(e,t){var r=e+":"+t,i=this.cache.get(r);if(!i){switch(e){case"scene":i=this.loadScene(t);break;case"node":i=this.loadNode(t);break;case"mesh":i=this.loadMesh(t);break;case"accessor":i=this.loadAccessor(t);break;case"bufferView":i=this.loadBufferView(t);break;case"buffer":i=this.loadBuffer(t);break;case"material":i=this.loadMaterial(t);break;case"texture":i=this.loadTexture(t);break;case"skin":i=this.loadSkin(t);break;case"animation":i=this.loadAnimation(t);break;case"camera":i=this.loadCamera(t);break;case"light":i=this.extensions[n.KHR_LIGHTS_PUNCTUAL].loadLight(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(r,i)}return i},F.prototype.getDependencies=function(e){var t=this.cache.get(e);if(!t){var n=this,r=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(r.map(function(t,r){return n.getDependency(e,r)})),this.cache.add(e,t)}return t},F.prototype.loadBuffer=function(e){var t=this.json.buffers[e],r=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[n.KHR_BINARY_GLTF].body);var i=this.options;return new Promise(function(e,n){r.load(k(t.uri,i.path),e,void 0,function(){n(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})},F.prototype.loadBufferView=function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(e){var n=t.byteLength||0,r=t.byteOffset||0;return e.slice(r,r+n)})},F.prototype.loadAccessor=function(e){var t=this,n=this.json,i=this.json.accessors[e];if(void 0===i.bufferView&&void 0===i.sparse)return Promise.resolve(null);var a=[];return void 0!==i.bufferView?a.push(this.getDependency("bufferView",i.bufferView)):a.push(null),void 0!==i.sparse&&(a.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),a.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(a).then(function(e){var a,o,s=e[0],c=T[i.type],l=E[i.componentType],u=l.BYTES_PER_ELEMENT,h=u*c,p=i.byteOffset||0,d=void 0!==i.bufferView?n.bufferViews[i.bufferView].byteStride:void 0,f=!0===i.normalized;if(d&&d!==h){var m="InterleavedBuffer:"+i.bufferView+":"+i.componentType,g=t.cache.get(m);g||(a=new l(s),g=new r.InterleavedBuffer(a,d/u),t.cache.add(m,g)),o=new r.InterleavedBufferAttribute(g,c,p/u,f)}else a=null===s?new l(i.count*c):new l(s,p,i.count*c),o=new r.BufferAttribute(a,c,f);if(void 0!==i.sparse){var v=T.SCALAR,y=E[i.sparse.indices.componentType],b=i.sparse.indices.byteOffset||0,_=i.sparse.values.byteOffset||0,w=new y(e[1],b,i.sparse.count*v),x=new l(e[2],_,i.sparse.count*c);null!==s&&o.setArray(o.array.slice());for(var M=0,S=w.length;M<S;M++){var P=w[M];if(o.setX(P,x[M*c]),c>=2&&o.setY(P,x[M*c+1]),c>=3&&o.setZ(P,x[M*c+2]),c>=4&&o.setW(P,x[M*c+3]),c>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return o})},F.prototype.loadTexture=function(e){var t,i=this,a=this.json,o=this.options,s=this.textureLoader,c=window.URL||window.webkitURL,l=a.textures[e],u=l.extensions||{},h=(t=u[n.MSFT_TEXTURE_DDS]?a.images[u[n.MSFT_TEXTURE_DDS].source]:a.images[l.source]).uri,p=!1;return void 0!==t.bufferView&&(h=i.getDependency("bufferView",t.bufferView).then(function(e){p=!0;var n=new Blob([e],{type:t.mimeType});return h=c.createObjectURL(n)})),Promise.resolve(h).then(function(e){var t=r.Loader.Handlers.get(e);return t||(t=u[n.MSFT_TEXTURE_DDS]?i.extensions[n.MSFT_TEXTURE_DDS].ddsLoader:s),new Promise(function(n,r){t.load(k(e,o.path),n,void 0,r)})}).then(function(e){!0===p&&c.revokeObjectURL(h),e.flipY=!1,void 0!==l.name&&(e.name=l.name),t.mimeType in I&&(e.format=I[t.mimeType]);var n=(a.samplers||{})[l.sampler]||{};return e.magFilter=M[n.magFilter]||r.LinearFilter,e.minFilter=M[n.minFilter]||r.LinearMipMapLinearFilter,e.wrapS=S[n.wrapS]||r.RepeatWrapping,e.wrapT=S[n.wrapT]||r.RepeatWrapping,e})},F.prototype.assignTexture=function(e,t,i){var a=this;return this.getDependency("texture",i.index).then(function(o){switch(t){case"aoMap":case"emissiveMap":case"metalnessMap":case"normalMap":case"roughnessMap":o.format=r.RGBFormat}if(a.extensions[n.KHR_TEXTURE_TRANSFORM]){var s=void 0!==i.extensions?i.extensions[n.KHR_TEXTURE_TRANSFORM]:void 0;s&&(o=a.extensions[n.KHR_TEXTURE_TRANSFORM].extendTexture(o,s))}e[t]=o})},F.prototype.assignFinalMaterial=function(e){var t=e.geometry,i=e.material,a=this.extensions,o=void 0!==t.attributes.tangent,s=void 0!==t.attributes.color,c=void 0===t.attributes.normal,l=!0===e.isSkinnedMesh,u=Object.keys(t.morphAttributes).length>0,h=u&&void 0!==t.morphAttributes.normal;if(e.isPoints){var p="PointsMaterial:"+i.uuid,d=this.cache.get(p);d||(d=new r.PointsMaterial,r.Material.prototype.copy.call(d,i),d.color.copy(i.color),d.map=i.map,d.lights=!1,this.cache.add(p,d)),i=d}else if(e.isLine){p="LineBasicMaterial:"+i.uuid;var f=this.cache.get(p);f||(f=new r.LineBasicMaterial,r.Material.prototype.copy.call(f,i),f.color.copy(i.color),f.lights=!1,this.cache.add(p,f)),i=f}if(o||s||c||l||u){p="ClonedMaterial:"+i.uuid+":";i.isGLTFSpecularGlossinessMaterial&&(p+="specular-glossiness:"),l&&(p+="skinning:"),o&&(p+="vertex-tangents:"),s&&(p+="vertex-colors:"),c&&(p+="flat-shading:"),u&&(p+="morph-targets:"),h&&(p+="morph-normals:");var m=this.cache.get(p);m||(m=i.isGLTFSpecularGlossinessMaterial?a[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].cloneMaterial(i):i.clone(),l&&(m.skinning=!0),o&&(m.vertexTangents=!0),s&&(m.vertexColors=r.VertexColors),c&&(m.flatShading=!0),u&&(m.morphTargets=!0),h&&(m.morphNormals=!0),this.cache.add(p,m)),i=m}i.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&(console.log("THREE.GLTFLoader: Duplicating UVs to support aoMap."),t.addAttribute("uv2",new r.BufferAttribute(t.attributes.uv.array,2))),i.isGLTFSpecularGlossinessMaterial&&(e.onBeforeRender=a[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].refreshUniforms),e.material=i},F.prototype.loadMaterial=function(e){var t,i=this.json,a=this.extensions,o=i.materials[e],s={},c=o.extensions||{},l=[];if(c[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var u=a[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];t=u.getMaterialType(o),l.push(u.extendParams(s,o,this))}else if(c[n.KHR_MATERIALS_UNLIT]){var h=a[n.KHR_MATERIALS_UNLIT];t=h.getMaterialType(o),l.push(h.extendParams(s,o,this))}else{t=r.MeshStandardMaterial;var p=o.pbrMetallicRoughness||{};if(s.color=new r.Color(1,1,1),s.opacity=1,Array.isArray(p.baseColorFactor)){var d=p.baseColorFactor;s.color.fromArray(d),s.opacity=d[3]}void 0!==p.baseColorTexture&&l.push(this.assignTexture(s,"map",p.baseColorTexture)),s.metalness=void 0!==p.metallicFactor?p.metallicFactor:1,s.roughness=void 0!==p.roughnessFactor?p.roughnessFactor:1,void 0!==p.metallicRoughnessTexture&&(l.push(this.assignTexture(s,"metalnessMap",p.metallicRoughnessTexture)),l.push(this.assignTexture(s,"roughnessMap",p.metallicRoughnessTexture)))}!0===o.doubleSided&&(s.side=r.DoubleSide);var f=o.alphaMode||C;return f===L?s.transparent=!0:(s.transparent=!1,f===R&&(s.alphaTest=void 0!==o.alphaCutoff?o.alphaCutoff:.5)),void 0!==o.normalTexture&&t!==r.MeshBasicMaterial&&(l.push(this.assignTexture(s,"normalMap",o.normalTexture)),s.normalScale=new r.Vector2(1,1),void 0!==o.normalTexture.scale&&s.normalScale.set(o.normalTexture.scale,o.normalTexture.scale)),void 0!==o.occlusionTexture&&t!==r.MeshBasicMaterial&&(l.push(this.assignTexture(s,"aoMap",o.occlusionTexture)),void 0!==o.occlusionTexture.strength&&(s.aoMapIntensity=o.occlusionTexture.strength)),void 0!==o.emissiveFactor&&t!==r.MeshBasicMaterial&&(s.emissive=(new r.Color).fromArray(o.emissiveFactor)),void 0!==o.emissiveTexture&&t!==r.MeshBasicMaterial&&l.push(this.assignTexture(s,"emissiveMap",o.emissiveTexture)),Promise.all(l).then(function(){var e;return e=t===r.ShaderMaterial?a[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(s):new t(s),void 0!==o.name&&(e.name=o.name),e.map&&(e.map.encoding=r.sRGBEncoding),e.emissiveMap&&(e.emissiveMap.encoding=r.sRGBEncoding),e.specularMap&&(e.specularMap.encoding=r.sRGBEncoding),z(e,o),o.extensions&&N(a,e,o),e})},F.prototype.loadGeometries=function(e){var t=this,i=this.extensions,a=this.primitiveCache;function o(e){return i[n.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then(function(n){return U(n,e,t)})}for(var s,c,l=[],u=0,h=e.length;u<h;u++){var p,d=e[u],f=(c=void 0,(c=(s=d).extensions&&s.extensions[n.KHR_DRACO_MESH_COMPRESSION])?"draco:"+c.bufferView+":"+c.indices+":"+B(c.attributes):s.indices+":"+B(s.attributes)+":"+s.mode),m=a[f];if(m)l.push(m.promise);else p=d.extensions&&d.extensions[n.KHR_DRACO_MESH_COMPRESSION]?o(d):U(new r.BufferGeometry,d,t),a[f]={primitive:d,promise:p},l.push(p)}return Promise.all(l)},F.prototype.loadMesh=function(e){for(var t=this,n=this.json,i=(this.extensions,n.meshes[e]),a=i.primitives,o=[],s=0,c=a.length;s<c;s++){var l=void 0===a[s].material?m=m||new r.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:r.FrontSide}):this.getDependency("material",a[s].material);o.push(l)}return Promise.all(o).then(function(n){return t.loadGeometries(a).then(function(o){for(var s=[],c=0,l=o.length;c<l;c++){var u,h=o[c],p=a[c],d=n[c];if(p.mode===_||p.mode===w||p.mode===x||void 0===p.mode)!0===(u=!0===i.isSkinnedMesh?new r.SkinnedMesh(h,d):new r.Mesh(h,d)).isSkinnedMesh&&u.normalizeSkinWeights(),p.mode===w?u.drawMode=r.TriangleStripDrawMode:p.mode===x&&(u.drawMode=r.TriangleFanDrawMode);else if(p.mode===v)u=new r.LineSegments(h,d);else if(p.mode===b)u=new r.Line(h,d);else if(p.mode===y)u=new r.LineLoop(h,d);else{if(p.mode!==g)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+p.mode);u=new r.Points(h,d)}Object.keys(u.geometry.morphAttributes).length>0&&D(u,i),u.name=i.name||"mesh_"+e,o.length>1&&(u.name+="_"+c),z(u,i),t.assignFinalMaterial(u),s.push(u)}if(1===s.length)return s[0];var f=new r.Group;for(c=0,l=s.length;c<l;c++)f.add(s[c]);return f})})},F.prototype.loadCamera=function(e){var t,n=this.json.cameras[e],i=n[n.type];if(i)return"perspective"===n.type?t=new r.PerspectiveCamera(r.Math.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):"orthographic"===n.type&&(t=new r.OrthographicCamera(i.xmag/-2,i.xmag/2,i.ymag/2,i.ymag/-2,i.znear,i.zfar)),void 0!==n.name&&(t.name=n.name),z(t,n),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")},F.prototype.loadSkin=function(e){var t=this.json.skins[e],n={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(n):this.getDependency("accessor",t.inverseBindMatrices).then(function(e){return n.inverseBindMatrices=e,n})},F.prototype.loadAnimation=function(e){for(var t=this.json.animations[e],n=[],i=[],a=[],o=[],s=[],c=0,l=t.channels.length;c<l;c++){var u=t.channels[c],h=t.samplers[u.sampler],p=u.target,d=void 0!==p.node?p.node:p.id,m=void 0!==t.parameters?t.parameters[h.input]:h.input,g=void 0!==t.parameters?t.parameters[h.output]:h.output;n.push(this.getDependency("node",d)),i.push(this.getDependency("accessor",m)),a.push(this.getDependency("accessor",g)),o.push(h),s.push(p)}return Promise.all([Promise.all(n),Promise.all(i),Promise.all(a),Promise.all(o),Promise.all(s)]).then(function(n){for(var i=n[0],a=n[1],o=n[2],s=n[3],c=n[4],l=[],u=0,h=i.length;u<h;u++){var p=i[u],d=a[u],m=o[u],g=s[u],v=c[u];if(void 0!==p){var y;switch(p.updateMatrix(),p.matrixAutoUpdate=!0,A[v.path]){case A.weights:y=r.NumberKeyframeTrack;break;case A.rotation:y=r.QuaternionKeyframeTrack;break;case A.position:case A.scale:default:y=r.VectorKeyframeTrack}var b=p.name?p.name:p.uuid,_=void 0!==g.interpolation?O[g.interpolation]:r.InterpolateLinear,w=[];A[v.path]===A.weights?p.traverse(function(e){!0===e.isMesh&&e.morphTargetInfluences&&w.push(e.name?e.name:e.uuid)}):w.push(b);for(var x=0,E=w.length;x<E;x++){var M=new y(w[x]+"."+A[v.path],d.array,m.array,_);"CUBICSPLINE"===g.interpolation&&(M.createInterpolant=function(e){return new f(this.times,this.values,this.getValueSize()/3,e)},M.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),l.push(M)}}}var S=void 0!==t.name?t.name:"animation_"+e;return new r.AnimationClip(S,void 0,l)})},F.prototype.loadNode=function(e){var t=this.json,i=this.extensions,a=this,o=t.meshReferences,s=t.meshUses,c=t.nodes[e];return(!0===c.isBone?Promise.resolve(new r.Bone):void 0!==c.mesh?a.getDependency("mesh",c.mesh).then(function(e){var t;if(o[c.mesh]>1){var n=s[c.mesh]++;(t=e.clone()).name+="_instance_"+n,t.onBeforeRender=e.onBeforeRender;for(var r=0,i=t.children.length;r<i;r++)t.children[r].name+="_instance_"+n,t.children[r].onBeforeRender=e.children[r].onBeforeRender}else t=e;return void 0!==c.weights&&t.traverse(function(e){if(e.isMesh)for(var t=0,n=c.weights.length;t<n;t++)e.morphTargetInfluences[t]=c.weights[t]}),t}):void 0!==c.camera?a.getDependency("camera",c.camera):c.extensions&&c.extensions[n.KHR_LIGHTS_PUNCTUAL]&&void 0!==c.extensions[n.KHR_LIGHTS_PUNCTUAL].light?a.getDependency("light",c.extensions[n.KHR_LIGHTS_PUNCTUAL].light):Promise.resolve(new r.Object3D)).then(function(e){if(void 0!==c.name&&(e.name=r.PropertyBinding.sanitizeNodeName(c.name)),z(e,c),c.extensions&&N(i,e,c),void 0!==c.matrix){var t=new r.Matrix4;t.fromArray(c.matrix),e.applyMatrix(t)}else void 0!==c.translation&&e.position.fromArray(c.translation),void 0!==c.rotation&&e.quaternion.fromArray(c.rotation),void 0!==c.scale&&e.scale.fromArray(c.scale);return e})},F.prototype.loadScene=function(){function e(t,n,i,a){var o=i.nodes[t];return a.getDependency("node",t).then(function(e){return void 0===o.skin?e:a.getDependency("skin",o.skin).then(function(e){for(var n=[],r=0,i=(t=e).joints.length;r<i;r++)n.push(a.getDependency("node",t.joints[r]));return Promise.all(n)}).then(function(n){for(var i=!0===e.isGroup?e.children:[e],a=0,o=i.length;a<o;a++){for(var s=i[a],c=[],l=[],u=0,h=n.length;u<h;u++){var p=n[u];if(p){c.push(p);var d=new r.Matrix4;void 0!==t.inverseBindMatrices&&d.fromArray(t.inverseBindMatrices.array,16*u),l.push(d)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[u])}s.bind(new r.Skeleton(c,l),s.matrixWorld)}return e});var t}).then(function(t){n.add(t);var r=[];if(o.children)for(var s=o.children,c=0,l=s.length;c<l;c++){var u=s[c];r.push(e(u,t,i,a))}return Promise.all(r)})}return function(t){var n=this.json,i=this.extensions,a=this.json.scenes[t],o=new r.Scene;void 0!==a.name&&(o.name=a.name),z(o,a),a.extensions&&N(i,o,a);for(var s=a.nodes||[],c=[],l=0,u=s.length;l<u;l++)c.push(e(s[l],o,n,this));return Promise.all(c).then(function(){return o})}}(),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(25);t.getShadowMapSetting=function(){switch(r.getAudioQualitySetting()){case"high":return!0;case"medium":case"low":default:return!1}},t.getPixelRatioSetting=function(){switch(r.getAudioQualitySetting()){case"high":case"medium":return window.devicePixelRatio;case"low":default:return 1}},t.getAntialiasingSetting=function(){switch(r.getAudioQualitySetting()){case"high":case"medium":return!0;case"low":default:return!1}}},function(e,t,n){var r=n(113);e.exports=d,e.exports.parse=a,e.exports.compile=function(e,t){return s(a(e,t))},e.exports.tokensToFunction=s,e.exports.tokensToRegExp=p;var i=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function a(e,t){for(var n,r=[],a=0,o=0,s="",u=t&&t.delimiter||"/";null!=(n=i.exec(e));){var h=n[0],p=n[1],d=n.index;if(s+=e.slice(o,d),o=d+h.length,p)s+=p[1];else{var f=e[o],m=n[2],g=n[3],v=n[4],y=n[5],b=n[6],_=n[7];s&&(r.push(s),s="");var w=null!=m&&null!=f&&f!==m,x="+"===b||"*"===b,E="?"===b||"*"===b,M=n[2]||u,S=v||y;r.push({name:g||a++,prefix:m||"",delimiter:M,optional:E,repeat:x,partial:w,asterisk:!!_,pattern:S?l(S):_?".*":"[^"+c(M)+"]+?"})}}return o<e.length&&(s+=e.substr(o)),s&&r.push(s),r}function o(e){return encodeURI(e).replace(/[\/?#]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function s(e){for(var t=new Array(e.length),n=0;n<e.length;n++)"object"==typeof e[n]&&(t[n]=new RegExp("^(?:"+e[n].pattern+")$"));return function(n,i){for(var a="",s=n||{},c=(i||{}).pretty?o:encodeURIComponent,l=0;l<e.length;l++){var u=e[l];if("string"!=typeof u){var h,p=s[u.name];if(null==p){if(u.optional){u.partial&&(a+=u.prefix);continue}throw new TypeError('Expected "'+u.name+'" to be defined')}if(r(p)){if(!u.repeat)throw new TypeError('Expected "'+u.name+'" to not repeat, but received `'+JSON.stringify(p)+"`");if(0===p.length){if(u.optional)continue;throw new TypeError('Expected "'+u.name+'" to not be empty')}for(var d=0;d<p.length;d++){if(h=c(p[d]),!t[l].test(h))throw new TypeError('Expected all "'+u.name+'" to match "'+u.pattern+'", but received `'+JSON.stringify(h)+"`");a+=(0===d?u.prefix:u.delimiter)+h}}else{if(h=u.asterisk?encodeURI(p).replace(/[?#]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}):c(p),!t[l].test(h))throw new TypeError('Expected "'+u.name+'" to match "'+u.pattern+'", but received "'+h+'"');a+=u.prefix+h}}else a+=u}return a}}function c(e){return e.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function l(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function u(e,t){return e.keys=t,e}function h(e){return e.sensitive?"":"i"}function p(e,t,n){r(t)||(n=t||n,t=[]);for(var i=(n=n||{}).strict,a=!1!==n.end,o="",s=0;s<e.length;s++){var l=e[s];if("string"==typeof l)o+=c(l);else{var p=c(l.prefix),d="(?:"+l.pattern+")";t.push(l),l.repeat&&(d+="(?:"+p+d+")*"),o+=d=l.optional?l.partial?p+"("+d+")?":"(?:"+p+"("+d+"))?":p+"("+d+")"}}var f=c(n.delimiter||"/"),m=o.slice(-f.length)===f;return i||(o=(m?o.slice(0,-f.length):o)+"(?:"+f+"(?=$))?"),o+=a?"$":i&&m?"":"(?="+f+"|$)",u(new RegExp("^"+o,h(n)),t)}function d(e,t,n){return r(t)||(n=t||n,t=[]),n=n||{},e instanceof RegExp?function(e,t){var n=e.source.match(/\((?!\?)/g);if(n)for(var r=0;r<n.length;r++)t.push({name:r,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return u(e,t)}(e,t):r(e)?function(e,t,n){for(var r=[],i=0;i<e.length;i++)r.push(d(e[i],t,n).source);return u(new RegExp("(?:"+r.join("|")+")",h(n)),t)}(e,t,n):function(e,t,n){return p(a(e,n),t,n)}(e,t,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(25);let i;const a=[];function o(e){(i=e).onstatechange=c,c()}function s(){i=void 0}function c(){for(const e of i.inputs.values())e.onmidimessage=l}function l(e){const t=e.data[0],n=e.data[1],r=e.data.length>2?e.data[2]:0;switch(t){case 144:0===r?u(n,r):function(e,t){if(document.hidden)return;a.forEach(n=>{n.onNoteOn(e,t)})}(n,r);break;case 128:u(n,r)}}function u(e,t){a.forEach(n=>{n.onNoteOff(e,t)})}t.isWebMidiAvailable=function(){return void 0!==navigator.requestMIDIAccess},t.addListener=function(e){a.indexOf(e)>-1||a.push(e)},t.removeListener=function(e){const t=a.indexOf(e);t>-1&&a.splice(t,1)},t.init=function(){return"none"===r.getMIDIInputSetting()?Promise.resolve():navigator.requestMIDIAccess?navigator.requestMIDIAccess().then(o,s):Promise.resolve()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(12),i=n(106);let a,o;t.init=function(){return new Promise(e=>{i.createNode(r.urlForFile("rnbo/patches/rnbo-test.json")).then(t=>{a=t,e(t)})})},t.provideInstrument=function(e){if(void 0===a)throw new Error("RNBO node not initialized!");return o===e||void 0===o?(o=e,a):(o.relinquishInstrument(),o=e,a)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(12);let i;function a(){if(void 0===i)throw new Error("Forgot to initialize preset librarian");return i}t.init=function(){return fetch(r.urlForFile("presets/preset-catalog.json")).then(e=>e.text()).then(e=>JSON.parse(e)).then(e=>{i=e})},t.getPresetCatalog=a,t.findLessonPreset=function(e,t){return a()[e+".preset"]}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";function r(e,t){return e.chapters.findIndex(e=>e.id===t)}Object.defineProperty(t,"__esModule",{value:!0}),t.resolveIds=function(e,t,n){let r,i,a=-1,o=-1;if(void 0!==t){if(-1===(a=e.chapters.findIndex(e=>e.id===t)))return;if(r=e.chapters[a],void 0!==n){if(-1===(o=r.pages.findIndex(e=>e.id===n)))return;i=r.pages[o]}else o=0,i=r.pages[0]}else a=0,o=0,i=(r=e.chapters[0]).pages[0];return{lesson:e,chapter:r,page:i,chapterIndex:a,pageIndex:o}},t.findChapterIndexWithId=r,t.findNextPage=function(e,t,n){let i=r(e,t);-1===i&&(i=0);const a=e.chapters[i];let o=a.pages.findIndex(e=>e.id===n);-1===o&&(o=0);const s=o+1;if(s===a.pages.length){const t=i+1;if(t===e.chapters.length)return;{const n=e.chapters[t],r=n.pages[0];return{lessonId:e.id,chapterId:n.id,pageId:r.id}}}{const n=a.pages[s];return{lessonId:e.id,chapterId:t,pageId:n.id}}},t.findPrevPage=function(e,t,n){let i=r(e,t);-1===i&&(i=0);const a=e.chapters[i];let o=a.pages.findIndex(e=>e.id===n);-1===o&&(o=0);const s=o-1;if(-1===s){const t=i-1;if(-1===t)return;{const n=e.chapters[t],r=n.pages[n.pages.length-1];return{lessonId:e.id,chapterId:n.id,pageId:r.id}}}{const n=a.pages[s];return{lessonId:e.id,chapterId:t,pageId:n.id}}}},function(e,t,n){"use strict";var r=n(150),i=n(151),a=n(35),o=n(152),s=n(153),c=n(154);e.exports=function(e,t){var n,a,o={};t||(t={});for(a in p)n=t[a],o[a]=null==n?p[a]:n;(o.position.indent||o.position.start)&&(o.indent=o.position.indent||[],o.position=o.position.start);return function(e,t){var n,a,o,p,j,F,U,V,H,G,W,q,X,Y,K,$,Z,J,Q,ee=t.additional,te=t.nonTerminated,ne=t.text,re=t.reference,ie=t.warning,ae=t.textContext,oe=t.referenceContext,se=t.warningContext,ce=t.position,le=t.indent||[],ue=e.length,he=0,pe=-1,de=ce.column||1,fe=ce.line||1,me="",ge=[];"string"==typeof ee&&(ee=ee.charCodeAt(0));$=ye(),V=ie?function(e,t){var n=ye();n.column+=t,n.offset+=t,ie.call(se,D[e],n,e)}:h,he--,ue++;for(;++he<ue;)if(j===f&&(de=le[pe]||1),(j=e.charCodeAt(he))===v){if((U=e.charCodeAt(he+1))===d||U===f||U===m||U===g||U===v||U===b||U!=U||ee&&U===ee){me+=u(j),de++;continue}for(q=X=he+1,Q=X,U===w?(Q=++q,(U=e.charCodeAt(Q))===x||U===E?(Y=T,Q=++q):Y=P):Y=S,n="",W="",p="",K=O[Y],Q--;++Q<ue&&(U=e.charCodeAt(Q),K(U));)p+=u(U),Y===S&&l.call(r,p)&&(n=p,W=r[p]);(o=e.charCodeAt(Q)===y)&&(Q++,(a=Y===S&&c(p))&&(n=p,W=a)),J=1+Q-X,(o||te)&&(p?Y===S?(o&&!W?V(k,1):(n!==p&&(Q=q+n.length,J=1+Q-q,o=!1),o||(H=n?C:L,t.attribute?(U=e.charCodeAt(Q))===_?(V(H,J),W=null):s(U)?W=null:V(H,J):V(H,J))),F=W):(o||V(R,J),F=parseInt(p,A[Y]),(ve=F)>=55296&&ve<=57343||ve>1114111?(V(z,J),F=u(M)):F in i?(V(N,J),F=i[F]):(G="",B(F)&&V(N,J),F>65535&&(G+=u((F-=65536)>>>10|55296),F=56320|1023&F),F=G+u(F))):Y!==S&&V(I,J)),F?(be(),$=ye(),he=Q-1,de+=Q-X+1,ge.push(F),(Z=ye()).offset++,re&&re.call(oe,F,{start:$,end:Z},e.slice(X-1,Q)),$=Z):(p=e.slice(X-1,Q),me+=p,de+=p.length,he=Q-1)}else 10===j&&(fe++,pe++,de=0),j==j?(me+=u(j),de++):be();var ve;return ge.join("");function ye(){return{line:fe,column:de,offset:he+(ce.offset||0)}}function be(){me&&(ge.push(me),ne&&ne.call(ae,me,{start:$,end:ye()}),me="")}}(e,o)};var l={}.hasOwnProperty,u=String.fromCharCode,h=Function.prototype,p={warning:null,reference:null,text:null,warningContext:null,referenceContext:null,textContext:null,position:{},additional:null,attribute:!1,nonTerminated:!0},d=9,f=10,m=12,g=32,v=38,y=59,b=60,_=61,w=35,x=88,E=120,M=65533,S="named",T="hexadecimal",P="decimal",A={};A[T]=16,A[P]=10;var O={};O[S]=s,O[P]=a,O[T]=o;var C=1,R=2,L=3,I=4,k=5,N=6,z=7,D={};function B(e){return e>=1&&e<=8||11===e||e>=13&&e<=31||e>=127&&e<=159||e>=64976&&e<=65007||65535==(65535&e)||65534==(65535&e)}D[C]="Named character references must be terminated by a semicolon",D[R]="Numeric character references must be terminated by a semicolon",D[L]="Named character references cannot be empty",D[I]="Numeric character references cannot be empty",D[k]="Named character references must be known",D[N]="Numeric character references cannot be disallowed",D[z]="Numeric character references cannot be outside the permissible Unicode range"},function(e,t,n){"use strict";
/*!
 * repeat-string <https://github.com/jonschlinkert/repeat-string>
 *
 * Copyright (c) 2014-2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var r,i="";e.exports=function(e,t){if("string"!=typeof e)throw new TypeError("expected a string");if(1===t)return e;if(2===t)return e+e;var n=e.length*t;if(r!==e||void 0===r)r=e,i="";else if(i.length>=n)return i.substr(0,n);for(;n>i.length&&t>1;)1&t&&(i+=e),t>>=1,e+=e;return i=(i+=e).substr(0,n)}},function(e,t,n){"use strict";e.exports=function(e){var t=String(e),n=t.length;for(;t.charAt(--n)===r;);return t.slice(0,n+1)};var r="\n"},function(e,t,n){"use strict";e.exports=function(e,t,n,r){var i,a,o,s,c,l,u=["pedantic","commonmark"],h=u.length,p=e.length,d=-1;for(;++d<p;){for(i=e[d],a=i[1]||{},o=i[0],s=-1,l=!1;++s<h;)if(void 0!==a[c=u[s]]&&a[c]!==n.options[c]){l=!0;break}if(!l&&t[o].apply(n,r))return!0}return!1}},function(e,t,n){"use strict";var r=n(174);e.exports=function(e){return r(e).toLowerCase()}},function(e,t,n){var r=n(210),i=n(211);e.exports=function(e,t,n){var a=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||r)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var s=0;s<16;++s)t[a+s]=o[s];return t||i(o)}},function(e,t){e.exports=Tone},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(219);var i;function a(e){return e.value}function o(e,t){switch(e.kind){case i.number:!function(e,t){if("number"!=typeof t)throw new Error(`Invalid argument to number parameter ${t}`);if(t<e.min||t>e.max)throw new Error(`Value ${t} out of range [${e.min}, ${e.max}]`);e.value=t}(e,t);break;case i.enum:!function(e,t){if("number"!=typeof t)throw new Error(`Invalid argument to enum parameter ${t}`);if(t<0||t>=e.options.length)throw new Error(`Value ${t} not in range [0, ${[e.options.length-1]}`);e.value=t}(e,t);break;default:return r.assertHandled(e)}}function s(e){if(void 0===e.unit)return Number(e.value).toFixed(2);switch(e.unit.kind){case"decibel":return`${Number(e.value).toFixed(2)} dB`;case"percent":return`${Number(100*e.value).toFixed(1)}%`;case"pitch":return`${Number(e.value).toFixed(2)} ${e.unit.postfix}`;case"time":return e.value>1e3?`${Number(e.value/1e3).toFixed(2)} s`:`${Number(e.value).toFixed(2)} ms`;case"frequency":return e.value>1e3?`${Number(e.value/1e3).toFixed(2)} kHz`:`${Number(e.value).toFixed(2)} Hz`;default:return String(e.value)}}function c(e,t){const n=e.find(e=>e.name===t);if(void 0===n)throw new Error(`Parameter ${t} does not exist.`);return n}!function(e){e.number="number",e.enum="enum"}(i=t.Kind||(t.Kind={})),t.getValue=a,t.setValue=o,t.getStringValue=function(e){switch(e.kind){case i.enum:return String(e.value);case i.number:return s(e)}},t.getStringValueForNumberParameter=s,t.findParameterByName=c,t.findParameterIndexByName=function(e,t){const n=e.findIndex(e=>e.name===t);if(-1===n)throw new Error(`Parameter ${t} does not exist.`);return n},t.getParameterValueByName=function(e,t){return a(c(e,t))},t.setParameterValueByName=function(e,t,n){o(c(e,t),n)},t.isModulationTarget=function(e){return e.kind===i.number&&!0===e.isModulationTarget},t.isBipolar=function(e){switch(e.kind){case i.number:return e.min<0&&e.max>0;case i.enum:default:return!1}},t.controlValueToEnumIndex=function(e,t){const n=1/e.options.length;return Math.max(0,Math.ceil(t/n)-1)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(6);var i;!function(e){e.linear="linear",e.exponential="exponential",e.pitch="pitch",e.quantizedPitch="quantizedPitch"}(i=t.Kind||(t.Kind={})),t.convertFromControlValue=function(e,t){switch(t.scaling.kind){case i.linear:return r.mapNormalizedValueToRange(e,t.min,t.max);case i.exponential:return r.mapNormalizedValueToRange(Math.pow(e,t.scaling.exponent),t.min,t.max);case i.pitch:return r.clamp(t.scaling.baseFrequency*Math.pow(2,e*t.scaling.octaves),t.min,t.max);case i.quantizedPitch:return Math.round(r.mapNormalizedValueToRange(e,t.min,t.max))}},t.convertToControlValue=function(e,t){switch(t.scaling.kind){case i.linear:return r.normalize(e,t.min,t.max);case i.exponential:return Math.pow(r.normalize(e,t.min,t.max),1/t.scaling.exponent);case i.pitch:return r.clamp(Math.log2(e/t.scaling.baseFrequency)/t.scaling.octaves,0,1);case i.quantizedPitch:return r.clamp(r.normalize(e,t.min,t.max),0,1)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(3),a=n(5),o=n(6);t.SimpleADSR=class extends r.Component{constructor(e){super(e),this.sizeObserver=new a.SizeObserver,this.attackX=0,this.attackY=0,this.decaySustainX=0,this.decaySustainY=0,this.sustainEndX=0,this.releaseX=0,this.releaseY=0,this.progressX=0,this.progressY=0,this.ref=r.createRef(),this.onResize=this.onResize.bind(this)}componentDidMount(){this.sizeObserver.startObserving(this.ref,this.onResize)}componentWillUnmount(){this.sizeObserver.stopObserving()}render(){return this.recomputePixelValues(),r.createElement("div",{ref:this.ref,className:"components_simple-adsr"},r.createElement("svg",{className:"components_simple-adsr-drawing"},r.createElement("path",{className:"components_simple-adsr-drawing__adsr-envelope-shape",d:this.envelopePath()})),r.createElement("div",{className:"components_simple-adsr__adsr-progress-dot "+this.sustainVizState(),style:{transform:`translateX(${this.progressX}px) translateY(${this.progressY}px)`}},r.createElement("div",{className:"components_simple-adsr__adsr-progress-dot-container",style:{transform:this.sustainWidthTransform()}},r.createElement("div",{className:i("components_simple-adsr__adsr-progress-dot-fill",{"components_simple-adsr__adsr-progress-dot-fill--active":this.props.history.attackPct>0&&this.props.history.releasePct<1})}))))}shouldComponentUpdate(e){return this.props.attack!==e.attack||this.props.decay!==e.decay||this.props.sustain!==e.sustain||this.props.release!==e.release||this.props.history.attackPct!==e.history.attackPct||this.props.history.decayPct!==e.history.decayPct||this.props.history.sustain!==e.history.sustain||this.props.history.releasePct!==e.history.releasePct}xRangeForHandleInPct(e){switch(e){case 0:return{low:0,high:.3};case 1:const t=this.xRangeForHandleInPct(0),n=o.mapNormalizedValueToRange(this.props.attack,t.low,t.high);return{low:n,high:n+.3};case 2:const r=this.xRangeForHandleInPct(1),i=.1+o.mapNormalizedValueToRange(this.props.decay,r.low,r.high);return{low:i,high:i+.3}}}computeAttackX(){return Math.round(this.handleX(0))}computeAttackY(){return 0}computeDecaySustainX(){return Math.round(this.handleX(1))}computeDecaySustainY(){return Math.round(this.pctToY(1-this.props.sustain))}computeSustainEndX(){return Math.round(this.pctToX(this.xRangeForHandleInPct(2).low))}computeReleaseX(){return Math.round(this.handleX(2))}computeReleaseY(){return Math.round(this.height())}handleX(e){const t=this.xRangeForHandleInPct(e),n=t.low,r=t.high;switch(e){case 0:return this.pctToX(o.mapNormalizedValueToRange(this.props.attack,n,r));case 1:return this.pctToX(o.mapNormalizedValueToRange(this.props.decay,n,r));case 2:return this.pctToX(o.mapNormalizedValueToRange(this.props.release,n,r))}}recomputePixelValues(){this.attackX=this.computeAttackX(),this.attackY=this.computeAttackY(),this.decaySustainX=this.computeDecaySustainX(),this.decaySustainY=this.computeDecaySustainY(),this.sustainEndX=this.computeSustainEndX(),this.releaseX=this.computeReleaseX(),this.releaseY=this.computeReleaseY(),this.progressX=this.computeProgressX(),this.progressY=this.computeProgressY()}width(){return this.sizeObserver.getWidth()}height(){return this.sizeObserver.getHeight()}envelopePath(){return`M${`0,${this.height()}`} L${`${this.attackX},${this.attackY}`} L${`${this.decaySustainX},${this.decaySustainY}`} L${`${this.sustainEndX},${this.decaySustainY}`} L${`${this.releaseX},${this.releaseY}`} Z`}sustainVizState(){return i({"sustain-started":this.props.history.sustain,"sustain-ended":this.props.history.releasePct>0,active:this.isSustainActive()})}computeProgressX(){return this.props.history.releasePct>0?this.sustainEndX+(this.releaseX-this.sustainEndX)*this.props.history.releasePct:this.props.history.decayPct>0?this.attackX+(this.decaySustainX-this.attackX)*this.props.history.decayPct:this.props.history.attackPct>0?this.attackX*this.props.history.attackPct:0}computeProgressY(){return this.props.history.releasePct>0?this.decaySustainY+(this.height()-this.decaySustainY)*this.props.history.releasePct:this.props.history.decayPct>0?this.decaySustainY*this.props.history.decayPct:this.props.history.attackPct>0?this.height()*(1-this.props.history.attackPct):this.height()}sustainWidthTransform(){return this.isSustainActive()?`translateX(${this.sustainEndX-this.decaySustainX}px)`:"translateX(0px)"}pctToX(e){return e*this.width()}pctToY(e){return e*this.height()}onResize(){this.forceUpdate()}isSustainActive(){return this.props.history.sustain&&0===this.props.history.releasePct}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(3),a=n(21),o=n(5);t.SineLFO=class extends r.Component{constructor(e){super(e),this.sizeObserver=new o.SizeObserver,this.ref=r.createRef(),this.onResize=this.onResize.bind(this)}render(){const e=i("components--lfo-shape",{"active-shape":this.props.active}),t=this.sizeObserver.getHeight(),n=this.sizeObserver.getWidth(),o=2*this.props.frequency,s=a.cosinePolylinePoints(n,t,this.props.phase,this.props.amplitude,o,this.props.window),c=a.cosinePointAtPhase(t,this.props.phase,this.props.amplitude);return r.createElement("div",{className:e,ref:this.ref},r.createElement("svg",{width:"100%",height:"100%"},r.createElement("polyline",{className:"components--lfo-shape__viz-waveshape-filled",points:s}),r.createElement("circle",{className:"components--lfo-shape__viz-dot",cx:`${n/2}`,cy:c,r:"5"})))}shouldComponentUpdate(e){return e.amplitude!==this.props.amplitude||e.phase!==this.props.phase||e.active!==this.props.active}componentDidMount(){this.sizeObserver.startObserving(this.ref,this.onResize)}componentWillUnmount(){this.sizeObserver.stopObserving()}onResize(){this.forceUpdate()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(3),a=n(15),o=n(13),s=n(5),c=n(24),l=n(232),u=n(10),h=n(20);class p extends r.Component{constructor(e){super(e),this.pulseCount=0,this.maxNumPulses=3,this.pointerObserver=new o.PointerObserver,this.animationFramer=new u.AnimationFramer,this.sizeObserver=new s.SizeObserver,this.wasActivated=!1;const t=void 0===this.props.initialX?.5:this.props.initialX,n=void 0===this.props.initialY?.5:this.props.initialY;this.xyGesture=new l.XYGesture(t,n,!0===this.props.lockX,!0===this.props.lockY,this.props.rotation,this.props.easing,!0===this.props.restAtInitialX||!0===this.props.restAtInitialY),this.hitAreaRef=r.createRef(),this.controlParentRef=r.createRef(),this.pulseRefs=[];for(let e=0;e<this.maxNumPulses;e++)this.pulseRefs.push(r.createRef());this.fillRef=r.createRef(),this.ringRef=r.createRef(),this.onPointerChange=this.onPointerChange.bind(this),this.controlTransform=this.controlTransform.bind(this),this.onAnimationFrame=this.onAnimationFrame.bind(this),this.onResize=this.onResize.bind(this),this.onPlaybackEvent=this.onPlaybackEvent.bind(this)}componentDidMount(){this.pointerObserver.startObserving(this.controlParentRef.current,this.onPointerChange,{clampX:!0,clampY:!0}),this.sizeObserver.startObserving(this.controlParentRef,this.onResize),void 0!==this.props.player&&this.props.player.addPlayerListener(this)}componentWillUnmount(){this.sizeObserver.stopObserving(),this.animationFramer.stopAnimating(),this.pointerObserver.stopObserving(),void 0!==this.props.player&&this.props.player.removePlayerListener(this)}render(){const e=[];for(const t of this.pulseRefs)e.push(this.pulseElement(t));const t=i("components_xy-pad__container","container",{active:this.xyGesture.getIsActive()},{"--was-activated":this.wasActivated});return r.createElement("div",{className:"components_xy-pad",ref:this.hitAreaRef},r.createElement("div",{className:t,style:{transform:this.rotationTransform()}},r.createElement("div",{className:"components_xy-pad__visualization"},this.props.visualization&&this.props.visualization(this.createStateFromGesture())),r.createElement("div",{className:"components_xy-pad__padding",style:{padding:`${this.props.thumbRadius}px`}},r.createElement("div",{ref:this.controlParentRef,className:"components_xy-pad__control-parent"},r.createElement("div",{className:"components_xy-pad__control-container",style:{top:"-25px",left:"-25px",transform:this.controlTransform()}},e,r.createElement("svg",{className:"components_xy-pad__control",viewBox:"0 0 50 50"},r.createElement("circle",{r:this.props.thumbRadius-2,cx:25,cy:25,ref:this.ringRef,className:"components_xy-pad__control_ring"}),r.createElement("circle",{r:this.props.thumbRadius-4,cx:25,cy:25,ref:this.fillRef,className:"components_xy-pad__control_fill"})),this.props.tooltipKey&&r.createElement(c.ButtonTooltip,{tooltipKey:this.props.tooltipKey}))))))}onPlaybackEvent(e,t,n){switch(e){case 0:this.animatePulse(!0);break;case 1:break;case 2:this.animatePulse(!1),this.pulseCount=(this.pulseCount+1)%this.maxNumPulses}}animatePulse(e){const t=this.pulseRefs[this.pulseCount].current;if(void 0===t)return!1;a.remove(t),a(e?{targets:t,scale:[1,2],opacity:[1,1],easing:"easeOutQuart",duration:150}:{targets:t,scale:8,opacity:0,easing:"easeOutSine",duration:300})}animateControl(e){if(void 0===this.fillRef.current)return!1;if(void 0===this.ringRef.current)return!1;this.wasActivated=!0;const t=this.fillRef.current,n=this.ringRef.current;a.remove(t),a.remove(n);let r=this.context.global.background.hex(),i=this.context.global.foreground.hex(),o=0,s=14.5,c=1,l=1,u=500;e&&(r=this.context.global.foreground.hex(),i=this.context.global.foreground.hex(),c=1.3,l=1.1,o=17.5,s=18.5,u=250),a({targets:t,scale:c,fill:r,easing:"easeInOutQuart",duration:u}),a({targets:n,scale:l,stroke:i,easing:"easeInOutQuart",duration:u})}notifyStateChange(e){this.props.callback({xPctEased:this.xyGesture.getX(),yPctEased:this.xyGesture.getY(),xPctRaw:this.xyGesture.getXTarget(),yPctRaw:this.xyGesture.getYTarget(),type:e})}onPointerChange(e){switch(e.type){case 0:this.animationFramer.startAnimating(this.onAnimationFrame),this.xyGesture.start(e.xPct,e.yPct),this.notifyStateChange(e.type),this.animateControl(!0);break;case 1:this.xyGesture.move(e.xPct,e.yPct);break;case 2:this.xyGesture.end(),this.notifyStateChange(e.type),this.animateControl(!1)}}controlTransform(){return`translate3D(${this.xyGesture.getX()*this.sizeObserver.getWidth()}px,${this.xyGesture.getY()*this.sizeObserver.getHeight()}px,10px)`}rotationTransform(){return this.props.rotation?`perspective(550px)               rotateY(${this.xyGesture.getRotationX()}deg)               rotateX(${this.xyGesture.getRotationY()}deg)`:""}onAnimationFrame(){this.xyGesture.tick()&&this.animationFramer.stopAnimating(),this.notifyStateChange(1),this.forceUpdate()}onResize(){this.forceUpdate()}createStateFromGesture(){return{active:this.xyGesture.getIsActive(),x:this.xyGesture.getX(),y:this.xyGesture.getY(),rx:this.xyGesture.getRotationX(),ry:this.xyGesture.getRotationY(),xTarget:this.xyGesture.getXTarget(),yTarget:this.xyGesture.getYTarget(),rxTarget:this.xyGesture.getRotationX(),ryTarget:this.xyGesture.getRotationY(),pointerDownTime:this.xyGesture.getGestureStartTime()}}pulseElement(e){return r.createElement("svg",{ref:e,className:"components_xy-pad__pulse",viewBox:"0 0 25 25"},r.createElement("circle",{r:12.5,cx:12.5,cy:12.5}))}}p.contextType=h.ThemeContext,t.XYPad=p},function(e,t,n){"use strict";var r=n(233),i=n(236),a=[].slice,o=["keyword","gray","hex"],s={};Object.keys(i).forEach(function(e){s[a.call(i[e].labels).sort().join("")]=e});var c={};function l(e,t){if(!(this instanceof l))return new l(e,t);if(t&&t in o&&(t=null),t&&!(t in i))throw new Error("Unknown model: "+t);var n,u;if(null==e)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(e instanceof l)this.model=e.model,this.color=e.color.slice(),this.valpha=e.valpha;else if("string"==typeof e){var h=r.get(e);if(null===h)throw new Error("Unable to parse color from string: "+e);this.model=h.model,u=i[this.model].channels,this.color=h.value.slice(0,u),this.valpha="number"==typeof h.value[u]?h.value[u]:1}else if(e.length){this.model=t||"rgb",u=i[this.model].channels;var p=a.call(e,0,u);this.color=d(p,u),this.valpha="number"==typeof e[u]?e[u]:1}else if("number"==typeof e)e&=16777215,this.model="rgb",this.color=[e>>16&255,e>>8&255,255&e],this.valpha=1;else{this.valpha=1;var f=Object.keys(e);"alpha"in e&&(f.splice(f.indexOf("alpha"),1),this.valpha="number"==typeof e.alpha?e.alpha:0);var m=f.sort().join("");if(!(m in s))throw new Error("Unable to parse color from object: "+JSON.stringify(e));this.model=s[m];var g=i[this.model].labels,v=[];for(n=0;n<g.length;n++)v.push(e[g[n]]);this.color=d(v)}if(c[this.model])for(u=i[this.model].channels,n=0;n<u;n++){var y=c[this.model][n];y&&(this.color[n]=y(this.color[n]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}function u(e,t,n){return(e=Array.isArray(e)?e:[e]).forEach(function(e){(c[e]||(c[e]=[]))[t]=n}),e=e[0],function(r){var i;return arguments.length?(n&&(r=n(r)),(i=this[e]()).color[t]=r,i):(i=this[e]().color[t],n&&(i=n(i)),i)}}function h(e){return function(t){return Math.max(0,Math.min(e,t))}}function p(e){return Array.isArray(e)?e:[e]}function d(e,t){for(var n=0;n<t;n++)"number"!=typeof e[n]&&(e[n]=0);return e}l.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(e){var t=this.model in r.to?this:this.rgb(),n=1===(t=t.round("number"==typeof e?e:1)).valpha?t.color:t.color.concat(this.valpha);return r.to[t.model](n)},percentString:function(e){var t=this.rgb().round("number"==typeof e?e:1),n=1===t.valpha?t.color:t.color.concat(this.valpha);return r.to.rgb.percent(n)},array:function(){return 1===this.valpha?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var e={},t=i[this.model].channels,n=i[this.model].labels,r=0;r<t;r++)e[n[r]]=this.color[r];return 1!==this.valpha&&(e.alpha=this.valpha),e},unitArray:function(){var e=this.rgb().color;return e[0]/=255,e[1]/=255,e[2]/=255,1!==this.valpha&&e.push(this.valpha),e},unitObject:function(){var e=this.rgb().object();return e.r/=255,e.g/=255,e.b/=255,1!==this.valpha&&(e.alpha=this.valpha),e},round:function(e){return e=Math.max(e||0,0),new l(this.color.map(function(e){return function(t){return function(e,t){return Number(e.toFixed(t))}(t,e)}}(e)).concat(this.valpha),this.model)},alpha:function(e){return arguments.length?new l(this.color.concat(Math.max(0,Math.min(1,e))),this.model):this.valpha},red:u("rgb",0,h(255)),green:u("rgb",1,h(255)),blue:u("rgb",2,h(255)),hue:u(["hsl","hsv","hsl","hwb","hcg"],0,function(e){return(e%360+360)%360}),saturationl:u("hsl",1,h(100)),lightness:u("hsl",2,h(100)),saturationv:u("hsv",1,h(100)),value:u("hsv",2,h(100)),chroma:u("hcg",1,h(100)),gray:u("hcg",2,h(100)),white:u("hwb",1,h(100)),wblack:u("hwb",2,h(100)),cyan:u("cmyk",0,h(100)),magenta:u("cmyk",1,h(100)),yellow:u("cmyk",2,h(100)),black:u("cmyk",3,h(100)),x:u("xyz",0,h(100)),y:u("xyz",1,h(100)),z:u("xyz",2,h(100)),l:u("lab",0,h(100)),a:u("lab",1),b:u("lab",2),keyword:function(e){return arguments.length?new l(e):i[this.model].keyword(this.color)},hex:function(e){return arguments.length?new l(e):r.to.hex(this.rgb().round().color)},rgbNumber:function(){var e=this.rgb().color;return(255&e[0])<<16|(255&e[1])<<8|255&e[2]},luminosity:function(){for(var e=this.rgb().color,t=[],n=0;n<e.length;n++){var r=e[n]/255;t[n]=r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4)}return.2126*t[0]+.7152*t[1]+.0722*t[2]},contrast:function(e){var t=this.luminosity(),n=e.luminosity();return t>n?(t+.05)/(n+.05):(n+.05)/(t+.05)},level:function(e){var t=this.contrast(e);return t>=7.1?"AAA":t>=4.5?"AA":""},isDark:function(){var e=this.rgb().color;return(299*e[0]+587*e[1]+114*e[2])/1e3<128},isLight:function(){return!this.isDark()},negate:function(){for(var e=this.rgb(),t=0;t<3;t++)e.color[t]=255-e.color[t];return e},lighten:function(e){var t=this.hsl();return t.color[2]+=t.color[2]*e,t},darken:function(e){var t=this.hsl();return t.color[2]-=t.color[2]*e,t},saturate:function(e){var t=this.hsl();return t.color[1]+=t.color[1]*e,t},desaturate:function(e){var t=this.hsl();return t.color[1]-=t.color[1]*e,t},whiten:function(e){var t=this.hwb();return t.color[1]+=t.color[1]*e,t},blacken:function(e){var t=this.hwb();return t.color[2]+=t.color[2]*e,t},grayscale:function(){var e=this.rgb().color,t=.3*e[0]+.59*e[1]+.11*e[2];return l.rgb(t,t,t)},fade:function(e){return this.alpha(this.valpha-this.valpha*e)},opaquer:function(e){return this.alpha(this.valpha+this.valpha*e)},rotate:function(e){var t=this.hsl(),n=t.color[0];return n=(n=(n+e)%360)<0?360+n:n,t.color[0]=n,t},mix:function(e,t){if(!e||!e.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof e);var n=e.rgb(),r=this.rgb(),i=void 0===t?.5:t,a=2*i-1,o=n.alpha()-r.alpha(),s=((a*o==-1?a:(a+o)/(1+a*o))+1)/2,c=1-s;return l.rgb(s*n.red()+c*r.red(),s*n.green()+c*r.green(),s*n.blue()+c*r.blue(),n.alpha()*i+r.alpha()*(1-i))}},Object.keys(i).forEach(function(e){if(-1===o.indexOf(e)){var t=i[e].channels;l.prototype[e]=function(){if(this.model===e)return new l(this);if(arguments.length)return new l(arguments,e);var n="number"==typeof arguments[t]?t:this.valpha;return new l(p(i[this.model][e].raw(this.color)).concat(n),e)},l[e]=function(n){return"number"==typeof n&&(n=d(a.call(arguments),t)),new l(n,e)}}}),e.exports=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(238),a=n(239),o=n(240),s=n(241),c=n(242),l=n(243),u=n(245),h=n(246);t.createVisualization=function(e,t,n,p,d){switch(e){case"glow":return r.createElement(i.GlowVisualization,Object.assign({},t));case"low-pass-no-resonance":case"low-pass-with-resonance":if(void 0===d)throw new Error("player is undefined");return r.createElement(a.LowPassWithResonanceVisualization,Object.assign({frequency:d.getParameterValue("filter_frequency"),resonance:d.getParameterValue("filter_resonance")},t));case"amplitude-ramp":return r.createElement(o.AmplitudeRampVisualization,Object.assign({},t));case"pitch-strip":return r.createElement(s.PitchStripVisualization,Object.assign({},t));case"lfo-wave-shapes":return r.createElement(c.LfoWaveShapesVisualization,Object.assign({xMacro:n,yMacro:p,player:d},t));case"fast-lfo":return r.createElement(u.FastLfoVisualization,Object.assign({player:d},t));case"adsr":return r.createElement(h.XYADSRVisualization,Object.assign({player:d},t));case"osc-shape-mix":return r.createElement(l.XYOscShapeMixVisualization,Object.assign({player:d},t));default:return r.createElement(r.Fragment,null)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(59);t.getColorFromCssVariable=function(e){if(void 0===e)return r.rgb(0,0,0);try{return r(getComputedStyle(document.body).getPropertyValue(e).trim())}catch(t){return console.error(`Error parsing color: ${e}`),r.rgb(0,0,0)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(3),a=n(1),o=n(15),s=n(39),c=n(61),l=n(12),u=n(5),h=n(20),p=n(10),d=n(13),f=n(40),m=n(6);class g extends r.Component{constructor(e){super(e),this.sceneFilePath="content/assets/models/synth003b.glb",this.sizeObserver=new u.SizeObserver,this.animationFramer=new p.AnimationFramer({allowThrottling:!0}),this.pointerObserver=new d.PointerObserver,this.scene=new a.Scene,this.camera=new a.PerspectiveCamera,this.renderer=new a.WebGLRenderer({antialias:f.getAntialiasingSetting()}),this.sceneBackgroundColor=16777215,this.synthKeys=[],this.dotKeys=[],this.synthControls={},this.accentColor=new a.Color("#000"),this.whiteKeyOffColor=new a.Color("#000"),this.blackKeyOffColor=new a.Color("#000"),this.paramOffColor=new a.Color("#000"),this.paramHighlightedOffColor=new a.Color("#000"),this.state={isKeyDown:!1,pitchOfNote:void 0,ready:!1},this.ref=r.createRef(),this.shouldRender=!1,this.createRenderer(),this.createScene(),this.createLights(),this.createCamera(),this.onResize=this.onResize.bind(this),this.onAnimationFrame=this.onAnimationFrame.bind(this),this.onPlaybackEvent=this.onPlaybackEvent.bind(this),this.onPress=this.onPress.bind(this)}render(){const e=i("components_visualizations_synth_3d",{"components_visualizations_synth_3d--ready":this.state.ready});return r.createElement("div",{className:e,ref:this.ref})}componentDidMount(){this.ref.current.appendChild(this.renderer.domElement),this.sizeObserver.startObserving(this.ref,this.onResize),this.pointerObserver.startObserving(this.ref.current,this.onPress,{clampX:!0,clampY:!0}),this.animationFramer.startAnimating(this.onAnimationFrame),this.loadGLTF(),this.props.player.addPlayerListener(this)}componentWillUnmount(){this.sizeObserver.stopObserving(),this.animationFramer.stopAnimating(),this.pointerObserver.stopObserving(),this.props.player.removePlayerListener(this)}onPlaybackEvent(e,t,n){switch(e){case 0:this.setState({isKeyDown:!0,pitchOfNote:n}),n&&(this.animateKey(n,!1),this.props.activeParameterNames&&this.props.activeParameterNames.forEach(e=>{const t=this.synthControls[e];t&&this.animateParam(t,!1)}));break;case 1:n&&(this.animateKey(n,!0),this.props.activeParameterNames&&this.props.activeParameterNames.forEach(e=>{const t=this.synthControls[e];t&&this.animateParam(t,!0)}));break;case 2:this.setState({isKeyDown:!1,pitchOfNote:n})}}onParameterEvent(e,t,n){const r=this.synthControls[t];r&&this.props.activeParameterNames&&this.props.activeParameterNames.find(e=>e===t)&&(r.update(this.props.player.getParameterControlValue(t)),this.shouldRender=!0)}animateKey(e,t){if(!this.state.ready)return;const n=this.synthKeys[e].obj,r=this.synthKeys[e].mat,i=r.color;let a=Math.PI/180*4;this.synthKeys[e].isWhiteKey||(a=Math.PI/180*2);let s=this.accentColor,c=this.whiteKeyOffColor,l=150,u="easeOutQuart";t&&(a=0,l=250,u="easeOutSine",s=this.whiteKeyOffColor,c=this.paramHighlightedOffColor,this.synthKeys[e].isWhiteKey||(s=this.blackKeyOffColor)),o.remove(n.rotation),o({targets:n.rotation,x:a,easing:u,duration:l}),o.remove(i),o({targets:i,r:s.r,g:s.g,b:s.b,duration:l,easing:u,update:()=>{r.color=i}});const h=this.dotKeys[e].mat,p=h.color;o.remove(p),o({targets:p,r:c.r,g:c.g,b:c.b,duration:l,easing:u,update:()=>{h.color=p}})}animateParam(e,t){let n=this.accentColor,r=150,i="easeOutQuart";t&&(r=250,i="easeOutSine",n=e.offColor);const a=e.mat,s=a.color;o.remove(s),o({targets:s,r:n.r,g:n.g,b:n.b,duration:r,easing:i,update:()=>{a.color=s}})}onResize(){const e=this.sizeObserver.getHeight(),t=this.sizeObserver.getWidth();this.camera.aspect=t/e,this.camera.updateProjectionMatrix(),this.renderer.setSize(t,e),this.forceUpdate(),this.renderer.render(this.scene,this.camera)}loadGLTF(){const e=new s.GLTFLoader,t=l.urlForFile(this.sceneFilePath);e.load(t,e=>{this.scene.add(e.scene),this.styleScene()},void 0,e=>{console.error(e)})}createRenderer(){this.renderer.setClearColor(this.sceneBackgroundColor),this.renderer.setPixelRatio(f.getPixelRatioSetting()),this.renderer.shadowMap.enabled=f.getShadowMapSetting(),this.renderer.shadowMap.type=a.PCFSoftShadowMap}createScene(){this.scene.background=new a.Color(this.sceneBackgroundColor)}createLights(){const e=new a.AmbientLight(16777215,1);this.scene.add(e);const t=new a.DirectionalLight(16777215,.1);t.position.set(-.3,2,.5),this.scene.add(t),t.castShadow=!0}createCamera(){this.camera=new a.PerspectiveCamera(45,16/9,1,1e3);const e=Math.PI/180*-15,t=Math.PI/180*0,n=Math.PI/180*0;this.camera.position.set(0,.7,2),this.camera.rotation.set(e,t,n)}styleScene(){const e=c.getColorFromCssVariable("--color-foreground"),t=c.getColorFromCssVariable("--current-theme-color"),n=(c.getColorFromCssVariable("--current-theme-color-shade"),c.getColorFromCssVariable("--color-gray-2")),r=c.getColorFromCssVariable("--color-gray-2-5"),i=c.getColorFromCssVariable("--color-gray-3");this.accentColor=new a.Color(t.string()),this.whiteKeyOffColor=new a.Color(n.string()),this.blackKeyOffColor=new a.Color(e.string()),this.paramOffColor=new a.Color(e.string()),this.paramHighlightedOffColor=new a.Color(e.string()),this.props.emphasizeParameters&&(this.blackKeyOffColor=new a.Color(r.string()),this.paramOffColor=new a.Color(r.string()));const o=new a.MeshLambertMaterial({color:this.whiteKeyOffColor}),s=new a.MeshLambertMaterial({color:this.blackKeyOffColor}),l=new a.MeshBasicMaterial({color:this.blackKeyOffColor}),u=new a.MeshBasicMaterial({color:i.string()}),h=new a.MeshLambertMaterial({color:n.string()}),p=new a.MeshLambertMaterial({color:i.string()}),d=new a.MeshBasicMaterial({color:i.string()}),f=this.scene.getObjectByName("scene"),m=this.scene.getObjectByName("powercord"),g=this.scene.getObjectByName("base"),v=this.scene.getObjectByName("panelbase"),y=this.scene.getObjectByName("knobs").children,b=this.scene.getObjectByName("faderLaneBgs").children,_=this.scene.getObjectByName("blackkeys").children,w=this.scene.getObjectByName("modwheel"),x=this.scene.getObjectByName("plantAndPot"),E=this.scene.getObjectByName("pot"),M=this.scene.getObjectByName("leaf1"),S=this.scene.getObjectByName("leaf2"),T=this.scene.getObjectByName("leaf3");if(this.addMaterialToObject(g,o,!0,!0),this.addMaterialToObject(v,o,!0,!0),this.addMaterialToObject(w,s,!0,!0),this.addMaterialToObject(m,l,!0,!0),y.forEach((e,t)=>{const n=e.children[1];this.addMaterialToObject(e,u,!0,!0),this.addMaterialToObject(n,o,!0,!0)}),b.forEach(e=>{this.addMaterialToObject(e,d,!1,!0)}),_.forEach(e=>{e.rotation.x=Math.PI/180*.01}),this.props.showPlant?(this.addMaterialToObject(E,h,!0,!0),this.addMaterialToObject(M,p,!0,!0),this.addMaterialToObject(S,p,!0,!0),this.addMaterialToObject(T,p,!0,!0)):x.position.set(1e3,1e3,1e3),this.configureKeyboard(),this.configureParameterControls(),this.props.musicEvents.forEach(t=>{const n=this.synthKeys[t.pitch];if(n){const r=n.obj.children[0],i=new a.MeshBasicMaterial({color:new a.Color(e.string())});this.addMaterialToObject(r,i,!1,!1),this.dotKeys[t.pitch]={obj:r,mat:i}}}),this.props.position){const e=this.props.position.split(" ").map(Number);f.position.set(e[0],e[1],e[2])}if(this.props.rotation){const e=this.props.rotation.split(" ").map(Number),t=Math.PI/180;f.rotation.set(e[0]*t,e[1]*t,e[2]*t)}this.renderer.render(this.scene,this.camera),this.setState({ready:!0})}configureKeyboard(){const e=this.scene.getObjectByName("key01"),t=new a.MeshLambertMaterial({color:this.whiteKeyOffColor});this.addMaterialToObject(e,t,!0,!0);const n=this.scene.getObjectByName("key02"),r=new a.MeshLambertMaterial({color:this.blackKeyOffColor});this.addMaterialToObject(n,r,!0,!0);const i=this.scene.getObjectByName("key03"),o=new a.MeshLambertMaterial({color:this.whiteKeyOffColor});this.addMaterialToObject(i,o,!0,!0);const s=this.scene.getObjectByName("key04"),c=new a.MeshLambertMaterial({color:this.blackKeyOffColor});this.addMaterialToObject(s,c,!0,!0);const l=this.scene.getObjectByName("key05"),u=new a.MeshLambertMaterial({color:this.whiteKeyOffColor});this.addMaterialToObject(l,u,!0,!0);const h=this.scene.getObjectByName("key06"),p=new a.MeshLambertMaterial({color:this.whiteKeyOffColor});this.addMaterialToObject(h,p,!0,!0);const d=this.scene.getObjectByName("key07"),f=new a.MeshLambertMaterial({color:this.blackKeyOffColor});this.addMaterialToObject(d,f,!0,!0);const m=this.scene.getObjectByName("key08"),g=new a.MeshLambertMaterial({color:this.whiteKeyOffColor});this.addMaterialToObject(m,g,!0,!0);const v=this.scene.getObjectByName("key09"),y=new a.MeshLambertMaterial({color:this.blackKeyOffColor});this.addMaterialToObject(v,y,!0,!0);const b=this.scene.getObjectByName("key10"),_=new a.MeshLambertMaterial({color:this.whiteKeyOffColor});this.addMaterialToObject(b,_,!0,!0);const w=this.scene.getObjectByName("key11"),x=new a.MeshLambertMaterial({color:this.blackKeyOffColor});this.addMaterialToObject(w,x,!0,!0);const E=this.scene.getObjectByName("key12"),M=new a.MeshLambertMaterial({color:this.whiteKeyOffColor});this.addMaterialToObject(E,M,!0,!0);const S=this.scene.getObjectByName("key13"),T=new a.MeshLambertMaterial({color:this.whiteKeyOffColor});this.addMaterialToObject(S,T,!0,!0);const P=this.scene.getObjectByName("key14"),A=new a.MeshLambertMaterial({color:this.blackKeyOffColor});this.addMaterialToObject(P,A,!0,!0);const O=this.scene.getObjectByName("key15"),C=new a.MeshLambertMaterial({color:this.whiteKeyOffColor});this.addMaterialToObject(O,C,!0,!0);const R=this.scene.getObjectByName("key16"),L=new a.MeshLambertMaterial({color:this.blackKeyOffColor});this.addMaterialToObject(R,L,!0,!0);const I=this.scene.getObjectByName("key17"),k=new a.MeshLambertMaterial({color:this.whiteKeyOffColor});this.addMaterialToObject(I,k,!0,!0);const N=this.scene.getObjectByName("key18"),z=new a.MeshLambertMaterial({color:this.whiteKeyOffColor});this.addMaterialToObject(N,z,!0,!0);const D=this.scene.getObjectByName("key19"),B=new a.MeshLambertMaterial({color:this.blackKeyOffColor});this.addMaterialToObject(D,B,!0,!0);const j=this.scene.getObjectByName("key20"),F=new a.MeshLambertMaterial({color:this.whiteKeyOffColor});this.addMaterialToObject(j,F,!0,!0);const U=this.scene.getObjectByName("key21"),V=new a.MeshLambertMaterial({color:this.blackKeyOffColor});this.addMaterialToObject(U,V,!0,!0);const H=this.scene.getObjectByName("key22"),G=new a.MeshLambertMaterial({color:this.whiteKeyOffColor});this.addMaterialToObject(H,G,!0,!0);const W=this.scene.getObjectByName("key23"),q=new a.MeshLambertMaterial({color:this.blackKeyOffColor});this.addMaterialToObject(W,q,!0,!0);const X=this.scene.getObjectByName("key24"),Y=new a.MeshLambertMaterial({color:this.whiteKeyOffColor});this.addMaterialToObject(X,Y,!0,!0);const K=this.scene.getObjectByName("key25"),$=new a.MeshLambertMaterial({color:this.whiteKeyOffColor});this.addMaterialToObject(K,$,!0,!0),this.synthKeys[48]={obj:e,mat:t,isWhiteKey:!0},this.synthKeys[49]={obj:n,mat:r,isWhiteKey:!1},this.synthKeys[50]={obj:i,mat:o,isWhiteKey:!0},this.synthKeys[51]={obj:s,mat:c,isWhiteKey:!1},this.synthKeys[52]={obj:l,mat:u,isWhiteKey:!0},this.synthKeys[53]={obj:h,mat:p,isWhiteKey:!0},this.synthKeys[54]={obj:d,mat:f,isWhiteKey:!1},this.synthKeys[55]={obj:m,mat:g,isWhiteKey:!0},this.synthKeys[56]={obj:v,mat:y,isWhiteKey:!1},this.synthKeys[57]={obj:b,mat:_,isWhiteKey:!0},this.synthKeys[58]={obj:w,mat:x,isWhiteKey:!1},this.synthKeys[59]={obj:E,mat:M,isWhiteKey:!0},this.synthKeys[60]={obj:S,mat:T,isWhiteKey:!0},this.synthKeys[61]={obj:P,mat:A,isWhiteKey:!1},this.synthKeys[62]={obj:O,mat:C,isWhiteKey:!0},this.synthKeys[63]={obj:R,mat:L,isWhiteKey:!1},this.synthKeys[64]={obj:I,mat:k,isWhiteKey:!0},this.synthKeys[65]={obj:N,mat:z,isWhiteKey:!0},this.synthKeys[66]={obj:D,mat:B,isWhiteKey:!1},this.synthKeys[67]={obj:j,mat:F,isWhiteKey:!0},this.synthKeys[68]={obj:U,mat:V,isWhiteKey:!1},this.synthKeys[69]={obj:H,mat:G,isWhiteKey:!0},this.synthKeys[70]={obj:W,mat:q,isWhiteKey:!1},this.synthKeys[71]={obj:X,mat:Y,isWhiteKey:!0},this.synthKeys[72]={obj:K,mat:$,isWhiteKey:!0}}configureParameterControls(){this.configureKnob("knob01","oscillator_pitch"),this.configureKnob("knob02","oscillator_pulse_width"),this.configureKnob("knob03","oscillator_pulse_width_lfo_amount"),this.configureKnob("knob04","oscillator_pitch_offset"),this.configureKnob("knob05","filter_lfo_amount"),this.configureKnob("knob06","filter_frequency"),this.configureKnob("knob07","lfo_frequency"),this.configureKnob("knob08","filter_resonance"),this.configureKnob("knob09","knob_05_param"),this.configureKnob("knob10","knob_06_param"),this.configureKnob("knob11","knob_07_param"),this.configureKnob("knob12","knob_08_param"),this.configureFader("fader01","oscillator_noise_amplitude"),this.configureFader("fader02","fader_02_param"),this.configureFader("fader03","fader_03_param"),this.configureFader("fader04","amplitude")}configureKnob(e,t){const n=this.scene.getObjectByName(e);let r=this.paramOffColor;this.props.parameterNames&&this.props.parameterNames.forEach(e=>{e===t&&(r=this.paramHighlightedOffColor)});const i=new a.MeshBasicMaterial({color:r});this.addMaterialToObject(n.children[0],i,!0,!0),this.synthControls[t]={type:"knob",obj:n,mat:i,offColor:r,update:e=>{n.rotation.y=m.mapNormalizedValueToRange(e,Math.PI/180*135,Math.PI/180*-135)}};try{this.synthControls[t].update(this.props.player.getParameterControlValue(t))}catch(e){}}configureFader(e,t){const n=this.scene.getObjectByName(e);let r=this.paramOffColor;this.props.parameterNames&&this.props.parameterNames.forEach(e=>{e===t&&(r=this.paramHighlightedOffColor)});const i=new a.MeshLambertMaterial({color:r});this.addMaterialToObject(n,i,!0,!0),this.synthControls[t]={type:"fader",obj:n,mat:i,offColor:r,update:e=>{n.position.z=m.mapNormalizedValueToRange(e,.1375,-.1375)}};try{this.synthControls[t].update(this.props.player.getParameterControlValue(t))}catch(e){}}addMaterialToObject(e,t,n,r){e.traverse(e=>{e instanceof a.Mesh&&(e.material=t,e.castShadow=n,e.receiveShadow=r)})}onAnimationFrame(){(o.running.length>0||this.shouldRender)&&(this.renderer.render(this.scene,this.camera),this.shouldRender=!1)}onPress(e){e&&this.props.callback&&this.props.callback(e)}}g.contextType=h.ThemeContext,t.Synth3DViz=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(22),i=n(8),a=n(12);let o,s,c;t.init=function(){return Promise.all([fetch(a.urlForFile("content/assets/sounds/kick.wav")).then(e=>e.arrayBuffer()).then(e=>i.audioContext.decodeAudioData(e)).then(e=>{o=e}),fetch(a.urlForFile("content/assets/sounds/snare.wav")).then(e=>e.arrayBuffer()).then(e=>i.audioContext.decodeAudioData(e)).then(e=>{s=e}),fetch(a.urlForFile("content/assets/sounds/hihat.wav")).then(e=>e.arrayBuffer()).then(e=>i.audioContext.decodeAudioData(e)).then(e=>{c=e})])},t.playOneShot=function(e,t){const n=i.audioContext.createBufferSource();switch(i.connectToPostFxOutput(n),e){case r.Timbre.bd:n.buffer=o,n.start(t);break;case r.Timbre.sn:n.buffer=s,n.start(t);break;case r.Timbre.hh:n.buffer=c,n.start(t)}}},function(e,t){t.__esModule=!0;t.ATTRIBUTE_NAMES={BODY:"bodyAttributes",HTML:"htmlAttributes",TITLE:"titleAttributes"};var n=t.TAG_NAMES={BASE:"base",BODY:"body",HEAD:"head",HTML:"html",LINK:"link",META:"meta",NOSCRIPT:"noscript",SCRIPT:"script",STYLE:"style",TITLE:"title"},r=(t.VALID_TAG_NAMES=Object.keys(n).map(function(e){return n[e]}),t.TAG_PROPERTIES={CHARSET:"charset",CSS_TEXT:"cssText",HREF:"href",HTTPEQUIV:"http-equiv",INNER_HTML:"innerHTML",ITEM_PROP:"itemprop",NAME:"name",PROPERTY:"property",REL:"rel",SRC:"src"},t.REACT_TAG_MAP={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"});t.HELMET_PROPS={DEFAULT_TITLE:"defaultTitle",DEFER:"defer",ENCODE_SPECIAL_CHARACTERS:"encodeSpecialCharacters",ON_CHANGE_CLIENT_STATE:"onChangeClientState",TITLE_TEMPLATE:"titleTemplate"},t.HTML_TAG_MAP=Object.keys(r).reduce(function(e,t){return e[r[t]]=t,e},{}),t.SELF_CLOSING_TAGS=[n.NOSCRIPT,n.SCRIPT,n.STYLE],t.HELMET_ATTRIBUTE="data-react-helmet"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0);t.ScrollIntoView=class extends r.Component{render(){return r.createElement(r.Fragment,null)}componentDidMount(){this.scroll()}componentDidUpdate(e){e.id!==this.props.id&&this.scroll()}scroll(){if(void 0===this.props.id)return void window.scrollTo({top:0});const e=document.getElementById(this.props.id);e?e.scrollIntoView():window.scrollTo({top:0})}}},function(e,t){var n,r,i=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(e){n=a}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var c,l=[],u=!1,h=-1;function p(){u&&c&&(u=!1,c.length?l=c.concat(l):h=-1,l.length&&d())}function d(){if(!u){var e=s(p);u=!0;for(var t=l.length;t;){for(c=l,l=[];++h<t;)c&&c[h].run();h=-1,t=l.length}c=null,u=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new f(e,t)),1!==l.length||u||s(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,n){(function(e){function n(e,t){for(var n=0,r=e.length-1;r>=0;r--){var i=e[r];"."===i?e.splice(r,1):".."===i?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}function r(e,t){if(e.filter)return e.filter(t);for(var n=[],r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n}t.resolve=function(){for(var t="",i=!1,a=arguments.length-1;a>=-1&&!i;a--){var o=a>=0?arguments[a]:e.cwd();if("string"!=typeof o)throw new TypeError("Arguments to path.resolve must be strings");o&&(t=o+"/"+t,i="/"===o.charAt(0))}return(i?"/":"")+(t=n(r(t.split("/"),function(e){return!!e}),!i).join("/"))||"."},t.normalize=function(e){var a=t.isAbsolute(e),o="/"===i(e,-1);return(e=n(r(e.split("/"),function(e){return!!e}),!a).join("/"))||a||(e="."),e&&o&&(e+="/"),(a?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(r(e,function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},t.relative=function(e,n){function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=t.resolve(e).substr(1),n=t.resolve(n).substr(1);for(var i=r(e.split("/")),a=r(n.split("/")),o=Math.min(i.length,a.length),s=o,c=0;c<o;c++)if(i[c]!==a[c]){s=c;break}var l=[];for(c=s;c<i.length;c++)l.push("..");return(l=l.concat(a.slice(s))).join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){if("string"!=typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),n=47===t,r=-1,i=!0,a=e.length-1;a>=1;--a)if(47===(t=e.charCodeAt(a))){if(!i){r=a;break}}else i=!1;return-1===r?n?"/":".":n&&1===r?"/":e.slice(0,r)},t.basename=function(e,t){var n=function(e){"string"!=typeof e&&(e+="");var t,n=0,r=-1,i=!0;for(t=e.length-1;t>=0;--t)if(47===e.charCodeAt(t)){if(!i){n=t+1;break}}else-1===r&&(i=!1,r=t+1);return-1===r?"":e.slice(n,r)}(e);return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},t.extname=function(e){"string"!=typeof e&&(e+="");for(var t=-1,n=0,r=-1,i=!0,a=0,o=e.length-1;o>=0;--o){var s=e.charCodeAt(o);if(47!==s)-1===r&&(i=!1,r=o+1),46===s?-1===t?t=o:1!==a&&(a=1):-1!==t&&(a=-1);else if(!i){n=o+1;break}}return-1===t||-1===r||0===a||1===a&&t===r-1&&t===n+1?"":e.slice(t,r)};var i="b"==="ab".substr(-1)?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return t<0&&(t=e.length+t),e.substr(t,n)}}).call(this,n(66))},function(e,t,n){"use strict";e.exports=function(e){var t="string"==typeof e?e.charCodeAt(0):e;return t>=97&&t<=122||t>=65&&t<=90}},function(e,t,n){"use strict";e.exports={position:!0,gfm:!0,commonmark:!1,footnotes:!1,pedantic:!1,blocks:n(158)}},function(e,t,n){"use strict";e.exports=function(e){var t,n=0,i=0,a=e.charAt(n),o={};for(;a in r;)t=r[a],i+=t,t>1&&(i=Math.floor(i/t)*t),o[i]=n,a=e.charAt(++n);return{indent:i,stops:o}};var r={" ":1,"\t":4}},function(e,t,n){"use strict";var r="<[A-Za-z][A-Za-z0-9\\-]*(?:\\s+[a-zA-Z_:][a-zA-Z0-9:._-]*(?:\\s*=\\s*(?:[^\"'=<>`\\u0000-\\u0020]+|'[^']*'|\"[^\"]*\"))?)*\\s*\\/?>",i="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>";t.openCloseTag=new RegExp("^(?:"+r+"|"+i+")"),t.tag=new RegExp("^(?:"+r+"|"+i+"|\x3c!----\x3e|\x3c!--(?:-?[^>-])(?:-?[^-])*--\x3e|<[?].*?[?]>|<![A-Za-z]+\\s+[^>]*>|<!\\[CDATA\\[[\\s\\S]*?\\]\\]>)")},function(e,t,n){"use strict";e.exports=function(e,t){return e.indexOf("<",t)}},function(e,t,n){"use strict";e.exports=function(e,t){var n=e.indexOf("[",t),r=e.indexOf("![",t);if(-1===r)return n;return n<r?n:r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(3),a=n(52),o=n(212),s=n(213),c=n(214),l=n(215),u=n(76),h=n(231),p=n(247),d=n(252),f=n(253),m=n(257),g=n(259),v=n(79),y=n(262),b=n(264),_=n(269),w=n(270),x=n(271),E=n(272),M=n(78);t.create=function(e,t,n){try{const S=i("embed",{"embed-hidden":"shared-synth"===e},t.classes);return r.createElement("div",{className:S},function(e,t,n){const i=n?n.lessonId:"";switch(e){case v.ComponentName:return r.createElement(v.SharedSynth,{key:a(),player:E.createPlayer(i,t.preset),notes:t.notes,sequence:t.sequence,playButtonTooltipKey:t.playButtonTooltipKey,pressButtonTooltipKey:t.pressButtonTooltipKey,resetButton:"no"!==t.showResetButton});case y.ComponentName:{const e=v.sharedSynthInstance.getPlayer();return r.createElement(y.SynthPanel,{player:e,sharedSynthComponent:v.sharedSynthInstance,panel:t.panel,texts:t.texts,tooltipKey:t.tooltipKey,rotation:t.rotation,visualization:t.visualization,initialX:t.initialX,initialY:t.initialY,xMacro:M.createMacro(t.xParameter,e),yMacro:M.createMacro(t.yParameter,e)})}case l.ComponentName:return r.createElement(o.Loader,{componentPromise:s.findLessonSample(t.sample,i).then(e=>{const n=t.duration,i=!0===t.loop;return r.createElement(l.Sampler,{sample:e,tooltipKey:t.tooltipKey,duration:n,gainInDb:t.gainInDb,loop:i})})});case d.ComponentName:return r.createElement(d.Synth,{player:E.createPlayer(i,t.preset),minPitchOffset:t.minPitchOffset,maxPitchOffset:t.maxPitchOffset,note:t.note,tooltipKey:"nothing"});case h.ComponentName:{const e=E.createPlayer(i,t.preset);return r.createElement(h.Synth,{player:e,xMacro:M.createMacro(t.xParameter,e),yMacro:M.createMacro(t.yParameter,e),tooltipKey:t.tooltipKey,rotation:t.rotation,visualization:t.visualization,controls:t.controls,easing:t.easing,restAtInitialX:t.restAtInitialX,restAtInitialY:t.restAtInitialY,note:t.note?t.note:48})}case b.ComponentName:{const e=E.createPlayer(i,t.preset);return r.createElement(b.Synth,{player:e,visualization:t.visualization,note:t.note?t.note:48,macro:M.createMacro(t.parameter,e),labels:!!t.labels,tooltipKey:t.tooltipKey,initialPercent:t.initialPercent,restAtInitialPercent:t.restAtInitialPercent})}case g.ComponentName:return r.createElement(g.ModBot,{player:E.createPlayer(i,t.preset),note:t.note?t.note:48,tooltipKey:t.tooltipKey});case m.ComponentName:return r.createElement(m.Carousel,{player:E.createPlayer(i,t.preset),maxFrequency:t.maxFrequency,tooltipKey:t.tooltipKey});case p.ComponentName:{const e=E.createPlayer(i,t.preset),n=t.lock&&t.lock.includes("attack"),a=t.lock&&t.lock.includes("release"),o=t.lock&&(t.lock.includes("decay")||t.lock.includes("sustain")),s=t.show&&t.show.includes("x-axis"),c=t.show&&t.show.includes("y-axis"),l=t.show&&t.show.includes("attack-label"),u=t.show&&t.show.includes("decay-label"),h=t.show&&t.show.includes("sustain-label"),d=t.show&&t.show.includes("release-label"),f=t.show&&t.show.includes("interaction-tooltip"),m=t.yAxisLabelKey?t.yAxisLabelKey:"",g=t.handleRadius?t.handleRadius:14.5,v=!0===t.linkAttack,y=!0===t.linkDecay,b=!0===t.linkSustain,_=!0===t.linkRelease;return r.createElement(p.Synth,{player:e,attackParameter:t.attackParameter,decayParameter:t.decayParameter,sustainParameter:t.sustainParameter,releaseParameter:t.releaseParameter,attackOverrideInMs:t.attack,decayOverrideInMs:t.decay,sustainOverride:t.sustain,releaseOverrideInMs:t.release,lockAttack:n,lockDecaySustain:o,lockRelease:a,showXAxis:s,showYAxis:c,showAttackLabel:l,showDecayLabel:u,showSustainLabel:h,showReleaseLabel:d,yAxisLabelKey:m,handleRadius:g,linkAttack:v,linkDecay:y,linkSustain:b,linkRelease:_,note:t.note?t.note:48,showResetButton:!0===t.showResetButton,showInteractionTooltip:f})}case f.ComponentName:return r.createElement(o.Loader,{componentPromise:s.findLessonSample(t.sample,i).then(e=>r.createElement(f.DoorFilter,{sample:e,tooltipKey:t.tooltipKey}))});case _.ComponentName:return r.createElement(_.Synth3DPress,{player:E.createPlayer(i,t.preset),notes:t.notes,tooltipKey:t.tooltipKey,rotation:t.rotation,position:t.position,showPlant:t.showPlant,emphasizeParameters:t.emphasizeParameters});case w.ComponentName:{const e=E.createPlayer(i,t.preset);return r.createElement(w.Synth3DSliders,{player:e,notes:t.notes,tooltipKey:t.tooltipKey,rotation:t.rotation,position:t.position,showPlant:t.showPlant,slider1Text:t.slider1Text,slider1Macro:M.createMacro(t.slider1Parameter,e),slider2Text:t.slider2Text,slider2Macro:M.createMacro(t.slider2Parameter,e),slider3Text:t.slider3Text,slider3Macro:M.createMacro(t.slider3Parameter,e)})}case x.ComponentName:{const e=E.createPlayer(i,t.preset);return r.createElement(x.Synth3DXY,{player:e,notes:t.notes,tooltipKey:t.tooltipKey,rotation:t.rotation,position:t.position,xMacro:M.createMacro(t.xParameter,e),yMacro:M.createMacro(t.yParameter,e)})}case c.ComponentName:return r.createElement(c.DefPlayerComponent,{player:E.createPlayer(i,t.preset),defNotation:t.defNotation});case u.ComponentName:return r.createElement(u.SubtractiveSynthComponent,null);default:throw new Error(`Embed not found: ${e}`)}}(e,t,n))}catch(e){return r.createElement("div",{className:"embed unknown"}," ",String(e)," ")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(53),i=n(22),a=n(63),o=n(8);t.DefPlayer=class{constructor(e,t){this.isPlaying=!1,this.timbres=[],this.player=e,this.notation=t,this.timbres[i.Timbre.default]={play:(e,t)=>{this.player.playNote(e,t)},stop:(e,t)=>{this.player.stopNote(e,t)}}}getIsPlaying(){return this.isPlaying}play(){void 0!==this.part&&this.part.dispose(),this.part=new r.Part((e,t)=>{const n=t.musicEvent.timbre;n!==i.Timbre.rest&&!1!==this.isPlaying&&(n===i.Timbre.bd||n===i.Timbre.sn||n===i.Timbre.hh?o.browserSupportsAudioWorklet()&&"on"===t.type&&a.playOneShot(n,e):("on"===t.type&&this.timbres[n].play(t.musicEvent.pitch,e),"off"===t.type&&this.timbres[n].stop(t.musicEvent.pitch,e)))},this.createTonePartEvents()).start(0),this.part.loop=!0,this.part.loopEnd=this.sequenceDuration(),r.Transport.position="0:0:0",r.Transport.start(),this.isPlaying=!0}stop(){r.Transport.stop(),this.player.stopAllNotes(o.audioContext.currentTime+.5),this.isPlaying=!1}progress(){return void 0===this.part?0:this.part.progress}setNotation(e){this.notation=e,this.isPlaying&&(this.stop(),this.play())}createTonePartEvents(){const e=i.notationToMusicEvents(this.notation),t=[];return e.forEach(e=>{t.push({time:e.startTime,type:"on",musicEvent:e}),t.push({time:e.startTime+e.duration-.01,type:"off",musicEvent:e})}),t}sequenceDuration(){const e=i.notationToMusicEvents(this.notation);if(0===e.length)return 0;const t=e.map(e=>e.startTime+e.duration);return t.sort()[t.length-1]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(4),a=n(44),o=n(77),s=n(79),c=n(224),l=n(80),u=n(81),h=n(83),p=n(84),d=n(87),f=n(88),m=n(89),g=n(91),v=n(93),y=n(229),b=n(230),_=n(43),w=n(31);t.ComponentName="subtractive-synth";t.SubtractiveSynthComponent=class extends r.Component{constructor(e){super(e),this.rnboTestPlayer=new o.Player(_.provideInstrument),this.presetCatalog={},this.currentTabBodyClass="",this.state={currentPresetName:void 0,currentSequence:c.playgroundSequences()[0]},this.presetCatalog=a.getPresetCatalog(),this.onResetPreset=this.onResetPreset.bind(this),this.onClickPreset=this.onClickPreset.bind(this),this.onClickSequence=this.onClickSequence.bind(this),this.togglePresets=this.togglePresets.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.presetChooserRef=r.createRef(),this.synthContainerRef=r.createRef(),this.presetsRackRef=r.createRef(),this.sourcesTabRef=r.createRef(),this.sourcesRackRef=r.createRef(),this.amplitudeTabRef=r.createRef(),this.amplitudeRackRef=r.createRef(),this.filterTabRef=r.createRef(),this.filterRackRef=r.createRef(),this.modulationTabRef=r.createRef(),this.modulationRackRef=r.createRef(),this.currentRackRef=r.createRef(),this.currentTabRef=r.createRef(),document.body.classList.add("playground"),document.body.classList.remove("lesson"),document.body.classList.remove("recipes")}componentDidMount(){this.currentRackRef=this.sourcesRackRef,this.currentTabRef=this.sourcesTabRef,this.currentTabBodyClass="sources",document.addEventListener("keydown",this.onKeyDown),window.dispatchEvent(new Event("resize"))}componentWillUnmount(){document.removeEventListener("keydown",this.onKeyDown)}render(){return r.createElement(r.Fragment,null,r.createElement(s.SharedSynth,{player:this.rnboTestPlayer,notes:this.state.currentSequence.notes,sequence:this.state.currentSequence.sequence,resetButton:!1}),r.createElement("div",{className:"components_embeds_subtractive-synth__tabs"},r.createElement("div",{className:"components_embeds_subtractive-synth__tabs-wrapper"},r.createElement("a",{href:"javascript:void(0)",onClick:e=>this.showRack("sources"),ref:this.sourcesTabRef,className:"active"},i.translated("playground:tab_names.sources")),r.createElement("a",{href:"javascript:void(0)",onClick:e=>this.showRack("amplitude"),ref:this.amplitudeTabRef},i.translated("playground:tab_names.amplitude")),r.createElement("a",{href:"javascript:void(0)",onClick:e=>this.showRack("filter"),ref:this.filterTabRef},i.translated("playground:tab_names.filter")),r.createElement("a",{href:"javascript:void(0)",onClick:e=>this.showRack("modulation"),ref:this.modulationTabRef},i.translated("playground:tab_names.modulation")))),r.createElement("div",{className:"components_embeds_subtractive-synth"},r.createElement("div",{className:"components_embeds_subtractive-synth__wrapper",ref:this.synthContainerRef},r.createElement("div",{className:"components_embeds_subtractive-synth__rack",ref:this.presetsRackRef,key:"sequence-rack",id:"subtractive-synth__rack-presets",style:{"--current-theme-color":"var(--color-foreground)"}},r.createElement("div",{className:"components_embeds_subtractive-synth__panel",key:"presets-panel"},r.createElement("div",{className:"components_embeds_subtractive-synth__panel_content"},r.createElement("h3",null,i.translated("playground:panel_names.presets")),r.createElement("div",null,this.renderPresetChooser()))),r.createElement("div",{className:"components_embeds_subtractive-synth__panel",key:"sequences-panel"},r.createElement("div",{className:"components_embeds_subtractive-synth__panel_content"},r.createElement("h3",null,i.translated("playground:panel_names.sequence")),r.createElement("div",null,this.renderSequenceChooser()))),w.isRunningLocally()&&r.createElement("div",{className:"components_embeds_subtractive-synth__panel",key:"dev-tools-panel"},r.createElement("div",{className:"components_embeds_subtractive-synth__panel_content"},r.createElement("h3",null,"Development tools"),r.createElement("div",null,r.createElement("div",null,"Upload Preset: ",r.createElement("input",{type:"file",onChange:e=>this.handlePresetUpload(e)})),r.createElement("div",{className:"components_embeds_subtractive-synth__download-preset-button"},r.createElement("a",{onClick:e=>this.handlePresetDownload(e)},"Download Preset JSON ")))))),r.createElement("div",{className:"components_embeds_subtractive-synth__rack--active",ref:this.sourcesRackRef,key:"sources-rack",id:"subtractive-synth__rack-sources"},r.createElement(g.PulseOscillatorPanel,{player:this.rnboTestPlayer}),r.createElement(v.SawOscillatorPanel,{player:this.rnboTestPlayer}),r.createElement(d.PitchPanel,{player:this.rnboTestPlayer}),r.createElement(f.NoisePanel,{player:this.rnboTestPlayer})),r.createElement("div",{className:"components_embeds_subtractive-synth__rack",ref:this.amplitudeRackRef,key:"amplitude-rack",id:"subtractive-synth__rack-amplitude"},r.createElement(l.AmplitudeEnvelopePanel,{player:this.rnboTestPlayer}),r.createElement(m.AmplitudePanel,{player:this.rnboTestPlayer})),r.createElement("div",{className:"components_embeds_subtractive-synth__rack",ref:this.filterRackRef,key:"filter-rack",id:"subtractive-synth__rack-filter"},r.createElement(u.LowPassFilterPanel,{player:this.rnboTestPlayer})),r.createElement("div",{className:"components_embeds_subtractive-synth__rack",ref:this.modulationRackRef,key:"modulation-rack",id:"subtractive-synth__rack-modulation",style:{"--current-theme-color":"var(--color-red)"}},r.createElement(p.LfoPanel,{player:this.rnboTestPlayer}),r.createElement(h.ModEnvelopePanel,{player:this.rnboTestPlayer})))),r.createElement("div",{className:"components_embeds_subtractive-synth__presets-menu"},r.createElement("div",{className:"components_embeds_subtractive-synth__presets-menu-overlay",onClick:e=>this.togglePresets()}),r.createElement("div",{className:"components_embeds_subtractive-synth__presets-menu-content",style:{"--current-theme-color":"var(--color-foreground)"}},r.createElement("div",{className:"components_embeds_subtractive-synth__presets-menu-section"},r.createElement("h3",null,i.translated("playground:panel_names.presets")),this.renderPresetChooser()),r.createElement("div",{className:"components_embeds_subtractive-synth__presets-menu-section"},r.createElement("h3",null,i.translated("playground:panel_names.sequence")),this.renderSequenceChooser()))),r.createElement(y.LessonShareToggle,null),r.createElement(b.SynthPresetsToggleButton,{onClick:this.togglePresets,opened:document.body.classList.contains("show-presets"),tooltipKey:"common:tooltips.presets"}))}renderPresetChooser(){const e=[r.createElement("li",null,r.createElement("a",{href:"javascript:void(0)",className:"selected",onClick:this.onClickPreset,"data-preset":""},i.translated("presets:names.default")))];for(const t in this.presetCatalog)if(this.presetCatalog.hasOwnProperty(t)&&void 0!==this.presetCatalog[t].presetMetadata){const n=i.translated(this.presetCatalog[t].presetMetadata.name);void 0!==n&&e.push(r.createElement("li",null,r.createElement("a",{href:"javascript:void(0)",onClick:this.onClickPreset,"data-preset":t},n)))}return r.createElement("div",{className:"components_embeds_subtractive-synth__panel_presets"},r.createElement("ul",null,e))}renderSequenceChooser(){const e=[];return c.playgroundSequences().forEach((t,n)=>{e.push(r.createElement("li",null,r.createElement("a",{href:"javascript:void(0)",className:this.state.currentSequence===t?"selected":"",onClick:this.onClickSequence,"data-index":`${n}`},t.name)))}),r.createElement("div",{className:"components_embeds_subtractive-synth__panel_sequences"},r.createElement("ul",null,e))}onClickPreset(e){const t=document.body.querySelectorAll(".components_embeds_subtractive-synth__panel_presets a");for(const e of t)e.classList.remove("selected");e.target.classList.add("selected");const n=e.target.getAttribute("data-preset");this.loadPreset(n)}onClickSequence(e){const t=document.body.querySelectorAll(".components_embeds_subtractive-synth__panel_sequences a");for(const e of t)e.classList.remove("selected");e.target.classList.add("selected");const n=parseInt(e.target.getAttribute("data-index"),10);this.setState({currentSequence:c.playgroundSequences()[n]})}onResetPreset(){this.presetChooserRef.current&&this.loadPreset(this.presetChooserRef.current.value)}onKeyDown(e){switch(e.key){case"Escape":document.body.classList.contains("show-presets")&&this.togglePresets()}}loadPreset(e){const t=e?this.presetCatalog[e]:void 0;void 0!==t?(this.rnboTestPlayer.preset(t),this.setState({currentPresetName:e})):(this.rnboTestPlayer.reset(),this.setState({currentPresetName:void 0}))}handlePresetUpload(e){const t=new FileReader;t.onload=e=>{if(null!==e.target){const t=JSON.parse(e.target.result);this.rnboTestPlayer.preset(t),this.forceUpdate()}else console.log("Failure reading preset file.")},t.readAsText(e.target.files[0])}handlePresetDownload(e){const t=this.rnboTestPlayer.getPresetJSONFromCurrentState(),n="text/json;charset=utf-8,"+encodeURIComponent(t);e.target.setAttribute("href","data:"+n),console.log(this.state);const r=void 0!==this.state.currentPresetName?this.state.currentPresetName:"subtractive-synth.preset";e.target.setAttribute("download",`${r}.json`)}showRack(e){switch(this.currentRackRef.current&&(this.currentRackRef.current.className="components_embeds_subtractive-synth__rack"),this.currentTabRef.current&&(this.currentTabRef.current.className=""),document.body.classList.remove(this.currentTabBodyClass),e){case"sources":this.currentRackRef=this.sourcesRackRef,this.currentTabRef=this.sourcesTabRef;break;case"amplitude":this.currentRackRef=this.amplitudeRackRef,this.currentTabRef=this.amplitudeTabRef;break;case"filter":this.currentRackRef=this.filterRackRef,this.currentTabRef=this.filterTabRef;break;case"modulation":this.currentRackRef=this.modulationRackRef,this.currentTabRef=this.modulationTabRef}this.currentRackRef.current&&(this.currentRackRef.current.className="components_embeds_subtractive-synth__rack--active"),this.currentTabRef.current&&(this.currentTabRef.current.className="active"),this.currentTabBodyClass=e,document.body.classList.add(this.currentTabBodyClass),window.dispatchEvent(new Event("resize"))}togglePresets(){window.innerWidth<1680&&(document.body.classList.toggle("show-presets"),this.forceUpdate())}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(218),i=n(8),a=n(78),o=n(6),s=n(55),c=n(54),l=n(55);t.Player=class{constructor(e){this.rnboParamNameToIndexCache={},this.modulatedValues={},this.playerListener=[],this.instrumentProvider=e,this.instrumentState=this.getDefaultState(),this.instrumentState.parameters.forEach((e,t)=>{this.rnboParamNameToIndexCache[e.name]=t,c.isModulationTarget(e)&&(this.modulatedValues[e.name]=void 0)}),this.modulatedValues.lfo_phase=void 0,this.heldNoteTimes=new Array(127),this.heldNoteTimes.fill(-1),this.onRnboEvent=this.onRnboEvent.bind(this)}getParameterValue(e){return this.getParameterByName(e).value}getParameterDefaultValue(e){return c.getParameterValueByName(u.parameters,e)}setParameterValue(e,t){if("number"!=typeof t)throw new Error(`Attempting to set non number value ${t} for RNBO parameter`);const n=this.getParameterByName(e);if(void 0!==n&&(c.setValue(n,t),this.notifyParameterListeners(0,e,t),this.rnboInstrument)){let r=t,i=e;n.kind===c.Kind.number&&n.isModulationTarget&&(r=s.convertToControlValue(t,n),i+="_cv"),this.rnboInstrument.setParameterValueByName(i,r)}}setParameterToDefaultValue(e){this.setParameterValue(e,this.getParameterDefaultValue(e))}getParameterControlValue(e){const t=this.getParameterByName(e);if(t.kind===c.Kind.number)return s.convertToControlValue(t.value,t);throw new Error("Attempting to get control value of non-number parameter.")}setParameterControlValue(e,t){if(!o.inRange(t,0,1,!0))throw new Error(`Control value out of range: ${t}`);const n=this.getParameterByName(e);switch(n.kind){case c.Kind.number:this.setParameterValue(e,s.convertFromControlValue(t,n));break;case c.Kind.enum:this.setParameterValue(e,c.controlValueToEnumIndex(n,t));break;default:throw new Error("Attempting to set control value of non-number or non-enum parameter.")}}convertToControlValue(e,t){const n=this.getParameterByName(e);switch(n.kind){case c.Kind.number:return s.convertToControlValue(t,n);default:throw new Error("Attempting to get control value of non-number parameter.")}}convertFromControlValue(e,t){const n=this.getParameterByName(e);switch(n.kind){case c.Kind.number:return s.convertFromControlValue(t,n);default:throw new Error("Attempting to get value of non-number parameter.")}}isParameterModulationTarget(e){return c.isModulationTarget(this.getParameterByName(e))}getModulatedParameterControlValue(e){const t=this.modulatedValues[e];return void 0!==t?t:this.getParameterByName(e)?this.getParameterControlValue(e):0}getModulatedParameterValue(e){const t=this.getModulatedParameterControlValue(e),n=this.getParameterByName(e);if(n.kind===c.Kind.number)return s.convertFromControlValue(t,n);throw new Error("Attempting to get modulated value of non-number parameter.")}setMacroValue(e,t){e.forEach(e=>{a.setValueForMacroTarget(e,t,this)})}getParameterByName(e){return this.getState().parameters[this.rnboParamNameToIndexCache[e]]}getParameterValueAsString(e){return c.getStringValue(this.getParameterByName(e))}reset(){this.setParameterValue("global_slew_time",0);let e=0;this.getDefaultState().parameters.forEach(t=>{"global_slew_time"!==t.name?this.setParameterValue(t.name,t.value):e=t.value}),this.setParameterValue("global_slew_time",e)}preset(e){const t=(e=JSON.parse(JSON.stringify(e))).version,n=this.getState().version;if(0!==r(e.version,this.getState().version))throw new Error(`Preset versions not equal: ${t}, ${n}`);this.reset(),this.setParameterValue("global_slew_time",0);let i=0;e.parameters.forEach(e=>{"global_slew_time"!==e.name?this.setParameterValue(e.name,e.value):i=e.value}),this.setParameterValue("global_slew_time",i),this.notifyPresetListeners(0)}addPlayerListener(e){this.playerListener.find(t=>t===e)||this.playerListener.push(e)}removePlayerListener(e){this.playerListener=this.playerListener.filter(t=>t!==e)}playNote(e,t){if(void 0===this.rnboInstrument){if(this.rnboInstrument=this.instrumentProvider(this),void 0===this.rnboInstrument)throw new Error("Error preparing for playback");this.rnboInstrument.addEventListener("MessageEvent",this.onRnboEvent),this.preset(this.instrumentState)}const n=void 0===t?i.audioContext.currentTime:t;this.rnboInstrument.playNote(e,n),void 0===this.heldNoteTimes.find(e=>e>-1)&&this.notifyPlayerListeners(0,n,e),this.heldNoteTimes[e]=n}stopNote(e,t){const n=void 0===t?i.audioContext.currentTime:t;this.rnboInstrument&&(this.rnboInstrument.stopNote(e,n),this.heldNoteTimes[e]=-1,this.notifyPlayerListeners(1,n,e),void 0===this.heldNoteTimes.find(e=>e>-1)&&this.notifyPlayerListeners(2,n,e))}stopAllNotes(e){const t=void 0===e?i.audioContext.currentTime:e;if(this.rnboInstrument){for(let e=0;e<128;e++)this.rnboInstrument.stopNote(e,t);this.heldNoteTimes.fill(-1),this.notifyPlayerListeners(2,t)}}stopAllSound(){if(void 0!==this.rnboInstrument){const e=this.getParameterValue("amplitude_envelope_release");this.rnboInstrument.setParameterValueByName("amplitude_envelope_release",1),this.stopAllNotes(),setTimeout(()=>{void 0!==this.rnboInstrument&&this.rnboInstrument.setParameterValueByName("amplitude_envelope_release",e)},100)}}getDefaultState(){return JSON.parse(JSON.stringify(u))}getState(){return this.instrumentState}getStateCopy(){return JSON.parse(this.getPresetJSONFromCurrentState())}getPresetJSONFromCurrentState(){return JSON.stringify(this.getState(),null,4)}relinquishInstrument(){this.removeModulationListeners(),this.rnboInstrument=void 0}getHeldNotes(){const e=[];for(let t=0;t<this.heldNoteTimes.length;t++){const n=this.heldNoteTimes[t];n>=0&&e.push({pitch:t,time:n})}return e}removeModulationListeners(){if(void 0===this.rnboInstrument)throw new Error("Attempting to remove modulation listeners from undefined instrument");this.rnboInstrument.removeEventListener("MessageEvent",this.onRnboEvent)}onRnboEvent(e){const t=e.detail.tag,n=t.substring(0,t.length-"_modulated".length),r=e.detail.payload;this.updateModulatedValues(n,r)}notifyPlayerListeners(e,t,n){this.playerListener.forEach(r=>{r.onPlaybackEvent&&r.onPlaybackEvent(e,t,n)})}notifyPresetListeners(e){this.playerListener.forEach(t=>{t.onPresetEvent&&t.onPresetEvent(e)})}notifyParameterListeners(e,t,n){this.playerListener.forEach(r=>{r.onParameterEvent&&r.onParameterEvent(e,t,n)})}updateModulatedValues(e,t){this.modulatedValues[e]=t}},t.StateVersion="0",t.getDefaultState=function(){return JSON.parse(JSON.stringify(u))};const u={instrumentName:"rnbo-test",version:t.StateVersion,presetMetadata:{name:"Default"},parameters:[{kind:c.Kind.number,name:"oscillator_noise_amplitude",min:0,max:1,value:0,scaling:{kind:l.Kind.exponential,exponent:.8},unit:{kind:"percent"}},{kind:c.Kind.number,name:"oscillator_pulse_amplitude",min:0,max:1,value:1,scaling:{kind:l.Kind.exponential,exponent:.8},unit:{kind:"percent"}},{kind:c.Kind.number,name:"oscillator_pulse_width",min:-1,max:1,value:0,scaling:{kind:l.Kind.linear},unit:{kind:"percent"},isModulationTarget:!0},{kind:c.Kind.number,name:"oscillator_saw_amplitude",min:0,max:1,value:0,scaling:{kind:l.Kind.exponential,exponent:.8},unit:{kind:"percent"}},{kind:c.Kind.number,name:"oscillator_saw_detune_coarse",min:-48,max:48,value:0,scaling:{kind:l.Kind.linear},unit:{kind:"pitch",postfix:"st"}},{kind:c.Kind.number,name:"oscillator_saw_detune_fine",min:-100,max:100,value:0,scaling:{kind:l.Kind.linear},unit:{kind:"pitch",postfix:"ct"}},{kind:c.Kind.number,name:"amplitude_envelope_attack",min:0,max:5e3,value:30,scaling:{kind:l.Kind.exponential,exponent:3},unit:{kind:"time"}},{kind:c.Kind.number,name:"amplitude_envelope_decay",min:1,max:5e3,value:200,scaling:{kind:l.Kind.exponential,exponent:3},unit:{kind:"time"}},{kind:c.Kind.number,name:"amplitude_envelope_sustain",min:0,max:1,value:.5,scaling:{kind:l.Kind.exponential,exponent:.8},unit:{kind:"percent"}},{kind:c.Kind.number,name:"amplitude_envelope_release",min:1,max:2e4,value:300,scaling:{kind:l.Kind.exponential,exponent:5},unit:{kind:"time"}},{kind:c.Kind.number,name:"modulation_envelope_attack",min:0,max:5e3,value:100,scaling:{kind:l.Kind.exponential,exponent:3},unit:{kind:"time"}},{kind:c.Kind.number,name:"modulation_envelope_decay",min:1,max:5e3,value:500,scaling:{kind:l.Kind.exponential,exponent:3},unit:{kind:"time"}},{kind:c.Kind.number,name:"modulation_envelope_sustain",min:0,max:1,value:.5,scaling:{kind:l.Kind.exponential,exponent:.8},unit:{kind:"percent"}},{kind:c.Kind.number,name:"modulation_envelope_release",min:1,max:2e4,value:150,scaling:{kind:l.Kind.exponential,exponent:5},unit:{kind:"time"}},{kind:c.Kind.number,name:"filter_envelope_amount",min:-1,max:1,value:0,scaling:{kind:l.Kind.linear},unit:{kind:"percent"}},{kind:c.Kind.number,name:"filter_frequency",min:20,max:2e4,value:3e3,scaling:{kind:l.Kind.pitch,baseFrequency:20,octaves:10},unit:{kind:"frequency"},isModulationTarget:!0},{kind:c.Kind.number,name:"filter_resonance",min:0,max:1,value:.2,scaling:{kind:l.Kind.linear},unit:{kind:"percent"}},{kind:c.Kind.number,name:"lfo_frequency",min:.1,max:1e3,value:1,scaling:{kind:l.Kind.exponential,exponent:8},unit:{kind:"frequency"},isModulationTarget:!0},{kind:c.Kind.number,name:"lfo_frequency_envelope_amount",min:-1,max:1,value:0,scaling:{kind:l.Kind.linear},unit:{kind:"percent"}},{kind:c.Kind.enum,name:"lfo_shape",value:0,options:["sin","saw_down","square","sample_hold"]},{kind:c.Kind.enum,name:"lfo_retrigger",value:1,options:["off","on"]},{kind:c.Kind.number,name:"amplitude_lfo_amount",min:-1,max:1,value:0,scaling:{kind:l.Kind.linear},unit:{kind:"percent"}},{kind:c.Kind.number,name:"oscillator_pulse_width_lfo_amount",min:-1,max:1,value:0,scaling:{kind:l.Kind.linear},unit:{kind:"percent"}},{kind:c.Kind.number,name:"oscillator_pulse_width_envelope_amount",min:-1,max:1,value:0,scaling:{kind:l.Kind.linear},unit:{kind:"percent"}},{kind:c.Kind.number,name:"filter_lfo_amount",min:-1,max:1,value:0,scaling:{kind:l.Kind.linear},unit:{kind:"percent"}},{kind:c.Kind.number,name:"oscillator_pitch_offset_lfo_amount",min:-48,max:48,value:0,scaling:{kind:l.Kind.linear},unit:{kind:"pitch",postfix:"st"}},{kind:c.Kind.number,name:"oscillator_pitch_offset_envelope_amount",min:-48,max:48,value:0,scaling:{kind:l.Kind.linear},unit:{kind:"pitch",postfix:"st"}},{kind:c.Kind.number,name:"oscillator_pitch_offset",min:-48,max:48,value:0,scaling:{kind:l.Kind.linear},unit:{kind:"pitch",postfix:"st"},isModulationTarget:!0},{kind:c.Kind.number,name:"global_slew_time",min:0,max:5e3,value:50,scaling:{kind:l.Kind.linear},unit:{kind:"time"}},{kind:c.Kind.number,name:"oscillator_pitch",min:-48,max:48,value:0,scaling:{kind:l.Kind.quantizedPitch},unit:{kind:"pitch",postfix:"st"}},{kind:c.Kind.number,name:"oscillator_pitch_glide",min:0,max:1500,value:50,scaling:{kind:l.Kind.linear},unit:{kind:"time"}},{kind:c.Kind.number,name:"glide_time",min:0,max:5e3,value:0,scaling:{kind:l.Kind.exponential,exponent:3},unit:{kind:"time"}},{kind:c.Kind.number,name:"amplitude",min:0,max:1,value:1,scaling:{kind:l.Kind.linear},unit:{kind:"percent"},isModulationTarget:!0}]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(54),i=n(6);function a(e,t){const n=function(e,t,n,i){const a=e.getParameterByName(t);switch(a.kind){case r.Kind.number:{const r=void 0!==n?e.convertToControlValue(t,n):0,a=void 0!==i?e.convertToControlValue(t,i):1;return{min:r,max:a}}case r.Kind.enum:{const e=void 0!==n?n/a.options.length:0,t=void 0!==i?(i+1)/a.options.length:1;return{min:e,max:t}}default:return{min:0,max:1}}}(t,e.name,e.min,e.max),i=void 0===e.breakpoints?void 0:function(e,t,n){return n.map(n=>({pct:n.pct,controlValue:e.convertToControlValue(t,n.value)}))}(t,e.name,e.breakpoints);return{parameterName:e.name,minControlValue:n.min,maxControlValue:n.max,breakpoints:i}}t.createMacro=function(e,t){return void 0===e?[]:e instanceof Array?e.map(e=>a(e,t)):[a(e,t)]},t.setValueForMacroTarget=function(e,t,n){if(void 0===e.breakpoints)n.setParameterControlValue(e.parameterName,i.mapNormalizedValueToRange(t,e.minControlValue,e.maxControlValue));else{const r=function(e,t){let n=0,r=0,a=1,o=1;for(let i=0;i<e.length;i++){const s=e[i];if(s.pct<=t&&(n=s.controlValue,r=s.pct),s.pct>=t){a=s.controlValue,o=s.pct;break}}return r===o?a:i.mapValueToRange(t,r,o,n,a)}(e.breakpoints,t);n.setParameterControlValue(e.parameterName,r)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(30),a=n(3),o=n(34),s=n(42),c=n(220),l=n(221),u=n(75),h=n(22),p=n(10),d=n(222),f=n(16);t.ComponentName="shared-synth";t.SharedSynth=class extends r.Component{constructor(e){super(e),this.keyboardHandler=new c.KeyboardEventPlayer,this.pressButtonDown=!1,this.musicEvents=[],this.musicEventIndex=0,this.animationFramer=new p.AnimationFramer,this.controlPortals=[],this.isPlayingPubSubNote=!1,t.sharedSynthInstance=this,this.state={showResetButton:!1},this.player=this.props.player,this.player.addPlayerListener(this),this.initialPreset=this.player.getStateCopy(),this.defPlayer=new u.DefPlayer(this.player,this.props.sequence),this.musicEvents=h.notationToMusicEvents(this.props.notes),this.onNoteOn=this.onNoteOn.bind(this),this.onNoteOff=this.onNoteOff.bind(this),this.onPress=this.onPress.bind(this),this.onRelease=this.onRelease.bind(this),this.onReset=this.onReset.bind(this),this.startSequence=this.startSequence.bind(this),this.stopSequence=this.stopSequence.bind(this),this.onAnimationFrame=this.onAnimationFrame.bind(this),this.onNoteOnRequested=this.onNoteOnRequested.bind(this),this.onNoteOffRequested=this.onNoteOffRequested.bind(this),this.decideWhetherToShowResetButton=o.debounce(this.decideWhetherToShowResetButton,250)}componentDidMount(){if(s.addListener(this),this.animationFramer.startAnimating(this.onAnimationFrame),f.subscribe("requestSharedSynthNoteOn",this.onNoteOnRequested),f.subscribe("requestSharedSynthNoteOff",this.onNoteOffRequested),this.keyboardHandler.startObservingKeyboardEvents(this),"IntersectionObserver"in window&&"IntersectionObserverEntry"in window){const e=document.querySelector(".recipes .components_lesson-viewer__footer"),t=document.querySelector(".recipes .subtractive-synth__floating_controls"),n=new IntersectionObserver(e=>{t&&(e[0].isIntersecting?document.body.classList.add("move-floating-buttons"):document.body.classList.remove("move-floating-buttons"))},{threshold:.25});e&&n.observe(e)}}componentWillUnmount(){this.keyboardHandler.stopObservingKeyboardEvents(),s.removeListener(this),this.defPlayer.stop(),this.player.stopAllSound(),this.player.removePlayerListener(this),this.animationFramer.stopAnimating(),f.unsubscribe("requestSharedSynthNoteOn",this.onNoteOnRequested),f.unsubscribe("requestSharedSynthNoteOff",this.onNoteOffRequested),t.sharedSynthInstance=void 0}componentDidUpdate(e){e.sequence!==this.props.sequence&&this.defPlayer&&this.defPlayer.setNotation(this.props.sequence),e.notes!==this.props.notes&&this.defPlayer&&(this.musicEvents=h.notationToMusicEvents(this.props.notes),this.musicEventIndex=0)}render(){return 0===this.controlPortals.length||document.body.classList.contains("recipes")?this.renderControls("subtractive-synth__floating_controls"):r.createElement(r.Fragment,null,this.controlPortals.map(e=>i.createPortal(this.renderControls("subtractive-synth__inline_controls"),e)))}addControlPortal(e){this.controlPortals.push(e),this.forceUpdate()}getPlayer(){return this.player}onNoteOn(e,t){this.defPlayer.getIsPlaying()&&this.stopSequence(),this.isPlayingPubSubNote&&(this.onRelease(!0),this.isPlayingPubSubNote=!1),this.player.playNote(e)}onNoteOff(e,t){this.player.stopNote(e)}onPress(){this.pressButtonDown=!0;const e=this.musicEvents[this.musicEventIndex%this.musicEvents.length].pitch;this.onNoteOn(e,127),this.forceUpdate()}onRelease(e){this.pressButtonDown=!1;const t=this.musicEvents[this.musicEventIndex%this.musicEvents.length].pitch;void 0!==e&&!1!==e||this.musicEventIndex++,this.onNoteOff(t,127),this.forceUpdate()}onParameterEvent(e,t,n){this.decideWhetherToShowResetButton()}decideWhetherToShowResetButton(){const e=!o.isEqual(this.initialPreset,this.player.getState());this.setState({showResetButton:e})}startSequence(){this.defPlayer.play(),this.forceUpdate()}stopSequence(){this.defPlayer.stop(),this.forceUpdate()}onAnimationFrame(){this.defPlayer.getIsPlaying()&&this.forceUpdate()}onReset(){this.player.preset(this.initialPreset),this.setState({showResetButton:!1})}onNoteOnRequested(e){this.defPlayer.getIsPlaying()||(this.onPress(),this.isPlayingPubSubNote=!0)}onNoteOffRequested(e){!this.defPlayer.getIsPlaying()&&this.isPlayingPubSubNote&&(this.onRelease(e.noAdvance),this.isPlayingPubSubNote=!1)}renderControls(e){return r.createElement("div",{className:e},r.createElement("div",{className:a("subtractive-synth__reset-button-wrapper",{"subtractive-synth__reset-button-wrapper--show":this.state.showResetButton&&this.props.resetButton})},r.createElement(l.ResetButton,{onClick:this.onReset})),r.createElement(d.SynthPlaybackControls,{onPress:this.onPress,onRelease:this.onRelease,onStartSequence:this.startSequence,onStopSequence:this.stopSequence,progress:this.defPlayer.progress(),playingSequence:this.defPlayer.getIsPlaying(),pressButtonDown:this.pressButtonDown,playButtonTooltipKey:this.props.playButtonTooltipKey,pressButtonTooltipKey:this.props.pressButtonTooltipKey}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(19),a=n(56),o=n(4),s=n(8),c=n(27),l=n(28);t.AmplitudeEnvelopePanel=class extends r.Component{constructor(e){super(e),this.adsrHistory=new c.ADSRHistory}componentDidMount(){this.props.player.addPlayerListener(this)}componentWillUnmount(){this.props.player.removePlayerListener(this)}render(){return r.createElement("div",{className:"components_embeds_subtractive-synth__panel",key:"amp-envelope-panel",style:{"--current-theme-color":"var(--color-green)"}},r.createElement("div",{className:"components_embeds_subtractive-synth__panel_content"},r.createElement("h3",null,o.translated("playground:panel_names.amplitude_envelope")),r.createElement("div",{className:"components_embeds_subtractive-synth__visualization_panel"},r.createElement(l.AnimationFrameUpdater,{render:()=>(this.adsrHistory.setADR(this.props.player.getParameterValue("amplitude_envelope_attack")/1e3,this.props.player.getParameterValue("amplitude_envelope_decay")/1e3,this.props.player.getParameterValue("amplitude_envelope_release")/1e3),r.createElement(a.SimpleADSR,{attack:this.props.player.getParameterControlValue("amplitude_envelope_attack"),decay:this.props.player.getParameterControlValue("amplitude_envelope_decay"),sustain:this.props.player.getParameterControlValue("amplitude_envelope_sustain"),release:this.props.player.getParameterControlValue("amplitude_envelope_release"),history:this.adsrHistory.getHistory(s.audioContext.currentTime)}))})),r.createElement(i.NumberParameterSlider,{key:"amplitude_envelope_attack",paramName:"amplitude_envelope_attack",player:this.props.player}),r.createElement(i.NumberParameterSlider,{key:"amplitude_envelope_decay",paramName:"amplitude_envelope_decay",player:this.props.player}),r.createElement(i.NumberParameterSlider,{key:"amplitude_envelope_sustain",paramName:"amplitude_envelope_sustain",player:this.props.player}),r.createElement(i.NumberParameterSlider,{key:"amplitude_envelope_release",paramName:"amplitude_envelope_release",player:this.props.player})))}onPlaybackEvent(e,t,n){switch(e){case 0:this.adsrHistory.startNote(s.audioContext.currentTime);break;case 1:break;case 2:this.adsrHistory.releaseNote(s.audioContext.currentTime)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(19),a=n(82),o=n(4),s=n(38);t.LowPassFilterPanel=class extends r.Component{constructor(e){super(e)}render(){return r.createElement("div",{className:"components_embeds_subtractive-synth__panel",key:"low-pass-panel",style:{"--current-theme-color":"var(--color-yellow)"}},r.createElement("div",{className:"components_embeds_subtractive-synth__panel_content"},r.createElement("h3",null,o.translated("playground:panel_names.low_pass_filter")),r.createElement("div",{className:"components_embeds_subtractive-synth__visualization_panel"},r.createElement(s.PlayerObserver,{player:this.props.player,parameters:["filter_frequency","filter_resonance"],render:()=>r.createElement(a.FilterCurve,{type:"lowpass",frequency:this.props.player.getParameterValue("filter_frequency"),resonance:this.props.player.getParameterValue("filter_resonance")})})),r.createElement(i.NumberParameterSlider,{key:"filter_frequency",paramName:"filter_frequency",player:this.props.player}),r.createElement("div",{className:"components_embeds_subtractive-synth__modulation_panel"},r.createElement("div",{className:"components_embeds_subtractive-synth__modulation_panel_bg"}),r.createElement(i.NumberParameterSlider,{key:"filter_lfo_amount",paramName:"filter_lfo_amount",player:this.props.player}),r.createElement(i.NumberParameterSlider,{key:"filter_envelope_amount",paramName:"filter_envelope_amount",player:this.props.player})),r.createElement(i.NumberParameterSlider,{key:"filter_resonance",paramName:"filter_resonance",player:this.props.player})))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(5),a=n(8),o=n(6);t.upperFrequencyLimitHz=22e3;t.FilterCurve=class extends r.PureComponent{constructor(e){super(e),this.sizeObserver=new i.SizeObserver,this.biquad=a.audioContext.createBiquadFilter(),this.frequenciesToDraw=new Float32Array(0),this.magnitudeResponse=new Float32Array(0),this.phaseResponse=new Float32Array(0),this.ref=r.createRef(),this.onResize=this.onResize.bind(this)}render(){return r.createElement("div",{ref:this.ref,className:"component_filter-curve"},r.createElement("svg",null,r.createElement("path",{className:"component_filter-curve__path",d:this.path()})))}componentDidMount(){this.sizeObserver.startObserving(this.ref,this.onResize)}componentWillUnmount(){this.sizeObserver.stopObserving()}xPctToFreq(e){const n=t.upperFrequencyLimitHz;return o.clamp(20*Math.pow(2,10*e),20,n)}onResize(){const e=this.sizeObserver.getWidth();this.frequenciesToDraw=new Float32Array(e),this.magnitudeResponse=new Float32Array(e),this.phaseResponse=new Float32Array(e);for(let t=0;t<e;t++)this.frequenciesToDraw[t]=this.xPctToFreq(t/e);this.forceUpdate()}path(){const e=this.sizeObserver.getWidth(),t=this.sizeObserver.getHeight();this.biquad.Q.value=5*this.props.resonance,this.biquad.frequency.value=this.props.frequency,this.biquad.type=this.props.type,this.biquad.getFrequencyResponse(this.frequenciesToDraw,this.magnitudeResponse,this.phaseResponse);const n=t/2;let r=`M0,${n} `;return this.magnitudeResponse.forEach((e,t)=>{r+=`${0===t?"M":"L"}${t},${n+(1-e)*n} `}),r+=`L${e},${t} `,r+=`L0,${t} `}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(19),a=n(56),o=n(4),s=n(8),c=n(27),l=n(28);t.ModEnvelopePanel=class extends r.Component{constructor(e){super(e),this.adsrHistory=new c.ADSRHistory}componentDidMount(){this.props.player.addPlayerListener(this)}componentWillUnmount(){this.props.player.removePlayerListener(this)}render(){return r.createElement("div",{className:"components_embeds_subtractive-synth__panel",key:"amp-envelope-panel",style:{"--current-theme-color":"var(--color-red)"}},r.createElement("div",{className:"components_embeds_subtractive-synth__panel_content"},r.createElement("h3",null,o.translated("playground:panel_names.mod_envelope")),r.createElement("div",{className:"components_embeds_subtractive-synth__visualization_panel"},r.createElement(l.AnimationFrameUpdater,{render:()=>(this.adsrHistory.setADR(this.props.player.getParameterValue("modulation_envelope_attack")/1e3,this.props.player.getParameterValue("modulation_envelope_decay")/1e3,this.props.player.getParameterValue("modulation_envelope_release")/1e3),r.createElement(a.SimpleADSR,{attack:this.props.player.getParameterControlValue("modulation_envelope_attack"),decay:this.props.player.getParameterControlValue("modulation_envelope_decay"),sustain:this.props.player.getParameterControlValue("modulation_envelope_sustain"),release:this.props.player.getParameterControlValue("modulation_envelope_release"),history:this.adsrHistory.getHistory(s.audioContext.currentTime)}))})),r.createElement(i.NumberParameterSlider,{key:"modulation_envelope_attack",paramName:"modulation_envelope_attack",player:this.props.player}),r.createElement(i.NumberParameterSlider,{key:"modulation_envelope_decay",paramName:"modulation_envelope_decay",player:this.props.player}),r.createElement(i.NumberParameterSlider,{key:"modulation_envelope_sustain",paramName:"modulation_envelope_sustain",player:this.props.player}),r.createElement(i.NumberParameterSlider,{key:"modulation_envelope_release",paramName:"modulation_envelope_release",player:this.props.player})))}onPlaybackEvent(e,t,n){switch(e){case 0:this.adsrHistory.startNote(s.audioContext.currentTime);break;case 1:break;case 2:this.adsrHistory.releaseNote(s.audioContext.currentTime)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(19),a=n(226),o=n(4),s=n(85),c=n(86),l=n(57),u=n(227),h=n(28);t.LfoPanel=class extends r.Component{constructor(e){super(e)}render(){return r.createElement("div",{className:"components_embeds_subtractive-synth__panel",key:"lfo-panel",style:{"--current-theme-color":"var(--color-red)","--current-theme-color-shade":"var(--color-red-shade)"}},r.createElement("div",{className:"components_embeds_subtractive-synth__panel_content"},r.createElement("h3",null,o.translated("playground:panel_names.lfo")),r.createElement("div",{className:"components_embeds_subtractive-synth__visualization_panel"},r.createElement(h.AnimationFrameUpdater,{render:()=>{const e=this.props.player.getParameterValue("lfo_shape");let t=this.props.player.getModulatedParameterValue("lfo_frequency"),n=this.props.player.getModulatedParameterControlValue("lfo_phase");switch(t>=13.92&&(t=13.92,n=performance.now()/1e3%1*13.92),e){case 0:return r.createElement(l.SineLFO,{active:!1,phase:n,frequency:t,amplitude:1});case 1:return r.createElement(s.SawLFO,{active:!1,phase:n,frequency:t,amplitude:1});case 2:return r.createElement(c.PulseLFO,{active:!1,phase:n,frequency:t,amplitude:1});case 3:return r.createElement(u.SampleAndHoldLFO,{active:!1,phase:n,frequency:t,amplitude:1});default:throw new Error("Invalid LFO shape")}}})),r.createElement(a.LfoShapeChooser,{key:"lfo_shape",player:this.props.player}),r.createElement(i.NumberParameterSlider,{key:"lfo_frequency",paramName:"lfo_frequency",player:this.props.player}),r.createElement("div",{className:"components_embeds_subtractive-synth__modulation_panel"},r.createElement("div",{className:"components_embeds_subtractive-synth__modulation_panel_bg"}),r.createElement(i.NumberParameterSlider,{key:"lfo_frequency_envelope_amount",paramName:"lfo_frequency_envelope_amount",player:this.props.player}))))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(3),a=n(21),o=n(5);t.SawLFO=class extends r.Component{constructor(e){super(e),this.sizeObserver=new o.SizeObserver,this.ref=r.createRef(),this.onResize=this.onResize.bind(this)}render(){const e=i("components--lfo-shape",{"active-shape":this.props.active}),t=this.sizeObserver.getWidth(),n=this.sizeObserver.getHeight(),o=2*this.props.frequency,s=a.sawPolylinePoints(t,n,this.props.phase,this.props.amplitude,o),c=a.sawPointAtPhase(n,this.props.phase,this.props.amplitude);return r.createElement("div",{className:e,ref:this.ref},r.createElement("svg",{width:"100%",height:"100%"},r.createElement("polyline",{className:"components--lfo-shape__viz-waveshape-filled",points:s}),r.createElement("circle",{className:"components--lfo-shape__viz-dot",cx:`${t/2}`,cy:c,r:"5"})))}shouldComponentUpdate(e){return e.amplitude!==this.props.amplitude||e.phase!==this.props.phase||e.active!==this.props.active}componentDidMount(){this.sizeObserver.startObserving(this.ref,this.onResize)}componentWillUnmount(){this.sizeObserver.stopObserving()}onResize(){this.forceUpdate()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(3),a=n(21),o=n(5);t.PulseLFO=class extends r.Component{constructor(e){super(e),this.sizeObserver=new o.SizeObserver,this.ref=r.createRef(),this.onResize=this.onResize.bind(this)}render(){const e=i("components--lfo-shape",{"active-shape":this.props.active}),t=this.sizeObserver.getWidth(),n=this.sizeObserver.getHeight(),o=2*this.props.frequency,s=a.pulsePolylinePoints(t,n,this.props.phase,this.props.amplitude,o,.5),c=a.pulsePointAtPhase(n,this.props.phase,this.props.amplitude,.5);return r.createElement("div",{className:e,ref:this.ref},r.createElement("svg",{width:"100%",height:"100%"},r.createElement("polyline",{className:"components--lfo-shape__viz-waveshape-filled",points:s}),r.createElement("circle",{className:"components--lfo-shape__viz-dot",cx:`${t/2}`,cy:c,r:"5"})))}shouldComponentUpdate(e){return e.amplitude!==this.props.amplitude||e.phase!==this.props.phase||e.active!==this.props.active}componentDidMount(){this.sizeObserver.startObserving(this.ref,this.onResize)}componentWillUnmount(){this.sizeObserver.stopObserving()}onResize(){this.forceUpdate()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(19),a=n(4);t.PitchPanel=class extends r.Component{constructor(e){super(e)}render(){return r.createElement("div",{className:"components_embeds_subtractive-synth__panel",key:"pitch-envelope-panel",style:{"--current-theme-color":"var(--color-blue)"}},r.createElement("div",{className:"components_embeds_subtractive-synth__panel_content"},r.createElement("h3",null,a.translated("playground:panel_names.pitch")),r.createElement(i.NumberParameterSlider,{key:"oscillator_pitch_offset",paramName:"oscillator_pitch_offset",player:this.props.player}),r.createElement("div",{className:"components_embeds_subtractive-synth__modulation_panel"},r.createElement("div",{className:"components_embeds_subtractive-synth__modulation_panel_bg"}),r.createElement(i.NumberParameterSlider,{key:"oscillator_pitch_offset_lfo_amount",paramName:"oscillator_pitch_offset_lfo_amount",player:this.props.player}),r.createElement(i.NumberParameterSlider,{key:"oscillator_pitch_offset_envelope_amount",paramName:"oscillator_pitch_offset_envelope_amount",player:this.props.player})),r.createElement(i.NumberParameterSlider,{key:"glide_time",paramName:"glide_time",player:this.props.player})))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(19),a=n(4);t.NoisePanel=class extends r.Component{constructor(e){super(e)}render(){return r.createElement("div",{className:"components_embeds_subtractive-synth__panel",key:"noise-envelope-panel",style:{"--current-theme-color":"var(--color-blue)"}},r.createElement("div",{className:"components_embeds_subtractive-synth__panel_content"},r.createElement("h3",null,a.translated("playground:panel_names.noise")),r.createElement(i.NumberParameterSlider,{key:"oscillator_noise_amplitude",paramName:"oscillator_noise_amplitude",player:this.props.player})))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(19),a=n(4),o=n(90),s=n(38);t.AmplitudePanel=class extends r.Component{constructor(e){super(e)}render(){return r.createElement("div",{className:"components_embeds_subtractive-synth__panel",key:"amplitude-panel",style:{"--current-theme-color":"var(--color-green)"}},r.createElement("div",{className:"components_embeds_subtractive-synth__panel_content"},r.createElement("h3",null,a.translated("playground:panel_names.amplitude")),r.createElement("div",{className:"components_embeds_subtractive-synth__visualization_panel"},r.createElement(s.PlayerObserver,{player:this.props.player,parameters:["amplitude"],render:()=>r.createElement(o.AmplitudeRamp,{amplitude:this.props.player.getParameterControlValue("amplitude")})})),r.createElement(i.NumberParameterSlider,{key:"amplitude",paramName:"amplitude",player:this.props.player}),r.createElement("div",{className:"components_embeds_subtractive-synth__modulation_panel"},r.createElement("div",{className:"components_embeds_subtractive-synth__modulation_panel_bg"}),r.createElement(i.NumberParameterSlider,{key:"amplitude_lfo_amount",paramName:"amplitude_lfo_amount",player:this.props.player}))))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(5);t.AmplitudeRamp=class extends r.Component{constructor(e){super(e),this.sizeObserver=new i.SizeObserver,this.ref=r.createRef(),this.onResize=this.onResize.bind(this)}render(){const e=this.sizeObserver.getHeight(),t=this.sizeObserver.getWidth(),n=`0 0 ${t} ${e}`,i=this.props.amplitude*t,a=`M0,${e} L${t},${e} L${t},0 L0,${e} Z`;return r.createElement("div",{ref:this.ref,className:"component_amplitude-ramp"},r.createElement("svg",{viewBox:n},r.createElement("defs",null,r.createElement("clipPath",{id:"amplitude-ramp-clippath"},r.createElement("rect",{x:"0",y:"0",width:i,height:e}))),r.createElement("path",{className:"component_amplitude-ramp__background",d:a}),r.createElement("path",{className:"component_amplitude-ramp__fill",clipPath:"url(#amplitude-ramp-clippath)",style:{opacity:1},d:a})))}shouldComponentUpdate(e){return e.amplitude!==this.props.amplitude}componentDidMount(){this.sizeObserver.startObserving(this.ref,this.onResize)}componentWillUnmount(){this.sizeObserver.stopObserving()}onResize(){this.forceUpdate()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(19),a=n(4),o=n(92),s=n(38);t.PulseOscillatorPanel=class extends r.Component{constructor(e){super(e)}render(){return r.createElement("div",{className:"components_embeds_subtractive-synth__panel",key:"pulse-osc-panel",style:{"--current-theme-color":"var(--color-blue)"}},r.createElement("div",{className:"components_embeds_subtractive-synth__panel_content"},r.createElement("h3",null,a.translated("playground:panel_names.pulse_oscillator")),r.createElement("div",{className:"components_embeds_subtractive-synth__visualization_panel"},r.createElement(s.PlayerObserver,{player:this.props.player,parameters:["oscillator_pulse_width","oscillator_pulse_amplitude"],render:()=>r.createElement(o.PulseWaveform,{phase:0,width:this.props.player.getParameterControlValue("oscillator_pulse_width"),amplitude:this.props.player.getParameterControlValue("oscillator_pulse_amplitude")})})),r.createElement(i.NumberParameterSlider,{key:"oscillator_pulse_amplitude",paramName:"oscillator_pulse_amplitude",player:this.props.player}),r.createElement(i.NumberParameterSlider,{key:"oscillator_pulse_width",paramName:"oscillator_pulse_width",player:this.props.player}),r.createElement("div",{className:"components_embeds_subtractive-synth__modulation_panel"},r.createElement("div",{className:"components_embeds_subtractive-synth__modulation_panel_bg"}),r.createElement(i.NumberParameterSlider,{key:"oscillator_pulse_width_lfo_amount",paramName:"oscillator_pulse_width_lfo_amount",player:this.props.player}),r.createElement(i.NumberParameterSlider,{key:"oscillator_pulse_width_envelope_amount",paramName:"oscillator_pulse_width_envelope_amount",player:this.props.player}))))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(21),a=n(5);class o extends r.Component{constructor(e){super(e),this.sizeObserver=new a.SizeObserver,this.ref=r.createRef(),this.onResize=this.onResize.bind(this)}render(){return r.createElement("div",{ref:this.ref,className:"component_pulse-waveform"},r.createElement("svg",null,r.createElement("polyline",{className:"component_pulse-waveform__path",points:i.pulsePolylinePoints(this.sizeObserver.getWidth(),this.sizeObserver.getHeight(),this.props.phase,this.props.amplitude,2,this.props.width)})))}shouldComponentUpdate(e){return e.amplitude!==this.props.amplitude||e.phase!==this.props.phase||e.width!==this.props.width}componentDidMount(){this.sizeObserver.startObserving(this.ref,this.onResize)}componentWillUnmount(){this.sizeObserver.stopObserving()}onResize(){this.forceUpdate()}}o.defaultProps={width:.5,amplitude:1,phase:0},t.PulseWaveform=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(19),a=n(4),o=n(228),s=n(38);t.SawOscillatorPanel=class extends r.Component{constructor(e){super(e)}render(){return r.createElement("div",{className:"components_embeds_subtractive-synth__panel",key:"saw-osc-panel",style:{"--current-theme-color":"var(--color-blue)"}},r.createElement("div",{className:"components_embeds_subtractive-synth__panel_content"},r.createElement("h3",null,a.translated("playground:panel_names.saw_oscillator")),r.createElement("div",{className:"components_embeds_subtractive-synth__visualization_panel"},r.createElement(s.PlayerObserver,{player:this.props.player,parameters:["oscillator_saw_amplitude"],render:()=>r.createElement(o.SawWaveform,{amplitude:this.props.player.getParameterControlValue("oscillator_saw_amplitude")})})),r.createElement(i.NumberParameterSlider,{key:"oscillator_saw_amplitude",paramName:"oscillator_saw_amplitude",player:this.props.player}),r.createElement(i.NumberParameterSlider,{key:"oscillator_saw_detune_fine",paramName:"oscillator_saw_detune_fine",player:this.props.player}),r.createElement(i.NumberParameterSlider,{key:"oscillator_saw_detune_coarse",paramName:"oscillator_saw_detune_coarse",player:this.props.player})))}}},function(e,t,n){"use strict";e.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},function(e,t,n){var r=n(94),i={};for(var a in r)r.hasOwnProperty(a)&&(i[r[a]]=a);var o=e.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var s in o)if(o.hasOwnProperty(s)){if(!("channels"in o[s]))throw new Error("missing channels property: "+s);if(!("labels"in o[s]))throw new Error("missing channel labels property: "+s);if(o[s].labels.length!==o[s].channels)throw new Error("channel and label counts mismatch: "+s);var c=o[s].channels,l=o[s].labels;delete o[s].channels,delete o[s].labels,Object.defineProperty(o[s],"channels",{value:c}),Object.defineProperty(o[s],"labels",{value:l})}o.rgb.hsl=function(e){var t,n,r=e[0]/255,i=e[1]/255,a=e[2]/255,o=Math.min(r,i,a),s=Math.max(r,i,a),c=s-o;return s===o?t=0:r===s?t=(i-a)/c:i===s?t=2+(a-r)/c:a===s&&(t=4+(r-i)/c),(t=Math.min(60*t,360))<0&&(t+=360),n=(o+s)/2,[t,100*(s===o?0:n<=.5?c/(s+o):c/(2-s-o)),100*n]},o.rgb.hsv=function(e){var t,n,r,i,a,o=e[0]/255,s=e[1]/255,c=e[2]/255,l=Math.max(o,s,c),u=l-Math.min(o,s,c),h=function(e){return(l-e)/6/u+.5};return 0===u?i=a=0:(a=u/l,t=h(o),n=h(s),r=h(c),o===l?i=r-n:s===l?i=1/3+t-r:c===l&&(i=2/3+n-t),i<0?i+=1:i>1&&(i-=1)),[360*i,100*a,100*l]},o.rgb.hwb=function(e){var t=e[0],n=e[1],r=e[2];return[o.rgb.hsl(e)[0],100*(1/255*Math.min(t,Math.min(n,r))),100*(r=1-1/255*Math.max(t,Math.max(n,r)))]},o.rgb.cmyk=function(e){var t,n=e[0]/255,r=e[1]/255,i=e[2]/255;return[100*((1-n-(t=Math.min(1-n,1-r,1-i)))/(1-t)||0),100*((1-r-t)/(1-t)||0),100*((1-i-t)/(1-t)||0),100*t]},o.rgb.keyword=function(e){var t=i[e];if(t)return t;var n,a,o,s=1/0;for(var c in r)if(r.hasOwnProperty(c)){var l=r[c],u=(a=e,o=l,Math.pow(a[0]-o[0],2)+Math.pow(a[1]-o[1],2)+Math.pow(a[2]-o[2],2));u<s&&(s=u,n=c)}return n},o.keyword.rgb=function(e){return r[e]},o.rgb.xyz=function(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255;return[100*(.4124*(t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92)+.3576*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)+.1805*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92)),100*(.2126*t+.7152*n+.0722*r),100*(.0193*t+.1192*n+.9505*r)]},o.rgb.lab=function(e){var t=o.rgb.xyz(e),n=t[0],r=t[1],i=t[2];return r/=100,i/=108.883,n=(n/=95.047)>.008856?Math.pow(n,1/3):7.787*n+16/116,[116*(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116)-16,500*(n-r),200*(r-(i=i>.008856?Math.pow(i,1/3):7.787*i+16/116))]},o.hsl.rgb=function(e){var t,n,r,i,a,o=e[0]/360,s=e[1]/100,c=e[2]/100;if(0===s)return[a=255*c,a,a];t=2*c-(n=c<.5?c*(1+s):c+s-c*s),i=[0,0,0];for(var l=0;l<3;l++)(r=o+1/3*-(l-1))<0&&r++,r>1&&r--,a=6*r<1?t+6*(n-t)*r:2*r<1?n:3*r<2?t+(n-t)*(2/3-r)*6:t,i[l]=255*a;return i},o.hsl.hsv=function(e){var t=e[0],n=e[1]/100,r=e[2]/100,i=n,a=Math.max(r,.01);return n*=(r*=2)<=1?r:2-r,i*=a<=1?a:2-a,[t,100*(0===r?2*i/(a+i):2*n/(r+n)),100*((r+n)/2)]},o.hsv.rgb=function(e){var t=e[0]/60,n=e[1]/100,r=e[2]/100,i=Math.floor(t)%6,a=t-Math.floor(t),o=255*r*(1-n),s=255*r*(1-n*a),c=255*r*(1-n*(1-a));switch(r*=255,i){case 0:return[r,c,o];case 1:return[s,r,o];case 2:return[o,r,c];case 3:return[o,s,r];case 4:return[c,o,r];case 5:return[r,o,s]}},o.hsv.hsl=function(e){var t,n,r,i=e[0],a=e[1]/100,o=e[2]/100,s=Math.max(o,.01);return r=(2-a)*o,n=a*s,[i,100*(n=(n/=(t=(2-a)*s)<=1?t:2-t)||0),100*(r/=2)]},o.hwb.rgb=function(e){var t,n,r,i,a,o,s,c=e[0]/360,l=e[1]/100,u=e[2]/100,h=l+u;switch(h>1&&(l/=h,u/=h),r=6*c-(t=Math.floor(6*c)),0!=(1&t)&&(r=1-r),i=l+r*((n=1-u)-l),t){default:case 6:case 0:a=n,o=i,s=l;break;case 1:a=i,o=n,s=l;break;case 2:a=l,o=n,s=i;break;case 3:a=l,o=i,s=n;break;case 4:a=i,o=l,s=n;break;case 5:a=n,o=l,s=i}return[255*a,255*o,255*s]},o.cmyk.rgb=function(e){var t=e[0]/100,n=e[1]/100,r=e[2]/100,i=e[3]/100;return[255*(1-Math.min(1,t*(1-i)+i)),255*(1-Math.min(1,n*(1-i)+i)),255*(1-Math.min(1,r*(1-i)+i))]},o.xyz.rgb=function(e){var t,n,r,i=e[0]/100,a=e[1]/100,o=e[2]/100;return n=-.9689*i+1.8758*a+.0415*o,r=.0557*i+-.204*a+1.057*o,t=(t=3.2406*i+-1.5372*a+-.4986*o)>.0031308?1.055*Math.pow(t,1/2.4)-.055:12.92*t,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:12.92*n,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:12.92*r,[255*(t=Math.min(Math.max(0,t),1)),255*(n=Math.min(Math.max(0,n),1)),255*(r=Math.min(Math.max(0,r),1))]},o.xyz.lab=function(e){var t=e[0],n=e[1],r=e[2];return n/=100,r/=108.883,t=(t/=95.047)>.008856?Math.pow(t,1/3):7.787*t+16/116,[116*(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116)-16,500*(t-n),200*(n-(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116))]},o.lab.xyz=function(e){var t,n,r,i=e[0];t=e[1]/500+(n=(i+16)/116),r=n-e[2]/200;var a=Math.pow(n,3),o=Math.pow(t,3),s=Math.pow(r,3);return n=a>.008856?a:(n-16/116)/7.787,t=o>.008856?o:(t-16/116)/7.787,r=s>.008856?s:(r-16/116)/7.787,[t*=95.047,n*=100,r*=108.883]},o.lab.lch=function(e){var t,n=e[0],r=e[1],i=e[2];return(t=360*Math.atan2(i,r)/2/Math.PI)<0&&(t+=360),[n,Math.sqrt(r*r+i*i),t]},o.lch.lab=function(e){var t,n=e[0],r=e[1];return t=e[2]/360*2*Math.PI,[n,r*Math.cos(t),r*Math.sin(t)]},o.rgb.ansi16=function(e){var t=e[0],n=e[1],r=e[2],i=1 in arguments?arguments[1]:o.rgb.hsv(e)[2];if(0===(i=Math.round(i/50)))return 30;var a=30+(Math.round(r/255)<<2|Math.round(n/255)<<1|Math.round(t/255));return 2===i&&(a+=60),a},o.hsv.ansi16=function(e){return o.rgb.ansi16(o.hsv.rgb(e),e[2])},o.rgb.ansi256=function(e){var t=e[0],n=e[1],r=e[2];return t===n&&n===r?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(n/255*5)+Math.round(r/255*5)},o.ansi16.rgb=function(e){var t=e%10;if(0===t||7===t)return e>50&&(t+=3.5),[t=t/10.5*255,t,t];var n=.5*(1+~~(e>50));return[(1&t)*n*255,(t>>1&1)*n*255,(t>>2&1)*n*255]},o.ansi256.rgb=function(e){if(e>=232){var t=10*(e-232)+8;return[t,t,t]}var n;return e-=16,[Math.floor(e/36)/5*255,Math.floor((n=e%36)/6)/5*255,n%6/5*255]},o.rgb.hex=function(e){var t=(((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2]))).toString(16).toUpperCase();return"000000".substring(t.length)+t},o.hex.rgb=function(e){var t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];var n=t[0];3===t[0].length&&(n=n.split("").map(function(e){return e+e}).join(""));var r=parseInt(n,16);return[r>>16&255,r>>8&255,255&r]},o.rgb.hcg=function(e){var t,n=e[0]/255,r=e[1]/255,i=e[2]/255,a=Math.max(Math.max(n,r),i),o=Math.min(Math.min(n,r),i),s=a-o;return t=s<=0?0:a===n?(r-i)/s%6:a===r?2+(i-n)/s:4+(n-r)/s+4,t/=6,[360*(t%=1),100*s,100*(s<1?o/(1-s):0)]},o.hsl.hcg=function(e){var t=e[1]/100,n=e[2]/100,r=1,i=0;return(r=n<.5?2*t*n:2*t*(1-n))<1&&(i=(n-.5*r)/(1-r)),[e[0],100*r,100*i]},o.hsv.hcg=function(e){var t=e[1]/100,n=e[2]/100,r=t*n,i=0;return r<1&&(i=(n-r)/(1-r)),[e[0],100*r,100*i]},o.hcg.rgb=function(e){var t=e[0]/360,n=e[1]/100,r=e[2]/100;if(0===n)return[255*r,255*r,255*r];var i,a=[0,0,0],o=t%1*6,s=o%1,c=1-s;switch(Math.floor(o)){case 0:a[0]=1,a[1]=s,a[2]=0;break;case 1:a[0]=c,a[1]=1,a[2]=0;break;case 2:a[0]=0,a[1]=1,a[2]=s;break;case 3:a[0]=0,a[1]=c,a[2]=1;break;case 4:a[0]=s,a[1]=0,a[2]=1;break;default:a[0]=1,a[1]=0,a[2]=c}return i=(1-n)*r,[255*(n*a[0]+i),255*(n*a[1]+i),255*(n*a[2]+i)]},o.hcg.hsv=function(e){var t=e[1]/100,n=t+e[2]/100*(1-t),r=0;return n>0&&(r=t/n),[e[0],100*r,100*n]},o.hcg.hsl=function(e){var t=e[1]/100,n=e[2]/100*(1-t)+.5*t,r=0;return n>0&&n<.5?r=t/(2*n):n>=.5&&n<1&&(r=t/(2*(1-n))),[e[0],100*r,100*n]},o.hcg.hwb=function(e){var t=e[1]/100,n=t+e[2]/100*(1-t);return[e[0],100*(n-t),100*(1-n)]},o.hwb.hcg=function(e){var t=e[1]/100,n=1-e[2]/100,r=n-t,i=0;return r<1&&(i=(n-r)/(1-r)),[e[0],100*r,100*i]},o.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},o.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},o.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},o.gray.hsl=o.gray.hsv=function(e){return[0,0,e[0]]},o.gray.hwb=function(e){return[0,100,e[0]]},o.gray.cmyk=function(e){return[0,0,0,e[0]]},o.gray.lab=function(e){return[e[0],0,0]},o.gray.hex=function(e){var t=255&Math.round(e[0]/100*255),n=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(n.length)+n},o.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(15),a=n(3),o=n(13),s=n(5),c=n(20),l=n(24);class u extends r.Component{constructor(e){super(e),this.sizeObserver=new s.SizeObserver,this.pointerObserver=new o.PointerObserver,this.wasActivated=!1,this.hitAreaRef=r.createRef(),this.fillRef=r.createRef(),this.ringRef=r.createRef(),this.onResize=this.onResize.bind(this),this.onPointerChange=this.onPointerChange.bind(this)}render(){const e=a("components_control__presspad",{"components_control__presspad--active":this.props.active},{"components_control__presspad--was-activated":this.wasActivated});return r.createElement("div",{className:e,ref:this.hitAreaRef},r.createElement("div",{className:"components_control__presspad_button"},r.createElement("svg",null,r.createElement("circle",{r:"14.5",cx:21.5,cy:21.5,ref:this.ringRef,className:"components_control__presspad_ring"}),r.createElement("circle",{r:"3.0",cx:21.5,cy:21.5,ref:this.fillRef,className:"components_control__presspad_fill"})),this.props.tooltipKey&&r.createElement(l.ButtonTooltip,{tooltipKey:this.props.tooltipKey})))}componentDidMount(){this.pointerObserver.startObserving(this.hitAreaRef.current,this.onPointerChange,{clampX:!0,clampY:!0}),this.sizeObserver.startObserving(this.hitAreaRef,this.onResize)}componentWillUnmount(){this.sizeObserver.stopObserving(),this.pointerObserver.stopObserving()}componentDidUpdate(e){e.active!==this.props.active&&(this.wasActivated=!0,this.animateToggle())}onResize(){this.forceUpdate()}onPointerChange(e){e&&this.props.callback&&this.props.callback(e)}animateToggle(){if(void 0===this.fillRef.current)return!1;if(void 0===this.ringRef.current)return!1;const e=this.fillRef.current,t=this.ringRef.current;i.remove(e),i.remove(t);let n=this.context.global.foreground.hex(),r=this.context.global.foreground.hex(),a=3,o=14,s=500;this.props.active&&(n=this.context.theme.color.hex(),r=this.context.global.shade.hex(),a=17.5,o=18,s=250),i({targets:e,r:a,fill:n,easing:"easeInOutQuart",duration:s}),i({targets:t,r:o,stroke:r,easing:"easeInOutQuart",duration:s})}}u.contextType=c.ThemeContext,t.PressPad=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(32),a=n(4),o=n(74),s=n(26);t.NotFoundPage=class extends r.Component{render(){return r.createElement("div",{className:"components_pages_not-found__wrapper"},r.createElement(i.Helmet,{title:`404 | ${a.translated("common:names.learning-synths")}`}),r.createElement("div",{className:"main"},r.createElement("div",{className:"content"},r.createElement("div",{className:"page"},r.createElement("section",null,r.createElement("div",null,r.createElement("h1",{className:"components_pages_not-found__headline"},s.renderMarkdown(a.translated("common:not-found.title")))),r.createElement("div",null,r.createElement("h3",{className:"components_pages_not-found__recommendation"},s.renderMarkdown(a.translated("common:not-found.recommendation1")))),r.createElement("div",{className:"right"},r.createElement("p",{className:"components_pages_not-found__recommendation2"},s.renderMarkdown(a.translated("common:not-found.recommendation2")))),o.create("synth-xy",{xParameter:[{name:"filter_frequency"},{name:"oscillator_pitch",min:0,max:12}],yParameter:[{name:"filter_lfo_amount",min:0,max:.4},{name:"lfo_frequency",min:20,max:1}],visualization:"glow",rotation:7.5,classes:"centered",preset:"subbass",tooltipKey:"common:tooltips.drag"},{lessonId:"synthesis"}))))))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(4);t.BrandFooter=class extends r.PureComponent{render(){return r.createElement("div",{className:"components_brand_footer"},r.createElement("div",{className:"components_brand_footer__feedback"},r.createElement("a",{href:"mailto:learning@ableton.com?subject=learningsynths.ableton.com"},r.createElement("span",{className:"components_brand_footer__beta-label"},i.translated("common:names.beta")),i.translated("common:calls-to-action.send-us-your-feedback"))),r.createElement("div",{className:"components_brand_footer__link"},r.createElement("a",{href:"https://www.ableton.com/"},i.translated("common:calls-to-action.go-to-ableton"))))}}},function(e,t,n){"use strict";var r={childContextTypes:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},i={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},a=Object.defineProperty,o=Object.getOwnPropertyNames,s=Object.getOwnPropertySymbols,c=Object.getOwnPropertyDescriptor,l=Object.getPrototypeOf,u=l&&l(Object);e.exports=function e(t,n,h){if("string"!=typeof n){if(u){var p=l(n);p&&p!==u&&e(t,p,h)}var d=o(n);s&&(d=d.concat(s(n)));for(var f=0;f<d.length;++f){var m=d[f];if(!(r[m]||i[m]||h&&h[m])){var g=c(n,m);try{a(t,m,g)}catch(e){}}}return t}return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(30),a=n(101),o=n(110);t.init=function(e){return a.init(e)},t.createApp=function(e){i.render(r.createElement(o.App,null),e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(4),i=n(8),a=n(10),o=n(42),s=n(12),c=n(25),l=n(43),u=n(63),h=n(44),p=n(31);t.init=function(e){return s.setStaticURL(e.staticURL),c.init().then(()=>i.init()).then(()=>Promise.all([r.init({locale:r.Language.en}),a.init(),o.init(),u.init(),h.init(),l.init()]))},p.isRunningInBrowser&&window.history&&"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")},function(e,t,n){var r=n(103).default;e.exports=r,e.exports.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(104)),o=n(105),s=(r=o)&&r.__esModule?r:{default:r};function c(){return{loadPath:"/locales/{{lng}}/{{ns}}.json",addPath:"/locales/add/{{lng}}/{{ns}}",allowMultiLoading:!1,parse:JSON.parse,crossDomain:!1,ajax:s.default}}var l=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init(t,n),this.type="backend"}return i(e,[{key:"init",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.services=e,this.options=a.defaults(t,this.options||{},c())}},{key:"readMulti",value:function(e,t,n){var r=this.options.loadPath;"function"==typeof this.options.loadPath&&(r=this.options.loadPath(e,t));var i=this.services.interpolator.interpolate(r,{lng:e.join("+"),ns:t.join("+")});this.loadUrl(i,n)}},{key:"read",value:function(e,t,n){var r=this.options.loadPath;"function"==typeof this.options.loadPath&&(r=this.options.loadPath([e],[t]));var i=this.services.interpolator.interpolate(r,{lng:e,ns:t});this.loadUrl(i,n)}},{key:"loadUrl",value:function(e,t){var n=this;this.options.ajax(e,this.options,function(r,i){if(i.status>=500&&i.status<600)return t("failed loading "+e,!0);if(i.status>=400&&i.status<500)return t("failed loading "+e,!1);var a=void 0,o=void 0;try{a=n.options.parse(r,e)}catch(t){o="failed parsing "+e+" to json"}if(o)return t(o,!1);t(null,a)})}},{key:"create",value:function(e,t,n,r){var i=this;"string"==typeof e&&(e=[e]);var a={};a[n]=r||"",e.forEach(function(e){var n=i.services.interpolator.interpolate(i.options.addPath,{lng:e,ns:t});i.options.ajax(n,i.options,function(e,t){},a)})}}]),e}();l.type="backend",t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaults=function(e){return i.call(a.call(arguments,1),function(t){if(t)for(var n in t)void 0===e[n]&&(e[n]=t[n])}),e},t.extend=function(e){return i.call(a.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e};var r=[],i=r.forEach,a=r.slice},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function i(e,t){if(t&&"object"===(void 0===t?"undefined":r(t))){var n="",i=encodeURIComponent;for(var a in t)n+="&"+i(a)+"="+i(t[a]);if(!n)return e;e=e+(-1!==e.indexOf("?")?"&":"?")+n.slice(1)}return e}t.default=function(e,t,n,a,o){a&&"object"===(void 0===a?"undefined":r(a))&&(o||(a._t=new Date),a=i("",a).slice(1)),t.queryStringParams&&(e=i(e,t.queryStringParams));try{var s;(s=XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP.3.0")).open(a?"POST":"GET",e,1),t.crossDomain||s.setRequestHeader("X-Requested-With","XMLHttpRequest"),s.withCredentials=!!t.withCredentials,a&&s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),s.overrideMimeType&&s.overrideMimeType("application/json");var c=t.customHeaders;if(c)for(var l in c)s.setRequestHeader(l,c[l]);s.onreadystatechange=function(){s.readyState>3&&n&&n(s.responseText,s)},s.send(a)}catch(e){console&&console.log(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(107),i=n(108),a=n(8);t.createNode=function(e){const t=i.RNBOWorkletObject,n=i.RNBOScriptObject,o=a.isUsingAudioWorklet()?new t(a.audioContext):new n(a.audioContext);return new Promise((t,n)=>{fetch(e).then(e=>e.text()).then(e=>o.setPatcher(console.log(e))).then(()=>{o.setBufferSize&&o.setBufferSize(a.recommendedBufferSize()),a.connectToPreFxOutput(o.node),t(new r.RNBONode(o,i))})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RNBONode=class{constructor(e,t){this.rnboParamNameToIndexMap={},this.node=e,this.rnboInterface=t;for(let e=0;e<this.node.getNumParameters();e++)this.rnboParamNameToIndexMap[this.node.getParameterName(e)]=e;this.unmute()}playNote(e,t){this.scheduleMidiEvent(0,[144,e,100],t)}stopNote(e,t){this.scheduleMidiEvent(0,[144,e,0],t)}getParameterIndexByName(e){return this.rnboParamNameToIndexMap[e]}getParameterInfoByName(e){return this.node.getParameterInfo(this.getParameterIndexByName(e))}setParameterValueToDefaultByName(e){const t=this.node.getParameterInfoByName(e).initialValue;this.setParameterValueByName(e,t)}setParameterValueByName(e,t){void 0!==t?this.node.setParameterValue(this.getParameterIndexByName(e),t):this.setParameterValueToDefaultByName(e)}setParameterValueByNameNormalized(e,t){void 0!==t?this.node.setParameterValueNormalized(this.getParameterIndexByName(e),t):this.setParameterValueToDefaultByName(e)}addEventListener(e,t){this.node.addEventListener(e,t)}removeEventListener(e,t){this.node.removeEventListener(e,t)}scheduleMidiEvent(e,t,n){if(void 0===this.rnboInterface)return;const r=this.rnboInterface.MIDIEvent;this.node.scheduleEvent(new r(n||0,e,t,t.length,null))}unmute(){this.playNote(60,0),this.stopNote(60,.002)}}},function(module,exports,__webpack_require__){
/*!
 * 
 * Copyright (C) 2019 Cycling '74 - All Rights Reserved
 * 
 */
var root,factory;root=window,factory=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"u",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.u)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.u?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=27)}([function(e,t,n){n.d(t,"a",function(){return r});class r{constructor(e,t,n){this.type=e,this.time=t,this.eventTarget=n}}},function(e,t,n){t.a=Object.freeze({toProcessor:{setPatcher:0,scheduleEvent:1},fromProcessor:{setPatcherFinished:1e3,scheduleEvent:1001,outgoingEvent:1002,notifyParameterValueChanged:1003}})},function(e,t,n){(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
function r(e,t){if(e===t)return 0;for(var n=e.length,r=t.length,i=0,a=Math.min(n,r);i<a;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0}function i(e){return t.Buffer&&"function"==typeof t.Buffer.isBuffer?t.Buffer.isBuffer(e):!(null==e||!e.h)}var a=n(31),o=Object.prototype.hasOwnProperty,s=Array.prototype.slice,c="foo"===function(){}.name;function l(e){return Object.prototype.toString.call(e)}function u(e){return!i(e)&&"function"==typeof t.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):!!e&&(e instanceof DataView||!!(e.buffer&&e.buffer instanceof ArrayBuffer)))}var h=e.exports=v,p=/\s*function\s+([^\(\s]*)\s*/;function d(e){if(a.isFunction(e)){if(c)return e.name;var t=e.toString().match(p);return t&&t[1]}}function f(e,t){return"string"==typeof e?e.length<t?e:e.slice(0,t):e}function m(e){if(c||!a.isFunction(e))return a.inspect(e);var t=d(e);return"[Function"+(t?": "+t:"")+"]"}function g(e,t,n,r,i){throw new h.AssertionError({message:n,actual:e,expected:t,operator:r,stackStartFunction:i})}function v(e,t){e||g(e,!0,t,"==",h.ok)}function y(e,t,n,o){if(e===t)return!0;if(i(e)&&i(t))return 0===r(e,t);if(a.isDate(e)&&a.isDate(t))return e.getTime()===t.getTime();if(a.isRegExp(e)&&a.isRegExp(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if(null!==e&&"object"==typeof e||null!==t&&"object"==typeof t){if(u(e)&&u(t)&&l(e)===l(t)&&!(e instanceof Float32Array||e instanceof Float64Array))return 0===r(new Uint8Array(e.buffer),new Uint8Array(t.buffer));if(i(e)!==i(t))return!1;var c=(o=o||{actual:[],expected:[]}).actual.indexOf(e);return-1!==c&&c===o.expected.indexOf(t)||(o.actual.push(e),o.expected.push(t),function(e,t,n,r){if(null==e||null==t)return!1;if(a.isPrimitive(e)||a.isPrimitive(t))return e===t;if(n&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;var i=b(e),o=b(t);if(i&&!o||!i&&o)return!1;if(i)return y(e=s.call(e),t=s.call(t),n);var c,l,u=x(e),h=x(t);if(u.length!==h.length)return!1;for(u.sort(),h.sort(),l=u.length-1;l>=0;l--)if(u[l]!==h[l])return!1;for(l=u.length-1;l>=0;l--)if(!y(e[c=u[l]],t[c],n,r))return!1;return!0}(e,t,n,o))}return n?e===t:e==t}function b(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function _(e,t){if(!e||!t)return!1;if("[object RegExp]"==Object.prototype.toString.call(t))return t.test(e);try{if(e instanceof t)return!0}catch(e){}return!Error.isPrototypeOf(t)&&!0===t.call({},e)}function w(e,t,n,r){var i;if("function"!=typeof t)throw new TypeError('"block" argument must be a function');"string"==typeof n&&(r=n,n=null),i=function(e){var t;try{e()}catch(e){t=e}return t}(t),r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),e&&!i&&g(i,n,"Missing expected exception"+r);var o="string"==typeof r,s=!e&&i&&!n;if((!e&&a.isError(i)&&o&&_(i,n)||s)&&g(i,n,"Got unwanted exception"+r),e&&i&&n&&!_(i,n)||!e&&i)throw i}h.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=f(m(this.actual),128)+" "+this.operator+" "+f(m(this.expected),128),this.generatedMessage=!0);var t=e.stackStartFunction||g;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var n=new Error;if(n.stack){var r=n.stack,i=d(t),a=r.indexOf("\n"+i);if(a>=0){var o=r.indexOf("\n",a+1);r=r.substring(o+1)}this.stack=r}}},a.inherits(h.AssertionError,Error),h.fail=g,h.ok=v,h.equal=function(e,t,n){e!=t&&g(e,t,n,"==",h.equal)},h.notEqual=function(e,t,n){e==t&&g(e,t,n,"!=",h.notEqual)},h.deepEqual=function(e,t,n){y(e,t,!1)||g(e,t,n,"deepEqual",h.deepEqual)},h.deepStrictEqual=function(e,t,n){y(e,t,!0)||g(e,t,n,"deepStrictEqual",h.deepStrictEqual)},h.notDeepEqual=function(e,t,n){y(e,t,!1)&&g(e,t,n,"notDeepEqual",h.notDeepEqual)},h.notDeepStrictEqual=function e(t,n,r){y(t,n,!0)&&g(t,n,r,"notDeepStrictEqual",e)},h.strictEqual=function(e,t,n){e!==t&&g(e,t,n,"===",h.strictEqual)},h.notStrictEqual=function(e,t,n){e===t&&g(e,t,n,"!==",h.notStrictEqual)},h.throws=function(e,t,n){w(!0,e,t,n)},h.doesNotThrow=function(e,t,n){w(!1,e,t,n)},h.ifError=function(e){if(e)throw e};var x=Object.keys||function(e){var t=[];for(var n in e)o.call(e,n)&&t.push(n);return t}}).call(this,n(18))},function(e,t,n){var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var r in n)i(n,r)&&(e[r]=n[r])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var a={arraySet:function(e,t,n,r,i){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+r),i);else for(var a=0;a<r;a++)e[i+a]=t[n+a]},flattenChunks:function(e){var t,n,r,i,a,o;for(r=0,t=0,n=e.length;t<n;t++)r+=e[t].length;for(o=new Uint8Array(r),i=0,t=0,n=e.length;t<n;t++)a=e[t],o.set(a,i),i+=a.length;return o}},o={arraySet:function(e,t,n,r,i){for(var a=0;a<r;a++)e[i+a]=t[n+a]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,a)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,o))},t.setTyped(r)},function(e,t,n){n.d(t,"a",function(){return i});var r=n(0);class i extends r.a{constructor(e,t,n,r,i){super("MIDIEvent",e,i),this.status=240&n[0],this.channel=15&n[0],this.port=t,this.data=n,this.length=r}}},function(e,t,n){n.d(t,"a",function(){return i});var r=n(0);class i extends r.a{constructor(e,t,n,r){super("MessageEvent",e,r),this.tag=t,this.payload=n}}},function(e,t,n){var r=n(12),i=n(1),a=n(2),o=n.n(a);function s(e,t){let n=e;if(t>0)if(1===t)e>0&&(n=1);else{var r=1/(t-1);n=Math.round(e/r)*r}return n}class c{constructor(e,t){this.v=-1,this.g=e,this._=t}get interfaceId(){return this.v}set interfaceId(e){this.v=e}getNumParameters(){return this.g.getNumParameters()}getParameterValue(e){return o()(!1),0}getParameterName(e){return this.g.getParameterName(e)}getParameterId(e){return this.g.getParameterId(e)}getParameterInfo(e,t){this.g.getParameterInfo(e,t)}setParameterValue(e,t){this.setParameter(new r.a(0,e,t,this.interfaceId,void 0))}setParameter(e){this.updateShadowValue(e.target,e.value),this.g.scheduleEvent(e)}setParameterWithDataBuffer(e,t){}convertToNormalizedParameterValue(e,t){let n={min:0,max:0,exponent:1};this.g.getParameterInfo(e,n);let r=t;r<n.min&&(r=n.min),r>n.max&&(r=n.max);let i=(r-n.min)/(n.max-n.min);return 1!==n.exponent&&(i=Math.exp(1*Math.log(i)/n.exponent)),s(i,n.steps)}convertFromNormalizedParameterValue(e,t){let n={min:0,max:0,exponent:1};this.g.getParameterInfo(e,n);let r=t;return t<0&&(r=0),t>1&&(r=1),r=s(r,n.steps),1===n.exponent?n.min+r*(n.max-n.min):n.min+Math.exp(Math.log(r)*n.exponent)*(n.max-n.min)}getParameterValueNormalized(e){return this.convertToNormalizedParameterValue(e,this.getParameterValue(e))}setParameterValueNormalized(e,t){this.setParameterValue(e,this.convertFromNormalizedParameterValue(e,t))}pushOutgoingEvent(e){this._.outgoingEvent(e)}notifyParameterValueChanged(e,t,n,r){void 0!==r&&-1!==r&&r===this.interfaceId&&this.getParameterValue(t)===n||(this.updateShadowValue(t,n),this._.notifyParameterValueChanged(e,t,n,r))}updateShadowValue(e,t){}setEngine(e){this.g=e}}class l extends c{constructor(e,t){super(e,t)}getParameterValue(e){return this.g.getParameterValue(e)}}class u extends c{constructor(e,t,n){super(e,t),this.I=[];for(var r=0;r<this.g.getNumParameters();r++)this.I[r]=0;n.addListener(i.a.fromProcessor.setPatcherFinished,this.refreshShadowValues.bind(this))}getParameterValue(e){return e<this.g.getNumParameters()?this.I[e]:0}refreshShadowValues(e){this.I=e}updateShadowValue(e,t){this.I[e]=t}}n.d(t,"a",function(){return p});let h=n(7);class p{constructor(e){if(this.M=1,this.P=0,this.O=44100,this.T=64,this.S=0,this.A=0,e){this.D=e.D,this.M=e.M;for(var t=0;t<this.D.length;t++)this.D[t].setEngine(this)}else this.D=[];this.B=this.sampsToMs(this.T)}createParameterInterface(e){let t=this.isSync()?new l(this,e):new u(this,e,this.getEmitter());return t.interfaceId=this.M++,this.D.push(t),t}isSync(){return o()(!1),!1}scheduleEvent(e){o()(!1)}getNumInputChannels(){return this.C.getNumInputChannels()}getNumOutputChannels(){return this.C.getNumOutputChannels()}getNumParameters(){return this.C.getNumParameters()}getParameterValue(e){return o()(!1),0}getParameterName(e){return this.C.getParameterName(e)}getParameterId(e){return this.C.getParameterId(e)}getParameterInfo(e,t){return this.C.getParameterInfo(e,t)}sampsToMs(e){return e/this.O*1e3}getSampleRate(){return this.O}getSamplesPerBlock(){return this.T}get needsObjInit(){return!0}prepareToProcess(e,t,n){(n||e!==this.O||t!==this.T)&&(this.O=e,this.T=t,this.B=this.sampsToMs(this.T),this.isSync()&&this.needsObjInit&&this.C.prepareToProcess(this.O,this.T))}getEmitter(){o()(!1)}getPatcherSerial(){return this.C.getPatcherSerial()}getNumSignalInParameters(){return this.S}getNumSignalOutParameters(){return this.A}updateSignalIOParameters(){this.S=0,this.A=0;for(var e=this.C.getNumParameters(),t=0;t<e;t++){let e={min:0,max:0,exponent:1};this.C.getParameterInfo(t,e),e.type===h.ParameterTypeSignal&&(e.IOType===h.IOTypeInput?this.S++:1===e.IOType&&this.A++)}}}},function(module,exports,__webpack_require__){var Float32Buffer=__webpack_require__(11).Float32Buffer,Float64Buffer=__webpack_require__(11).Float64Buffer,IntBuffer=__webpack_require__(11).IntBuffer,UInt8Buffer=__webpack_require__(11).UInt8Buffer,ExternalLoaderFactory=__webpack_require__(35).ExternalLoaderFactory,patcherSerialKey="XX__PatcherSerialKey__XX",eventTargetKey="XX__EventTargetKey__XX",ParameterTypeNumber=0,ParameterTypeBang=1,ParameterTypeList=2,ParameterTypeSignal=3,ParameterTypeCount=4,IOTypeInput=0,IOTypeOutput=1,IOTypeUndefined=2;function rand01(){return Math.random()}function pi01(){return Math.PI}var abs=Math.abs,acos=Math.acos,acosh=Math.acosh,asin=Math.asin,asinh=Math.asinh,atan=Math.atan,atan2=Math.atan2,atanh=Math.atanh,cbrt=Math.cbrt,ceil=Math.ceil,clz32=Math.clz32,cos=Math.cos,cosh=Math.cosh,exp=Math.exp,expm1=Math.expm1,floor=Math.floor,fround=Math.fround,hypot=Math.hypot,imul=Math.imul,log=Math.log,log10=Math.log10,log1p=Math.log1p,log2=Math.log2,max=Math.max,min=Math.min,pow=Math.pow,random=Math.random,round=Math.round,sign=Math.sign,sin=Math.sin,sinh=Math.sinh,sqrt=Math.sqrt,tan=Math.tan,tanh=Math.tanh,trunc=Math.trunc,fabs=Math.abs,fmax=Math.max,fmod=Math.mod,isnan=function(e){return isNaN(e)};function fixnan(e){return isnan(e)?0:e}function fract(e){return e%1}function fixdenorm(e){return e}function isdenorm(e){return!1}var fastsin=Math.sin,fastcos=Math.cos,fastexp=Math.exp,fastpow=Math.pow,fasttan=Math.tan;function next_power_of_two(e){return 0===e?1:(e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,1+(e|=e>>16))}function getArrayValueAtIndex(e,t){return e[t]}function allocateArray(e,t){return new Array(e)}function createListCopy(e){return e.slice(0)}function assignList(e,t){e.length=t.length;for(let n=0;n<t.length;n++)e[n]=t[n]}function convertListToNumber(e){return e.length>0?e[0]:0}function list(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);return e}function resizeSignal(e,t){for(var n=[],r=0;r<t;r++)n[r]=0;return n}function containsValue(e){return void 0!==e}function addressOf(e){return e}function systemticks(){return Date.now()}function bitwiseFloat(e){var t=new Uint32Array(1);return t[0]=e,new DataView(t.buffer).getFloat32(0,!0)}function imul(e,t){return Math.imul(e,t)}var MIDI_StatusByteReceived=1,MIDI_SecondByteReceived=2,MIDI_NoteOff=3,MIDI_NoteOn=4,MIDI_Aftertouch=5,MIDI_CC=6,MIDI_ProgramChange=7,MIDI_ChannelPressure=8,MIDI_PitchBend=9,MIDI_Sysex_Started=10,MIDI_Sysex_Complete=11,MIDI_Generic=99,MIDI_InvalidByte=-1,MIDI_NoteOffMask=128,MIDI_NoteOnMask=144,MIDI_AfterTouchMask=160,MIDI_CCMask=176,MIDI_ProgramChangeMask=192,MIDI_ChannelPressureMask=208,MIDI_PitchBendMask=224,MIDI_CC_Sustain=64,MIDI_CC_Sostenuto=66,MIDI_CC_AllNotesOff=123,MIDI_CC_PressureMSB=70,MIDI_CC_PressureLSB=102,MIDI_CC_TimbreMSB=74,MIDI_CC_TimbreLSB=106,MIDI_NoteState_Off=0,MIDI_NoteState_On=1,MIDI_NoteState_Sustained=2,CLOCKS_PER_SEC=1;function parseMidi(e,t,n){if(240==t)return MIDI_Sysex_Started;if(e==MIDI_Sysex_Started)return 247==t?MIDI_Sysex_Complete:t<=127?e:MIDI_InvalidByte;if(t>127)return MIDI_StatusByteReceived;var r=240&n;return e==MIDI_StatusByteReceived?r==MIDI_ProgramChangeMask?MIDI_ProgramChange:r==MIDI_ChannelPressureMask?MIDI_ChannelPressure:MIDI_SecondByteReceived:e==MIDI_SecondByteReceived?r==MIDI_NoteOffMask||r==MIDI_NoteOnMask&&0==t?MIDI_NoteOff:r==MIDI_NoteOnMask?MIDI_NoteOn:r==MIDI_AfterTouchMask?MIDI_Aftertouch:r==MIDI_CCMask?MIDI_CC:r==MIDI_PitchBendMask?MIDI_PitchBend:MIDI_Generic:e}function getMIDIChannel(e){var t=240&e;return t>=128&&t<=224?15&e:0}function initDataRef(e){var t={};return t.name=e,t.isValid=!1,t.arrayBuffer=void 0,t.wantsFillFlag=!1,t.sizeInBytes=0,t.wantsFill=function(){return this.wantsFillFlag},t.getSizeInBytes=function(){return this.sizeInBytes},t}function TAG(e){let t=0;for(let n=0;n<e.length;n++)t=e.charCodeAt(n)+(t<<6)+(t<<16)-t;return 0|t}function _evalSrc(src){var rnboObj;return eval(src),rnboObj}module.exports={deserializeJSON:function(e){var t=e;return"string"==typeof t&&(t=JSON.parse(e)),_evalSrc(t.src)},extractOptionsFromJSON:function(e){var t=e;return"string"==typeof t&&(t=JSON.parse(e)),t.options?t.options:{}},ParameterTypeNumber:ParameterTypeNumber,ParameterTypeBang:ParameterTypeBang,ParameterTypeList:ParameterTypeList,ParameterTypeSignal:ParameterTypeSignal,ParameterTypeCount:ParameterTypeCount,IOTypeInput:IOTypeInput,IOTypeOutput:IOTypeOutput,IOTypeUndefined:IOTypeUndefined.length,TAG:TAG}},function(e,t,n){n.d(t,"a",function(){return r});class r{getSubState(e){return void 0===this[e]&&(this[e]=new r),this[e]}getSubStateAt(e,t){return void 0===this[e]&&(this[e]=new r),void 0===this[e][t]&&(this[e][t]=new r),this[e][t]}}},function(e,t,n){let r=n(7);t.a={ensureBuffers:function(e,t,n,r){let i=!1;for(let a=0;a<n;a++)r>e.k&&t[a]&&(e._rnbo_module._free(t[a]),t[a]=void 0),t[a]||(i=!0,t[a]=e._rnbo_module._malloc(r*Float64Array.BYTES_PER_ELEMENT));if(i){let n=t===e.N,r=n?e.R:this.j;r&&e._rnbo_module._free(r),r=e._rnbo_module._malloc(t.length*Float32Array.BYTES_PER_ELEMENT),e._rnbo_module.HEAP32.set(t,r>>2),n?e.R=r:e.j=r}},ensureArrayPassingHEAP(e,t){(null==e.V||e.V<t)&&(e.V=t,null!=e.F&&e._rnbo_module._free(e.F),e.F=e._rnbo_module._malloc(e.V*Float64Array.BYTES_PER_ELEMENT))},pushArray(e,t){return this.ensureArrayPassingHEAP(e,t.length),e._rnbo_module.HEAPF64.set(t,e.F>>3),e.F},retrieveArray(e){let t=[];for(var n=0;n<e.size();n++)t.push(e.get(n));return t},setup:function(e,t){let n=new t.CoreObject;e.N=[],e.L=[],e.U={},e.X=n,e._rnbo_module=t;var i={handleParameterEvent:e.handleParameterEvent.bind(e),handleMidiEvent:e.handleMidiEvent.bind(e),handleMessageEvent:e.handleMessageEvent.bind(e)},a=t.EventHandler.implement(i);e.q=n.createParameterInterface(a),e.W=0;for(let t=0;t<n.getNumParameters();t++){let i=n.getParameterInfo(t);if(i.type===r.ParameterTypeSignal&&i.IOType===r.IOTypeInput){let r=n.getParameterName(t);e.U[r]=i.signalIndex,e.W++}}e.K=n.getNumInputChannels()+e.W,e.Z=n.getNumOutputChannels(),e.N=new Array(e.K),e.L=new Array(e.Z),e.R=0,e.j=0,this.ensureBuffers(e,e.N,e.K,128),this.ensureBuffers(e,e.L,e.Z,128),this.ensureArrayPassingHEAP(e,128),e.k=128}}},function(e,t,n){var r=n(6),i=n(4),a=n(0);class o extends a.a{constructor(e,t,n,r){super("ClockEvent",e,r),this.clockIndex=t,this.value=n}hasValue(){return void 0!==this.value}}var s,c=n(5);!function(e){e[e.Update=1]="Update"}(s||(s={}));class l extends a.a{constructor(e,t,n,r){super("DataRefEvent",e,r),this.dataRefIndex=t,this.action=n}}var u=n(8);let h=n(7);function p(e,t){return e.time-t.time}function d(e){e.sort(p)}class f extends r.a{constructor(e,t){super(t),this.J=!1,this.G=null,this.H=-1,this.Y=[],this.J=!1,this.setPatcher(e)}isSync(){return!0}setPatcher(e){var t=new u.a;this.C&&this.C.getState(t),this.C=h.deserializeJSON(e);for(let e=0;e<this.Y.length;e++)this.Y[e].eventTarget&&(this.Y[e].invalid=!0);this.C.setEngineAndPatcher(this,null),this.C.initialize(t),this.C.prepareToProcess(this.O,this.T,!0),this.updateSignalIOParameters();for(let e=this.Y.length-1;e>=0;e--)this.Y[e].invalid&&this.Y.splice(e,1)}handleEvent(e){var t=e.eventTarget;if(e.time=Math.max(e.time,this.P),t||(t=this.C),this.G=e,"ParameterEvent"===e.type){let n=e;t.setParameterValue(n.target,n.value,e.time)}else if("MIDIEvent"===e.type){let n=e;t.processMidiEvent(n.time,n.port,n.data,n.length)}else if("ClockEvent"===e.type){let n=e;t.processClockEvent(n.time,n.clockIndex,n.hasValue(),n.value)}else if("DataRefEvent"===e.type){let n=e;n.action===s.Update&&t.processDataViewUpdate(n.dataRefIndex,n.time)}else if("MessageEvent"===e.type){let n=e;Array.isArray(n.payload)?t.processListMessage(h.TAG(n.tag),n.time,n.payload):t.processNumMessage(h.TAG(n.tag),n.time,n.payload)}this.G=null}getCurrentTime(){return this.P}setCurrentTime(e){this.P=e}process(e,t,n,r,i,a,o){var s=0,c=Math.min(t,this.getNumInputChannels()+this.S),l=Math.min(r,this.getNumOutputChannels()),u=Math.min(i,this.T);this.H=this.P+this.B,void 0!==this.midiInput&&(this.Y.push.apply(this.Y,a),this.J=!0),this.J&&(d(this.Y),this.J=!1);var h=this.Y.length;for(s=0;s<h&&this.Y[s].time<this.H;s++)this.handleEvent(this.Y[s]);if(this.Y.splice(0,s),null!==n&&l>0){for(s=0;s<n.length;s++)n[s].fill(0);this.C.process(e,c,n,l,u)}this.P=this.H,this.H=-1}scheduleEvent(e){this.Y.push(e),this.isInProcess()?d(this.Y):this.J=!0}sendMessage(e,t,n){this.scheduleEvent(new c.a(n,e,t))}scheduleMidiEvent(e,t){this.scheduleEvent(new i.a(this.P,e,t,t.length,this.C))}notifyParameterValueChanged(e,t){let n=this.G?this.G.source:void 0;if(e<this.getNumParameters())for(var r=this.D.length,i=0;i<r;i++)this.D[i].notifyParameterValueChanged(this.getCurrentTime(),e,t,n)}sendNumMessage(e,t){for(var n=this.D.length,r=0;r<n;r++)this.D[r].pushOutgoingEvent(new c.a(this.P,this.C.resolveTag(e),t))}sendListMessage(e,t){for(var n=this.D.length,r=0;r<n;r++)this.D[r].pushOutgoingEvent(new c.a(this.P,this.C.resolveTag(e),t))}getParameterValue(e){return this.C.getParameterValue(e)}flushClockEvents(e,t,n){for(var r=0;r<this.Y.length;r++)if(this.Y[r]instanceof o){let i=this.Y[r];i.eventTarget!==e||i.clockIndex!==t&&void 0!==i.clockIndex||(this.Y.splice(r,1),n&&this.handleEvent(i),r--)}}deleteClockEvents(e){this.flushClockEvents(e,void 0,!1)}scheduleClockEvent(e,t,n){this.scheduleClockEventWithValue(e,t,n,void 0)}scheduleClockEventWithValue(e,t,n,r){this.scheduleEvent(new o(n,t,r,e))}sendMidiEvent(e,t,n,r,a){for(var o=0;o<this.D.length;o++)this.D[o].pushOutgoingEvent(new i.a(this.getCurrentTime(),e,[t,n,r],void 0===a?3:a,void 0))}sendMidiEventList(e,t){var n;for(n=2;n<t.length;n+=3)this.sendMidiEvent(e,t[n-2],t[n-1],t[n],void 0);if((n-=3)<t.length){var r=n-t.length;this.sendMidiEvent(e,t[n],r>1?t[n+1]:void 0,r>2?t[n+2]:void 0,r)}}sendOutlet(e,t,n){console.log("sendOutlet",e,t,n)}updatePatcherEventTarget(e,t){for(var n=0;n<this.Y.length;n++)this.Y[n].eventTarget===e&&(this.Y[n].eventTarget=t,this.Y[n].invalid=!1)}rescheduleEventTarget(e){for(var t=0;t<this.Y.length;t++)this.Y[t].eventTarget===e&&(this.Y[t].invalid=!1)}isInProcess(){return this.H>-1}sendDataRefUpdated(e){this.scheduleEvent(new l(this.P,e,s.Update,this.C))}}var m=n(1),g=n(24),v=n(2),y=n.n(v);let b=n(7);class _ extends r.a{constructor(e,t){super(t),this.$=new g.EventEmitter,this.$.addListener(m.a.fromProcessor.outgoingEvent,this.receiveOutgoingEvent.bind(this)),this.$.addListener(m.a.fromProcessor.notifyParameterValueChanged,this.notifyParameterValueChanged.bind(this)),this.setPatcher(e)}isSync(){return!1}getEmitter(){return this.$}setPatcher(e){this.C=b.deserializeJSON(e),this.C.setEngineAndPatcher(this,null);var t=new u.a;this.C.setState(t),this.updateSignalIOParameters()}scheduleEvent(e){this.$.emit("postMessage",m.a.toProcessor.scheduleEvent,e)}sendMessage(e,t,n){this.scheduleEvent(new c.a(n,e,t))}receiveOutgoingEvent(e){for(let t=0;t<this.D.length;t++)"ParameterEvent"===e.type?this.D[t].notifyParameterValueChanged(e.time,e.target,e.value,e.source):this.D[t].pushOutgoingEvent(e)}notifyParameterValueChanged(e,t,n,r){for(let i=0;i<this.D.length;i++)this.D[i].notifyParameterValueChanged(e,t,n,r)}process(e,t,n,r,i,a,o){y()(!1)}}var w=n(15),x=n(16),E=n.n(x),M=n(12);n.d(t,"a",function(){return P});class S{fromRNBOtime(e){return e}toRNBOtime(e){return e}}class T{constructor(){this.tt={},this.et=new S}addEventListener(e,t){e in this.tt||(this.tt[e]=[]),this.tt[e].push(t)}removeEventListener(e,t){if(!(e in this.tt))return;let n=this.tt[e];for(let e=0,r=n.length;e<r;e++)if(n[e]===t)return void n.splice(e,1)}dispatchEvent(e){if(!(e.type in this.tt))return!0;let t=this.tt[e.type];for(let n=0,r=t.length;n<r;n++)t[n].call(this,e);return!e.defaultPrevented}wrapAndDispatchEvent(e){e.time=this.et.fromRNBOtime(e.time),e.source&&delete e.source,this.dispatchEvent(new CustomEvent(e.type,{detail:e}))}outgoingEvent(e){this.wrapAndDispatchEvent(e)}notifyParameterValueChanged(e,t,n,r){this.outgoingEvent(new M.a(e,t,n,r,void 0))}}class P extends T{constructor(e){super(),this.rt=e,this.useAsyncEngine()?this.g=new _(E.a,void 0):this.g=new f(E.a,void 0),this.q=this.g.createParameterInterface(this)}createParameterInterface(){let e=new T;return e.et=this.et,this.g.createParameterInterface(e),e}getParameterInfo(e){var t={min:0,max:0,exponent:1};return this.g.getParameterInfo(e,t),t}setCurrentTime(e){this.g.setCurrentTime(e)}scheduleEvent(e){e.time=this.et.toRNBOtime(e.time),this.g.scheduleEvent(e)}sendMessage(e,t,n){null==n&&(n=0),this.g.sendMessage(e,t,n)}useAsyncEngine(){return this.rt}setPatcher(e,t){if(t&&e.hasOwnProperty("wasm")){var n=new w.a(this.g);return n.setPatcher(e).then(()=>{this.g=n})}return this.g instanceof w.a?this.useAsyncEngine()?this.g=new _(e,this.g):this.g=new f(e,this.g):this.g.setPatcher(e),Promise.resolve()}getNumInputChannels(){return this.g.getNumInputChannels()}getNumOutputChannels(){return this.g.getNumOutputChannels()}getNumParameters(){return this.g.getNumParameters()}getParameterName(e){return this.g.getParameterName(e)}getParameterId(e){return this.g.getParameterId(e)}prepareToProcess(e,t,n){this.g.prepareToProcess(e,t,n)}process(e,t,n,r,i,a,o){this.g.process(e,t,n,r,i,a,o)}getParameterValue(e){return this.q.getParameterValue(e)}getParameterValueNormalized(e){return this.q.getParameterValueNormalized(e)}setParameterValue(e,t){this.q.setParameterValue(e,t)}setParameterValueNormalized(e,t){this.q.setParameterValueNormalized(e,t)}convertToNormalizedParameterValue(e,t){return this.q.convertToNormalizedParameterValue(e,t)}convertFromNormalizedParameterValue(e,t){return this.q.convertFromNormalizedParameterValue(e,t)}}},function(e,t){function n(){return(this.dataRef.sizeInBytes?this.dataRef.sizeInBytes:0)/this.BASEARRAY.BYTES_PER_ELEMENT/this.dataRef.channels}function r(e){var t=this.dataRef.channels,n=e*this.BASEARRAY.BYTES_PER_ELEMENT*t;(!this.dataRef.sizeInBytes||this.dataRef.sizeInBytes<n)&&(this.dataRef.sizeInBytes=n)}function i(e,t){return this[this.getChannels()*t+e]}function a(e,t,n){this[this.getChannels()*t+e]=n}function o(){return this.dataRef.channels}function s(e){if(e!=this.dataRef.channels){var t=this.getSize();this.dataRef.channels=e,this.setSize(t)}}function c(){if(this.dataRef.sizeInBytes>0&&this.dataRef.channels>0){var e;(!this.dataRef.arrayBuffer||this.dataRef.arrayBuffer.byteLength<this.dataRef.sizeInBytes)&&(e=new ArrayBuffer(this.dataRef.sizeInBytes)),e&&(this.dataRef.arrayBuffer=e,this.dataRef.wantsFillFlag=!0,this.dataRef.isValid=!0);var t=new this.BASEARRAY(this.dataRef.arrayBuffer);return p(t,this.dataRef,this.BASEARRAY),this.isAudioBuffer&&d(t),t}}function l(){this.fill(0)}function u(){return this.touched}function h(e){this.touched=e}function p(e,t,i){e.dataRef=t,e.BASEARRAY=i,e.getSize=n,e.setSize=r,e.allocateIfNeeded=c,e.setZero=l,t.setZero=function(){e.setZero()},e.touched=!1,e.getTouched=u,e.setTouched=h}function d(e){e.getSample=i,e.setSample=a,e.getChannels=o,e.setChannels=s,e.isAudioBuffer=!0}var f=function(e,t,n){var r;if(e.isValid)r=new n(e.arrayBuffer);else{t||(t=0),e.channels=1;var i=t*n.BYTES_PER_ELEMENT;(!e.sizeInBytes||e.sizeInBytes<i)&&(e.sizeInBytes=i),r={}}return p(r,e,n),r};(f.prototype=Object.create(null)).constructor=f;var m=function(e,t,n,r){var i=f.call(this,e,t,r);if(!e.isValid){t||(t=0),n||(n=1),(!e.channels||e.channels<n)&&(e.channels=n);var a=t*r.BYTES_PER_ELEMENT*n;(!e.sizeInBytes||e.sizeInBytes<a)&&(e.sizeInBytes=a)}return d(i),i};(m.prototype=Object.create(f)).constructor=m;var g=function(e,t,n){return m.call(this,e,t,n,Float32Array)};(g.prototype=Object.create(m.prototype)).constructor=g;var v=function(e,t,n){return m.call(this,e,t,n,Float64Array)};(v.prototype=Object.create(m.prototype)).constructor=v;var y=function(e,t){return f.call(this,e,t,Int32Array)};(y.prototype=Object.create(f.prototype)).constructor=y;var b=function(e,t){return f.call(this,e,t,Uint8Array)};(b.prototype=Object.create(f.prototype)).constructor=b,e.exports={Float32Buffer:g,Float64Buffer:v,IntBuffer:y,UInt8Buffer:b}},function(e,t,n){n.d(t,"a",function(){return i});var r=n(0);class i extends r.a{constructor(e,t,n,r,i){super("ParameterEvent",e,i),this.target=t,this.value=n,this.source=r}}},function(e,t,n){var r={};(0,n(3).assign)(r,n(36),n(39),n(23)),e.exports=r},function(e,t,n){e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(module,__webpack_exports__,__webpack_require__){(function(Buffer){__webpack_require__.d(__webpack_exports__,"a",function(){return WASMEngine});var _BaseEngine__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6),_MIDIEvent__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(4),_MessageEvent__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(5),_WASMHelper__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(9),_State__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(8),pako__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(13),pako__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(pako__WEBPACK_IMPORTED_MODULE_5__);let JSUtils=__webpack_require__(7);class WASMEngine extends _BaseEngine__WEBPACK_IMPORTED_MODULE_0__.a{constructor(){super(...arguments),this.N=[],this.L=[],this.nt=!1}isSync(){return!0}get needsObjInit(){return!1}setPatcher(patch){if(!patch.hasOwnProperty("wasm")){const e={message:"No WASM code provided."};throw e}this.C=JSUtils.deserializeJSON(patch),this.C.setEngineAndPatcher(this,null);var state=new _State__WEBPACK_IMPORTED_MODULE_4__.a;this.C.setState(state),this.updateSignalIOParameters();let wasm=patch.wasm;"base64"==patch.wasmEncoding&&(wasm=Buffer.from(patch.wasm,"base64").toString("binary"));var restoredWASM=pako__WEBPACK_IMPORTED_MODULE_5___default.a.inflate(wasm,{to:"string"}),restoredRnboModule;return restoredWASM+="restoredRnboModule = rnbo_module;",eval(restoredWASM),restoredRnboModule().then(e=>{delete e.then,_WASMHelper__WEBPACK_IMPORTED_MODULE_3__.a.setup(this,e),this.nt=!0})}getCurrentTime(){return this.X.getCurrentTime()}setCurrentTime(e){this.nt&&this.X.setCurrentTime(e)}prepareToProcess(e,t,n){if(n||e!==this.O||t!==this.T){let r=t!==this.T;_BaseEngine__WEBPACK_IMPORTED_MODULE_0__.a.prototype.prepareToProcess.call(this,e,t,n),r&&(_WASMHelper__WEBPACK_IMPORTED_MODULE_3__.a.ensureBuffers(this,this.N,this.K,t),_WASMHelper__WEBPACK_IMPORTED_MODULE_3__.a.ensureBuffers(this,this.L,this.Z,t)),this.X.prepareToProcess(e,t)}}process(e,t,n,r,i,a,o){let s=0,c=0;for(let n=0;n<t;n++){var l=e[n];if(!(s<this.K))break;this._rnbo_module.HEAPF64.set(l,this.N[s]>>3),s++}this.X.process(this.R,s,this.j,this.Z,i);for(let e=0;e<r;e++){var u=n[e];if(!(c<this.Z))break;{let e=this.L[c]>>3;u.set(this._rnbo_module.HEAPF64.slice(e,e+u.length)),c++}}}scheduleEvent(e){"MIDIEvent"===e.type?this.X.scheduleMidiEvent(e.time,e.port,e.data[0],e.data[1],e.data[2]):"ParameterEvent"===e.type&&this.X.scheduleParameterEvent(e.target,e.time,e.value,e.source)}sendMessage(e,t,n){"number"==typeof t?this.X.sendNumMessage(e,t,n):Array.isArray(t)&&this.X.sendListMessage(e,_WASMHelper__WEBPACK_IMPORTED_MODULE_3__.a.pushArray(this,t),t.length,n)}scheduleMidiEvent(e,t){this.scheduleEvent(new _MIDIEvent__WEBPACK_IMPORTED_MODULE_1__.a(this.P,e,t,t.length,this.C))}handleParameterEvent(e){for(let t=0;t<this.D.length;t++)this.D[t].notifyParameterValueChanged(e.time,e.index,e.value,e.source)}handleMidiEvent(e){for(var t=0;t<this.D.length;t++)this.D[t].pushOutgoingEvent(new _MIDIEvent__WEBPACK_IMPORTED_MODULE_1__.a(e.time,e.port,[e.b1,e.b2,e.b3],e.length,void 0))}handleMessageEvent(e){for(var t=0;t<this.D.length;t++)this.D[t].pushOutgoingEvent(new _MessageEvent__WEBPACK_IMPORTED_MODULE_2__.a(e.time,this.X.resolveTag(e.tag),0==e.type?e.numValue:_WASMHelper__WEBPACK_IMPORTED_MODULE_3__.a.retrieveArray(e.listValue)))}getParameterValue(e){return this.X.getParameterValue(e)}}}).call(this,__webpack_require__(17).Buffer)},function(e,t){e.exports={src:'class RNBOPatcher{constructor(){this.currentTime=0,this.audioProcessSampleCount=0,this.sampleOffsetIntoNextAudioBuffer=0,this.vs=0,this.maxvs=0,this.sr=44100,this.invsr=2267573696e-14,this.zeroBuffer=0,this.dummyBuffer=0,this.voiceIndex=0,this.noteNumber=0}getParameterIndexForID(e){return-1}getNumMidiInputPorts(){return 0}processMidiEvent(e,t,s,r){this.updateTime(e)}getNumMidiOutputPorts(){return 0}process(e,t,s,r,i){this.vs=i,this.updateTime(this.getEngine().getCurrentTime()),this.audioProcessSampleCount=this.msToSamps(this.currentTime,this.sr)}prepareToProcess(e,t){this.vs=t,this.maxvs=t,this.zeroBuffer=resizeSignal(this.zeroBuffer,t),this.dummyBuffer=resizeSignal(this.dummyBuffer,t),this.sr=e,this.invsr=1/e}msToSamps(e,t){return floor(e*t*.001)}sampsToMs(e){return e*(1e3*this.invsr)}getNumInputChannels(){return 0}getNumOutputChannels(){return 0}getSignalIndexForID(e){return-1}getDataRef(e){return 0}getNumDataRefs(){return 0}fillDataRef(e,t){e}processDataViewUpdate(e,t){this.updateTime(t)}initialize(e){this.assign_defaults(),this.setState(e),this.initializeObjects(e),this.allocateDataRefs(),this.startup(e)}initializeObjects(e){}allocateDataRefs(){}startup(e){}setIsMuted(e){}getPatcherSerial(){return 7}getState(e){e[eventTargetKey]=this,e[patcherSerialKey]=this.getPatcherSerial(),e.p7=1,e.p7_noteNumber=this.noteNumber}setState(e){e[patcherSerialKey]==this.getPatcherSerial()&&(containsValue(e[eventTargetKey])&&this.getEngine().updatePatcherEventTarget(e[eventTargetKey],this),containsValue(e.p7_noteNumber)&&(this.noteNumber=e.p7_noteNumber))}setParameterValue(e,t,s){this.updateTime(s)}processParameterEvent(e,t,s){this.setParameterValue(e,t,s)}processNormalizedParameterEvent(e,t,s){this.setParameterValueNormalized(e,t,s)}getParameterValue(e){return 0}getNumSignalInParameters(){return 0}getNumParameters(){return 0}getParameterName(e){return"bogus"}getParameterId(e){return"bogus"}getParameterInfo(e,t){e}sendParameter(e){this.getEngine().notifyParameterValueChanged(e,this.getParameterValue(e))}processClockEvent(e,t,s,r){this.updateTime(e)}processOutletAtCurrentTime(e,t,s){}processOutletEvent(e,t,s,r){this.updateTime(r),this.processOutletAtCurrentTime(e,t,s)}sendOutlet(e,t){this.getEngine().sendOutlet(this,e,t)}schedule(e,t){this.getEngine().scheduleClockEvent(this,e,t+this.currentTime)}scheduleValue(e,t,s){this.getEngine().scheduleClockEventWithValue(this,e,t+this.currentTime,s)}stop(e){this.getEngine().flushClockEvents(this,e,!1)}processNumMessage(e,t,s){this.updateTime(t)}processListMessage(e,t,s){this.updateTime(t)}resolveTag(e){return""}sendMidiEvent(e,t,s,r){this.getEngine().sendMidiEvent(e,t,s,r)}sendMidiEventList(e,t){this.getEngine().sendMidiEventList(e,t)}updateTime(e){this.currentTime=e,this.sampleOffsetIntoNextAudioBuffer=this.msToSamps(e,this.sr)-this.vs-this.audioProcessSampleCount}assign_defaults(){}setEngineAndPatcher(e,t){this._engineInterface=e,this._parentPatcher=t}getEngine(){return this._engineInterface}getPatcher(){return this._parentPatcher}}rnboObj=new RNBOPatcher;',options:{classname:"rnbomatic",minifyOutput:!0},desc:{parameters:[],numParameters:0,numSignalInParameters:0,layouts:[{name:"layout",boxes:[]}],numInputChannels:0,numOutputChannels:0}}},function(e,t,n){(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var r=n(28),i=n(29),a=n(30);function o(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(o()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,n){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return h(this,e)}return l(this,e,t,n)}function l(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=p(e,t),e}(e,t,n,r):"string"==typeof t?function(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|f(t,n),i=(e=s(e,r)).write(t,n);return i!==r&&(e=e.slice(0,i)),e}(e,t,n):function(e,t){if(c.isBuffer(t)){var n=0|d(t.length);return 0===(e=s(e,n)).length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?s(e,0):p(e,t);if("Buffer"===t.type&&a(t.data))return p(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function h(e,t){if(u(t),e=s(e,t<0?0:0|d(t)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function p(e,t){var n=t.length<0?0:0|d(t.length);e=s(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function d(e){if(e>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|e}function f(e,t){if(c.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return F(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return U(e).length;default:if(r)return F(e).length;t=(""+t).toLowerCase(),r=!0}}function m(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function g(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=c.from(t,r)),c.isBuffer(t))return 0===t.length?-1:v(e,t,n,r,i);if("number"==typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):v(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function v(e,t,n,r,i){var a,o=1,s=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;o=2,s/=2,c/=2,n/=2}function l(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i){var u=-1;for(a=n;a<s;a++)if(l(e,a)===l(t,-1===u?0:a-u)){if(-1===u&&(u=a),a-u+1===c)return u*o}else-1!==u&&(a-=a-u),u=-1}else for(n+c>s&&(n=s-c),a=n;a>=0;a--){for(var h=!0,p=0;p<c;p++)if(l(e,a+p)!==l(t,p)){h=!1;break}if(h)return a}return-1}function y(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var a=t.length;if(a%2!=0)throw new TypeError("Invalid hex string");r>a/2&&(r=a/2);for(var o=0;o<r;++o){var s=parseInt(t.substr(2*o,2),16);if(isNaN(s))return o;e[n+o]=s}return o}function b(e,t,n,r){return V(F(t,e.length-n),e,n,r)}function _(e,t,n,r){return V(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function w(e,t,n,r){return _(e,t,n,r)}function x(e,t,n,r){return V(U(t),e,n,r)}function E(e,t,n,r){return V(function(e,t){for(var n,r,i,a=[],o=0;o<e.length&&!((t-=2)<0);++o)r=(n=e.charCodeAt(o))>>8,i=n%256,a.push(i),a.push(r);return a}(t,e.length-n),e,n,r)}function M(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function S(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var a,o,s,c,l=e[i],u=null,h=l>239?4:l>223?3:l>191?2:1;if(i+h<=n)switch(h){case 1:l<128&&(u=l);break;case 2:128==(192&(a=e[i+1]))&&(c=(31&l)<<6|63&a)>127&&(u=c);break;case 3:a=e[i+1],o=e[i+2],128==(192&a)&&128==(192&o)&&(c=(15&l)<<12|(63&a)<<6|63&o)>2047&&(c<55296||c>57343)&&(u=c);break;case 4:a=e[i+1],o=e[i+2],s=e[i+3],128==(192&a)&&128==(192&o)&&128==(192&s)&&(c=(15&l)<<18|(63&a)<<12|(63&o)<<6|63&s)>65535&&c<1114112&&(u=c)}null===u?(u=65533,h=1):u>65535&&(u-=65536,r.push(u>>>10&1023|55296),u=56320|1023&u),r.push(u),i+=h}return function(e){var t=e.length;if(t<=T)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=T));return n}(r)}t.Buffer=c,t.SlowBuffer=function(e){return+e!=e&&(e=0),c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=o(),c.poolSize=8192,c.it=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,n){return l(null,e,t,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,n){return function(e,t,n,r){return u(t),t<=0?s(e,t):void 0!==n?"string"==typeof r?s(e,t).fill(n,r):s(e,t).fill(n):s(e,t)}(null,e,t,n)},c.allocUnsafe=function(e){return h(null,e)},c.allocUnsafeSlow=function(e){return h(null,e)},c.isBuffer=function(e){return!(null==e||!e.h)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,a=Math.min(n,r);i<a;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!a(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=c.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var o=e[n];if(!c.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i),i+=o.length}return r},c.byteLength=f,c.prototype.h=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?S(this,0,e):function(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return O(this,t,n);case"utf8":case"utf-8":return S(this,t,n);case"ascii":return P(this,t,n);case"latin1":case"binary":return A(this,t,n);case"base64":return M(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,n,r,i){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var a=(i>>>=0)-(r>>>=0),o=(n>>>=0)-(t>>>=0),s=Math.min(a,o),l=this.slice(r,i),u=e.slice(t,n),h=0;h<s;++h)if(l[h]!==u[h]){a=l[h],o=u[h];break}return a<o?-1:o<a?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return g(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return g(this,e,t,n,!1)},c.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var a=!1;;)switch(r){case"hex":return y(this,e,t,n);case"utf8":case"utf-8":return b(this,e,t,n);case"ascii":return _(this,e,t,n);case"latin1":case"binary":return w(this,e,t,n);case"base64":return x(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,e,t,n);default:if(a)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),a=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this.st||this,0)}};var T=4096;function P(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function A(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function O(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",a=t;a<n;++a)i+=j(e[a]);return i}function C(e,t,n){for(var r=e.slice(t,n),i="",a=0;a<r.length;a+=2)i+=String.fromCharCode(r[a]+256*r[a+1]);return i}function R(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function L(e,t,n,r,i,a){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<a)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function I(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,a=Math.min(e.length-n,2);i<a;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function k(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,a=Math.min(e.length-n,4);i<a;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function N(e,t,n,r,i,a){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function z(e,t,n,r,a){return a||N(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function D(e,t,n,r,a){return a||N(e,0,n,8),i.write(e,t,n,r,52,8),n+8}c.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=c.prototype;else{var i=t-e;n=new c(i,void 0);for(var a=0;a<i;++a)n[a]=this[a+e]}return n},c.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var r=this[e],i=1,a=0;++a<t&&(i*=256);)r+=this[e+a]*i;return r},c.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},c.prototype.readUInt8=function(e,t){return t||R(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||R(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||R(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||R(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||R(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var r=this[e],i=1,a=0;++a<t&&(i*=256);)r+=this[e+a]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},c.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var r=t,i=1,a=this[e+--r];r>0&&(i*=256);)a+=this[e+--r]*i;return a>=(i*=128)&&(a-=Math.pow(2,8*t)),a},c.prototype.readInt8=function(e,t){return t||R(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||R(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){t||R(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return t||R(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||R(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||R(e,4,this.length),i.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||R(e,4,this.length),i.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||R(e,8,this.length),i.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||R(e,8,this.length),i.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,n,r){e=+e,t|=0,n|=0,r||L(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,a=0;for(this[t]=255&e;++a<n&&(i*=256);)this[t+a]=e/i&255;return t+n},c.prototype.writeUIntBE=function(e,t,n,r){e=+e,t|=0,n|=0,r||L(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,a=1;for(this[t+i]=255&e;--i>=0&&(a*=256);)this[t+i]=e/a&255;return t+n},c.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):I(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):I(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):k(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):k(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);L(this,e,t,n,i-1,-i)}var a=0,o=1,s=0;for(this[t]=255&e;++a<n&&(o*=256);)e<0&&0===s&&0!==this[t+a-1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+n},c.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);L(this,e,t,n,i-1,-i)}var a=n-1,o=1,s=0;for(this[t+a]=255&e;--a>=0&&(o*=256);)e<0&&0===s&&0!==this[t+a+1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+n},c.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):I(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):I(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):k(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):k(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,n){return z(this,e,t,!0,n)},c.prototype.writeFloatBE=function(e,t,n){return z(this,e,t,!1,n)},c.prototype.writeDoubleLE=function(e,t,n){return D(this,e,t,!0,n)},c.prototype.writeDoubleBE=function(e,t,n){return D(this,e,t,!1,n)},c.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,a=r-n;if(this===e&&n<t&&t<r)for(i=a-1;i>=0;--i)e[i+t]=this[i+n];else if(a<1e3||!c.TYPED_ARRAY_SUPPORT)for(i=0;i<a;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+a),t);return a},c.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var a;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(a=t;a<n;++a)this[a]=e;else{var o=c.isBuffer(e)?e:F(new c(e,r).toString()),s=o.length;for(a=0;a<n-t;++a)this[a+t]=o[a%s]}return this};var B=/[^+\/0-9A-Za-z-_]/g;function j(e){return e<16?"0"+e.toString(16):e.toString(16)}function F(e,t){var n;t=t||1/0;for(var r=e.length,i=null,a=[],o=0;o<r;++o){if((n=e.charCodeAt(o))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(o+1===r){(t-=3)>-1&&a.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&a.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&a.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;a.push(n)}else if(n<2048){if((t-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function U(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(B,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function V(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}}).call(this,n(18))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){e.exports=function(e,t,n,r){for(var i=65535&e|0,a=e>>>16&65535|0,o=0;0!==n;){n-=o=n>2e3?2e3:n;do{a=a+(i=i+t[r++]|0)|0}while(--o);i%=65521,a%=65521}return i|a<<16|0}},function(e,t,n){var r=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();e.exports=function(e,t,n,i){var a=r,o=i+n;e^=-1;for(var s=i;s<o;s++)e=e>>>8^a[255&(e^t[s])];return-1^e}},function(e,t,n){var r=n(3),i=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch(e){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){a=!1}for(var o=new r.Buf8(256),s=0;s<256;s++)o[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;function c(e,t){if(t<65534&&(e.subarray&&a||!e.subarray&&i))return String.fromCharCode.apply(null,r.shrinkBuf(e,t));for(var n="",o=0;o<t;o++)n+=String.fromCharCode(e[o]);return n}o[254]=o[254]=1,t.string2buf=function(e){var t,n,i,a,o,s=e.length,c=0;for(a=0;a<s;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(i=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(i-56320),a++),c+=n<128?1:n<2048?2:n<65536?3:4;for(t=new r.Buf8(c),o=0,a=0;o<c;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(i=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(i-56320),a++),n<128?t[o++]=n:n<2048?(t[o++]=192|n>>>6,t[o++]=128|63&n):n<65536?(t[o++]=224|n>>>12,t[o++]=128|n>>>6&63,t[o++]=128|63&n):(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63,t[o++]=128|n>>>6&63,t[o++]=128|63&n);return t},t.buf2binstring=function(e){return c(e,e.length)},t.binstring2buf=function(e){for(var t=new r.Buf8(e.length),n=0,i=t.length;n<i;n++)t[n]=e.charCodeAt(n);return t},t.buf2string=function(e,t){var n,r,i,a,s=t||e.length,l=new Array(2*s);for(r=0,n=0;n<s;)if((i=e[n++])<128)l[r++]=i;else if((a=o[i])>4)l[r++]=65533,n+=a-1;else{for(i&=2===a?31:3===a?15:7;a>1&&n<s;)i=i<<6|63&e[n++],a--;a>1?l[r++]=65533:i<65536?l[r++]=i:(i-=65536,l[r++]=55296|i>>10&1023,l[r++]=56320|1023&i)}return c(l,r)},t.utf8border=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;n>=0&&128==(192&e[n]);)n--;return n<0?t:0===n?t:n+o[e[n]]>t?n:t}},function(e,t,n){e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},function(e,t,n){e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(e,t,n){var r,i="object"==typeof Reflect?Reflect:null,a=i&&"function"==typeof i.apply?i.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};r=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,s.EventEmitter=s,s.prototype.at=void 0,s.prototype.ot=0,s.prototype.ut=void 0;var c=10;function l(e){return void 0===e.ut?s.defaultMaxListeners:e.ut}function u(e,t,n,r){var i,a,o,s;if("function"!=typeof n)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n);if(void 0===(a=e.at)?(a=e.at=Object.create(null),e.ot=0):(void 0!==a.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),a=e.at),o=a[t]),void 0===o)o=a[t]=n,++e.ot;else if("function"==typeof o?o=a[t]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),(i=l(e))>0&&o.length>i&&!o.warned){o.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=o.length,s=c,console&&console.warn&&console.warn(s)}return e}function h(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=function(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,a(this.listener,this.target,e))}.bind(r);return i.listener=n,r.wrapFn=i,i}function p(e,t,n){var r=e.at;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):f(i,i.length)}function d(e){var t=this.at;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function f(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");c=e}}),s.init=function(){void 0!==this.at&&this.at!==Object.getPrototypeOf(this).at||(this.at=Object.create(null),this.ot=0),this.ut=this.ut||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this.ut=e,this},s.prototype.getMaxListeners=function(){return l(this)},s.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this.at;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var c=i[e];if(void 0===c)return!1;if("function"==typeof c)a(c,this,t);else{var l=c.length,u=f(c,l);for(n=0;n<l;++n)a(u[n],this,t)}return!0},s.prototype.addListener=function(e,t){return u(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return u(this,e,t,!0)},s.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.on(e,h(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.prependListener(e,h(this,e,t)),this},s.prototype.removeListener=function(e,t){var n,r,i,a,o;if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);if(void 0===(r=this.at))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this.ot?this.at=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,a=n.length-1;a>=0;a--)if(n[a]===t||n[a].listener===t){o=n[a].listener,i=a;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,o||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this.at))return this;if(void 0===n.removeListener)return 0===arguments.length?(this.at=Object.create(null),this.ot=0):void 0!==n[e]&&(0==--this.ot?this.at=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,a=Object.keys(n);for(r=0;r<a.length;++r)"removeListener"!==(i=a[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this.at=Object.create(null),this.ot=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},s.prototype.listeners=function(e){return p(this,e,!0)},s.prototype.rawListeners=function(e){return p(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):d.call(e,t)},s.prototype.listenerCount=d,s.prototype.eventNames=function(){return this.ot>0?r(this.at):[]}},function(e,t){e.exports='!function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"u",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.u)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.u?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=15)}([function(t,e,r){r.d(e,"a",function(){return n});class n{constructor(t,e,r){this.type=t,this.time=e,this.eventTarget=r}}},function(t,e,r){e.a=Object.freeze({toProcessor:{setPatcher:0,scheduleEvent:1},fromProcessor:{setPatcherFinished:1e3,scheduleEvent:1001,outgoingEvent:1002,notifyParameterValueChanged:1003}})},function(t,e){function r(){return(this.dataRef.sizeInBytes?this.dataRef.sizeInBytes:0)/this.BASEARRAY.BYTES_PER_ELEMENT/this.dataRef.channels}function n(t){var e=this.dataRef.channels,r=t*this.BASEARRAY.BYTES_PER_ELEMENT*e;(!this.dataRef.sizeInBytes||this.dataRef.sizeInBytes<r)&&(this.dataRef.sizeInBytes=r)}function i(t,e){return this[this.getChannels()*e+t]}function s(t,e,r){this[this.getChannels()*e+t]=r}function u(){return this.dataRef.channels}function a(t){if(t!=this.dataRef.channels){var e=this.getSize();this.dataRef.channels=t,this.setSize(e)}}function o(){if(this.dataRef.sizeInBytes>0&&this.dataRef.channels>0){var t;(!this.dataRef.arrayBuffer||this.dataRef.arrayBuffer.byteLength<this.dataRef.sizeInBytes)&&(t=new ArrayBuffer(this.dataRef.sizeInBytes)),t&&(this.dataRef.arrayBuffer=t,this.dataRef.wantsFillFlag=!0,this.dataRef.isValid=!0);var e=new this.BASEARRAY(this.dataRef.arrayBuffer);return l(e,this.dataRef,this.BASEARRAY),this.isAudioBuffer&&m(e),e}}function h(){this.fill(0)}function c(){return this.touched}function f(t){this.touched=t}function l(t,e,i){t.dataRef=e,t.BASEARRAY=i,t.getSize=r,t.setSize=n,t.allocateIfNeeded=o,t.setZero=h,e.setZero=function(){t.setZero()},t.touched=!1,t.getTouched=c,t.setTouched=f}function m(t){t.getSample=i,t.setSample=s,t.getChannels=u,t.setChannels=a,t.isAudioBuffer=!0}var p=function(t,e,r){var n;if(t.isValid)n=new r(t.arrayBuffer);else{e||(e=0),t.channels=1;var i=e*r.BYTES_PER_ELEMENT;(!t.sizeInBytes||t.sizeInBytes<i)&&(t.sizeInBytes=i),n={}}return l(n,t,r),n};(p.prototype=Object.create(null)).constructor=p;var v=function(t,e,r,n){var i=p.call(this,t,e,n);if(!t.isValid){e||(e=0),r||(r=1),(!t.channels||t.channels<r)&&(t.channels=r);var s=e*n.BYTES_PER_ELEMENT*r;(!t.sizeInBytes||t.sizeInBytes<s)&&(t.sizeInBytes=s)}return m(i),i};(v.prototype=Object.create(p)).constructor=v;var d=function(t,e,r){return v.call(this,t,e,r,Float32Array)};(d.prototype=Object.create(v.prototype)).constructor=d;var g=function(t,e,r){return v.call(this,t,e,r,Float64Array)};(g.prototype=Object.create(v.prototype)).constructor=g;var I=function(t,e){return p.call(this,t,e,Int32Array)};(I.prototype=Object.create(p.prototype)).constructor=I;var y=function(t,e){return p.call(this,t,e,Uint8Array)};(y.prototype=Object.create(p.prototype)).constructor=y,t.exports={Float32Buffer:d,Float64Buffer:g,IntBuffer:I,UInt8Buffer:y}},function(t,e,r){r.d(e,"a",function(){return i});var n=r(0);class i extends n.a{constructor(t,e,r,n){super("MessageEvent",t,n),this.tag=e,this.payload=r}}},function(t,e,r){(function(e){\n/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>\n * @license  MIT\n */\nfunction n(t,e){if(t===e)return 0;for(var r=t.length,n=e.length,i=0,s=Math.min(r,n);i<s;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return r<n?-1:n<r?1:0}function i(t){return e.Buffer&&"function"==typeof e.Buffer.isBuffer?e.Buffer.isBuffer(t):!(null==t||!t.h)}var s=r(11),u=Object.prototype.hasOwnProperty,a=Array.prototype.slice,o="foo"===function(){}.name;function h(t){return Object.prototype.toString.call(t)}function c(t){return!i(t)&&("function"==typeof e.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):!!t&&(t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer))))}var f=t.exports=g,l=/\\s*function\\s+([^\\(\\s]*)\\s*/;function m(t){if(s.isFunction(t)){if(o)return t.name;var e=t.toString().match(l);return e&&e[1]}}function p(t,e){return"string"==typeof t?t.length<e?t:t.slice(0,e):t}function v(t){if(o||!s.isFunction(t))return s.inspect(t);var e=m(t);return"[Function"+(e?": "+e:"")+"]"}function d(t,e,r,n,i){throw new f.AssertionError({message:r,actual:t,expected:e,operator:n,stackStartFunction:i})}function g(t,e){t||d(t,!0,e,"==",f.ok)}function I(t,e,r,u){if(t===e)return!0;if(i(t)&&i(e))return 0===n(t,e);if(s.isDate(t)&&s.isDate(e))return t.getTime()===e.getTime();if(s.isRegExp(t)&&s.isRegExp(e))return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase;if(null!==t&&"object"==typeof t||null!==e&&"object"==typeof e){if(c(t)&&c(e)&&h(t)===h(e)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===n(new Uint8Array(t.buffer),new Uint8Array(e.buffer));if(i(t)!==i(e))return!1;var o=(u=u||{actual:[],expected:[]}).actual.indexOf(t);return-1!==o&&o===u.expected.indexOf(e)||(u.actual.push(t),u.expected.push(e),function(t,e,r,n){if(null==t||null==e)return!1;if(s.isPrimitive(t)||s.isPrimitive(e))return t===e;if(r&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;var i=y(t),u=y(e);if(i&&!u||!i&&u)return!1;if(i)return t=a.call(t),e=a.call(e),I(t,e,r);var o,h,c=_(t),f=_(e);if(c.length!==f.length)return!1;for(c.sort(),f.sort(),h=c.length-1;h>=0;h--)if(c[h]!==f[h])return!1;for(h=c.length-1;h>=0;h--)if(o=c[h],!I(t[o],e[o],r,n))return!1;return!0}(t,e,r,u))}return r?t===e:t==e}function y(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function M(t,e){if(!t||!e)return!1;if("[object RegExp]"==Object.prototype.toString.call(e))return e.test(t);try{if(t instanceof e)return!0}catch(t){}return!Error.isPrototypeOf(e)&&!0===e.call({},t)}function b(t,e,r,n){var i;if("function"!=typeof e)throw new TypeError(\'"block" argument must be a function\');"string"==typeof r&&(n=r,r=null),i=function(t){var e;try{t()}catch(t){e=t}return e}(e),n=(r&&r.name?" ("+r.name+").":".")+(n?" "+n:"."),t&&!i&&d(i,r,"Missing expected exception"+n);var u="string"==typeof n,a=!t&&i&&!r;if((!t&&s.isError(i)&&u&&M(i,r)||a)&&d(i,r,"Got unwanted exception"+n),t&&i&&r&&!M(i,r)||!t&&i)throw i}f.AssertionError=function(t){var e;this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=p(v((e=this).actual),128)+" "+e.operator+" "+p(v(e.expected),128),this.generatedMessage=!0);var r=t.stackStartFunction||d;if(Error.captureStackTrace)Error.captureStackTrace(this,r);else{var n=new Error;if(n.stack){var i=n.stack,s=m(r),u=i.indexOf("\\n"+s);if(u>=0){var a=i.indexOf("\\n",u+1);i=i.substring(a+1)}this.stack=i}}},s.inherits(f.AssertionError,Error),f.fail=d,f.ok=g,f.equal=function(t,e,r){t!=e&&d(t,e,r,"==",f.equal)},f.notEqual=function(t,e,r){t==e&&d(t,e,r,"!=",f.notEqual)},f.deepEqual=function(t,e,r){I(t,e,!1)||d(t,e,r,"deepEqual",f.deepEqual)},f.deepStrictEqual=function(t,e,r){I(t,e,!0)||d(t,e,r,"deepStrictEqual",f.deepStrictEqual)},f.notDeepEqual=function(t,e,r){I(t,e,!1)&&d(t,e,r,"notDeepEqual",f.notDeepEqual)},f.notDeepStrictEqual=function t(e,r,n){I(e,r,!0)&&d(e,r,n,"notDeepStrictEqual",t)},f.strictEqual=function(t,e,r){t!==e&&d(t,e,r,"===",f.strictEqual)},f.notStrictEqual=function(t,e,r){t===e&&d(t,e,r,"!==",f.notStrictEqual)},f.throws=function(t,e,r){b(!0,t,e,r)},f.doesNotThrow=function(t,e,r){b(!1,t,e,r)},f.ifError=function(t){if(t)throw t};var _=Object.keys||function(t){var e=[];for(var r in t)u.call(t,r)&&e.push(r);return e}}).call(this,r(10))},function(t,e,r){r.d(e,"a",function(){return i});var n=r(0);class i extends n.a{constructor(t,e,r,n,i){super("MIDIEvent",t,i),this.status=240&r[0],this.channel=15&r[0],this.port=e,this.data=r,this.length=n}}},function(module,exports,__webpack_require__){var Float32Buffer=__webpack_require__(2).Float32Buffer,Float64Buffer=__webpack_require__(2).Float64Buffer,IntBuffer=__webpack_require__(2).IntBuffer,UInt8Buffer=__webpack_require__(2).UInt8Buffer,ExternalLoaderFactory=__webpack_require__(8).ExternalLoaderFactory,patcherSerialKey="XX__PatcherSerialKey__XX",eventTargetKey="XX__EventTargetKey__XX",ParameterTypeNumber=0,ParameterTypeBang=1,ParameterTypeList=2,ParameterTypeSignal=3,ParameterTypeCount=4,IOTypeInput=0,IOTypeOutput=1,IOTypeUndefined=2;function rand01(){return Math.random()}function pi01(){return Math.PI}var abs=Math.abs,acos=Math.acos,acosh=Math.acosh,asin=Math.asin,asinh=Math.asinh,atan=Math.atan,atan2=Math.atan2,atanh=Math.atanh,cbrt=Math.cbrt,ceil=Math.ceil,clz32=Math.clz32,cos=Math.cos,cosh=Math.cosh,exp=Math.exp,expm1=Math.expm1,floor=Math.floor,fround=Math.fround,hypot=Math.hypot,imul=Math.imul,log=Math.log,log10=Math.log10,log1p=Math.log1p,log2=Math.log2,max=Math.max,min=Math.min,pow=Math.pow,random=Math.random,round=Math.round,sign=Math.sign,sin=Math.sin,sinh=Math.sinh,sqrt=Math.sqrt,tan=Math.tan,tanh=Math.tanh,trunc=Math.trunc,fabs=Math.abs,fmax=Math.max,fmod=Math.mod,isnan=function(t){return isNaN(t)};function fixnan(t){return isnan(t)?0:t}function fract(t){return t%1}function fixdenorm(t){return t}function isdenorm(t){return!1}var fastsin=Math.sin,fastcos=Math.cos,fastexp=Math.exp,fastpow=Math.pow,fasttan=Math.tan;function next_power_of_two(t){return 0===t?1:(t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)+1)}function getArrayValueAtIndex(t,e){return t[e]}function allocateArray(t,e){return new Array(t)}function createListCopy(t){return t.slice(0)}function assignList(t,e){t.length=e.length;for(let r=0;r<e.length;r++)t[r]=e[r]}function convertListToNumber(t){return t.length>0?t[0]:0}function list(){for(var t=[],e=0;e<arguments.length;e++)t.push(arguments[e]);return t}function resizeSignal(t,e){for(var r=[],n=0;n<e;n++)r[n]=0;return r}function containsValue(t){return void 0!==t}function addressOf(t){return t}function systemticks(){return Date.now()}function bitwiseFloat(t){var e=new Uint32Array(1);return e[0]=t,new DataView(e.buffer).getFloat32(0,!0)}function imul(t,e){return Math.imul(t,e)}var MIDI_StatusByteReceived=1,MIDI_SecondByteReceived=2,MIDI_NoteOff=3,MIDI_NoteOn=4,MIDI_Aftertouch=5,MIDI_CC=6,MIDI_ProgramChange=7,MIDI_ChannelPressure=8,MIDI_PitchBend=9,MIDI_Sysex_Started=10,MIDI_Sysex_Complete=11,MIDI_Generic=99,MIDI_InvalidByte=-1,MIDI_NoteOffMask=128,MIDI_NoteOnMask=144,MIDI_AfterTouchMask=160,MIDI_CCMask=176,MIDI_ProgramChangeMask=192,MIDI_ChannelPressureMask=208,MIDI_PitchBendMask=224,MIDI_CC_Sustain=64,MIDI_CC_Sostenuto=66,MIDI_CC_AllNotesOff=123,MIDI_CC_PressureMSB=70,MIDI_CC_PressureLSB=102,MIDI_CC_TimbreMSB=74,MIDI_CC_TimbreLSB=106,MIDI_NoteState_Off=0,MIDI_NoteState_On=1,MIDI_NoteState_Sustained=2,CLOCKS_PER_SEC=1;function parseMidi(t,e,r){if(240==e)return MIDI_Sysex_Started;if(t==MIDI_Sysex_Started)return 247==e?MIDI_Sysex_Complete:e<=127?t:MIDI_InvalidByte;if(e>127)return MIDI_StatusByteReceived;var n=240&r;return t==MIDI_StatusByteReceived?n==MIDI_ProgramChangeMask?MIDI_ProgramChange:n==MIDI_ChannelPressureMask?MIDI_ChannelPressure:MIDI_SecondByteReceived:t==MIDI_SecondByteReceived?n==MIDI_NoteOffMask||n==MIDI_NoteOnMask&&0==e?MIDI_NoteOff:n==MIDI_NoteOnMask?MIDI_NoteOn:n==MIDI_AfterTouchMask?MIDI_Aftertouch:n==MIDI_CCMask?MIDI_CC:n==MIDI_PitchBendMask?MIDI_PitchBend:MIDI_Generic:t}function getMIDIChannel(t){var e=240&t;return e>=128&&e<=224?15&t:0}function initDataRef(t){var e={};return e.name=t,e.isValid=!1,e.arrayBuffer=void 0,e.wantsFillFlag=!1,e.sizeInBytes=0,e.wantsFill=function(){return this.wantsFillFlag},e.getSizeInBytes=function(){return this.sizeInBytes},e}function TAG(t){let e=0;for(let r=0;r<t.length;r++){e=t.charCodeAt(r)+(e<<6)+(e<<16)-e}return 0|e}function _evalSrc(src){var rnboObj;return eval(src),rnboObj}module.exports={deserializeJSON:function(t){var e=t;return"string"==typeof e&&(e=JSON.parse(t)),_evalSrc(e.src)},extractOptionsFromJSON:function(t){var e=t;return"string"==typeof e&&(e=JSON.parse(t)),e.options?e.options:{}},ParameterTypeNumber:ParameterTypeNumber,ParameterTypeBang:ParameterTypeBang,ParameterTypeList:ParameterTypeList,ParameterTypeSignal:ParameterTypeSignal,ParameterTypeCount:ParameterTypeCount,IOTypeInput:IOTypeInput,IOTypeOutput:IOTypeOutput,IOTypeUndefined:IOTypeUndefined.length,TAG:TAG}},function(t,e,r){r.d(e,"a",function(){return i});var n=r(0);class i extends n.a{constructor(t,e,r,n,i){super("ParameterEvent",t,i),this.target=e,this.value=r,this.source=n}}},function(t,e){var r=function(){};(r.prototype=Object.create(null)).constructor=r,r.prototype.setEngineAndPatcher=function(){},r.prototype.initialize=function(){},r.prototype.getNumParameters=function(){return 0},r.prototype.setParameterValue=function(){},r.prototype.prepareToProcess=function(){},r.prototype.process=function(){},t.exports={ExternalLoaderFactory:function(){return console.log("WARNING: Externals are not yet supported in Javascript"),new r}}},function(t,e){t.exports={src:\'class RNBOPatcher{constructor(){this.currentTime=0,this.audioProcessSampleCount=0,this.sampleOffsetIntoNextAudioBuffer=0,this.vs=0,this.maxvs=0,this.sr=44100,this.invsr=2267573696e-14,this.zeroBuffer=0,this.dummyBuffer=0,this.voiceIndex=0,this.noteNumber=0}getParameterIndexForID(e){return-1}getNumMidiInputPorts(){return 0}processMidiEvent(e,t,s,r){this.updateTime(e)}getNumMidiOutputPorts(){return 0}process(e,t,s,r,i){this.vs=i,this.updateTime(this.getEngine().getCurrentTime()),this.audioProcessSampleCount=this.msToSamps(this.currentTime,this.sr)}prepareToProcess(e,t){this.vs=t,this.maxvs=t,this.zeroBuffer=resizeSignal(this.zeroBuffer,t),this.dummyBuffer=resizeSignal(this.dummyBuffer,t),this.sr=e,this.invsr=1/e}msToSamps(e,t){return floor(e*t*.001)}sampsToMs(e){return e*(1e3*this.invsr)}getNumInputChannels(){return 0}getNumOutputChannels(){return 0}getSignalIndexForID(e){return-1}getDataRef(e){return 0}getNumDataRefs(){return 0}fillDataRef(e,t){e}processDataViewUpdate(e,t){this.updateTime(t)}initialize(e){this.assign_defaults(),this.setState(e),this.initializeObjects(e),this.allocateDataRefs(),this.startup(e)}initializeObjects(e){}allocateDataRefs(){}startup(e){}setIsMuted(e){}getPatcherSerial(){return 7}getState(e){e[eventTargetKey]=this,e[patcherSerialKey]=this.getPatcherSerial(),e.p7=1,e.p7_noteNumber=this.noteNumber}setState(e){e[patcherSerialKey]==this.getPatcherSerial()&&(containsValue(e[eventTargetKey])&&this.getEngine().updatePatcherEventTarget(e[eventTargetKey],this),containsValue(e.p7_noteNumber)&&(this.noteNumber=e.p7_noteNumber))}setParameterValue(e,t,s){this.updateTime(s)}processParameterEvent(e,t,s){this.setParameterValue(e,t,s)}processNormalizedParameterEvent(e,t,s){this.setParameterValueNormalized(e,t,s)}getParameterValue(e){return 0}getNumSignalInParameters(){return 0}getNumParameters(){return 0}getParameterName(e){return"bogus"}getParameterId(e){return"bogus"}getParameterInfo(e,t){e}sendParameter(e){this.getEngine().notifyParameterValueChanged(e,this.getParameterValue(e))}processClockEvent(e,t,s,r){this.updateTime(e)}processOutletAtCurrentTime(e,t,s){}processOutletEvent(e,t,s,r){this.updateTime(r),this.processOutletAtCurrentTime(e,t,s)}sendOutlet(e,t){this.getEngine().sendOutlet(this,e,t)}schedule(e,t){this.getEngine().scheduleClockEvent(this,e,t+this.currentTime)}scheduleValue(e,t,s){this.getEngine().scheduleClockEventWithValue(this,e,t+this.currentTime,s)}stop(e){this.getEngine().flushClockEvents(this,e,!1)}processNumMessage(e,t,s){this.updateTime(t)}processListMessage(e,t,s){this.updateTime(t)}resolveTag(e){return""}sendMidiEvent(e,t,s,r){this.getEngine().sendMidiEvent(e,t,s,r)}sendMidiEventList(e,t){this.getEngine().sendMidiEventList(e,t)}updateTime(e){this.currentTime=e,this.sampleOffsetIntoNextAudioBuffer=this.msToSamps(e,this.sr)-this.vs-this.audioProcessSampleCount}assign_defaults(){}setEngineAndPatcher(e,t){this._engineInterface=e,this._parentPatcher=t}getEngine(){return this._engineInterface}getPatcher(){return this._parentPatcher}}rnboObj=new RNBOPatcher;\',options:{classname:"rnbomatic",minifyOutput:!0},desc:{parameters:[],numParameters:0,numSignalInParameters:0,layouts:[{name:"layout",boxes:[]}],numInputChannels:0,numOutputChannels:0}}},function(t,e){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){(function(t){var n=Object.getOwnPropertyDescriptors||function(t){for(var e=Object.keys(t),r={},n=0;n<e.length;n++)r[e[n]]=Object.getOwnPropertyDescriptor(t,e[n]);return r},i=/%[sdj%]/g;e.format=function(t){if(!g(t)){for(var e=[],r=0;r<arguments.length;r++)e.push(a(arguments[r]));return e.join(" ")}r=1;for(var n=arguments,s=n.length,u=String(t).replace(i,function(t){if("%%"===t)return"%";if(r>=s)return t;switch(t){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(t){return"[Circular]"}default:return t}}),o=n[r];r<s;o=n[++r])v(o)||!M(o)?u+=" "+o:u+=" "+a(o);return u},e.deprecate=function(r,n){if(void 0!==t&&!0===t.noDeprecation)return r;if(void 0===t)return function(){return e.deprecate(r,n).apply(this,arguments)};var i=!1;return function(){if(!i){if(t.throwDeprecation)throw new Error(n);t.traceDeprecation?console.trace(n):console.error(n),i=!0}return r.apply(this,arguments)}};var s,u={};function a(t,r){var n={seen:[],stylize:h};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),p(r)?n.showHidden=r:r&&e.v(n,r),I(n.showHidden)&&(n.showHidden=!1),I(n.depth)&&(n.depth=2),I(n.colors)&&(n.colors=!1),I(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=o),c(n,t,n.depth)}function o(t,e){var r=a.styles[e];return r?"["+a.colors[r][0]+"m"+t+"["+a.colors[r][1]+"m":t}function h(t,e){return t}function c(t,r,n){if(t.customInspect&&r&&P(r.inspect)&&r.inspect!==e.inspect&&(!r.constructor||r.constructor.prototype!==r)){var i=r.inspect(n,t);return g(i)||(i=c(t,i,n)),i}var s=function(t,e){if(I(e))return t.stylize("undefined","undefined");if(g(e)){var r="\'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/\'/g,"\\\\\'").replace(/\\\\"/g,\'"\')+"\'";return t.stylize(r,"string")}if(d(e))return t.stylize(""+e,"number");if(p(e))return t.stylize(""+e,"boolean");if(v(e))return t.stylize("null","null")}(t,r);if(s)return s;var u=Object.keys(r),a=function(t){var e={};return t.forEach(function(t,r){e[t]=!0}),e}(u);if(t.showHidden&&(u=Object.getOwnPropertyNames(r)),_(r)&&(u.indexOf("message")>=0||u.indexOf("description")>=0))return f(r);if(0===u.length){if(P(r)){var o=r.name?": "+r.name:"";return t.stylize("[Function"+o+"]","special")}if(y(r))return t.stylize(RegExp.prototype.toString.call(r),"regexp");if(b(r))return t.stylize(Date.prototype.toString.call(r),"date");if(_(r))return f(r)}var h,M="",O=!1,E=["{","}"];(m(r)&&(O=!0,E=["[","]"]),P(r))&&(M=" [Function"+(r.name?": "+r.name:"")+"]");return y(r)&&(M=" "+RegExp.prototype.toString.call(r)),b(r)&&(M=" "+Date.prototype.toUTCString.call(r)),_(r)&&(M=" "+f(r)),0!==u.length||O&&0!=r.length?n<0?y(r)?t.stylize(RegExp.prototype.toString.call(r),"regexp"):t.stylize("[Object]","special"):(t.seen.push(r),h=O?function(t,e,r,n,i){for(var s=[],u=0,a=e.length;u<a;++u)S(e,String(u))?s.push(l(t,e,r,n,String(u),!0)):s.push("");return i.forEach(function(i){i.match(/^\\d+$/)||s.push(l(t,e,r,n,i,!0))}),s}(t,r,n,a,u):u.map(function(e){return l(t,r,n,a,e,O)}),t.seen.pop(),function(t,e,r){if(t.reduce(function(t,e){return 0,e.indexOf("\\n")>=0&&0,t+e.replace(/\\u001b\\[\\d\\d?m/g,"").length+1},0)>60)return r[0]+(""===e?"":e+"\\n ")+" "+t.join(",\\n  ")+" "+r[1];return r[0]+e+" "+t.join(", ")+" "+r[1]}(h,M,E)):E[0]+M+E[1]}function f(t){return"["+Error.prototype.toString.call(t)+"]"}function l(t,e,r,n,i,s){var u,a,o;if((o=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?a=o.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):o.set&&(a=t.stylize("[Setter]","special")),S(n,i)||(u="["+i+"]"),a||(t.seen.indexOf(o.value)<0?(a=v(r)?c(t,o.value,null):c(t,o.value,r-1)).indexOf("\\n")>-1&&(a=s?a.split("\\n").map(function(t){return"  "+t}).join("\\n").substr(2):"\\n"+a.split("\\n").map(function(t){return"   "+t}).join("\\n")):a=t.stylize("[Circular]","special")),I(u)){if(s&&i.match(/^\\d+$/))return a;(u=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(u=u.substr(1,u.length-2),u=t.stylize(u,"name")):(u=u.replace(/\'/g,"\\\\\'").replace(/\\\\"/g,\'"\').replace(/(^"|"$)/g,"\'"),u=t.stylize(u,"string"))}return u+": "+a}function m(t){return Array.isArray(t)}function p(t){return"boolean"==typeof t}function v(t){return null===t}function d(t){return"number"==typeof t}function g(t){return"string"==typeof t}function I(t){return void 0===t}function y(t){return M(t)&&"[object RegExp]"===O(t)}function M(t){return"object"==typeof t&&null!==t}function b(t){return M(t)&&"[object Date]"===O(t)}function _(t){return M(t)&&("[object Error]"===O(t)||t instanceof Error)}function P(t){return"function"==typeof t}function O(t){return Object.prototype.toString.call(t)}function E(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(r){if(I(s)&&(s=t.env.NODE_DEBUG||""),r=r.toUpperCase(),!u[r])if(new RegExp("\\\\b"+r+"\\\\b","i").test(s)){var n=t.pid;u[r]=function(){var t=e.format.apply(e,arguments);console.error("%s %d: %s",r,n,t)}}else u[r]=function(){};return u[r]},e.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=m,e.isBoolean=p,e.isNull=v,e.isNullOrUndefined=function(t){return null==t},e.isNumber=d,e.isString=g,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=I,e.isRegExp=y,e.isObject=M,e.isDate=b,e.isError=_,e.isFunction=P,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=r(13);var w=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function S(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){var t,r;console.log("%s - %s",(t=new Date,r=[E(t.getHours()),E(t.getMinutes()),E(t.getSeconds())].join(":"),[t.getDate(),w[t.getMonth()],r].join(" ")),e.format.apply(e,arguments))},e.inherits=r(14),e.v=function(t,e){if(!e||!M(e))return t;for(var r=Object.keys(e),n=r.length;n--;)t[r[n]]=e[r[n]];return t};var T="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function D(t,e){if(!t){var r=new Error("Promise was rejected with a falsy value");r.reason=t,t=r}return e(t)}e.promisify=function(t){if("function"!=typeof t)throw new TypeError(\'The "original" argument must be of type Function\');if(T&&t[T]){var e;if("function"!=typeof(e=t[T]))throw new TypeError(\'The "util.promisify.custom" argument must be of type Function\');return Object.defineProperty(e,T,{value:e,enumerable:!1,writable:!1,configurable:!0}),e}function e(){for(var e,r,n=new Promise(function(t,n){e=t,r=n}),i=[],s=0;s<arguments.length;s++)i.push(arguments[s]);i.push(function(t,n){t?r(t):e(n)});try{t.apply(this,i)}catch(t){r(t)}return n}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),T&&Object.defineProperty(e,T,{value:e,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(e,n(t))},e.promisify.custom=T,e.callbackify=function(e){if("function"!=typeof e)throw new TypeError(\'The "original" argument must be of type Function\');function r(){for(var r=[],n=0;n<arguments.length;n++)r.push(arguments[n]);var i=r.pop();if("function"!=typeof i)throw new TypeError("The last argument must be of type Function");var s=this,u=function(){return i.apply(s,arguments)};e.apply(this,r).then(function(e){t.nextTick(u,null,e)},function(e){t.nextTick(D,e,u)})}return Object.setPrototypeOf(r,Object.getPrototypeOf(e)),Object.defineProperties(r,n(e)),r}}).call(this,r(12))},function(t,e){var r,n,i=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function a(t){if(r===setTimeout)return setTimeout(t,0);if((r===s||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:s}catch(t){r=s}try{n="function"==typeof clearTimeout?clearTimeout:u}catch(t){n=u}}();var o,h=[],c=!1,f=-1;function l(){c&&o&&(c=!1,o.length?h=o.concat(h):f=-1,h.length&&m())}function m(){if(!c){var t=a(l);c=!0;for(var e=h.length;e;){for(o=h,h=[];++f<e;)o&&o[f].run();f=-1,e=h.length}o=null,c=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===u||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function v(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];h.push(new p(t,e)),1!==h.length||c||a(m)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}},function(t,e,r){r.r(e);var n=r(7),i=r(1),s=r(4),u=r.n(s);function a(t,e){let r=t;if(e>0)if(1===e)t>0&&(r=1);else{var n=1/(e-1);r=Math.round(t/n)*n}return r}class o{constructor(t,e){this.g=-1,this.I=t,this.M=e}get interfaceId(){return this.g}set interfaceId(t){this.g=t}getNumParameters(){return this.I.getNumParameters()}getParameterValue(t){return u()(!1),0}getParameterName(t){return this.I.getParameterName(t)}getParameterId(t){return this.I.getParameterId(t)}getParameterInfo(t,e){this.I.getParameterInfo(t,e)}setParameterValue(t,e){this.setParameter(new n.a(0,t,e,this.interfaceId,void 0))}setParameter(t){this.updateShadowValue(t.target,t.value),this.I.scheduleEvent(t)}setParameterWithDataBuffer(t,e){}convertToNormalizedParameterValue(t,e){let r={min:0,max:0,exponent:1};this.I.getParameterInfo(t,r);let n=e;n<r.min&&(n=r.min),n>r.max&&(n=r.max);let i=(n-r.min)/(r.max-r.min);return 1!==r.exponent&&(i=Math.exp(1*Math.log(i)/r.exponent)),i=a(i,r.steps)}convertFromNormalizedParameterValue(t,e){let r={min:0,max:0,exponent:1};this.I.getParameterInfo(t,r);let n,i=e;return e<0&&(i=0),e>1&&(i=1),i=a(i,r.steps),n=1===r.exponent?r.min+i*(r.max-r.min):r.min+Math.exp(Math.log(i)*r.exponent)*(r.max-r.min)}getParameterValueNormalized(t){return this.convertToNormalizedParameterValue(t,this.getParameterValue(t))}setParameterValueNormalized(t,e){this.setParameterValue(t,this.convertFromNormalizedParameterValue(t,e))}pushOutgoingEvent(t){this.M.outgoingEvent(t)}notifyParameterValueChanged(t,e,r,n){void 0!==n&&-1!==n&&n===this.interfaceId&&this.getParameterValue(e)===r||(this.updateShadowValue(e,r),this.M.notifyParameterValueChanged(t,e,r,n))}updateShadowValue(t,e){}setEngine(t){this.I=t}}class h extends o{constructor(t,e){super(t,e)}getParameterValue(t){return this.I.getParameterValue(t)}}class c extends o{constructor(t,e,r){super(t,e),this._=[];for(var n=0;n<this.I.getNumParameters();n++)this._[n]=0;r.addListener(i.a.fromProcessor.setPatcherFinished,this.refreshShadowValues.bind(this))}getParameterValue(t){return t<this.I.getNumParameters()?this._[t]:0}refreshShadowValues(t){this._=t}updateShadowValue(t,e){this._[t]=e}}let f=r(6);class l{constructor(t){if(this.P=1,this.O=0,this.S=44100,this.T=64,this.D=0,this.C=0,t){this.N=t.N,this.P=t.P;for(var e=0;e<this.N.length;e++)this.N[e].setEngine(this)}else this.N=[];this.j=this.sampsToMs(this.T)}createParameterInterface(t){let e=this.isSync()?new h(this,t):new c(this,t,this.getEmitter());return e.interfaceId=this.P++,this.N.push(e),e}isSync(){return u()(!1),!1}scheduleEvent(t){u()(!1)}getNumInputChannels(){return this.A.getNumInputChannels()}getNumOutputChannels(){return this.A.getNumOutputChannels()}getNumParameters(){return this.A.getNumParameters()}getParameterValue(t){return u()(!1),0}getParameterName(t){return this.A.getParameterName(t)}getParameterId(t){return this.A.getParameterId(t)}getParameterInfo(t,e){return this.A.getParameterInfo(t,e)}sampsToMs(t){return t/this.S*1e3}getSampleRate(){return this.S}getSamplesPerBlock(){return this.T}get needsObjInit(){return!0}prepareToProcess(t,e,r){(r||t!==this.S||e!==this.T)&&(this.S=t,this.T=e,this.j=this.sampsToMs(this.T),this.isSync()&&this.needsObjInit&&this.A.prepareToProcess(this.S,this.T))}getEmitter(){u()(!1)}getPatcherSerial(){return this.A.getPatcherSerial()}getNumSignalInParameters(){return this.D}getNumSignalOutParameters(){return this.C}updateSignalIOParameters(){this.D=0,this.C=0;for(var t=this.A.getNumParameters(),e=0;e<t;e++){let t={min:0,max:0,exponent:1};this.A.getParameterInfo(e,t),t.type===f.ParameterTypeSignal&&(t.IOType===f.IOTypeInput?this.D++:1===t.IOType&&this.C++)}}}var m=r(5),p=r(0);class v extends p.a{constructor(t,e,r,n){super("ClockEvent",t,n),this.clockIndex=e,this.value=r}hasValue(){return void 0!==this.value}}var d,g=r(3);!function(t){t[t.Update=1]="Update"}(d||(d={}));class I extends p.a{constructor(t,e,r,n){super("DataRefEvent",t,n),this.dataRefIndex=e,this.action=r}}class y{getSubState(t){return void 0===this[t]&&(this[t]=new y),this[t]}getSubStateAt(t,e){return void 0===this[t]&&(this[t]=new y),void 0===this[t][e]&&(this[t][e]=new y),this[t][e]}}let M=r(6);function b(t,e){return t.time-e.time}function _(t){t.sort(b)}class P extends l{constructor(t,e){super(e),this.B=!1,this.k=null,this.R=-1,this.V=[],this.B=!1,this.setPatcher(t)}isSync(){return!0}setPatcher(t){var e=new y;this.A&&this.A.getState(e),this.A=M.deserializeJSON(t);for(let t=0;t<this.V.length;t++)this.V[t].eventTarget&&(this.V[t].invalid=!0);this.A.setEngineAndPatcher(this,null),this.A.initialize(e),this.A.prepareToProcess(this.S,this.T,!0),this.updateSignalIOParameters();for(let t=this.V.length-1;t>=0;t--)this.V[t].invalid&&this.V.splice(t,1)}handleEvent(t){var e=t.eventTarget;if(t.time=Math.max(t.time,this.O),e||(e=this.A),this.k=t,"ParameterEvent"===t.type){let r=t;e.setParameterValue(r.target,r.value,t.time)}else if("MIDIEvent"===t.type){let r=t;e.processMidiEvent(r.time,r.port,r.data,r.length)}else if("ClockEvent"===t.type){let r=t;e.processClockEvent(r.time,r.clockIndex,r.hasValue(),r.value)}else if("DataRefEvent"===t.type){let r=t;r.action===d.Update&&e.processDataViewUpdate(r.dataRefIndex,r.time)}else if("MessageEvent"===t.type){let r=t;Array.isArray(r.payload)?e.processListMessage(M.TAG(r.tag),r.time,r.payload):e.processNumMessage(M.TAG(r.tag),r.time,r.payload)}this.k=null}getCurrentTime(){return this.O}setCurrentTime(t){this.O=t}process(t,e,r,n,i,s,u){var a=0,o=Math.min(e,this.getNumInputChannels()+this.D),h=Math.min(n,this.getNumOutputChannels()),c=Math.min(i,this.T);this.R=this.O+this.j,void 0!==this.midiInput&&(this.V.push.apply(this.V,s),this.B=!0),this.B&&(_(this.V),this.B=!1);var f=this.V.length;for(a=0;a<f&&this.V[a].time<this.R;a++)this.handleEvent(this.V[a]);if(this.V.splice(0,a),null!==r&&h>0){for(a=0;a<r.length;a++)r[a].fill(0);this.A.process(t,o,r,h,c)}this.O=this.R,this.R=-1}scheduleEvent(t){this.V.push(t),this.isInProcess()?_(this.V):this.B=!0}sendMessage(t,e,r){this.scheduleEvent(new g.a(r,t,e))}scheduleMidiEvent(t,e){this.scheduleEvent(new m.a(this.O,t,e,e.length,this.A))}notifyParameterValueChanged(t,e){let r=this.k?this.k.source:void 0;if(t<this.getNumParameters())for(var n=this.N.length,i=0;i<n;i++)this.N[i].notifyParameterValueChanged(this.getCurrentTime(),t,e,r)}sendNumMessage(t,e){for(var r=this.N.length,n=0;n<r;n++)this.N[n].pushOutgoingEvent(new g.a(this.O,this.A.resolveTag(t),e))}sendListMessage(t,e){for(var r=this.N.length,n=0;n<r;n++)this.N[n].pushOutgoingEvent(new g.a(this.O,this.A.resolveTag(t),e))}getParameterValue(t){return this.A.getParameterValue(t)}flushClockEvents(t,e,r){for(var n=0;n<this.V.length;n++)if(this.V[n]instanceof v){let i=this.V[n];i.eventTarget!==t||i.clockIndex!==e&&void 0!==i.clockIndex||(this.V.splice(n,1),r&&this.handleEvent(i),n--)}}deleteClockEvents(t){this.flushClockEvents(t,void 0,!1)}scheduleClockEvent(t,e,r){this.scheduleClockEventWithValue(t,e,r,void 0)}scheduleClockEventWithValue(t,e,r,n){this.scheduleEvent(new v(r,e,n,t))}sendMidiEvent(t,e,r,n,i){for(var s=0;s<this.N.length;s++)this.N[s].pushOutgoingEvent(new m.a(this.getCurrentTime(),t,[e,r,n],void 0===i?3:i,void 0))}sendMidiEventList(t,e){var r;for(r=2;r<e.length;r+=3)this.sendMidiEvent(t,e[r-2],e[r-1],e[r],void 0);if((r-=3)<e.length){var n=r-e.length;this.sendMidiEvent(t,e[r],n>1?e[r+1]:void 0,n>2?e[r+2]:void 0,n)}}sendOutlet(t,e,r){console.log("sendOutlet",t,e,r)}updatePatcherEventTarget(t,e){for(var r=0;r<this.V.length;r++)this.V[r].eventTarget===t&&(this.V[r].eventTarget=e,this.V[r].invalid=!1)}rescheduleEventTarget(t){for(var e=0;e<this.V.length;e++)this.V[e].eventTarget===t&&(this.V[e].invalid=!1)}isInProcess(){return this.R>-1}sendDataRefUpdated(t){this.scheduleEvent(new I(this.O,t,d.Update,this.A))}}var O=r(9),E=r.n(O);r.d(e,"default",function(){return S});let w=r(6);class S extends AudioWorkletProcessor{constructor(t){super(t),this.I=new P(E.a,void 0),this.F=[],this.X=[],this.L={},this.U=this.I.createParameterInterface(this),this.U.interfaceId=-1,this.port.onmessage=this.onmessage,this.port.owner=this,this.port.start()}static get parameterDescriptors(){}onmessage(t){switch(t.data[0]){case i.a.toProcessor.setPatcher:let e=t.data[1];this.owner.I.setPatcher(e);let r=[];for(let t=0;t<this.owner.U.getNumParameters();t++){r.push(this.owner.U.getParameterValue(t));let e={min:0,max:0,exponent:1};if(this.owner.I.getParameterInfo(t,e),e.type==w.ParameterTypeSignal&&e.IOType==w.IOTypeInput){let r=this.owner.I.getParameterName(t);this.owner.L[r]=e.signalIndex}}this.owner.F=new Array(this.owner.I.getNumInputChannels()+this.owner.I.getNumSignalInParameters()),this.owner.X=new Array(this.owner.I.getNumOutputChannels()+this.owner.I.getNumSignalOutParameters()),this.owner.I.process([],0,[[]],1,0),this.postMessage([i.a.fromProcessor.setPatcherFinished,r]);break;case i.a.toProcessor.scheduleEvent:this.owner.I.scheduleEvent(t.data[1])}}outgoingEvent(t){this.port.postMessage([i.a.fromProcessor.outgoingEvent,t])}notifyParameterValueChanged(t,e,r,n){this.port.postMessage([i.a.fromProcessor.notifyParameterValueChanged,t,e,r,n])}process(t,e,r){var n,i,s=0,u=0;for(n=0;n<t.length;n++){var a=t[n];for(i=0;i<a.length&&s<this.F.length;i++)this.F[s]=a[i],s++}for(var o in r)this.F[this.L[o]]=r[o],s++;for(n=0;n<e.length;n++){var h=e[n];for(i=0;i<h.length&&u<this.X.length;i++)this.X[u]=h[i],u++}var c=u>0?this.X[0].length:s>0?this.F[0].length:0;return this.I.setCurrentTime(1e3*currentTime),this.I.prepareToProcess(sampleRate,c),this.I.process(this.F,s,this.X,u,c),!0}}var T="XXXX---RNBOPROCESSORNAME_REPLACE---XXXX";T.startsWith("XXXX---RNBOPROCESSORNAME_REPLACE---")&&(T="RNBOProcessor"),registerProcessor(T,S)}]);'},function(e,t){e.exports='!function(t){var e={};function r(n){if(e[n])return e[n].exports;var a=e[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"u",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.u)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(n,a,function(e){return t[e]}.bind(null,a));return n},r.n=function(t){var e=t&&t.u?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=16)}([function(t,e,r){r.d(e,"a",function(){return n});class n{constructor(t,e,r){this.type=t,this.time=e,this.eventTarget=r}}},function(t,e,r){e.a=Object.freeze({toProcessor:{setPatcher:0,scheduleEvent:1},fromProcessor:{setPatcherFinished:1e3,scheduleEvent:1001,outgoingEvent:1002,notifyParameterValueChanged:1003}})},function(t,e){function r(){return(this.dataRef.sizeInBytes?this.dataRef.sizeInBytes:0)/this.BASEARRAY.BYTES_PER_ELEMENT/this.dataRef.channels}function n(t){var e=this.dataRef.channels,r=t*this.BASEARRAY.BYTES_PER_ELEMENT*e;(!this.dataRef.sizeInBytes||this.dataRef.sizeInBytes<r)&&(this.dataRef.sizeInBytes=r)}function a(t,e){return this[this.getChannels()*e+t]}function i(t,e,r){this[this.getChannels()*e+t]=r}function s(){return this.dataRef.channels}function u(t){if(t!=this.dataRef.channels){var e=this.getSize();this.dataRef.channels=t,this.setSize(e)}}function o(){if(this.dataRef.sizeInBytes>0&&this.dataRef.channels>0){var t;(!this.dataRef.arrayBuffer||this.dataRef.arrayBuffer.byteLength<this.dataRef.sizeInBytes)&&(t=new ArrayBuffer(this.dataRef.sizeInBytes)),t&&(this.dataRef.arrayBuffer=t,this.dataRef.wantsFillFlag=!0,this.dataRef.isValid=!0);var e=new this.BASEARRAY(this.dataRef.arrayBuffer);return I(e,this.dataRef,this.BASEARRAY),this.isAudioBuffer&&M(e),e}}function h(){this.fill(0)}function c(){return this.touched}function f(t){this.touched=t}function I(t,e,a){t.dataRef=e,t.BASEARRAY=a,t.getSize=r,t.setSize=n,t.allocateIfNeeded=o,t.setZero=h,e.setZero=function(){t.setZero()},t.touched=!1,t.getTouched=c,t.setTouched=f}function M(t){t.getSample=a,t.setSample=i,t.getChannels=s,t.setChannels=u,t.isAudioBuffer=!0}var _=function(t,e,r){var n;if(t.isValid)n=new r(t.arrayBuffer);else{e||(e=0),t.channels=1;var a=e*r.BYTES_PER_ELEMENT;(!t.sizeInBytes||t.sizeInBytes<a)&&(t.sizeInBytes=a),n={}}return I(n,t,r),n};(_.prototype=Object.create(null)).constructor=_;var l=function(t,e,r,n){var a=_.call(this,t,e,n);if(!t.isValid){e||(e=0),r||(r=1),(!t.channels||t.channels<r)&&(t.channels=r);var i=e*n.BYTES_PER_ELEMENT*r;(!t.sizeInBytes||t.sizeInBytes<i)&&(t.sizeInBytes=i)}return M(a),a};(l.prototype=Object.create(_)).constructor=l;var v=function(t,e,r){return l.call(this,t,e,r,Float32Array)};(v.prototype=Object.create(l.prototype)).constructor=v;var y=function(t,e,r){return l.call(this,t,e,r,Float64Array)};(y.prototype=Object.create(l.prototype)).constructor=y;var p=function(t,e){return _.call(this,t,e,Int32Array)};(p.prototype=Object.create(_.prototype)).constructor=p;var d=function(t,e){return _.call(this,t,e,Uint8Array)};(d.prototype=Object.create(_.prototype)).constructor=d,t.exports={Float32Buffer:v,Float64Buffer:y,IntBuffer:p,UInt8Buffer:d}},function(t,e,r){r.d(e,"a",function(){return a});var n=r(0);class a extends n.a{constructor(t,e,r,n){super("MessageEvent",t,n),this.tag=e,this.payload=r}}},,function(t,e,r){r.d(e,"a",function(){return a});var n=r(0);class a extends n.a{constructor(t,e,r,n,a){super("MIDIEvent",t,a),this.status=240&r[0],this.channel=15&r[0],this.port=e,this.data=r,this.length=n}}},function(module,exports,__webpack_require__){var Float32Buffer=__webpack_require__(2).Float32Buffer,Float64Buffer=__webpack_require__(2).Float64Buffer,IntBuffer=__webpack_require__(2).IntBuffer,UInt8Buffer=__webpack_require__(2).UInt8Buffer,ExternalLoaderFactory=__webpack_require__(8).ExternalLoaderFactory,patcherSerialKey="XX__PatcherSerialKey__XX",eventTargetKey="XX__EventTargetKey__XX",ParameterTypeNumber=0,ParameterTypeBang=1,ParameterTypeList=2,ParameterTypeSignal=3,ParameterTypeCount=4,IOTypeInput=0,IOTypeOutput=1,IOTypeUndefined=2;function rand01(){return Math.random()}function pi01(){return Math.PI}var abs=Math.abs,acos=Math.acos,acosh=Math.acosh,asin=Math.asin,asinh=Math.asinh,atan=Math.atan,atan2=Math.atan2,atanh=Math.atanh,cbrt=Math.cbrt,ceil=Math.ceil,clz32=Math.clz32,cos=Math.cos,cosh=Math.cosh,exp=Math.exp,expm1=Math.expm1,floor=Math.floor,fround=Math.fround,hypot=Math.hypot,imul=Math.imul,log=Math.log,log10=Math.log10,log1p=Math.log1p,log2=Math.log2,max=Math.max,min=Math.min,pow=Math.pow,random=Math.random,round=Math.round,sign=Math.sign,sin=Math.sin,sinh=Math.sinh,sqrt=Math.sqrt,tan=Math.tan,tanh=Math.tanh,trunc=Math.trunc,fabs=Math.abs,fmax=Math.max,fmod=Math.mod,isnan=function(t){return isNaN(t)};function fixnan(t){return isnan(t)?0:t}function fract(t){return t%1}function fixdenorm(t){return t}function isdenorm(t){return!1}var fastsin=Math.sin,fastcos=Math.cos,fastexp=Math.exp,fastpow=Math.pow,fasttan=Math.tan;function next_power_of_two(t){return 0===t?1:(t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)+1)}function getArrayValueAtIndex(t,e){return t[e]}function allocateArray(t,e){return new Array(t)}function createListCopy(t){return t.slice(0)}function assignList(t,e){t.length=e.length;for(let r=0;r<e.length;r++)t[r]=e[r]}function convertListToNumber(t){return t.length>0?t[0]:0}function list(){for(var t=[],e=0;e<arguments.length;e++)t.push(arguments[e]);return t}function resizeSignal(t,e){for(var r=[],n=0;n<e;n++)r[n]=0;return r}function containsValue(t){return void 0!==t}function addressOf(t){return t}function systemticks(){return Date.now()}function bitwiseFloat(t){var e=new Uint32Array(1);return e[0]=t,new DataView(e.buffer).getFloat32(0,!0)}function imul(t,e){return Math.imul(t,e)}var MIDI_StatusByteReceived=1,MIDI_SecondByteReceived=2,MIDI_NoteOff=3,MIDI_NoteOn=4,MIDI_Aftertouch=5,MIDI_CC=6,MIDI_ProgramChange=7,MIDI_ChannelPressure=8,MIDI_PitchBend=9,MIDI_Sysex_Started=10,MIDI_Sysex_Complete=11,MIDI_Generic=99,MIDI_InvalidByte=-1,MIDI_NoteOffMask=128,MIDI_NoteOnMask=144,MIDI_AfterTouchMask=160,MIDI_CCMask=176,MIDI_ProgramChangeMask=192,MIDI_ChannelPressureMask=208,MIDI_PitchBendMask=224,MIDI_CC_Sustain=64,MIDI_CC_Sostenuto=66,MIDI_CC_AllNotesOff=123,MIDI_CC_PressureMSB=70,MIDI_CC_PressureLSB=102,MIDI_CC_TimbreMSB=74,MIDI_CC_TimbreLSB=106,MIDI_NoteState_Off=0,MIDI_NoteState_On=1,MIDI_NoteState_Sustained=2,CLOCKS_PER_SEC=1;function parseMidi(t,e,r){if(240==e)return MIDI_Sysex_Started;if(t==MIDI_Sysex_Started)return 247==e?MIDI_Sysex_Complete:e<=127?t:MIDI_InvalidByte;if(e>127)return MIDI_StatusByteReceived;var n=240&r;return t==MIDI_StatusByteReceived?n==MIDI_ProgramChangeMask?MIDI_ProgramChange:n==MIDI_ChannelPressureMask?MIDI_ChannelPressure:MIDI_SecondByteReceived:t==MIDI_SecondByteReceived?n==MIDI_NoteOffMask||n==MIDI_NoteOnMask&&0==e?MIDI_NoteOff:n==MIDI_NoteOnMask?MIDI_NoteOn:n==MIDI_AfterTouchMask?MIDI_Aftertouch:n==MIDI_CCMask?MIDI_CC:n==MIDI_PitchBendMask?MIDI_PitchBend:MIDI_Generic:t}function getMIDIChannel(t){var e=240&t;return e>=128&&e<=224?15&t:0}function initDataRef(t){var e={};return e.name=t,e.isValid=!1,e.arrayBuffer=void 0,e.wantsFillFlag=!1,e.sizeInBytes=0,e.wantsFill=function(){return this.wantsFillFlag},e.getSizeInBytes=function(){return this.sizeInBytes},e}function TAG(t){let e=0;for(let r=0;r<t.length;r++){e=t.charCodeAt(r)+(e<<6)+(e<<16)-e}return 0|e}function _evalSrc(src){var rnboObj;return eval(src),rnboObj}module.exports={deserializeJSON:function(t){var e=t;return"string"==typeof e&&(e=JSON.parse(t)),_evalSrc(e.src)},extractOptionsFromJSON:function(t){var e=t;return"string"==typeof e&&(e=JSON.parse(t)),e.options?e.options:{}},ParameterTypeNumber:ParameterTypeNumber,ParameterTypeBang:ParameterTypeBang,ParameterTypeList:ParameterTypeList,ParameterTypeSignal:ParameterTypeSignal,ParameterTypeCount:ParameterTypeCount,IOTypeInput:IOTypeInput,IOTypeOutput:IOTypeOutput,IOTypeUndefined:IOTypeUndefined.length,TAG:TAG}},function(t,e,r){r.d(e,"a",function(){return a});var n=r(0);class a extends n.a{constructor(t,e,r,n,a){super("ParameterEvent",t,a),this.target=e,this.value=r,this.source=n}}},function(t,e){var r=function(){};(r.prototype=Object.create(null)).constructor=r,r.prototype.setEngineAndPatcher=function(){},r.prototype.initialize=function(){},r.prototype.getNumParameters=function(){return 0},r.prototype.setParameterValue=function(){},r.prototype.prepareToProcess=function(){},r.prototype.process=function(){},t.exports={ExternalLoaderFactory:function(){return console.log("WARNING: Externals are not yet supported in Javascript"),new r}}},,,,,,,,function(t,e,r){r.r(e);var n=r(1),a=r(7),i=r(5),s=r(3);let u=r(6);var o={ensureBuffers:function(t,e,r,n){let a=!1;for(let i=0;i<r;i++)n>t.h&&e[i]&&(t._rnbo_module._free(e[i]),e[i]=void 0),e[i]||(a=!0,e[i]=t._rnbo_module._malloc(n*Float64Array.BYTES_PER_ELEMENT));if(a){let r=e===t.I,n=r?t.M:this._;n&&t._rnbo_module._free(n),n=t._rnbo_module._malloc(e.length*Float32Array.BYTES_PER_ELEMENT),t._rnbo_module.HEAP32.set(e,n>>2),r?t.M=n:t._=n}},ensureArrayPassingHEAP(t,e){(null==t.v||t.v<e)&&(t.v=e,null!=t.D&&t._rnbo_module._free(t.D),t.D=t._rnbo_module._malloc(t.v*Float64Array.BYTES_PER_ELEMENT))},pushArray(t,e){return this.ensureArrayPassingHEAP(t,e.length),t._rnbo_module.HEAPF64.set(e,t.D>>3),t.D},retrieveArray(t){let e=[];for(var r=0;r<t.size();r++)e.push(t.get(r));return e},setup:function(t,e){let r=new e.CoreObject;t.I=[],t.O=[],t.P={},t.C=r,t._rnbo_module=e;var n={handleParameterEvent:t.handleParameterEvent.bind(t),handleMidiEvent:t.handleMidiEvent.bind(t),handleMessageEvent:t.handleMessageEvent.bind(t)},a=e.EventHandler.implement(n);t.S=r.createParameterInterface(a),t.g=0;for(let e=0;e<r.getNumParameters();e++){let n=r.getParameterInfo(e);if(n.type===u.ParameterTypeSignal&&n.IOType===u.IOTypeInput){let a=r.getParameterName(e);t.P[a]=n.signalIndex,t.g++}}t.T=r.getNumInputChannels()+t.g,t.A=r.getNumOutputChannels(),t.I=new Array(t.T),t.O=new Array(t.A),t.M=0,t._=0;this.ensureBuffers(t,t.I,t.T,128),this.ensureBuffers(t,t.O,t.A,128),this.ensureArrayPassingHEAP(t,128),t.h=128}};var h="XXXX---RNBOPROCESSORNAME_REPLACE---XXXX";h.startsWith("XXXX---RNBOPROCESSORNAME_REPLACE---")&&(h="RNBOProcessor"),registerProcessor(h,class extends AudioWorkletProcessor{constructor(t){super(t),this.B=!1,this.port.onmessage=this.onmessage,this.port.owner=this,this.port.start()}static get parameterDescriptors(){}handleParameterEvent(t){this.port.postMessage([n.a.fromProcessor.outgoingEvent,new a.a(t.time,t.index,t.value,t.source,void 0)])}handleMidiEvent(t){let e=new i.a(t.time,t.port,[t.getB1(),t.getB2(),t.getB3()],t.length,void 0);this.port.postMessage([n.a.fromProcessor.outgoingEvent,e])}handleMessageEvent(t){let e=new s.a(t.time,this.C.resolveTag(t.tag),0==t.type?t.numValue:o.retrieveArray(t.listValue));this.port.postMessage([n.a.fromProcessor.outgoingEvent,e])}onmessage(t){switch(t.data[0]){case n.a.toProcessor.setPatcher:rnbo_module().then(t=>{o.setup(this.owner,t);let e=[];for(let t=0;t<this.owner.C.getNumParameters();t++)e.push(this.owner.C.getParameterValue(t));this.owner.B=!0,this.postMessage([n.a.fromProcessor.setPatcherFinished,e])});break;case n.a.toProcessor.scheduleEvent:let e=t.data[1];"MIDIEvent"==e.type?this.owner.C.scheduleMidiEvent(e.time,e.port,e.data[0],e.data[1],e.data[2]):"ParameterEvent"==e.type?this.owner.C.scheduleParameterEvent(e.target,e.time,e.value,e.source):"MessageEvent"==e.type&&("number"==typeof e.payload?this.owner.C.sendNumMessage(e.tag,e.payload,e.time):Array.isArray(e.payload)&&this.owner.C.sendListMessage(e.tag,o.pushArray(this.owner,e.payload),e.payload.length,e.time))}}process(t,e,r){let n=0,a=0;if(!this.B)return;let i=this.A>0?e[0][0].length:this.T>0?t[0][0].length:0;i||(i=this.h),this.h<i&&(o.ensureBuffers(this,this.I,this.T,i),o.ensureBuffers(this,this.O,this.A,i),this.h=i);for(let e=0;e<t.length;e++){var s=t[e];for(let t=0;t<s.length&&n<this.T;t++)this._rnbo_module.HEAPF64.set(s[t],this.I[n]>>3),n++}for(var u in r){if(!(n<this.T))break;this._rnbo_module.HEAPF64.set(r[u],this.I[n]>>3),n++}this.C.setCurrentTime(1e3*currentTime),this.C.prepareToProcess(sampleRate,i),this.C.process(this.M,n,this._,this.A,i);for(let t=0;t<e.length;t++){var h=e[t];for(let t=0;t<h.length&&a<this.A;t++){let e=this.O[a]>>3;h[t].set(this._rnbo_module.HEAPF64.slice(e,e+h[t].length)),a++}}return!0}})}]);'},function(e,t,n){n.r(t),function(e){n.d(t,"RNBOScriptObject",function(){return g}),n.d(t,"RNBOWorkletObject",function(){return d});var r=n(10),i=n(4);n.d(t,"MIDIEvent",function(){return i.a});var a=n(1),o=n(13),s=n.n(o),c=n(25),l=n.n(c),u=n(26),h=n.n(u);let p=n(7),d={};const f=(()=>{try{if("object"==typeof WebAssembly&&"function"==typeof WebAssembly.instantiate){const e=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));if(e instanceof WebAssembly.Module)return new WebAssembly.Instance(e)instanceof WebAssembly.Instance}}catch(e){}return!1})();class m{fromRNBOtime(e){return.001*e}toRNBOtime(e){return 1e3*e}}class g extends r.a{constructor(e,t){super(!1);let n=void 0===t?1024:t;this.k=n,this.ft=e,this.et=new m,this.rebuild()}rebuild(){this.node&&this.node.disconnect(),this.node=this.ft.createScriptProcessor(this.k,this.getNumInputChannels(),Math.max(this.getNumOutputChannels(),1));const e=this,t=this.k;this.node.onaudioprocess=function(n){let r,i=[],a=[],o=n.inputBuffer,s=o?o.numberOfChannels:0;for(r=0;r<s;r++)i[r]=o.getChannelData(r);let c=n.outputBuffer,l=c?c.numberOfChannels:0;for(r=0;r<l;r++)a[r]=c.getChannelData(r);e.setCurrentTime(1e3*n.playbackTime),e.prepareToProcess(n.outputBuffer.sampleRate,t,!1),e.process(i,s,a,l,t,null,null)}}setPatcher(e){let t=this.getNumInputChannels(),n=this.getNumOutputChannels();return r.a.prototype.setPatcher.call(this,e,f).then(()=>{this.getNumInputChannels()===t&&this.getNumOutputChannels()===n||this.rebuild()})}setBufferSize(e){return this.k!==e&&(this.k=e,this.rebuild(),!0)}}let v=0;if("undefined"!=typeof AudioWorkletNode){class t extends AudioWorkletNode{constructor(e,t,n,r){super(e,"RNBOProcessor"+t,r),this.$=n,this.$.addListener("postMessage",this.postMessage.bind(this)),this.port.onmessage=this.onmessage,this.port.owner=this,this.port.start()}onmessage(e){this.owner.$.emit.apply(this.owner.$,e.data)}postMessage(e,t){this.port.postMessage([e,t])}setPatcher(e){return new Promise(t=>{this.$.once(a.a.fromProcessor.setPatcherFinished,()=>t()),this.port.postMessage([a.a.toProcessor.setPatcher,e])})}}d=class extends r.a{constructor(e){super(!0),this.ft=e,this.et=new m,this.node=e.createGain()}buildParamDescriptor(){let e="[",t=this.getNumParameters();for(let n=0;n<t;n++){let t=this.getParameterInfo(n);t.type===p.ParameterTypeSignal&&t.IOType===p.IOTypeInput&&(e+='{ name : "'+this.getParameterName(n)+'", minValue : '+(void 0===t.min?0:t.min)+", maxValue : "+(void 0===t.max?1:t.max)+"}")}return e+"]"}setPatcher(n){let i=!1,a=this.getNumInputChannels(),o=this.getNumOutputChannels(),c=this.g.getNumSignalInParameters(),u=this.g.getNumSignalOutParameters(),p=this.g.getPatcherSerial();return r.a.prototype.setPatcher.call(this,n).then(()=>{this.g.prepareToProcess(this.ft.sampleRate,128,!1),a===this.getNumInputChannels()&&o===this.getNumOutputChannels()&&c===this.g.getNumSignalInParameters()&&u===this.g.getNumSignalOutParameters()&&p===this.g.getPatcherSerial()||(i=!0),this.node&&this.node.disconnect();let r=n.hasOwnProperty("wasm")&&f;if(this.node instanceof t&&!i&&!r)return this.node.setPatcher(n);let d=r?h.a:l.a;a=this.getNumInputChannels(),o=this.getNumOutputChannels(),a<1&&(a=1),o<1&&(o=1);var m=v++;let g=d.replace("XXXX---RNBOPROCESSORNAME_REPLACE---XXXX","RNBOProcessor"+m),y=this.buildParamDescriptor();if(g=g.replace("//XXXX---RNBOPARAMDESCRIPTORS_REPLACE---XXXX",y),r){let t=n.wasm;"base64"==n.wasmEncoding&&(t=e.from(n.wasm,"base64").toString("binary"));var b=s.a.inflate(t,{to:"string"});g=(b+="\n\n")+g}let _=URL.createObjectURL(new Blob([g],{type:"text/javascript"}));return this.ft.audioWorklet.addModule(_).then(()=>(this.node=new t(this.ft,m,this.g.getEmitter(),{numberOfInputs:a,numberOfOutputs:1,outputChannelCount:[o]}),this.node.setPatcher(n)))})}}}}.call(this,n(17).Buffer)},function(e,t,n){t.byteLength=function(e){var t=l(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){for(var t,n=l(e),r=n[0],o=n[1],s=new a(3*(r+o)/4-o),c=0,u=o>0?r-4:r,h=0;h<u;h+=4)t=i[e.charCodeAt(h)]<<18|i[e.charCodeAt(h+1)]<<12|i[e.charCodeAt(h+2)]<<6|i[e.charCodeAt(h+3)],s[c++]=t>>16&255,s[c++]=t>>8&255,s[c++]=255&t;return 2===o&&(t=i[e.charCodeAt(h)]<<2|i[e.charCodeAt(h+1)]>>4,s[c++]=255&t),1===o&&(t=i[e.charCodeAt(h)]<<10|i[e.charCodeAt(h+1)]<<4|i[e.charCodeAt(h+2)]>>2,s[c++]=t>>8&255,s[c++]=255&t),s},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,a=[],o=0,s=n-i;o<s;o+=16383)a.push(u(e,o,o+16383>s?s:o+16383));return 1===i?(t=e[n-1],a.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],a.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"=")),a.join("")};for(var r=[],i=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,c=o.length;s<c;++s)r[s]=o[s],i[o.charCodeAt(s)]=s;function l(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function u(e,t,n){for(var i,a,o=[],s=t;s<n;s+=3)i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),o.push(r[(a=i)>>18&63]+r[a>>12&63]+r[a>>6&63]+r[63&a]);return o.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,i){var a,o,s=8*i-r-1,c=(1<<s)-1,l=c>>1,u=-7,h=n?i-1:0,p=n?-1:1,d=e[t+h];for(h+=p,a=d&(1<<-u)-1,d>>=-u,u+=s;u>0;a=256*a+e[t+h],h+=p,u-=8);for(o=a&(1<<-u)-1,a>>=-u,u+=r;u>0;o=256*o+e[t+h],h+=p,u-=8);if(0===a)a=1-l;else{if(a===c)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,r),a-=l}return(d?-1:1)*o*Math.pow(2,a-r)},t.write=function(e,t,n,r,i,a){var o,s,c,l=8*a-i-1,u=(1<<l)-1,h=u>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:a-1,f=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-o))<1&&(o--,c*=2),(t+=o+h>=1?p/c:p*Math.pow(2,1-h))*c>=2&&(o++,c/=2),o+h>=u?(s=0,o=u):o+h>=1?(s=(t*c-1)*Math.pow(2,i),o+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,i),o=0));i>=8;e[n+d]=255&s,d+=f,s/=256,i-=8);for(o=o<<i|s,l+=i;l>0;e[n+d]=255&o,d+=f,o/=256,l-=8);e[n+d-f]|=128*m}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){(function(e){var r=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++)n[t[r]]=Object.getOwnPropertyDescriptor(e,t[r]);return n},i=/%[sdj%]/g;t.format=function(e){if(!v(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(s(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,a=r.length,o=String(e).replace(i,function(e){if("%%"===e)return"%";if(n>=a)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}}),c=r[n];n<a;c=r[++n])m(c)||!_(c)?o+=" "+c:o+=" "+s(c);return o},t.deprecate=function(n,r){if(void 0!==e&&!0===e.noDeprecation)return n;if(void 0===e)return function(){return t.deprecate(n,r).apply(this,arguments)};var i=!1;return function(){if(!i){if(e.throwDeprecation)throw new Error(r);e.traceDeprecation?console.trace(r):console.error(r),i=!0}return n.apply(this,arguments)}};var a,o={};function s(e,n){var r={seen:[],stylize:l};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),f(n)?r.showHidden=n:n&&t.ht(r,n),y(r.showHidden)&&(r.showHidden=!1),y(r.depth)&&(r.depth=2),y(r.colors)&&(r.colors=!1),y(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=c),u(r,e,r.depth)}function c(e,t){var n=s.styles[t];return n?"["+s.colors[n][0]+"m"+e+"["+s.colors[n][1]+"m":e}function l(e,t){return e}function u(e,n,r){if(e.customInspect&&n&&E(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,e);return v(i)||(i=u(e,i,r)),i}var a=function(e,t){if(y(t))return e.stylize("undefined","undefined");if(v(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return g(t)?e.stylize(""+t,"number"):f(t)?e.stylize(""+t,"boolean"):m(t)?e.stylize("null","null"):void 0}(e,n);if(a)return a;var o=Object.keys(n),s=function(e){var t={};return o.forEach(function(e,n){t[e]=!0}),t}();if(e.showHidden&&(o=Object.getOwnPropertyNames(n)),x(n)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return h(n);if(0===o.length){if(E(n)){var c=n.name?": "+n.name:"";return e.stylize("[Function"+c+"]","special")}if(b(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(w(n))return e.stylize(Date.prototype.toString.call(n),"date");if(x(n))return h(n)}var l,_="",M=!1,S=["{","}"];return d(n)&&(M=!0,S=["[","]"]),E(n)&&(_=" [Function"+(n.name?": "+n.name:"")+"]"),b(n)&&(_=" "+RegExp.prototype.toString.call(n)),w(n)&&(_=" "+Date.prototype.toUTCString.call(n)),x(n)&&(_=" "+h(n)),0!==o.length||M&&0!=n.length?r<0?b(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),l=M?function(e,t,n,r,i){for(var a=[],o=0,s=t.length;o<s;++o)P(t,String(o))?a.push(p(e,t,n,r,String(o),!0)):a.push("");return i.forEach(function(i){i.match(/^\d+$/)||a.push(p(e,t,n,r,i,!0))}),a}(e,n,r,s,o):o.map(function(t){return p(e,n,r,s,t,M)}),e.seen.pop(),function(e,t,n){return e.reduce(function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}(l,_,S)):S[0]+_+S[1]}function h(e){return"["+Error.prototype.toString.call(e)+"]"}function p(e,t,n,r,i,a){var o,s,c;if((c=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?s=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(s=e.stylize("[Setter]","special")),P(r,i)||(o="["+i+"]"),s||(e.seen.indexOf(c.value)<0?(s=m(n)?u(e,c.value,null):u(e,c.value,n-1)).indexOf("\n")>-1&&(s=a?s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+s.split("\n").map(function(e){return"   "+e}).join("\n")):s=e.stylize("[Circular]","special")),y(o)){if(a&&i.match(/^\d+$/))return s;(o=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=e.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=e.stylize(o,"string"))}return o+": "+s}function d(e){return Array.isArray(e)}function f(e){return"boolean"==typeof e}function m(e){return null===e}function g(e){return"number"==typeof e}function v(e){return"string"==typeof e}function y(e){return void 0===e}function b(e){return _(e)&&"[object RegExp]"===M(e)}function _(e){return"object"==typeof e&&null!==e}function w(e){return _(e)&&"[object Date]"===M(e)}function x(e){return _(e)&&("[object Error]"===M(e)||e instanceof Error)}function E(e){return"function"==typeof e}function M(e){return Object.prototype.toString.call(e)}function S(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(n){if(y(a)&&(a=e.env.NODE_DEBUG||""),n=n.toUpperCase(),!o[n])if(new RegExp("\\b"+n+"\\b","i").test(a)){var r=e.pid;o[n]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",n,r,e)}}else o[n]=function(){};return o[n]},t.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=d,t.isBoolean=f,t.isNull=m,t.isNullOrUndefined=function(e){return null==e},t.isNumber=g,t.isString=v,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=y,t.isRegExp=b,t.isObject=_,t.isDate=w,t.isError=x,t.isFunction=E,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=n(33);var T=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function P(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){var e,n;console.log("%s - %s",(n=[S((e=new Date).getHours()),S(e.getMinutes()),S(e.getSeconds())].join(":"),[e.getDate(),T[e.getMonth()],n].join(" ")),t.format.apply(t,arguments))},t.inherits=n(34),t.ht=function(e,t){if(!t||!_(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e};var A="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function O(e,t){if(!e){var n=new Error("Promise was rejected with a falsy value");n.reason=e,e=n}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(A&&e[A]){var t;if("function"!=typeof(t=e[A]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,A,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,n,r=new Promise(function(e,r){t=e,n=r}),i=[],a=0;a<arguments.length;a++)i.push(arguments[a]);i.push(function(e,r){e?n(e):t(r)});try{e.apply(this,i)}catch(e){n(e)}return r}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),A&&Object.defineProperty(t,A,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,r(e))},t.promisify.custom=A,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],r=0;r<arguments.length;r++)n.push(arguments[r]);var i=n.pop();if("function"!=typeof i)throw new TypeError("The last argument must be of type Function");var a=this,o=function(){return i.apply(a,arguments)};t.apply(this,n).then(function(t){e.nextTick(o,null,t)},function(t){e.nextTick(O,t,o)})}return Object.setPrototypeOf(n,Object.getPrototypeOf(t)),Object.defineProperties(n,r(t)),n}}).call(this,n(32))},function(e,t){var n,r,i=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(e){n=a}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var c,l=[],u=!1,h=-1;function p(){u&&c&&(u=!1,c.length?l=c.concat(l):h=-1,l.length&&d())}function d(){if(!u){var e=s(p);u=!0;for(var t=l.length;t;){for(c=l,l=[];++h<t;)c&&c[h].run();h=-1,t=l.length}c=null,u=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new f(e,t)),1!==l.length||u||s(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t){var n=function(){};(n.prototype=Object.create(null)).constructor=n,n.prototype.setEngineAndPatcher=function(){},n.prototype.initialize=function(){},n.prototype.getNumParameters=function(){return 0},n.prototype.setParameterValue=function(){},n.prototype.prepareToProcess=function(){},n.prototype.process=function(){},e.exports={ExternalLoaderFactory:function(){return console.log("WARNING: Externals are not yet supported in Javascript"),new n}}},function(e,t,n){var r=n(37),i=n(3),a=n(21),o=n(14),s=n(22),c=Object.prototype.toString,l=0,u=-1,h=0,p=8;function d(e){if(!(this instanceof d))return new d(e);this.options=i.assign({level:u,method:p,chunkSize:16384,windowBits:15,memLevel:8,strategy:h,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var n=r.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==l)throw new Error(o[n]);if(t.header&&r.deflateSetHeader(this.strm,t.header),t.dictionary){var f;if(f="string"==typeof t.dictionary?a.string2buf(t.dictionary):"[object ArrayBuffer]"===c.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(n=r.deflateSetDictionary(this.strm,f))!==l)throw new Error(o[n]);this.ct=!0}}function f(e,t){var n=new d(t);if(n.push(e,!0),n.err)throw n.msg||o[n.err];return n.result}d.prototype.push=function(e,t){var n,o,s=this.strm,u=this.options.chunkSize;if(this.ended)return!1;o=t===~~t?t:!0===t?4:0,"string"==typeof e?s.input=a.string2buf(e):"[object ArrayBuffer]"===c.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new i.Buf8(u),s.next_out=0,s.avail_out=u),1!==(n=r.deflate(s,o))&&n!==l)return this.onEnd(n),this.ended=!0,!1;0!==s.avail_out&&(0!==s.avail_in||4!==o&&2!==o)||("string"===this.options.to?this.onData(a.buf2binstring(i.shrinkBuf(s.output,s.next_out))):this.onData(i.shrinkBuf(s.output,s.next_out)))}while((s.avail_in>0||0===s.avail_out)&&1!==n);return 4===o?(n=r.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===l):2!==o||(this.onEnd(l),s.avail_out=0,!0)},d.prototype.onData=function(e){this.chunks.push(e)},d.prototype.onEnd=function(e){e===l&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Deflate=d,t.deflate=f,t.deflateRaw=function(e,t){return(t=t||{}).raw=!0,f(e,t)},t.gzip=function(e,t){return(t=t||{}).gzip=!0,f(e,t)}},function(e,t,n){var r,i=n(3),a=n(38),o=n(19),s=n(20),c=n(14),l=0,u=4,h=0,p=-2,d=-1,f=1,m=4,g=2,v=8,y=9,b=286,_=30,w=19,x=2*b+1,E=15,M=3,S=258,T=S+M+1,P=42,A=103,O=113,C=666,R=1,L=2,I=3,k=4;function N(e,t){return e.msg=c[t],t}function z(e){return(e<<1)-(e>4?9:0)}function D(e){for(var t=e.length;--t>=0;)e[t]=0}function B(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(i.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function j(e,t){a.lt(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,B(e.strm)}function F(e,t){e.pending_buf[e.pending++]=t}function U(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function V(e,t){var n,r,i=e.max_chain_length,a=e.strstart,o=e.prev_length,s=e.nice_match,c=e.strstart>e.w_size-T?e.strstart-(e.w_size-T):0,l=e.window,u=e.w_mask,h=e.prev,p=e.strstart+S,d=l[a+o-1],f=l[a+o];e.prev_length>=e.good_match&&(i>>=2),s>e.lookahead&&(s=e.lookahead);do{if(l[(n=t)+o]===f&&l[n+o-1]===d&&l[n]===l[a]&&l[++n]===l[a+1]){a+=2,n++;do{}while(l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&l[++a]===l[++n]&&a<p);if(r=S-(p-a),a=p-S,r>o){if(e.match_start=t,o=r,r>=s)break;d=l[a+o-1],f=l[a+o]}}}while((t=h[t&u])>c&&0!=--i);return o<=e.lookahead?o:e.lookahead}function H(e){var t,n,r,a,c,l,u,h,p,d,f=e.w_size;do{if(a=e.window_size-e.lookahead-e.strstart,e.strstart>=f+(f-T)){i.arraySet(e.window,e.window,f,f,0),e.match_start-=f,e.strstart-=f,e.block_start-=f,t=n=e.hash_size;do{r=e.head[--t],e.head[t]=r>=f?r-f:0}while(--n);t=n=f;do{r=e.prev[--t],e.prev[t]=r>=f?r-f:0}while(--n);a+=f}if(0===e.strm.avail_in)break;if(l=e.strm,u=e.window,h=e.strstart+e.lookahead,p=a,d=void 0,(d=l.avail_in)>p&&(d=p),n=0===d?0:(l.avail_in-=d,i.arraySet(u,l.input,l.next_in,d,h),1===l.state.wrap?l.adler=o(l.adler,u,d,h):2===l.state.wrap&&(l.adler=s(l.adler,u,d,h)),l.next_in+=d,l.total_in+=d,d),e.lookahead+=n,e.lookahead+e.insert>=M)for(c=e.strstart-e.insert,e.ins_h=e.window[c],e.ins_h=(e.ins_h<<e.hash_shift^e.window[c+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[c+M-1])&e.hash_mask,e.prev[c&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=c,c++,e.insert--,!(e.lookahead+e.insert<M)););}while(e.lookahead<T&&0!==e.strm.avail_in)}function G(e,t){for(var n,r;;){if(e.lookahead<T){if(H(e),e.lookahead<T&&t===l)return R;if(0===e.lookahead)break}if(n=0,e.lookahead>=M&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+M-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-T&&(e.match_length=V(e,n)),e.match_length>=M)if(r=a.pt(e,e.strstart-e.match_start,e.match_length-M),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=M){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+M-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=a.pt(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(j(e,!1),0===e.strm.avail_out))return R}return e.insert=e.strstart<M-1?e.strstart:M-1,t===u?(j(e,!0),0===e.strm.avail_out?I:k):e.last_lit&&(j(e,!1),0===e.strm.avail_out)?R:L}function W(e,t){for(var n,r,i;;){if(e.lookahead<T){if(H(e),e.lookahead<T&&t===l)return R;if(0===e.lookahead)break}if(n=0,e.lookahead>=M&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+M-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=M-1,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-T&&(e.match_length=V(e,n),e.match_length<=5&&(e.strategy===f||e.match_length===M&&e.strstart-e.match_start>4096)&&(e.match_length=M-1)),e.prev_length>=M&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-M,r=a.pt(e,e.strstart-1-e.prev_match,e.prev_length-M),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+M-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=M-1,e.strstart++,r&&(j(e,!1),0===e.strm.avail_out))return R}else if(e.match_available){if((r=a.pt(e,0,e.window[e.strstart-1]))&&j(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return R}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=a.pt(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<M-1?e.strstart:M-1,t===u?(j(e,!0),0===e.strm.avail_out?I:k):e.last_lit&&(j(e,!1),0===e.strm.avail_out)?R:L}function q(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}function X(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=v,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(2*x),this.dyn_dtree=new i.Buf16(2*(2*_+1)),this.bl_tree=new i.Buf16(2*(2*w+1)),D(this.dyn_ltree),D(this.dyn_dtree),D(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(E+1),this.heap=new i.Buf16(2*b+1),D(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(2*b+1),D(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Y(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=g,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?P:O,e.adler=2===t.wrap?0:1,t.last_flush=l,a.dt(t),h):N(e,p)}function K(e){var t,n=Y(e);return n===h&&((t=e.state).window_size=2*t.w_size,D(t.head),t.max_lazy_match=r[t.level].max_lazy,t.good_match=r[t.level].good_length,t.nice_match=r[t.level].nice_length,t.max_chain_length=r[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=M-1,t.match_available=0,t.ins_h=0),n}function $(e,t,n,r,a,o){if(!e)return p;var s=1;if(t===d&&(t=6),r<0?(s=0,r=-r):r>15&&(s=2,r-=16),a<1||a>y||n!==v||r<8||r>15||t<0||t>9||o<0||o>m)return N(e,p);8===r&&(r=9);var c=new X;return e.state=c,c.strm=e,c.wrap=s,c.gzhead=null,c.w_bits=r,c.w_size=1<<c.w_bits,c.w_mask=c.w_size-1,c.hash_bits=a+7,c.hash_size=1<<c.hash_bits,c.hash_mask=c.hash_size-1,c.hash_shift=~~((c.hash_bits+M-1)/M),c.window=new i.Buf8(2*c.w_size),c.head=new i.Buf16(c.hash_size),c.prev=new i.Buf16(c.w_size),c.lit_bufsize=1<<a+6,c.pending_buf_size=4*c.lit_bufsize,c.pending_buf=new i.Buf8(c.pending_buf_size),c.d_buf=1*c.lit_bufsize,c.l_buf=3*c.lit_bufsize,c.level=t,c.strategy=o,c.method=n,K(e)}r=[new q(0,0,0,0,function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(H(e),0===e.lookahead&&t===l)return R;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+n;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,j(e,!1),0===e.strm.avail_out))return R;if(e.strstart-e.block_start>=e.w_size-T&&(j(e,!1),0===e.strm.avail_out))return R}return e.insert=0,t===u?(j(e,!0),0===e.strm.avail_out?I:k):(e.strstart>e.block_start&&(j(e,!1),e.strm.avail_out),R)}),new q(4,4,8,4,G),new q(4,5,16,8,G),new q(4,6,32,32,G),new q(4,4,16,16,W),new q(8,16,32,32,W),new q(8,16,128,128,W),new q(8,32,128,256,W),new q(32,128,258,1024,W),new q(32,258,258,4096,W)],t.deflateInit=function(e,t){return $(e,t,v,15,8,0)},t.deflateInit2=$,t.deflateReset=K,t.deflateResetKeep=Y,t.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?p:(e.state.gzhead=t,h):p},t.deflate=function(e,t){var n,i,o,c;if(!e||!e.state||t>5||t<0)return e?N(e,p):p;if(i=e.state,!e.output||!e.input&&0!==e.avail_in||i.status===C&&t!==u)return N(e,0===e.avail_out?-5:p);if(i.strm=e,n=i.last_flush,i.last_flush=t,i.status===P)if(2===i.wrap)e.adler=0,F(i,31),F(i,139),F(i,8),i.gzhead?(F(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),F(i,255&i.gzhead.time),F(i,i.gzhead.time>>8&255),F(i,i.gzhead.time>>16&255),F(i,i.gzhead.time>>24&255),F(i,9===i.level?2:i.strategy>=2||i.level<2?4:0),F(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(F(i,255&i.gzhead.extra.length),F(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=s(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(F(i,0),F(i,0),F(i,0),F(i,0),F(i,0),F(i,9===i.level?2:i.strategy>=2||i.level<2?4:0),F(i,3),i.status=O);else{var d=v+(i.w_bits-8<<4)<<8;d|=(i.strategy>=2||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(d|=32),d+=31-d%31,i.status=O,U(i,d),0!==i.strstart&&(U(i,e.adler>>>16),U(i,65535&e.adler)),e.adler=1}if(69===i.status)if(i.gzhead.extra){for(o=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),B(e),o=i.pending,i.pending!==i.pending_buf_size));)F(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){o=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),B(e),o=i.pending,i.pending===i.pending_buf_size)){c=1;break}c=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,F(i,c)}while(0!==c);i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),0===c&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){o=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),B(e),o=i.pending,i.pending===i.pending_buf_size)){c=1;break}c=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,F(i,c)}while(0!==c);i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),0===c&&(i.status=A)}else i.status=A;if(i.status===A&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&B(e),i.pending+2<=i.pending_buf_size&&(F(i,255&e.adler),F(i,e.adler>>8&255),e.adler=0,i.status=O)):i.status=O),0!==i.pending){if(B(e),0===e.avail_out)return i.last_flush=-1,h}else if(0===e.avail_in&&z(t)<=z(n)&&t!==u)return N(e,-5);if(i.status===C&&0!==e.avail_in)return N(e,-5);if(0!==e.avail_in||0!==i.lookahead||t!==l&&i.status!==C){var f=2===i.strategy?function(e,t){for(var n;;){if(0===e.lookahead&&(H(e),0===e.lookahead)){if(t===l)return R;break}if(e.match_length=0,n=a.pt(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(j(e,!1),0===e.strm.avail_out))return R}return e.insert=0,t===u?(j(e,!0),0===e.strm.avail_out?I:k):e.last_lit&&(j(e,!1),0===e.strm.avail_out)?R:L}(i,t):3===i.strategy?function(e,t){for(var n,r,i,o,s=e.window;;){if(e.lookahead<=S){if(H(e),e.lookahead<=S&&t===l)return R;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=M&&e.strstart>0&&(r=s[i=e.strstart-1])===s[++i]&&r===s[++i]&&r===s[++i]){o=e.strstart+S;do{}while(r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&i<o);e.match_length=S-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=M?(n=a.pt(e,1,e.match_length-M),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=a.pt(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(j(e,!1),0===e.strm.avail_out))return R}return e.insert=0,t===u?(j(e,!0),0===e.strm.avail_out?I:k):e.last_lit&&(j(e,!1),0===e.strm.avail_out)?R:L}(i,t):r[i.level].func(i,t);if(f!==I&&f!==k||(i.status=C),f===R||f===I)return 0===e.avail_out&&(i.last_flush=-1),h;if(f===L&&(1===t?a.vt(i):5!==t&&(a.gt(i,0,0,!1),3===t&&(D(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),B(e),0===e.avail_out))return i.last_flush=-1,h}return t!==u?h:i.wrap<=0?1:(2===i.wrap?(F(i,255&e.adler),F(i,e.adler>>8&255),F(i,e.adler>>16&255),F(i,e.adler>>24&255),F(i,255&e.total_in),F(i,e.total_in>>8&255),F(i,e.total_in>>16&255),F(i,e.total_in>>24&255)):(U(i,e.adler>>>16),U(i,65535&e.adler)),B(e),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?h:1)},t.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==P&&69!==t&&73!==t&&91!==t&&t!==A&&t!==O&&t!==C?N(e,p):(e.state=null,t===O?N(e,-3):h):p},t.deflateSetDictionary=function(e,t){var n,r,a,s,c,l,u,d,f=t.length;if(!e||!e.state)return p;if(2===(s=(n=e.state).wrap)||1===s&&n.status!==P||n.lookahead)return p;for(1===s&&(e.adler=o(e.adler,t,f,0)),n.wrap=0,f>=n.w_size&&(0===s&&(D(n.head),n.strstart=0,n.block_start=0,n.insert=0),d=new i.Buf8(n.w_size),i.arraySet(d,t,f-n.w_size,n.w_size,0),t=d,f=n.w_size),c=e.avail_in,l=e.next_in,u=e.input,e.avail_in=f,e.next_in=0,e.input=t,H(n);n.lookahead>=M;){r=n.strstart,a=n.lookahead-(M-1);do{n.ins_h=(n.ins_h<<n.hash_shift^n.window[r+M-1])&n.hash_mask,n.prev[r&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=r,r++}while(--a);n.strstart=r,n.lookahead=M-1,H(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=M-1,n.match_available=0,e.next_in=l,e.input=u,e.avail_in=c,n.wrap=s,h},t.deflateInfo="pako deflate (from Nodeca project)"},function(e,t,n){var r=n(3);function i(e){for(var t=e.length;--t>=0;)e[t]=0}var a=0,o=256,s=o+1+29,c=30,l=19,u=2*s+1,h=15,p=16,d=256,f=16,m=17,g=18,v=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],y=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],b=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],_=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],w=new Array(2*(s+2));i(w);var x=new Array(2*c);i(x);var E=new Array(512);i(E);var M=new Array(256);i(M);var S=new Array(29);i(S);var T,P,A,O=new Array(c);function C(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}function R(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function L(e){return e<256?E[e]:E[256+(e>>>7)]}function I(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function k(e,t,n){e.bi_valid>p-n?(e.bi_buf|=t<<e.bi_valid&65535,I(e,e.bi_buf),e.bi_buf=t>>p-e.bi_valid,e.bi_valid+=n-p):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function N(e,t,n){k(e,n[2*t],n[2*t+1])}function z(e,t){var n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1}function D(e,t,n){var r,i,a=new Array(h+1),o=0;for(r=1;r<=h;r++)a[r]=o=o+n[r-1]<<1;for(i=0;i<=t;i++){var s=e[2*i+1];0!==s&&(e[2*i]=z(a[s]++,s))}}function B(e){var t;for(t=0;t<s;t++)e.dyn_ltree[2*t]=0;for(t=0;t<c;t++)e.dyn_dtree[2*t]=0;for(t=0;t<l;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*d]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function j(e){e.bi_valid>8?I(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function F(e,t,n,r){var i=2*t,a=2*n;return e[i]<e[a]||e[i]===e[a]&&r[t]<=r[n]}function U(e,t,n){for(var r=e.heap[n],i=n<<1;i<=e.heap_len&&(i<e.heap_len&&F(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!F(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r}function V(e,t,n){var r,i,a,s,c=0;if(0!==e.last_lit)do{r=e.pending_buf[e.d_buf+2*c]<<8|e.pending_buf[e.d_buf+2*c+1],i=e.pending_buf[e.l_buf+c],c++,0===r?N(e,i,t):(N(e,(a=M[i])+o+1,t),0!==(s=v[a])&&k(e,i-=S[a],s),N(e,a=L(--r),n),0!==(s=y[a])&&k(e,r-=O[a],s))}while(c<e.last_lit);N(e,d,t)}function H(e,t){var n,r,i,a=t.dyn_tree,o=t.stat_desc.static_tree,s=t.stat_desc.has_stree,c=t.stat_desc.elems,l=-1;for(e.heap_len=0,e.heap_max=u,n=0;n<c;n++)0!==a[2*n]?(e.heap[++e.heap_len]=l=n,e.depth[n]=0):a[2*n+1]=0;for(;e.heap_len<2;)a[2*(i=e.heap[++e.heap_len]=l<2?++l:0)]=1,e.depth[i]=0,e.opt_len--,s&&(e.static_len-=o[2*i+1]);for(t.max_code=l,n=e.heap_len>>1;n>=1;n--)U(e,a,n);i=c;do{n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],U(e,a,1),r=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=r,a[2*i]=a[2*n]+a[2*r],e.depth[i]=(e.depth[n]>=e.depth[r]?e.depth[n]:e.depth[r])+1,a[2*n+1]=a[2*r+1]=i,e.heap[1]=i++,U(e,a,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,r,i,a,o,s,c=t.dyn_tree,l=t.max_code,p=t.stat_desc.static_tree,d=t.stat_desc.has_stree,f=t.stat_desc.extra_bits,m=t.stat_desc.extra_base,g=t.stat_desc.max_length,v=0;for(a=0;a<=h;a++)e.bl_count[a]=0;for(c[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<u;n++)(a=c[2*c[2*(r=e.heap[n])+1]+1]+1)>g&&(a=g,v++),c[2*r+1]=a,r>l||(e.bl_count[a]++,o=0,r>=m&&(o=f[r-m]),s=c[2*r],e.opt_len+=s*(a+o),d&&(e.static_len+=s*(p[2*r+1]+o)));if(0!==v){do{for(a=g-1;0===e.bl_count[a];)a--;e.bl_count[a]--,e.bl_count[a+1]+=2,e.bl_count[g]--,v-=2}while(v>0);for(a=g;0!==a;a--)for(r=e.bl_count[a];0!==r;)(i=e.heap[--n])>l||(c[2*i+1]!==a&&(e.opt_len+=(a-c[2*i+1])*c[2*i],c[2*i+1]=a),r--)}}(e,t),D(a,l,e.bl_count)}function G(e,t,n){var r,i,a=-1,o=t[1],s=0,c=7,l=4;for(0===o&&(c=138,l=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)i=o,o=t[2*(r+1)+1],++s<c&&i===o||(s<l?e.bl_tree[2*i]+=s:0!==i?(i!==a&&e.bl_tree[2*i]++,e.bl_tree[2*f]++):s<=10?e.bl_tree[2*m]++:e.bl_tree[2*g]++,s=0,a=i,0===o?(c=138,l=3):i===o?(c=6,l=3):(c=7,l=4))}function W(e,t,n){var r,i,a=-1,o=t[1],s=0,c=7,l=4;for(0===o&&(c=138,l=3),r=0;r<=n;r++)if(i=o,o=t[2*(r+1)+1],!(++s<c&&i===o)){if(s<l)do{N(e,i,e.bl_tree)}while(0!=--s);else 0!==i?(i!==a&&(N(e,i,e.bl_tree),s--),N(e,f,e.bl_tree),k(e,s-3,2)):s<=10?(N(e,m,e.bl_tree),k(e,s-3,3)):(N(e,g,e.bl_tree),k(e,s-11,7));s=0,a=i,0===o?(c=138,l=3):i===o?(c=6,l=3):(c=7,l=4)}}i(O);var q=!1;function X(e,t,n,i){k(e,(a<<1)+(i?1:0),3),function(e,t,n,i){j(e),I(e,n),I(e,~n),r.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}(e,t,n)}t.dt=function(e){q||(function(){var e,t,n,r,i,a=new Array(h+1);for(n=0,r=0;r<28;r++)for(S[r]=n,e=0;e<1<<v[r];e++)M[n++]=r;for(M[n-1]=r,i=0,r=0;r<16;r++)for(O[r]=i,e=0;e<1<<y[r];e++)E[i++]=r;for(i>>=7;r<c;r++)for(O[r]=i<<7,e=0;e<1<<y[r]-7;e++)E[256+i++]=r;for(t=0;t<=h;t++)a[t]=0;for(e=0;e<=143;)w[2*e+1]=8,e++,a[8]++;for(;e<=255;)w[2*e+1]=9,e++,a[9]++;for(;e<=279;)w[2*e+1]=7,e++,a[7]++;for(;e<=287;)w[2*e+1]=8,e++,a[8]++;for(D(w,s+1,a),e=0;e<c;e++)x[2*e+1]=5,x[2*e]=z(e,5);T=new C(w,v,o+1,s,h),P=new C(x,y,0,c,h),A=new C(new Array(0),b,0,l,7)}(),q=!0),e.l_desc=new R(e.dyn_ltree,T),e.d_desc=new R(e.dyn_dtree,P),e.bl_desc=new R(e.bl_tree,A),e.bi_buf=0,e.bi_valid=0,B(e)},t.gt=X,t.lt=function(e,t,n,r){var i,a,s=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<o;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),H(e,e.l_desc),H(e,e.d_desc),s=function(e){var t;for(G(e,e.dyn_ltree,e.l_desc.max_code),G(e,e.dyn_dtree,e.d_desc.max_code),H(e,e.bl_desc),t=l-1;t>=3&&0===e.bl_tree[2*_[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),i=e.opt_len+3+7>>>3,(a=e.static_len+3+7>>>3)<=i&&(i=a)):i=a=n+5,n+4<=i&&-1!==t?X(e,t,n,r):4===e.strategy||a===i?(k(e,2+(r?1:0),3),V(e,w,x)):(k(e,4+(r?1:0),3),function(e,t,n,r){var i;for(k(e,t-257,5),k(e,n-1,5),k(e,r-4,4),i=0;i<r;i++)k(e,e.bl_tree[2*_[i]+1],3);W(e,e.dyn_ltree,t-1),W(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),V(e,e.dyn_ltree,e.dyn_dtree)),B(e),r&&j(e)},t.pt=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(M[n]+o+1)]++,e.dyn_dtree[2*L(t)]++),e.last_lit===e.lit_bufsize-1},t.vt=function(e){k(e,2,3),N(e,d,w),function(e){16===e.bi_valid?(I(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},function(e,t,n){var r=n(40),i=n(3),a=n(21),o=n(23),s=n(14),c=n(22),l=n(43),u=Object.prototype.toString;function h(e){if(!(this instanceof h))return new h(e);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var n=r.inflateInit2(this.strm,t.windowBits);if(n!==o.Z_OK)throw new Error(s[n]);if(this.header=new l,r.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=a.string2buf(t.dictionary):"[object ArrayBuffer]"===u.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=r.inflateSetDictionary(this.strm,t.dictionary))!==o.Z_OK))throw new Error(s[n])}function p(e,t){var n=new h(t);if(n.push(e,!0),n.err)throw n.msg||s[n.err];return n.result}h.prototype.push=function(e,t){var n,s,c,l,h,p=this.strm,d=this.options.chunkSize,f=this.options.dictionary,m=!1;if(this.ended)return!1;s=t===~~t?t:!0===t?o.Z_FINISH:o.Z_NO_FLUSH,"string"==typeof e?p.input=a.binstring2buf(e):"[object ArrayBuffer]"===u.call(e)?p.input=new Uint8Array(e):p.input=e,p.next_in=0,p.avail_in=p.input.length;do{if(0===p.avail_out&&(p.output=new i.Buf8(d),p.next_out=0,p.avail_out=d),(n=r.inflate(p,o.Z_NO_FLUSH))===o.Z_NEED_DICT&&f&&(n=r.inflateSetDictionary(this.strm,f)),n===o.Z_BUF_ERROR&&!0===m&&(n=o.Z_OK,m=!1),n!==o.Z_STREAM_END&&n!==o.Z_OK)return this.onEnd(n),this.ended=!0,!1;p.next_out&&(0!==p.avail_out&&n!==o.Z_STREAM_END&&(0!==p.avail_in||s!==o.Z_FINISH&&s!==o.Z_SYNC_FLUSH)||("string"===this.options.to?(c=a.utf8border(p.output,p.next_out),l=p.next_out-c,h=a.buf2string(p.output,c),p.next_out=l,p.avail_out=d-l,l&&i.arraySet(p.output,p.output,c,l,0),this.onData(h)):this.onData(i.shrinkBuf(p.output,p.next_out)))),0===p.avail_in&&0===p.avail_out&&(m=!0)}while((p.avail_in>0||0===p.avail_out)&&n!==o.Z_STREAM_END);return n===o.Z_STREAM_END&&(s=o.Z_FINISH),s===o.Z_FINISH?(n=r.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===o.Z_OK):s!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),p.avail_out=0,!0)},h.prototype.onData=function(e){this.chunks.push(e)},h.prototype.onEnd=function(e){e===o.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Inflate=h,t.inflate=p,t.inflateRaw=function(e,t){return(t=t||{}).raw=!0,p(e,t)},t.ungzip=p},function(e,t,n){var r=n(3),i=n(19),a=n(20),o=n(41),s=n(42),c=1,l=2,u=0,h=-2,p=1,d=12,f=30,m=852,g=592;function v(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function y(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function b(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=p,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new r.Buf32(m),t.distcode=t.distdyn=new r.Buf32(g),t.sane=1,t.back=-1,u):h}function _(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,b(e)):h}function w(e,t){var n,r;return e&&e.state?(r=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?h:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,_(e))):h}function x(e,t){var n,r;return e?(r=new y,e.state=r,r.window=null,(n=w(e,t))!==u&&(e.state=null),n):h}var E,M,S=!0;function T(e){if(S){var t;for(E=new r.Buf32(512),M=new r.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(s(c,e.lens,0,288,E,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;s(l,e.lens,0,32,M,0,e.work,{bits:5}),S=!1}e.lencode=E,e.lenbits=9,e.distcode=M,e.distbits=5}function P(e,t,n,i){var a,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new r.Buf8(o.wsize)),i>=o.wsize?(r.arraySet(o.window,t,n-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):((a=o.wsize-o.wnext)>i&&(a=i),r.arraySet(o.window,t,n-i,a,o.wnext),(i-=a)?(r.arraySet(o.window,t,n-i,i,0),o.wnext=i,o.whave=o.wsize):(o.wnext+=a,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=a))),0}t.inflateReset=_,t.inflateReset2=w,t.inflateResetKeep=b,t.inflateInit=function(e){return x(e,15)},t.inflateInit2=x,t.inflate=function(e,t){var n,m,g,y,b,_,w,x,E,M,S,A,O,C,R,L,I,k,N,z,D,B,j,F,U=0,V=new r.Buf8(4),H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return h;(n=e.state).mode===d&&(n.mode=13),b=e.next_out,g=e.output,w=e.avail_out,y=e.next_in,m=e.input,_=e.avail_in,x=n.hold,E=n.bits,M=_,S=w,B=u;e:for(;;)switch(n.mode){case p:if(0===n.wrap){n.mode=13;break}for(;E<16;){if(0===_)break e;_--,x+=m[y++]<<E,E+=8}if(2&n.wrap&&35615===x){n.check=0,V[0]=255&x,V[1]=x>>>8&255,n.check=a(n.check,V,2,0),x=0,E=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&x)<<8)+(x>>8))%31){e.msg="incorrect header check",n.mode=f;break}if(8!=(15&x)){e.msg="unknown compression method",n.mode=f;break}if(E-=4,D=8+(15&(x>>>=4)),0===n.wbits)n.wbits=D;else if(D>n.wbits){e.msg="invalid window size",n.mode=f;break}n.dmax=1<<D,e.adler=n.check=1,n.mode=512&x?10:d,x=0,E=0;break;case 2:for(;E<16;){if(0===_)break e;_--,x+=m[y++]<<E,E+=8}if(n.flags=x,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=f;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=f;break}n.head&&(n.head.text=x>>8&1),512&n.flags&&(V[0]=255&x,V[1]=x>>>8&255,n.check=a(n.check,V,2,0)),x=0,E=0,n.mode=3;case 3:for(;E<32;){if(0===_)break e;_--,x+=m[y++]<<E,E+=8}n.head&&(n.head.time=x),512&n.flags&&(V[0]=255&x,V[1]=x>>>8&255,V[2]=x>>>16&255,V[3]=x>>>24&255,n.check=a(n.check,V,4,0)),x=0,E=0,n.mode=4;case 4:for(;E<16;){if(0===_)break e;_--,x+=m[y++]<<E,E+=8}n.head&&(n.head.xflags=255&x,n.head.os=x>>8),512&n.flags&&(V[0]=255&x,V[1]=x>>>8&255,n.check=a(n.check,V,2,0)),x=0,E=0,n.mode=5;case 5:if(1024&n.flags){for(;E<16;){if(0===_)break e;_--,x+=m[y++]<<E,E+=8}n.length=x,n.head&&(n.head.extra_len=x),512&n.flags&&(V[0]=255&x,V[1]=x>>>8&255,n.check=a(n.check,V,2,0)),x=0,E=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((A=n.length)>_&&(A=_),A&&(n.head&&(D=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),r.arraySet(n.head.extra,m,y,A,D)),512&n.flags&&(n.check=a(n.check,m,A,y)),_-=A,y+=A,n.length-=A),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===_)break e;A=0;do{D=m[y+A++],n.head&&D&&n.length<65536&&(n.head.name+=String.fromCharCode(D))}while(D&&A<_);if(512&n.flags&&(n.check=a(n.check,m,A,y)),_-=A,y+=A,D)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===_)break e;A=0;do{D=m[y+A++],n.head&&D&&n.length<65536&&(n.head.comment+=String.fromCharCode(D))}while(D&&A<_);if(512&n.flags&&(n.check=a(n.check,m,A,y)),_-=A,y+=A,D)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;E<16;){if(0===_)break e;_--,x+=m[y++]<<E,E+=8}if(x!==(65535&n.check)){e.msg="header crc mismatch",n.mode=f;break}x=0,E=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=d;break;case 10:for(;E<32;){if(0===_)break e;_--,x+=m[y++]<<E,E+=8}e.adler=n.check=v(x),x=0,E=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=b,e.avail_out=w,e.next_in=y,e.avail_in=_,n.hold=x,n.bits=E,2;e.adler=n.check=1,n.mode=d;case d:if(5===t||6===t)break e;case 13:if(n.last){x>>>=7&E,E-=7&E,n.mode=27;break}for(;E<3;){if(0===_)break e;_--,x+=m[y++]<<E,E+=8}switch(n.last=1&x,E-=1,3&(x>>>=1)){case 0:n.mode=14;break;case 1:if(T(n),n.mode=20,6===t){x>>>=2,E-=2;break e}break;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=f}x>>>=2,E-=2;break;case 14:for(x>>>=7&E,E-=7&E;E<32;){if(0===_)break e;_--,x+=m[y++]<<E,E+=8}if((65535&x)!=(x>>>16^65535)){e.msg="invalid stored block lengths",n.mode=f;break}if(n.length=65535&x,x=0,E=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(A=n.length){if(A>_&&(A=_),A>w&&(A=w),0===A)break e;r.arraySet(g,m,y,A,b),_-=A,y+=A,w-=A,b+=A,n.length-=A;break}n.mode=d;break;case 17:for(;E<14;){if(0===_)break e;_--,x+=m[y++]<<E,E+=8}if(n.nlen=257+(31&x),x>>>=5,E-=5,n.ndist=1+(31&x),x>>>=5,E-=5,n.ncode=4+(15&x),x>>>=4,E-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=f;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;E<3;){if(0===_)break e;_--,x+=m[y++]<<E,E+=8}n.lens[H[n.have++]]=7&x,x>>>=3,E-=3}for(;n.have<19;)n.lens[H[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,j={bits:n.lenbits},B=s(0,n.lens,0,19,n.lencode,0,n.work,j),n.lenbits=j.bits,B){e.msg="invalid code lengths set",n.mode=f;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;L=(U=n.lencode[x&(1<<n.lenbits)-1])>>>16&255,I=65535&U,!((R=U>>>24)<=E);){if(0===_)break e;_--,x+=m[y++]<<E,E+=8}if(I<16)x>>>=R,E-=R,n.lens[n.have++]=I;else{if(16===I){for(F=R+2;E<F;){if(0===_)break e;_--,x+=m[y++]<<E,E+=8}if(x>>>=R,E-=R,0===n.have){e.msg="invalid bit length repeat",n.mode=f;break}D=n.lens[n.have-1],A=3+(3&x),x>>>=2,E-=2}else if(17===I){for(F=R+3;E<F;){if(0===_)break e;_--,x+=m[y++]<<E,E+=8}E-=R,D=0,A=3+(7&(x>>>=R)),x>>>=3,E-=3}else{for(F=R+7;E<F;){if(0===_)break e;_--,x+=m[y++]<<E,E+=8}E-=R,D=0,A=11+(127&(x>>>=R)),x>>>=7,E-=7}if(n.have+A>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=f;break}for(;A--;)n.lens[n.have++]=D}}if(n.mode===f)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=f;break}if(n.lenbits=9,j={bits:n.lenbits},B=s(c,n.lens,0,n.nlen,n.lencode,0,n.work,j),n.lenbits=j.bits,B){e.msg="invalid literal/lengths set",n.mode=f;break}if(n.distbits=6,n.distcode=n.distdyn,j={bits:n.distbits},B=s(l,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,j),n.distbits=j.bits,B){e.msg="invalid distances set",n.mode=f;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(_>=6&&w>=258){e.next_out=b,e.avail_out=w,e.next_in=y,e.avail_in=_,n.hold=x,n.bits=E,o(e,S),b=e.next_out,g=e.output,w=e.avail_out,y=e.next_in,m=e.input,_=e.avail_in,x=n.hold,E=n.bits,n.mode===d&&(n.back=-1);break}for(n.back=0;L=(U=n.lencode[x&(1<<n.lenbits)-1])>>>16&255,I=65535&U,!((R=U>>>24)<=E);){if(0===_)break e;_--,x+=m[y++]<<E,E+=8}if(L&&0==(240&L)){for(k=R,N=L,z=I;L=(U=n.lencode[z+((x&(1<<k+N)-1)>>k)])>>>16&255,I=65535&U,!(k+(R=U>>>24)<=E);){if(0===_)break e;_--,x+=m[y++]<<E,E+=8}x>>>=k,E-=k,n.back+=k}if(x>>>=R,E-=R,n.back+=R,n.length=I,0===L){n.mode=26;break}if(32&L){n.back=-1,n.mode=d;break}if(64&L){e.msg="invalid literal/length code",n.mode=f;break}n.extra=15&L,n.mode=22;case 22:if(n.extra){for(F=n.extra;E<F;){if(0===_)break e;_--,x+=m[y++]<<E,E+=8}n.length+=x&(1<<n.extra)-1,x>>>=n.extra,E-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;L=(U=n.distcode[x&(1<<n.distbits)-1])>>>16&255,I=65535&U,!((R=U>>>24)<=E);){if(0===_)break e;_--,x+=m[y++]<<E,E+=8}if(0==(240&L)){for(k=R,N=L,z=I;L=(U=n.distcode[z+((x&(1<<k+N)-1)>>k)])>>>16&255,I=65535&U,!(k+(R=U>>>24)<=E);){if(0===_)break e;_--,x+=m[y++]<<E,E+=8}x>>>=k,E-=k,n.back+=k}if(x>>>=R,E-=R,n.back+=R,64&L){e.msg="invalid distance code",n.mode=f;break}n.offset=I,n.extra=15&L,n.mode=24;case 24:if(n.extra){for(F=n.extra;E<F;){if(0===_)break e;_--,x+=m[y++]<<E,E+=8}n.offset+=x&(1<<n.extra)-1,x>>>=n.extra,E-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=f;break}n.mode=25;case 25:if(0===w)break e;if(A=S-w,n.offset>A){if((A=n.offset-A)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=f;break}A>n.wnext?(A-=n.wnext,O=n.wsize-A):O=n.wnext-A,A>n.length&&(A=n.length),C=n.window}else C=g,O=b-n.offset,A=n.length;A>w&&(A=w),w-=A,n.length-=A;do{g[b++]=C[O++]}while(--A);0===n.length&&(n.mode=21);break;case 26:if(0===w)break e;g[b++]=n.length,w--,n.mode=21;break;case 27:if(n.wrap){for(;E<32;){if(0===_)break e;_--,x|=m[y++]<<E,E+=8}if(S-=w,e.total_out+=S,n.total+=S,S&&(e.adler=n.check=n.flags?a(n.check,g,S,b-S):i(n.check,g,S,b-S)),S=w,(n.flags?x:v(x))!==n.check){e.msg="incorrect data check",n.mode=f;break}x=0,E=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;E<32;){if(0===_)break e;_--,x+=m[y++]<<E,E+=8}if(x!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=f;break}x=0,E=0}n.mode=29;case 29:B=1;break e;case f:B=-3;break e;case 31:return-4;case 32:default:return h}return e.next_out=b,e.avail_out=w,e.next_in=y,e.avail_in=_,n.hold=x,n.bits=E,(n.wsize||S!==e.avail_out&&n.mode<f&&(n.mode<27||4!==t))&&P(e,e.output,e.next_out,S-e.avail_out)?(n.mode=31,-4):(M-=e.avail_in,S-=e.avail_out,e.total_in+=M,e.total_out+=S,n.total+=S,n.wrap&&S&&(e.adler=n.check=n.flags?a(n.check,g,S,e.next_out-S):i(n.check,g,S,e.next_out-S)),e.data_type=n.bits+(n.last?64:0)+(n.mode===d?128:0)+(20===n.mode||15===n.mode?256:0),(0===M&&0===S||4===t)&&B===u&&(B=-5),B)},t.inflateEnd=function(e){if(!e||!e.state)return h;var t=e.state;return t.window&&(t.window=null),e.state=null,u},t.inflateGetHeader=function(e,t){var n;return e&&e.state?0==(2&(n=e.state).wrap)?h:(n.head=t,t.done=!1,u):h},t.inflateSetDictionary=function(e,t){var n,r=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?h:11===n.mode&&i(1,t,r,0)!==n.check?-3:P(e,t,r,r)?(n.mode=31,-4):(n.havedict=1,u):h},t.inflateInfo="pako inflate (from Nodeca project)"},function(e,t,n){e.exports=function(e,t){var n,r,i,a,o,s,c,l,u,h,p,d,f,m,g,v,y,b,_,w,x,E,M,S,T;n=e.state,r=e.next_in,S=e.input,i=r+(e.avail_in-5),a=e.next_out,T=e.output,o=a-(t-e.avail_out),s=a+(e.avail_out-257),c=n.dmax,l=n.wsize,u=n.whave,h=n.wnext,p=n.window,d=n.hold,f=n.bits,m=n.lencode,g=n.distcode,v=(1<<n.lenbits)-1,y=(1<<n.distbits)-1;e:do{f<15&&(d+=S[r++]<<f,f+=8,d+=S[r++]<<f,f+=8),b=m[d&v];t:for(;;){if(d>>>=_=b>>>24,f-=_,0==(_=b>>>16&255))T[a++]=65535&b;else{if(!(16&_)){if(0==(64&_)){b=m[(65535&b)+(d&(1<<_)-1)];continue t}if(32&_){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}w=65535&b,(_&=15)&&(f<_&&(d+=S[r++]<<f,f+=8),w+=d&(1<<_)-1,d>>>=_,f-=_),f<15&&(d+=S[r++]<<f,f+=8,d+=S[r++]<<f,f+=8),b=g[d&y];n:for(;;){if(d>>>=_=b>>>24,f-=_,!(16&(_=b>>>16&255))){if(0==(64&_)){b=g[(65535&b)+(d&(1<<_)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(x=65535&b,f<(_&=15)&&(d+=S[r++]<<f,(f+=8)<_&&(d+=S[r++]<<f,f+=8)),(x+=d&(1<<_)-1)>c){e.msg="invalid distance too far back",n.mode=30;break e}if(d>>>=_,f-=_,x>(_=a-o)){if((_=x-_)>u&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(E=0,M=p,0===h){if(E+=l-_,_<w){w-=_;do{T[a++]=p[E++]}while(--_);E=a-x,M=T}}else if(h<_){if(E+=l+h-_,(_-=h)<w){w-=_;do{T[a++]=p[E++]}while(--_);if(E=0,h<w){w-=_=h;do{T[a++]=p[E++]}while(--_);E=a-x,M=T}}}else if(E+=h-_,_<w){w-=_;do{T[a++]=p[E++]}while(--_);E=a-x,M=T}for(;w>2;)T[a++]=M[E++],T[a++]=M[E++],T[a++]=M[E++],w-=3;w&&(T[a++]=M[E++],w>1&&(T[a++]=M[E++]))}else{E=a-x;do{T[a++]=T[E++],T[a++]=T[E++],T[a++]=T[E++],w-=3}while(w>2);w&&(T[a++]=T[E++],w>1&&(T[a++]=T[E++]))}break}}break}}while(r<i&&a<s);r-=w=f>>3,d&=(1<<(f-=w<<3))-1,e.next_in=r,e.next_out=a,e.avail_in=r<i?i-r+5:5-(r-i),e.avail_out=a<s?s-a+257:257-(a-s),n.hold=d,n.bits=f}},function(e,t,n){var r=n(3),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(e,t,n,c,l,u,h,p){var d,f,m,g,v,y,b,_,w,x=p.bits,E=0,M=0,S=0,T=0,P=0,A=0,O=0,C=0,R=0,L=0,I=null,k=0,N=new r.Buf16(16),z=new r.Buf16(16),D=null,B=0;for(E=0;E<=15;E++)N[E]=0;for(M=0;M<c;M++)N[t[n+M]]++;for(P=x,T=15;T>=1&&0===N[T];T--);if(P>T&&(P=T),0===T)return l[u++]=20971520,l[u++]=20971520,p.bits=1,0;for(S=1;S<T&&0===N[S];S++);for(P<S&&(P=S),C=1,E=1;E<=15;E++)if(C<<=1,(C-=N[E])<0)return-1;if(C>0&&(0===e||1!==T))return-1;for(z[1]=0,E=1;E<15;E++)z[E+1]=z[E]+N[E];for(M=0;M<c;M++)0!==t[n+M]&&(h[z[t[n+M]]++]=M);if(0===e?(I=D=h,y=19):1===e?(I=i,k-=257,D=a,B-=257,y=256):(I=o,D=s,y=-1),L=0,M=0,E=S,v=u,A=P,O=0,m=-1,g=(R=1<<P)-1,1===e&&R>852||2===e&&R>592)return 1;for(;;){b=E-O,h[M]<y?(_=0,w=h[M]):h[M]>y?(_=D[B+h[M]],w=I[k+h[M]]):(_=96,w=0),d=1<<E-O,S=f=1<<A;do{l[v+(L>>O)+(f-=d)]=b<<24|_<<16|w|0}while(0!==f);for(d=1<<E-1;L&d;)d>>=1;if(0!==d?(L&=d-1,L+=d):L=0,M++,0==--N[E]){if(E===T)break;E=t[n+h[M]]}if(E>P&&(L&g)!==m){for(0===O&&(O=P),v+=S,C=1<<(A=E-O);A+O<T&&!((C-=N[A+O])<=0);)A++,C<<=1;if(R+=1<<A,1===e&&R>852||2===e&&R>592)return 1;l[m=L&g]=P<<24|A<<16|v-u|0}}return 0!==L&&(l[v+L]=E-O<<24|64<<16|0),p.bits=P,0}},function(e,t,n){e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}}])},module.exports=factory()},function(e,t,n){"use strict";function r(e,t,n,i){this.message=e,this.expected=t,this.found=n,this.location=i,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,r)}!function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n}(r,Error),r.buildMessage=function(e,t){var n={literal:function(e){return'"'+i(e.text)+'"'},class:function(e){var t,n="";for(t=0;t<e.parts.length;t++)n+=e.parts[t]instanceof Array?a(e.parts[t][0])+"-"+a(e.parts[t][1]):a(e.parts[t]);return"["+(e.inverted?"^":"")+n+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function r(e){return e.charCodeAt(0).toString(16).toUpperCase()}function i(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(e){return"\\x0"+r(e)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(e){return"\\x"+r(e)})}function a(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(e){return"\\x0"+r(e)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(e){return"\\x"+r(e)})}return"Expected "+function(e){var t,r,i,a=new Array(e.length);for(t=0;t<e.length;t++)a[t]=(i=e[t],n[i.type](i));if(a.sort(),a.length>0){for(t=1,r=1;t<a.length;t++)a[t-1]!==a[t]&&(a[r]=a[t],r++);a.length=r}switch(a.length){case 1:return a[0];case 2:return a[0]+" or "+a[1];default:return a.slice(0,-1).join(", ")+", or "+a[a.length-1]}}(e)+" but "+function(e){return e?'"'+i(e)+'"':"end of input"}(t)+" found."},e.exports={SyntaxError:r,parse:function(e,t){t=void 0!==t?t:{};var n,i={},a={music:ve},o=ve,s=function(e,t){return{header:e,voices:t}},c=function(e){return{tempo:e>0?e:120,beat:Ce}},l="\\tempo",u=he("\\tempo",!1),h=/^[.]/,p=pe(["."],!1,!1),d="=",f=he("=",!1),m=function(e,t,n){return Ce=null!==t?e/1.5:e,n},g="//",v=he("//",!1),y=function(e){return e},b=function(e){return e},_=function(e){return[e]},w=function(e){return[e]},x=function(e,t){return{notes:e,rhythm:t}},E="<",M=he("<",!1),S=function(e){return e},T=">",P=he(">",!1),A=function(e){return e},O="bd",C=he("bd",!1),R="sn",L=he("sn",!1),I="hh",k=he("hh",!1),N=function(e){return{timbre:e,pitch:0}},z=function(e,t,n){return{timbre:e>=0?"default":"rest",pitch:e>=0?12*n+e+t:-1}},D=/^[a-gr]/,B=pe([["a","g"],"r"],!1,!1),j=function(e){return{r:-1,c:0,d:2,e:4,f:5,g:7,a:9,b:11}[e]},F=function(e,t){return e.length-t.length},U="s",V=he("s",!1),H="f",G=he("f",!1),W=function(e,t){return 4+e.length-t.length},q=",",X=he(",",!1),Y="'",K=he("'",!1),$="/",Z=he("/",!1),J=function(e,t,n){var r=null===e?Oe:Ce/e;return null!==t&&(r*=1.5),null!==n&&(r/=n),Oe=r,r},Q=/^[0-9]/,ee=pe([["0","9"]],!1,!1),te=function(e){return+e.join("")},ne=/^[|]/,re=pe(["|"],!1,!1),ie=/^[ \n]/,ae=pe([" ","\n"],!1,!1),oe=0,se=[{line:1,column:1}],ce=0,le=[],ue=0;if("startRule"in t){if(!(t.startRule in a))throw new Error("Can't start parsing from rule \""+t.startRule+'".');o=a[t.startRule]}function he(e,t){return{type:"literal",text:e,ignoreCase:t}}function pe(e,t,n){return{type:"class",parts:e,inverted:t,ignoreCase:n}}function de(t){var n,r=se[t];if(r)return r;for(n=t-1;!se[n];)n--;for(r={line:(r=se[n]).line,column:r.column};n<t;)10===e.charCodeAt(n)?(r.line++,r.column=1):r.column++,n++;return se[t]=r,r}function fe(e,t){var n=de(e),r=de(t);return{start:{offset:e,line:n.line,column:n.column},end:{offset:t,line:r.line,column:r.column}}}function me(e){oe<ce||(oe>ce&&(ce=oe,le=[]),le.push(e))}function ge(e,t,n){return new r(r.buildMessage(e,t),e,t,n)}function ve(){var t,n,r;return t=oe,(n=function(){var t,n,r;return t=oe,(n=function(){var t,n,r,a,o,s,c,g,v;return t=oe,e.substr(oe,6)===l?(n=l,oe+=6):(n=i,0===ue&&me(u)),n!==i?((r=Ae())===i&&(r=null),r!==i&&(a=Te())!==i?(h.test(e.charAt(oe))?(o=e.charAt(oe),oe++):(o=i,0===ue&&me(p)),o===i&&(o=null),o!==i?((s=Ae())===i&&(s=null),s!==i?(61===e.charCodeAt(oe)?(c=d,oe++):(c=i,0===ue&&me(f)),c!==i?((g=Ae())===i&&(g=null),g!==i&&(v=Te())!==i?(n=m(a,o,v),t=n):(oe=t,t=i)):(oe=t,t=i)):(oe=t,t=i)):(oe=t,t=i)):(oe=t,t=i)):(oe=t,t=i),t}())===i&&(n=null),n!==i?((r=Ae())===i&&(r=null),r!==i?(n=c(n),t=n):(oe=t,t=i)):(oe=t,t=i),t}())!==i&&(r=function(){var t,n,r,a;if(t=[],n=oe,(r=ye())!==i?(e.substr(oe,2)===g?(a=g,oe+=2):(a=i,0===ue&&me(v)),a===i&&(a=null),a!==i?(r=y(r),n=r):(oe=n,n=i)):(oe=n,n=i),n!==i)for(;n!==i;)t.push(n),n=oe,(r=ye())!==i?(e.substr(oe,2)===g?(a=g,oe+=2):(a=i,0===ue&&me(v)),a===i&&(a=null),a!==i?(r=y(r),n=r):(oe=n,n=i)):(oe=n,n=i);else t=i;return t}())!==i?t=n=s(n,r):(oe=t,t=i),t}function ye(){var e,t,n,r,a,o,s;if(e=[],t=oe,(n=Ae())===i&&(n=null),n!==i&&(r=be())!==i?((a=Ae())===i&&(a=null),a!==i?((o=Pe())===i&&(o=null),o!==i?((s=Ae())===i&&(s=null),s!==i?t=n=b(r):(oe=t,t=i)):(oe=t,t=i)):(oe=t,t=i)):(oe=t,t=i),t!==i)for(;t!==i;)e.push(t),t=oe,(n=Ae())===i&&(n=null),n!==i&&(r=be())!==i?((a=Ae())===i&&(a=null),a!==i?((o=Pe())===i&&(o=null),o!==i?((s=Ae())===i&&(s=null),s!==i?t=n=b(r):(oe=t,t=i)):(oe=t,t=i)):(oe=t,t=i)):(oe=t,t=i);else e=i;return e}function be(){var t,n,r;return t=oe,n=oe,(r=_e())!==i&&(r=_(r)),(n=r)===i&&(n=oe,(r=we())!==i&&(r=w(r)),(n=r)===i&&(n=function(){var t,n,r,a,o,s;if(t=oe,60===e.charCodeAt(oe)?(n=E,oe++):(n=i,0===ue&&me(M)),n!==i){if(r=[],a=oe,(o=_e())===i&&(o=we()),o!==i?((s=Ae())===i&&(s=null),s!==i?(o=S(o),a=o):(oe=a,a=i)):(oe=a,a=i),a!==i)for(;a!==i;)r.push(a),a=oe,(o=_e())===i&&(o=we()),o!==i?((s=Ae())===i&&(s=null),s!==i?(o=S(o),a=o):(oe=a,a=i)):(oe=a,a=i);else r=i;r!==i?(62===e.charCodeAt(oe)?(a=T,oe++):(a=i,0===ue&&me(P)),a!==i?(n=A(r),t=n):(oe=t,t=i)):(oe=t,t=i)}else oe=t,t=i;return t}())),n!==i&&(r=function(){var t,n,r,a,o;return t=oe,(n=Te())===i&&(n=null),n!==i?(h.test(e.charAt(oe))?(r=e.charAt(oe),oe++):(r=i,0===ue&&me(p)),r===i&&(r=null),r!==i?(47===e.charCodeAt(oe)?(a=$,oe++):(a=i,0===ue&&me(Z)),a===i&&(a=null),a!==i?((o=Te())===i&&(o=null),o!==i?(n=J(n,r,o),t=n):(oe=t,t=i)):(oe=t,t=i)):(oe=t,t=i)):(oe=t,t=i),t}())!==i?t=n=x(n,r):(oe=t,t=i),t}function _e(){var t;return oe,e.substr(oe,2)===O?(t=O,oe+=2):(t=i,0===ue&&me(C)),t===i&&(e.substr(oe,2)===R?(t=R,oe+=2):(t=i,0===ue&&me(L)),t===i&&(e.substr(oe,2)===I?(t=I,oe+=2):(t=i,0===ue&&me(k)))),t!==i&&(t=N(t)),t}function we(){var t,n,r,a;return t=oe,(n=function(){var t;return oe,D.test(e.charAt(oe))?(t=e.charAt(oe),oe++):(t=i,0===ue&&me(B)),t!==i&&(t=j(t)),t}())!==i&&(r=function(){var e,t,n,r;for(e=oe,t=[],n=xe();n!==i;)t.push(n),n=xe();if(t!==i){for(n=[],r=Ee();r!==i;)n.push(r),r=Ee();n!==i?(t=F(t,n),e=t):(oe=e,e=i)}else oe=e,e=i;return e}())!==i&&(a=function(){var e,t,n,r;for(e=oe,t=[],n=Se();n!==i;)t.push(n),n=Se();if(t!==i){for(n=[],r=Me();r!==i;)n.push(r),r=Me();n!==i?(t=W(t,n),e=t):(oe=e,e=i)}else oe=e,e=i;return e}())!==i?t=n=z(n,r,a):(oe=t,t=i),t}function xe(){var t;return 115===e.charCodeAt(oe)?(t=U,oe++):(t=i,0===ue&&me(V)),t}function Ee(){var t;return 102===e.charCodeAt(oe)?(t=H,oe++):(t=i,0===ue&&me(G)),t}function Me(){var t;return 44===e.charCodeAt(oe)?(t=q,oe++):(t=i,0===ue&&me(X)),t}function Se(){var t;return 39===e.charCodeAt(oe)?(t=Y,oe++):(t=i,0===ue&&me(K)),t}function Te(){var t,n;if(oe,t=[],Q.test(e.charAt(oe))?(n=e.charAt(oe),oe++):(n=i,0===ue&&me(ee)),n!==i)for(;n!==i;)t.push(n),Q.test(e.charAt(oe))?(n=e.charAt(oe),oe++):(n=i,0===ue&&me(ee));else t=i;return t!==i&&(t=te(t)),t}function Pe(){var t,n;if(t=[],ne.test(e.charAt(oe))?(n=e.charAt(oe),oe++):(n=i,0===ue&&me(re)),n!==i)for(;n!==i;)t.push(n),ne.test(e.charAt(oe))?(n=e.charAt(oe),oe++):(n=i,0===ue&&me(re));else t=i;return t}function Ae(){var t,n;if(t=[],ie.test(e.charAt(oe))?(n=e.charAt(oe),oe++):(n=i,0===ue&&me(ae)),n!==i)for(;n!==i;)t.push(n),ie.test(e.charAt(oe))?(n=e.charAt(oe),oe++):(n=i,0===ue&&me(ae));else t=i;return t}var Oe=1,Ce=4;if((n=o())!==i&&oe===e.length)return n;throw n!==i&&oe<e.length&&me({type:"end"}),ge(le,ce<e.length?e.charAt(ce):null,ce<e.length?fe(ce,ce+1):fe(ce,ce))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(29),a=n(9),o=n(114),s=n(282),c=n(31);t.App=class extends r.Component{constructor(){super({}),this.history=a.createBrowserHistory();const e=c.isRunningOnIPhone()&&!this.hasAcknowledgedUnmuteReminder();this.state={shouldShowUnmutingGraphic:e},this.onUnmute=this.onUnmute.bind(this)}render(){return this.state.shouldShowUnmutingGraphic?r.createElement(s.UnmuteIPhoneReminder,{onUnmute:this.onUnmute}):r.createElement(i.Router,{history:this.history},r.createElement(i.Route,null,r.createElement(o.LessonPage,{key:"lessons-synthesis",lessonId:"synthesis"})))}componentDidMount(){this.history.listen(e=>{const t=window.dataLayer;void 0!==t&&t.push({event:"Pageview",pagePath:e.pathname+e.search,pageTitle:document.title})})}onUnmute(){this.acknowledgeUnmuteReminder(),this.setState({shouldShowUnmutingGraphic:!1})}hasAcknowledgedUnmuteReminder(){return"yes"===localStorage.getItem("nunmute_reminder_acknowledged")}acknowledgeUnmuteReminder(){localStorage.setItem("nunmute_reminder_acknowledged","yes")}}},function(e,t,n){"use strict";var r=n(112);function i(){}function a(){}a.resetWarningCache=i,e.exports=function(){function e(e,t,n,i,a,o){if(o!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:a,resetWarningCache:i};return n.PropTypes=n,n}},function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t){e.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(29),a=n(3),o=n(115),s=n(116),c=n(117),l=n(118),u=n(273),h=n(276),p=n(280),d=n(98),f=n(281),m=n(97),g=n(46);t.LessonPage=class extends r.Component{constructor(e){super(e),this.scrollHelper=new p.LessonScrollHelper,this.state={lesson:void 0,errorLoadingLesson:!1},s.getLesson(this.props.lessonId).then(e=>{this.setState({lesson:e})}).catch(()=>{this.setState({errorLoadingLesson:!0})})}componentDidMount(){this.scrollHelper.start()}componentWillUnmount(){this.scrollHelper.stop()}render(){return this.state.errorLoadingLesson?r.createElement(m.NotFoundPage,null):void 0===this.state.lesson?r.createElement(r.Fragment,null):r.createElement(r.Fragment,null,r.createElement(i.Switch,null,r.createElement(i.Route,{exact:!0,path:"/playground",component:f.SynthesisPlaygroundPage}),r.createElement(i.Route,{path:"/:chapterId?/:pageId?",component:e=>void 0!==g.resolveIds(this.state.lesson,e.match.params.chapterId,e.match.params.pageId)?r.createElement(v,{lesson:this.state.lesson}):r.createElement(m.NotFoundPage,null)})),r.createElement(i.Route,{path:"/:chapterId?/:pageId?",render:e=>r.createElement(h.LessonTableOfContents,{lesson:this.state.lesson,currentChapterId:e.match.params.chapterId,currentPageId:e.match.params.pageId})}))}};class v extends r.Component{constructor(e){super(e),this.state={showTableOfContents:!1,selectedLanguageCode:o.LanguageCode.en}}render(){return r.createElement(r.Fragment,null,r.createElement(i.Route,{path:"/:chapterId?/:pageId?",render:e=>{"recipes"===e.match.params.chapterId?(document.body.classList.add("recipes"),document.body.classList.remove("lesson"),document.body.classList.remove("playground")):(document.body.classList.add("lesson"),document.body.classList.remove("recipes"),document.body.classList.remove("playground"));const t=`${this.props.lesson.id}-${e.match.params.chapterId}-${e.match.params.pageId}`,n=g.resolveIds(this.props.lesson,e.match.params.chapterId,e.match.params.pageId),i=void 0!==n&&0===n.pageIndex;return r.createElement(r.Fragment,null,r.createElement(c.LessonHeader,{lesson:this.props.lesson,chapter:n.chapter,isStartOfChapter:i,selectedLanguageCode:this.state.selectedLanguageCode}),r.createElement("div",{className:"main"},r.createElement("div",{className:"content"},r.createElement("div",{className:a("page",{"page--start-of-chapter":i}),id:"page"},r.createElement(l.LessonPage,{key:t,lesson:this.props.lesson,chapterId:e.match.params.chapterId,pageId:e.match.params.pageId})))),r.createElement(u.LessonFooter,{lesson:this.props.lesson,chapterId:e.match.params.chapterId,pageId:e.match.params.pageId}),r.createElement(d.BrandFooter,null))}}))}}t.LessonViewerComponent=v},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.en="en",e.de="de",e.es="es",e.fr="fr",e.ja="ja",e.it="it",e.nl="nl"}(r=t.LanguageCode||(t.LanguageCode={})),t.languages=[{id:r.en,name:"English",supported:!0},{id:r.de,name:"Deutsch",supported:!1},{id:r.es,name:"Espaol",supported:!1},{id:r.fr,name:"Franais",supported:!1},{id:r.ja,name:"",supported:!1},{id:r.it,name:"Italiano",supported:!1},{id:r.nl,name:"Nederlands",supported:!1}]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(12);t.getLesson=function(e){return fetch(r.urlForFile(`content/lessons/en/${e}/lesson.json`)).then(e=>e.text()).then(e=>JSON.parse(e))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(3),a=n(16),o=n(17);t.LessonHeader=class extends r.Component{constructor(e){super(e),this.headerRef=r.createRef()}render(){return r.createElement("div",{ref:this.headerRef,className:i("components_lesson-viewer__header",{"components_lesson-viewer__header--start-of-chapter":this.props.isStartOfChapter})},r.createElement("div",{className:"components_lesson-viewer__header-content"},r.createElement("a",{href:"https://www.ableton.com",className:"components_lesson-viewer__header-content-logo"},r.createElement(o.AbletonLogo,null)),r.createElement("div",{className:"components_lesson-viewer__header-content-title"},r.createElement("a",{href:"javascript:void(0)",onClick:()=>{a.publish("toggleTableOfContents",{show:!0})}},r.createElement("span",{className:"components_lesson-viewer__header-content-title-primary"},this.props.lesson.name),r.createElement("span",{className:"components_lesson-viewer__header-content-title-secondary"}," ",this.props.chapter.title)))))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(32),a=n(46),o=n(33),s=n(65),c=n(125),l=n(126),u=n(97),h=n(20),p=n(61);t.LessonPage=class extends r.PureComponent{constructor(e){super(e)}render(){const e=a.resolveIds(this.props.lesson,this.props.chapterId,this.props.pageId);if(void 0===e)return r.createElement(u.NotFoundPage,null);const t={theme:{color:p.getColorFromCssVariable(`--${e.chapter.theme}`),shade:p.getColorFromCssVariable(`--${e.chapter.theme}-shade`)},global:{background:p.getColorFromCssVariable("--color-background"),foreground:p.getColorFromCssVariable("--color-foreground"),shade:p.getColorFromCssVariable("--color-shade")}};return r.createElement(h.ThemeContext.Provider,{value:t},r.createElement("div",null,r.createElement(i.Helmet,{key:"helmet",title:`${e.chapter.title} | ${this.props.lesson.name}`}),r.createElement(c.Themer,{key:"themer",themeId:e.chapter.theme}),r.createElement(s.ScrollIntoView,{key:"scrollIntoView",id:void 0}),r.createElement(o.PageContext.Provider,{value:e.page},r.createElement("section",null,e.page.chunks.map((e,t)=>r.createElement(l.PageChunk,{key:t,chunk:e,lessonId:this.props.lesson.id}))))))}}},function(e,t,n){"use strict";function r(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var i=n(0),a=r(i),o=r(n(120)),s=r(n(121));e.exports=function(e,t,n){if("function"!=typeof e)throw new Error("Expected reducePropsToState to be a function.");if("function"!=typeof t)throw new Error("Expected handleStateChangeOnClient to be a function.");if(void 0!==n&&"function"!=typeof n)throw new Error("Expected mapStateOnServer to either be undefined or a function.");return function(r){if("function"!=typeof r)throw new Error("Expected WrappedComponent to be a React component.");var c=[],l=void 0;function u(){l=e(c.map(function(e){return e.props})),h.canUseDOM?t(l):n&&(l=n(l))}var h=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.peek=function(){return l},t.rewind=function(){if(t.canUseDOM)throw new Error("You may only call rewind() on the server. Call peek() to read the current state.");var e=l;return l=void 0,c=[],e},t.prototype.shouldComponentUpdate=function(e){return!s(e,this.props)},t.prototype.componentWillMount=function(){c.push(this),u()},t.prototype.componentDidUpdate=function(){u()},t.prototype.componentWillUnmount=function(){var e=c.indexOf(this);c.splice(e,1),u()},t.prototype.render=function(){return a.createElement(r,this.props)},t}(i.Component);return h.displayName="SideEffect("+function(e){return e.displayName||e.name||"Component"}(r)+")",h.canUseDOM=o.canUseDOM,h}}},function(e,t,n){var r;
/*!
  Copyright (c) 2015 Jed Watson.
  Based on code that is Copyright 2013-2015, Facebook, Inc.
  All rights reserved.
*/
/*!
  Copyright (c) 2015 Jed Watson.
  Based on code that is Copyright 2013-2015, Facebook, Inc.
  All rights reserved.
*/
!function(){"use strict";var i=!("undefined"==typeof window||!window.document||!window.document.createElement),a={canUseDOM:i,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:i&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:i&&!!window.screen};void 0===(r=function(){return a}.call(t,n,t,e))||(e.exports=r)}()},function(e,t){e.exports=function(e,t,n,r){var i=n?n.call(r,e,t):void 0;if(void 0!==i)return!!i;if(e===t)return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;var a=Object.keys(e),o=Object.keys(t);if(a.length!==o.length)return!1;for(var s=Object.prototype.hasOwnProperty.bind(t),c=0;c<a.length;c++){var l=a[c];if(!s(l))return!1;var u=e[l],h=t[l];if(!1===(i=n?n.call(r,u,h,l):void 0)||void 0===i&&u!==h)return!1}return!0}},function(e,t,n){"use strict";var r=Array.isArray,i=Object.keys,a=Object.prototype.hasOwnProperty,o="undefined"!=typeof Element;e.exports=function(e,t){try{return function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){var s,c,l,u=r(t),h=r(n);if(u&&h){if((c=t.length)!=n.length)return!1;for(s=c;0!=s--;)if(!e(t[s],n[s]))return!1;return!0}if(u!=h)return!1;var p=t instanceof Date,d=n instanceof Date;if(p!=d)return!1;if(p&&d)return t.getTime()==n.getTime();var f=t instanceof RegExp,m=n instanceof RegExp;if(f!=m)return!1;if(f&&m)return t.toString()==n.toString();var g=i(t);if((c=g.length)!==i(n).length)return!1;for(s=c;0!=s--;)if(!a.call(n,g[s]))return!1;if(o&&t instanceof Element&&n instanceof Element)return t===n;for(s=c;0!=s--;)if(!("_owner"===(l=g[s])&&t.$$typeof||e(t[l],n[l])))return!1;return!0}return t!=t&&n!=n}(e,t)}catch(e){if(e.message&&e.message.match(/stack|recursion/i)||-2146828260===e.number)return console.warn("Warning: react-fast-compare does not handle circular references.",e.name,e.message),!1;throw e}}},function(e,t,n){(function(e){t.__esModule=!0,t.warn=t.requestAnimationFrame=t.reducePropsToState=t.mapStateOnServer=t.handleClientStateChange=t.convertReactPropstoHtmlAttributes=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=c(n(0)),o=c(n(124)),s=n(64);function c(e){return e&&e.__esModule?e:{default:e}}var l,u=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return!1===t?String(e):String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")},h=function(e){var t=g(e,s.TAG_NAMES.TITLE),n=g(e,s.HELMET_PROPS.TITLE_TEMPLATE);if(n&&t)return n.replace(/%s/g,function(){return t});var r=g(e,s.HELMET_PROPS.DEFAULT_TITLE);return t||r||void 0},p=function(e){return g(e,s.HELMET_PROPS.ON_CHANGE_CLIENT_STATE)||function(){}},d=function(e,t){return t.filter(function(t){return void 0!==t[e]}).map(function(t){return t[e]}).reduce(function(e,t){return i({},e,t)},{})},f=function(e,t){return t.filter(function(e){return void 0!==e[s.TAG_NAMES.BASE]}).map(function(e){return e[s.TAG_NAMES.BASE]}).reverse().reduce(function(t,n){if(!t.length)for(var r=Object.keys(n),i=0;i<r.length;i++){var a=r[i].toLowerCase();if(-1!==e.indexOf(a)&&n[a])return t.concat(n)}return t},[])},m=function(e,t,n){var i={};return n.filter(function(t){return!!Array.isArray(t[e])||(void 0!==t[e]&&w("Helmet: "+e+' should be of type "Array". Instead found type "'+r(t[e])+'"'),!1)}).map(function(t){return t[e]}).reverse().reduce(function(e,n){var r={};n.filter(function(e){for(var n=void 0,a=Object.keys(e),o=0;o<a.length;o++){var c=a[o],l=c.toLowerCase();-1===t.indexOf(l)||n===s.TAG_PROPERTIES.REL&&"canonical"===e[n].toLowerCase()||l===s.TAG_PROPERTIES.REL&&"stylesheet"===e[l].toLowerCase()||(n=l),-1===t.indexOf(c)||c!==s.TAG_PROPERTIES.INNER_HTML&&c!==s.TAG_PROPERTIES.CSS_TEXT&&c!==s.TAG_PROPERTIES.ITEM_PROP||(n=c)}if(!n||!e[n])return!1;var u=e[n].toLowerCase();return i[n]||(i[n]={}),r[n]||(r[n]={}),!i[n][u]&&(r[n][u]=!0,!0)}).reverse().forEach(function(t){return e.push(t)});for(var a=Object.keys(r),c=0;c<a.length;c++){var l=a[c],u=(0,o.default)({},i[l],r[l]);i[l]=u}return e},[]).reverse()},g=function(e,t){for(var n=e.length-1;n>=0;n--){var r=e[n];if(r.hasOwnProperty(t))return r[t]}return null},v=(l=Date.now(),function(e){var t=Date.now();t-l>16?(l=t,e(t)):setTimeout(function(){v(e)},0)}),y=function(e){return clearTimeout(e)},b="undefined"!=typeof window?window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||v:e.requestAnimationFrame||v,_="undefined"!=typeof window?window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||y:e.cancelAnimationFrame||y,w=function(e){return console&&"function"==typeof console.warn&&console.warn(e)},x=null,E=function(e,t){var n=e.baseTag,r=e.bodyAttributes,i=e.htmlAttributes,a=e.linkTags,o=e.metaTags,c=e.noscriptTags,l=e.onChangeClientState,u=e.scriptTags,h=e.styleTags,p=e.title,d=e.titleAttributes;T(s.TAG_NAMES.BODY,r),T(s.TAG_NAMES.HTML,i),S(p,d);var f={baseTag:P(s.TAG_NAMES.BASE,n),linkTags:P(s.TAG_NAMES.LINK,a),metaTags:P(s.TAG_NAMES.META,o),noscriptTags:P(s.TAG_NAMES.NOSCRIPT,c),scriptTags:P(s.TAG_NAMES.SCRIPT,u),styleTags:P(s.TAG_NAMES.STYLE,h)},m={},g={};Object.keys(f).forEach(function(e){var t=f[e],n=t.newTags,r=t.oldTags;n.length&&(m[e]=n),r.length&&(g[e]=f[e].oldTags)}),t&&t(),l(e,m,g)},M=function(e){return Array.isArray(e)?e.join(""):e},S=function(e,t){void 0!==e&&document.title!==e&&(document.title=M(e)),T(s.TAG_NAMES.TITLE,t)},T=function(e,t){var n=document.getElementsByTagName(e)[0];if(n){for(var r=n.getAttribute(s.HELMET_ATTRIBUTE),i=r?r.split(","):[],a=[].concat(i),o=Object.keys(t),c=0;c<o.length;c++){var l=o[c],u=t[l]||"";n.getAttribute(l)!==u&&n.setAttribute(l,u),-1===i.indexOf(l)&&i.push(l);var h=a.indexOf(l);-1!==h&&a.splice(h,1)}for(var p=a.length-1;p>=0;p--)n.removeAttribute(a[p]);i.length===a.length?n.removeAttribute(s.HELMET_ATTRIBUTE):n.getAttribute(s.HELMET_ATTRIBUTE)!==o.join(",")&&n.setAttribute(s.HELMET_ATTRIBUTE,o.join(","))}},P=function(e,t){var n=document.head||document.querySelector(s.TAG_NAMES.HEAD),r=n.querySelectorAll(e+"["+s.HELMET_ATTRIBUTE+"]"),i=Array.prototype.slice.call(r),a=[],o=void 0;return t&&t.length&&t.forEach(function(t){var n=document.createElement(e);for(var r in t)if(t.hasOwnProperty(r))if(r===s.TAG_PROPERTIES.INNER_HTML)n.innerHTML=t.innerHTML;else if(r===s.TAG_PROPERTIES.CSS_TEXT)n.styleSheet?n.styleSheet.cssText=t.cssText:n.appendChild(document.createTextNode(t.cssText));else{var c=void 0===t[r]?"":t[r];n.setAttribute(r,c)}n.setAttribute(s.HELMET_ATTRIBUTE,"true"),i.some(function(e,t){return o=t,n.isEqualNode(e)})?i.splice(o,1):a.push(n)}),i.forEach(function(e){return e.parentNode.removeChild(e)}),a.forEach(function(e){return n.appendChild(e)}),{oldTags:i,newTags:a}},A=function(e){return Object.keys(e).reduce(function(t,n){var r=void 0!==e[n]?n+'="'+e[n]+'"':""+n;return t?t+" "+r:r},"")},O=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(e).reduce(function(t,n){return t[s.REACT_TAG_MAP[n]||n]=e[n],t},t)},C=function(e,t,n){switch(e){case s.TAG_NAMES.TITLE:return{toComponent:function(){return e=t.title,n=t.titleAttributes,(r={key:e})[s.HELMET_ATTRIBUTE]=!0,i=O(n,r),[a.default.createElement(s.TAG_NAMES.TITLE,i,e)];var e,n,r,i},toString:function(){return function(e,t,n,r){var i=A(n),a=M(t);return i?"<"+e+" "+s.HELMET_ATTRIBUTE+'="true" '+i+">"+u(a,r)+"</"+e+">":"<"+e+" "+s.HELMET_ATTRIBUTE+'="true">'+u(a,r)+"</"+e+">"}(e,t.title,t.titleAttributes,n)}};case s.ATTRIBUTE_NAMES.BODY:case s.ATTRIBUTE_NAMES.HTML:return{toComponent:function(){return O(t)},toString:function(){return A(t)}};default:return{toComponent:function(){return function(e,t){return t.map(function(t,n){var r,i=((r={key:n})[s.HELMET_ATTRIBUTE]=!0,r);return Object.keys(t).forEach(function(e){var n=s.REACT_TAG_MAP[e]||e;if(n===s.TAG_PROPERTIES.INNER_HTML||n===s.TAG_PROPERTIES.CSS_TEXT){var r=t.innerHTML||t.cssText;i.dangerouslySetInnerHTML={__html:r}}else i[n]=t[e]}),a.default.createElement(e,i)})}(e,t)},toString:function(){return function(e,t,n){return t.reduce(function(t,r){var i=Object.keys(r).filter(function(e){return!(e===s.TAG_PROPERTIES.INNER_HTML||e===s.TAG_PROPERTIES.CSS_TEXT)}).reduce(function(e,t){var i=void 0===r[t]?t:t+'="'+u(r[t],n)+'"';return e?e+" "+i:i},""),a=r.innerHTML||r.cssText||"",o=-1===s.SELF_CLOSING_TAGS.indexOf(e);return t+"<"+e+" "+s.HELMET_ATTRIBUTE+'="true" '+i+(o?"/>":">"+a+"</"+e+">")},"")}(e,t,n)}}}};t.convertReactPropstoHtmlAttributes=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(e).reduce(function(t,n){return t[s.HTML_TAG_MAP[n]||n]=e[n],t},t)},t.handleClientStateChange=function(e){x&&_(x),e.defer?x=b(function(){E(e,function(){x=null})}):(E(e),x=null)},t.mapStateOnServer=function(e){var t=e.baseTag,n=e.bodyAttributes,r=e.encode,i=e.htmlAttributes,a=e.linkTags,o=e.metaTags,c=e.noscriptTags,l=e.scriptTags,u=e.styleTags,h=e.title,p=void 0===h?"":h,d=e.titleAttributes;return{base:C(s.TAG_NAMES.BASE,t,r),bodyAttributes:C(s.ATTRIBUTE_NAMES.BODY,n,r),htmlAttributes:C(s.ATTRIBUTE_NAMES.HTML,i,r),link:C(s.TAG_NAMES.LINK,a,r),meta:C(s.TAG_NAMES.META,o,r),noscript:C(s.TAG_NAMES.NOSCRIPT,c,r),script:C(s.TAG_NAMES.SCRIPT,l,r),style:C(s.TAG_NAMES.STYLE,u,r),title:C(s.TAG_NAMES.TITLE,{title:p,titleAttributes:d},r)}},t.reducePropsToState=function(e){return{baseTag:f([s.TAG_PROPERTIES.HREF],e),bodyAttributes:d(s.ATTRIBUTE_NAMES.BODY,e),defer:g(e,s.HELMET_PROPS.DEFER),encode:g(e,s.HELMET_PROPS.ENCODE_SPECIAL_CHARACTERS),htmlAttributes:d(s.ATTRIBUTE_NAMES.HTML,e),linkTags:m(s.TAG_NAMES.LINK,[s.TAG_PROPERTIES.REL,s.TAG_PROPERTIES.HREF],e),metaTags:m(s.TAG_NAMES.META,[s.TAG_PROPERTIES.NAME,s.TAG_PROPERTIES.CHARSET,s.TAG_PROPERTIES.HTTPEQUIV,s.TAG_PROPERTIES.PROPERTY,s.TAG_PROPERTIES.ITEM_PROP],e),noscriptTags:m(s.TAG_NAMES.NOSCRIPT,[s.TAG_PROPERTIES.INNER_HTML],e),onChangeClientState:p(e),scriptTags:m(s.TAG_NAMES.SCRIPT,[s.TAG_PROPERTIES.SRC,s.TAG_PROPERTIES.INNER_HTML],e),styleTags:m(s.TAG_NAMES.STYLE,[s.TAG_PROPERTIES.CSS_TEXT],e),title:h(e),titleAttributes:d(s.ATTRIBUTE_NAMES.TITLE,e)}},t.requestAnimationFrame=b,t.warn=w}).call(this,n(45))},function(e,t,n){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;function o(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(e){r[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,s,c=o(e),l=1;l<arguments.length;l++){for(var u in n=Object(arguments[l]))i.call(n,u)&&(c[u]=n[u]);if(r){s=r(n);for(var h=0;h<s.length;h++)a.call(n,s[h])&&(c[s[h]]=n[s[h]])}}return c}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(32);t.Themer=class extends r.Component{render(){if(void 0===this.props.themeId)return r.createElement(r.Fragment,null);const e=getComputedStyle(document.body).getPropertyValue("--"+this.props.themeId),t=getComputedStyle(document.body).getPropertyValue("--"+this.props.themeId+"-shade");return r.createElement(i.Helmet,null,r.createElement("style",null,`:root {\n                    --current-theme-color: ${e};\n                    --current-theme-color-shade: ${t};\n                }`))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(34),a=n(26),o=n(74);t.PageChunk=class extends r.Component{constructor(e){super(e)}render(){return this.isEmbed()?this.renderEmbed():this.isFootnote()||this.isFootloose()?r.createElement(r.Fragment,null):a.renderMarkdown(this.props.chunk.markdown,this.props.chunk.metadata.classes)}shouldComponentUpdate(e){return!i.isEqual(this.props,e)}renderEmbed(){const e={lessonId:this.props.lessonId},t=this.props.chunk.metadata;return o.create(t.embed,t,e)}isEmbed(){return void 0!==this.props.chunk.metadata.embed}isFootnote(){return void 0!==this.props.chunk.metadata.footnote}isFootloose(){return void 0!==this.props.chunk.metadata.footloose}}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){"use strict";function r(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var i=n(18),a=n(129),o=n(142),s=n(2),c=n(198),l=n(200),u=n(201),h=n(202),p=n(203),d=n(204),f=n(205),m=n(206),g=n(207),v=Object.keys(m),y=function(e){var t=e.source||e.children||"",n=e.parserOptions;if(e.allowedTypes&&e.disallowedTypes)throw new Error("Only one of `allowedTypes` and `disallowedTypes` should be defined");var r=i(m,e.renderers),s=[[o,n]].concat(e.plugins||[]).reduce(b,a()).parse(t),f=i(e,{renderers:r,definitions:d(s)}),y=function(e){var t=[p,c()],n=e.disallowedTypes;e.allowedTypes&&(n=v.filter(function(t){return"root"!==t&&-1===e.allowedTypes.indexOf(t)}));var r=e.unwrapDisallowed?"unwrap":"remove";n&&n.length>0&&t.push(u.ofType(n,r));e.allowNode&&t.push(u.ifNotMatch(e.allowNode,r));var i=!e.escapeHtml&&!e.skipHtml,a=(e.astPlugins||[]).some(function(e){var t=Array.isArray(e)?e[0]:e;return t.identity===g.HtmlParser});i&&!a&&t.push(l);return e.astPlugins?t.concat(e.astPlugins):t}(e).reduce(function(e,t){return t(e,f)},s);return h(y,f)};function b(e,t){return Array.isArray(t)?e.use.apply(e,r(t)):e.use(t)}y.defaultProps={renderers:{},escapeHtml:!0,skipHtml:!1,sourcePos:!1,rawSourcePos:!1,transformLinkUri:f,astPlugins:[],plugins:[],parserOptions:{}},y.propTypes={className:s.string,source:s.string,children:s.string,sourcePos:s.bool,rawSourcePos:s.bool,escapeHtml:s.bool,skipHtml:s.bool,allowNode:s.func,allowedTypes:s.arrayOf(s.oneOf(v)),disallowedTypes:s.arrayOf(s.oneOf(v)),transformLinkUri:s.oneOfType([s.func,s.bool]),linkTarget:s.oneOfType([s.func,s.string]),transformImageUri:s.func,astPlugins:s.arrayOf(s.func),unwrapDisallowed:s.bool,renderers:s.object,plugins:s.array,parserOptions:s.object},y.types=v,y.renderers=m,y.uriTransformer=f,e.exports=y},function(e,t,n){"use strict";var r=n(130),i=n(131),a=n(132),o=n(138),s=n(140),c=n(141);e.exports=function e(){var t=[];var n=o();var y={};var b=!1;var _=-1;w.data=function(e,t){if(s(e))return 2===arguments.length?(m("data",b),y[e]=t,w):u.call(y,e)&&y[e]||null;if(e)return m("data",b),y=e,w;return y};w.freeze=x;w.attachers=t;w.use=function(e){var n;if(m("use",b),null==e);else if("function"==typeof e)s.apply(null,arguments);else{if("object"!=typeof e)throw new Error("Expected usable value, not `"+e+"`");"length"in e?o(e):i(e)}n&&(y.settings=r(y.settings||{},n));return w;function i(e){o(e.plugins),e.settings&&(n=r(n||{},e.settings))}function a(e){if("function"==typeof e)s(e);else{if("object"!=typeof e)throw new Error("Expected usable value, not `"+e+"`");"length"in e?s.apply(null,e):i(e)}}function o(e){var t,n;if(null==e);else{if(!("object"==typeof e&&"length"in e))throw new Error("Expected a list of plugins, not `"+e+"`");for(t=e.length,n=-1;++n<t;)a(e[n])}}function s(e,n){var i=function(e){var n,r=t.length,i=-1;for(;++i<r;)if((n=t[i])[0]===e)return n}(e);i?(c(i[1])&&c(n)&&(n=r(i[1],n)),i[1]=n):t.push(l.call(arguments))}};w.parse=function(e){var t,n=a(e);if(x(),d("parse",t=w.Parser),p(t))return new t(String(n),n).parse();return t(String(n),n)};w.stringify=function(e,t){var n,r=a(t);if(x(),f("stringify",n=w.Compiler),g(e),p(n))return new n(e,r).compile();return n(e,r)};w.run=E;w.runSync=function(e,t){var n,r=!1;return E(e,t,function(e,t){r=!0,i(e),n=t}),v("runSync","run",r),n};w.process=M;w.processSync=function(e){var t,n=!1;return x(),d("processSync",w.Parser),f("processSync",w.Compiler),M(t=a(e),function(e){n=!0,i(e)}),v("processSync","process",n),t};return w;function w(){for(var n=e(),i=t.length,a=-1;++a<i;)n.use.apply(null,t[a]);return n.data(r(!0,{},y)),n}function x(){var e,r,i,a;if(b)return w;for(;++_<t.length;)e=t[_],r=e[0],i=e[1],a=null,!1!==i&&(!0===i&&(e[1]=void 0),"function"==typeof(a=r.apply(w,e.slice(1)))&&n.use(a));return b=!0,_=1/0,w}function E(e,t,r){if(g(e),x(),r||"function"!=typeof t||(r=t,t=null),!r)return new Promise(i);function i(i,o){n.run(e,a(t),function(t,n,a){n=n||e,t?o(t):i?i(n):r(null,n,a)})}i(null,r)}function M(e,t){if(x(),d("process",w.Parser),f("process",w.Compiler),!t)return new Promise(n);function n(n,r){var i=a(e);h.run(w,{file:i},function(e){e?r(e):n?n(i):t(null,i)})}n(null,t)}}().freeze();var l=[].slice,u={}.hasOwnProperty,h=o().use(function(e,t){t.tree=e.parse(t.file)}).use(function(e,t,n){e.run(t.tree,t.file,function(e,r,i){e?n(e):(t.tree=r,t.file=i,n())})}).use(function(e,t){t.file.contents=e.stringify(t.tree,t.file)});function p(e){return"function"==typeof e&&function(e){var t;for(t in e)return!0;return!1}(e.prototype)}function d(e,t){if("function"!=typeof t)throw new Error("Cannot `"+e+"` without `Parser`")}function f(e,t){if("function"!=typeof t)throw new Error("Cannot `"+e+"` without `Compiler`")}function m(e,t){if(t)throw new Error(["Cannot invoke `"+e+"` on a frozen processor.\nCreate a new ","processor first, by invoking it: use `processor()` instead of ","`processor`."].join(""))}function g(e){if(!e||!s(e.type))throw new Error("Expected node, got `"+e+"`")}function v(e,t,n){if(!n)throw new Error("`"+e+"` finished async. Use `"+t+"` instead")}},function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty,i=Object.prototype.toString,a=Object.defineProperty,o=Object.getOwnPropertyDescriptor,s=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===i.call(e)},c=function(e){if(!e||"[object Object]"!==i.call(e))return!1;var t,n=r.call(e,"constructor"),a=e.constructor&&e.constructor.prototype&&r.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!n&&!a)return!1;for(t in e);return void 0===t||r.call(e,t)},l=function(e,t){a&&"__proto__"===t.name?a(e,t.name,{enumerable:!0,configurable:!0,value:t.newValue,writable:!0}):e[t.name]=t.newValue},u=function(e,t){if("__proto__"===t){if(!r.call(e,t))return;if(o)return o(e,t).value}return e[t]};e.exports=function e(){var t,n,r,i,a,o,h=arguments[0],p=1,d=arguments.length,f=!1;for("boolean"==typeof h&&(f=h,h=arguments[1]||{},p=2),(null==h||"object"!=typeof h&&"function"!=typeof h)&&(h={});p<d;++p)if(null!=(t=arguments[p]))for(n in t)r=u(h,n),h!==(i=u(t,n))&&(f&&i&&(c(i)||(a=s(i)))?(a?(a=!1,o=r&&s(r)?r:[]):o=r&&c(r)?r:{},l(h,{name:n,newValue:e(f,o,i)})):void 0!==i&&l(h,{name:n,newValue:i}));return h}},function(e,t,n){"use strict";e.exports=function(e){if(e)throw e}},function(e,t,n){"use strict";var r=n(133),i=n(135);e.exports=i;var a=i.prototype;function o(e,t,n){var i=this.path,a=new r(e,t,n);return i&&(a.name=i+":"+a.name,a.file=i),a.fatal=!1,this.messages.push(a),a}a.message=o,a.info=function(){var e=this.message.apply(this,arguments);return e.fatal=null,e},a.fail=function(){var e=this.message.apply(this,arguments);throw e.fatal=!0,e},a.warn=o},function(e,t,n){"use strict";var r=n(134);function i(){}e.exports=o,i.prototype=Error.prototype,o.prototype=new i;var a=o.prototype;function o(e,t,n){var i,a,o;"string"==typeof t&&(n=t,t=null),i=function(e){var t,n=[null,null];"string"==typeof e&&(-1===(t=e.indexOf(":"))?n[1]=e:(n[0]=e.slice(0,t),n[1]=e.slice(t+1)));return n}(n),a=r(t)||"1:1",o={start:{line:null,column:null},end:{line:null,column:null}},t&&t.position&&(t=t.position),t&&(t.start?(o=t,t=t.start):o.start=t),e.stack&&(this.stack=e.stack,e=e.message),this.message=e,this.name=a,this.reason=e,this.line=t?t.line:null,this.column=t?t.column:null,this.location=o,this.source=i[0],this.ruleId=i[1]}a.file="",a.name="",a.reason="",a.message="",a.stack="",a.fatal=null,a.column=null,a.line=null},function(e,t,n){"use strict";var r={}.hasOwnProperty;function i(e){return e&&"object"==typeof e||(e={}),o(e.line)+":"+o(e.column)}function a(e){return e&&"object"==typeof e||(e={}),i(e.start)+"-"+i(e.end)}function o(e){return e&&"number"==typeof e?e:1}e.exports=function(e){if(!e||"object"!=typeof e)return null;if(r.call(e,"position")||r.call(e,"type"))return a(e.position);if(r.call(e,"start")||r.call(e,"end"))return a(e);if(r.call(e,"line")||r.call(e,"column"))return i(e);return null}},function(e,t,n){"use strict";(function(t){var r=n(67),i=n(136),a=n(137);e.exports=l;var o={}.hasOwnProperty,s=l.prototype;s.toString=function(e){var t=this.contents||"";return a(t)?t.toString(e):String(t)};var c=["history","path","basename","stem","extname","dirname"];function l(e){var n,r,i;if(e){if("string"==typeof e||a(e))e={contents:e};else if("message"in e&&"messages"in e)return e}else e={};if(!(this instanceof l))return new l(e);for(this.data={},this.messages=[],this.history=[],this.cwd=t.cwd(),r=-1,i=c.length;++r<i;)n=c[r],o.call(e,n)&&(this[n]=e[n]);for(n in e)-1===c.indexOf(n)&&(this[n]=e[n])}function u(e,t){if(-1!==e.indexOf(r.sep))throw new Error("`"+t+"` cannot be a path: did not expect `"+r.sep+"`")}function h(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function p(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}Object.defineProperty(s,"path",{get:function(){return this.history[this.history.length-1]},set:function(e){h(e,"path"),e!==this.path&&this.history.push(e)}}),Object.defineProperty(s,"dirname",{get:function(){return"string"==typeof this.path?r.dirname(this.path):void 0},set:function(e){p(this.path,"dirname"),this.path=r.join(e||"",this.basename)}}),Object.defineProperty(s,"basename",{get:function(){return"string"==typeof this.path?r.basename(this.path):void 0},set:function(e){h(e,"basename"),u(e,"basename"),this.path=r.join(this.dirname||"",e)}}),Object.defineProperty(s,"extname",{get:function(){return"string"==typeof this.path?r.extname(this.path):void 0},set:function(e){var t=e||"";if(u(t,"extname"),p(this.path,"extname"),t){if("."!==t.charAt(0))throw new Error("`extname` must start with `.`");if(-1!==t.indexOf(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=i(this.path,t)}}),Object.defineProperty(s,"stem",{get:function(){return"string"==typeof this.path?r.basename(this.path,this.extname):void 0},set:function(e){h(e,"stem"),u(e,"stem"),this.path=r.join(this.dirname||"",e+(this.extname||""))}})}).call(this,n(66))},function(e,t,n){"use strict";var r=n(67);e.exports=function(e,t){if("string"!=typeof e)return e;if(0===e.length)return e;var n=r.basename(e,r.extname(e))+t;return r.join(r.dirname(e),n)}},function(e,t){function n(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
e.exports=function(e){return null!=e&&(n(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&n(e.slice(0,0))}(e)||!!e._isBuffer)}},function(e,t,n){"use strict";var r=n(139);e.exports=a,a.wrap=r;var i=[].slice;function a(){var e=[],t={run:function(){var t=-1,n=i.call(arguments,0,-1),a=arguments[arguments.length-1];if("function"!=typeof a)throw new Error("Expected function as last argument, not "+a);(function o(s){var c=e[++t];var l=i.call(arguments,0);var u=l.slice(1);var h=n.length;var p=-1;if(s)return void a(s);for(;++p<h;)null!==u[p]&&void 0!==u[p]||(u[p]=n[p]);n=u;c?r(c,o).apply(null,n):a.apply(null,[null].concat(n))}).apply(null,[null].concat(n))},use:function(n){if("function"!=typeof n)throw new Error("Expected `fn` to be a function, not "+n);return e.push(n),t}};return t}},function(e,t,n){"use strict";var r=[].slice;e.exports=function(e,t){var n;return function(){var t,o=r.call(arguments,0),s=e.length>o.length;s&&o.push(i);try{t=e.apply(null,o)}catch(e){if(s&&n)throw e;return i(e)}s||(t&&"function"==typeof t.then?t.then(a,i):t instanceof Error?i(t):a(t))};function i(){n||(n=!0,t.apply(null,arguments))}function a(e){i(null,e)}}},function(e,t){var n=Object.prototype.toString;e.exports=function(e){return"[object String]"===n.call(e)}},function(e,t,n){"use strict";var r=Object.prototype.toString;e.exports=function(e){var t;return"[object Object]"===r.call(e)&&(null===(t=Object.getPrototypeOf(e))||t===Object.getPrototypeOf({}))}},function(e,t,n){"use strict";var r=n(143),i=n(18),a=n(145);function o(e){var t=r(a);t.prototype.options=i(t.prototype.options,this.data("settings"),e),this.Parser=t}e.exports=o,o.Parser=a},function(e,t,n){"use strict";var r=n(18),i=n(144);e.exports=function(e){var t,n,a;for(n in i(s,e),i(o,s),t=s.prototype)(a=t[n])&&"object"==typeof a&&(t[n]="concat"in a?a.concat():r(a));return s;function o(t){return e.apply(this,t)}function s(){return this instanceof s?e.apply(this,arguments):new o(arguments)}}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},function(e,t,n){"use strict";var r=n(18),i=n(146),a=n(147),o=n(148),s=n(149),c=n(155);function l(e,t){this.file=t,this.offset={},this.options=r(this.options),this.setOptions({}),this.inList=!1,this.inBlock=!1,this.inLink=!1,this.atStart=!0,this.toOffset=a(t).toOffset,this.unescape=o(this,"escape"),this.decode=s(this)}e.exports=l;var u=l.prototype;function h(e){var t,n=[];for(t in e)n.push(t);return n}u.setOptions=n(156),u.parse=n(159),u.options=n(69),u.exitStart=i("atStart",!0),u.enterList=i("inList",!1),u.enterLink=i("inLink",!1),u.enterBlock=i("inBlock",!1),u.interruptParagraph=[["thematicBreak"],["atxHeading"],["fencedCode"],["blockquote"],["html"],["setextHeading",{commonmark:!1}],["definition",{commonmark:!1}],["footnote",{commonmark:!1}]],u.interruptList=[["atxHeading",{pedantic:!1}],["fencedCode",{pedantic:!1}],["thematicBreak",{pedantic:!1}],["definition",{commonmark:!1}],["footnote",{commonmark:!1}]],u.interruptBlockquote=[["indentedCode",{commonmark:!0}],["fencedCode",{commonmark:!0}],["atxHeading",{commonmark:!0}],["setextHeading",{commonmark:!0}],["thematicBreak",{commonmark:!0}],["html",{commonmark:!0}],["list",{commonmark:!0}],["definition",{commonmark:!1}],["footnote",{commonmark:!1}]],u.blockTokenizers={newline:n(163),indentedCode:n(164),fencedCode:n(165),blockquote:n(166),atxHeading:n(167),thematicBreak:n(168),list:n(169),setextHeading:n(171),html:n(172),footnote:n(173),definition:n(175),table:n(176),paragraph:n(177)},u.inlineTokenizers={escape:n(178),autoLink:n(180),url:n(181),html:n(183),link:n(184),reference:n(185),strong:n(186),emphasis:n(188),deletion:n(191),code:n(193),break:n(195),text:n(197)},u.blockMethods=h(u.blockTokenizers),u.inlineMethods=h(u.inlineTokenizers),u.tokenizeBlock=c("block"),u.tokenizeInline=c("inline"),u.tokenizeFactory=c},function(e,t,n){"use strict";e.exports=function(e,t,n){return function(){var r=n||this,i=r[e];return r[e]=!t,function(){r[e]=i}}}},function(e,t,n){"use strict";function r(e){return function(t){var n=-1,r=e.length;if(t<0)return{};for(;++n<r;)if(e[n]>t)return{line:n+1,column:t-(e[n-1]||0)+1,offset:t};return{}}}function i(e){return function(t){var n=t&&t.line,r=t&&t.column;if(!isNaN(n)&&!isNaN(r)&&n-1 in e)return(e[n-2]||0)+r-1||0;return-1}}e.exports=function(e){var t=function(e){var t=[],n=e.indexOf("\n");for(;-1!==n;)t.push(n+1),n=e.indexOf("\n",n+1);return t.push(e.length+1),t}(String(e));return{toPosition:r(t),toOffset:i(t)}}},function(e,t,n){"use strict";e.exports=function(e,t){return function(n){var r,i=0,a=n.indexOf("\\"),o=e[t],s=[];for(;-1!==a;)s.push(n.slice(i,a)),i=a+1,(r=n.charAt(i))&&-1!==o.indexOf(r)||s.push("\\"),a=n.indexOf("\\",i);return s.push(n.slice(i)),s.join("")}}},function(e,t,n){"use strict";var r=n(18),i=n(47);e.exports=function(e){return a.raw=function(e,a,o){return i(e,r(o,{position:t(a),warning:n}))},a;function t(t){for(var n=e.offset,r=t.line,i=[];++r&&r in n;)i.push((n[r]||0)+1);return{start:t,indent:i}}function n(t,n,r){3!==r&&e.file.message(t,n)}function a(r,a,o){i(r,{position:t(a),warning:n,text:o,reference:o,textContext:e,referenceContext:e})}}},function(e){e.exports=JSON.parse('{"AElig":"","AMP":"&","Aacute":"","Acirc":"","Agrave":"","Aring":"","Atilde":"","Auml":"","COPY":"","Ccedil":"","ETH":"","Eacute":"","Ecirc":"","Egrave":"","Euml":"","GT":">","Iacute":"","Icirc":"","Igrave":"","Iuml":"","LT":"<","Ntilde":"","Oacute":"","Ocirc":"","Ograve":"","Oslash":"","Otilde":"","Ouml":"","QUOT":"\\"","REG":"","THORN":"","Uacute":"","Ucirc":"","Ugrave":"","Uuml":"","Yacute":"","aacute":"","acirc":"","acute":"","aelig":"","agrave":"","amp":"&","aring":"","atilde":"","auml":"","brvbar":"","ccedil":"","cedil":"","cent":"","copy":"","curren":"","deg":"","divide":"","eacute":"","ecirc":"","egrave":"","eth":"","euml":"","frac12":"","frac14":"","frac34":"","gt":">","iacute":"","icirc":"","iexcl":"","igrave":"","iquest":"","iuml":"","laquo":"","lt":"<","macr":"","micro":"","middot":"","nbsp":"","not":"","ntilde":"","oacute":"","ocirc":"","ograve":"","ordf":"","ordm":"","oslash":"","otilde":"","ouml":"","para":"","plusmn":"","pound":"","quot":"\\"","raquo":"","reg":"","sect":"","shy":"","sup1":"","sup2":"","sup3":"","szlig":"","thorn":"","times":"","uacute":"","ucirc":"","ugrave":"","uml":"","uuml":"","yacute":"","yen":"","yuml":""}')},function(e){e.exports=JSON.parse('{"0":"","128":"","130":"","131":"","132":"","133":"","134":"","135":"","136":"","137":"","138":"","139":"","140":"","142":"","145":"","146":"","147":"","148":"","149":"","150":"","151":"","152":"","153":"","154":"","155":"","156":"","158":"","159":""}')},function(e,t,n){"use strict";e.exports=function(e){var t="string"==typeof e?e.charCodeAt(0):e;return t>=97&&t<=102||t>=65&&t<=70||t>=48&&t<=57}},function(e,t,n){"use strict";var r=n(68),i=n(35);e.exports=function(e){return r(e)||i(e)}},function(e,t,n){"use strict";var r,i=59;e.exports=function(e){var t,n="&"+e+";";if((r=r||document.createElement("i")).innerHTML=n,(t=r.textContent).charCodeAt(t.length-1)===i&&"semi"!==e)return!1;return t!==n&&t}},function(e,t,n){"use strict";e.exports=function(e){return function(t,n){var a,o,s,c,l,u,h=this,p=h.offset,d=[],f=h[e+"Methods"],m=h[e+"Tokenizers"],g=n.line,v=n.column;if(!t)return d;w.now=b,w.file=h.file,y("");for(;t;){for(a=-1,o=f.length,l=!1;++a<o&&(c=f[a],!(s=m[c])||s.onlyAtStart&&!h.atStart||s.notInList&&h.inList||s.notInBlock&&h.inBlock||s.notInLink&&h.inLink||(u=t.length,s.apply(h,[w,t]),!(l=u!==t.length))););l||h.file.fail(new Error("Infinite loop"),w.now())}return h.eof=b(),d;function y(e){for(var t=-1,n=e.indexOf("\n");-1!==n;)g++,t=n,n=e.indexOf("\n",n+1);-1===t?v+=e.length:v=e.length-t,g in p&&(-1!==t?v+=p[g]:v<=p[g]&&(v=p[g]+1))}function b(){var e={line:g,column:v};return e.offset=h.toOffset(e),e}function _(e){this.start=e,this.end=b()}function w(e){var n=function(){var e=[],t=g+1;return function(){for(var n=g+1;t<n;)e.push((p[t]||0)+1),t++;return e}}(),a=function(){var e=b();return function(t,n){var r=t.position,i=r?r.start:e,a=[],o=r&&r.end.line,s=e.line;if(t.position=new _(i),r&&n&&r.indent){if(a=r.indent,o<s){for(;++o<s;)a.push((p[o]||0)+1);a.push(e.column)}n=a.concat(n)}return t.position.indent=n||[],t}}(),o=b();return function(e){t.substring(0,e.length)!==e&&h.file.fail(new Error("Incorrectly eaten value: please report this warning on http://git.io/vg5Ft"),b())}(e),s.reset=c,c.test=l,s.test=l,t=t.substring(e.length),y(e),n=n(),s;function s(e,t){return a(function(e,t){var n=t?t.children:d,a=n[n.length-1];a&&e.type===a.type&&e.type in r&&i(a)&&i(e)&&(e=r[e.type].call(h,a,e));e!==a&&n.push(e);h.atStart&&0!==d.length&&h.exitStart();return e}(a(e),t),n)}function c(){var n=s.apply(null,arguments);return g=o.line,v=o.column,t=e+t,n}function l(){var n=a({});return g=o.line,v=o.column,t=e+t,n.position}}}};var r={text:function(e,t){return e.value+=t.value,e},blockquote:function(e,t){if(this.options.commonmark)return t;return e.children=e.children.concat(t.children),e}};function i(e){var t,n;return"text"!==e.type||!e.position||(t=e.position.start,n=e.position.end,t.line!==n.line||n.column-t.column===e.value.length)}},function(e,t,n){"use strict";var r=n(18),i=n(157),a=n(69);e.exports=function(e){var t,n,o=this.options;if(null==e)e={};else{if("object"!=typeof e)throw new Error("Invalid value `"+e+"` for setting `options`");e=r(e)}for(t in a){if(null==(n=e[t])&&(n=o[t]),"blocks"!==t&&"boolean"!=typeof n||"blocks"===t&&"object"!=typeof n)throw new Error("Invalid value `"+n+"` for setting `options."+t+"`");e[t]=n}return this.options=e,this.escape=i(e),this}},function(e,t,n){"use strict";e.exports=o;var r=["\\","`","*","{","}","[","]","(",")","#","+","-",".","!","_",">"],i=r.concat(["~","|"]),a=i.concat(["\n",'"',"$","%","&","'",",","/",":",";","<","=","?","@","^"]);function o(e){var t=e||{};return t.commonmark?a:t.gfm?i:r}o.default=r,o.gfm=i,o.commonmark=a},function(e){e.exports=JSON.parse('["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","iframe","legend","li","link","main","menu","menuitem","meta","nav","noframes","ol","optgroup","option","p","param","pre","section","source","title","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"]')},function(e,t,n){"use strict";var r=n(18),i=n(160);e.exports=function(){var e,t=String(this.file),n={line:1,column:1,offset:0},s=r(n);65279===(t=t.replace(o,a)).charCodeAt(0)&&(t=t.slice(1),s.column++,s.offset++);e={type:"root",children:this.tokenizeBlock(t,s),position:{start:n,end:this.eof||r(n)}},this.options.position||i(e,!0);return e};var a="\n",o=/\r\n|\r/g},function(e,t,n){"use strict";var r=n(36);function i(e){delete e.position}function a(e){e.position=void 0}e.exports=function(e,t){return r(e,t?i:a),e}},function(e,t,n){"use strict";e.exports=s;var r=n(162),i=!0,a="skip",o=!1;function s(e,t,n,i){var s;function l(e,r,u){var h,p=[];return(t&&!s(e,r,u[u.length-1]||null)||(p=c(n(e,u)))[0]!==o)&&e.children&&p[0]!==a&&(h=c(function(e,t){var n,r=i?-1:1,a=(i?e.length:-1)+r;for(;a>-1&&a<e.length;){if((n=l(e[a],a,t))[0]===o)return n;a="number"==typeof n[1]?n[1]:a+r}}(e.children,u.concat(e))))[0]===o?h:p}"function"==typeof t&&"function"!=typeof n&&(i=n,n=t,t=null),s=r(t),l(e,null,[])}function c(e){return null!==e&&"object"==typeof e&&"length"in e?e:"number"==typeof e?[i,e]:[e]}s.CONTINUE=i,s.SKIP=a,s.EXIT=o},function(e,t,n){"use strict";function r(e){if("string"==typeof e)return function(e){return function(t){return Boolean(t&&t.type===e)}}(e);if(null==e)return i;if("object"==typeof e)return("length"in e?function(e){var t=function(e){var t=[],n=e.length,i=-1;for(;++i<n;)t[i]=r(e[i]);return t}(e),n=t.length;return function(){var e=-1;for(;++e<n;)if(t[e].apply(this,arguments))return!0;return!1}}:function(e){return function(t){var n;for(n in e)if(t[n]!==e[n])return!1;return!0}})(e);if("function"==typeof e)return e;throw new Error("Expected function, string, or object as test")}function i(){return!0}e.exports=r},function(e,t,n){"use strict";var r=n(14);e.exports=function(e,t,n){var i,a,o,s,c=t.charAt(0);if("\n"!==c)return;if(n)return!0;s=1,i=t.length,a=c,o="";for(;s<i&&(c=t.charAt(s),r(c));)o+=c,"\n"===c&&(a+=o,o=""),s++;e(a)}},function(e,t,n){"use strict";var r=n(48),i=n(49);e.exports=function(e,t,n){var r,l,u,h=-1,p=t.length,d="",f="",m="",g="";for(;++h<p;)if(r=t.charAt(h),u)if(u=!1,d+=m,f+=g,m="",g="",r===a)m=r,g=r;else for(d+=r,f+=r;++h<p;){if(!(r=t.charAt(h))||r===a){g=r,m=r;break}d+=r,f+=r}else if(r===s&&t.charAt(h+1)===r&&t.charAt(h+2)===r&&t.charAt(h+3)===r)m+=c,h+=3,u=!0;else if(r===o)m+=r,u=!0;else{for(l="";r===o||r===s;)l+=r,r=t.charAt(++h);if(r!==a)break;m+=l+r,g+=r}if(f)return!!n||e(d)({type:"code",lang:null,value:i(f)})};var a="\n",o="\t",s=" ",c=r(s,4)},function(e,t,n){"use strict";var r=n(49);e.exports=function(e,t,n){var h,p,d,f,m,g,v,y,b,_,w,x=this.options,E=t.length+1,M=0,S="";if(!x.gfm)return;for(;M<E&&((d=t.charAt(M))===o||d===a);)S+=d,M++;if(_=M,(d=t.charAt(M))!==s&&d!==c)return;M++,p=d,h=1,S+=d;for(;M<E&&(d=t.charAt(M))===p;)S+=d,h++,M++;if(h<l)return;for(;M<E&&((d=t.charAt(M))===o||d===a);)S+=d,M++;f="",m="";for(;M<E&&(d=t.charAt(M))!==i&&d!==s&&d!==c;)d===o||d===a?m+=d:(f+=m+d,m=""),M++;if((d=t.charAt(M))&&d!==i)return;if(n)return!0;(w=e.now()).column+=S.length,w.offset+=S.length,S+=f,f=this.decode.raw(this.unescape(f),w),m&&(S+=m);m="",y="",b="",g="",v="";for(;M<E;)if(d=t.charAt(M),g+=y,v+=b,y="",b="",d===i){for(g?(y+=d,b+=d):S+=d,m="",M++;M<E&&(d=t.charAt(M))===o;)m+=d,M++;if(y+=m,b+=m.slice(_),!(m.length>=u)){for(m="";M<E&&(d=t.charAt(M))===p;)m+=d,M++;if(y+=m,b+=m,!(m.length<h)){for(m="";M<E&&((d=t.charAt(M))===o||d===a);)y+=d,b+=d,M++;if(!d||d===i)break}}}else g+=d,b+=d,M++;return e(S+=g+y)({type:"code",lang:f||null,value:r(v)})};var i="\n",a="\t",o=" ",s="~",c="`",l=3,u=4},function(e,t,n){"use strict";var r=n(23),i=n(50);e.exports=function(e,t,n){var l,u,h,p,d,f,m,g,v,y=this.offset,b=this.blockTokenizers,_=this.interruptBlockquote,w=e.now(),x=w.line,E=t.length,M=[],S=[],T=[],P=0;for(;P<E&&((u=t.charAt(P))===s||u===o);)P++;if(t.charAt(P)!==c)return;if(n)return!0;P=0;for(;P<E;){for(p=t.indexOf(a,P),m=P,g=!1,-1===p&&(p=E);P<E&&((u=t.charAt(P))===s||u===o);)P++;if(t.charAt(P)===c?(P++,g=!0,t.charAt(P)===s&&P++):P=m,d=t.slice(P,p),!g&&!r(d)){P=m;break}if(!g&&(h=t.slice(P),i(_,b,this,[e,h,!0])))break;f=m===P?d:t.slice(m,p),T.push(P-m),M.push(f),S.push(d),P=p+1}P=-1,E=T.length,l=e(M.join(a));for(;++P<E;)y[x]=(y[x]||0)+T[P],x++;return v=this.enterBlock(),S=this.tokenizeBlock(S.join(a),w),v(),l({type:"blockquote",children:S})};var a="\n",o="\t",s=" ",c=">"},function(e,t,n){"use strict";e.exports=function(e,t,n){var c,l,u,h=this.options,p=t.length+1,d=-1,f=e.now(),m="",g="";for(;++d<p;){if((c=t.charAt(d))!==a&&c!==i){d--;break}m+=c}u=0;for(;++d<=p;){if((c=t.charAt(d))!==o){d--;break}m+=c,u++}if(u>s)return;if(!u||!h.pedantic&&t.charAt(d+1)===o)return;p=t.length+1,l="";for(;++d<p;){if((c=t.charAt(d))!==a&&c!==i){d--;break}l+=c}if(!h.pedantic&&0===l.length&&c&&c!==r)return;if(n)return!0;m+=l,l="",g="";for(;++d<p&&(c=t.charAt(d))&&c!==r;)if(c===a||c===i||c===o){for(;c===a||c===i;)l+=c,c=t.charAt(++d);for(;c===o;)l+=c,c=t.charAt(++d);for(;c===a||c===i;)l+=c,c=t.charAt(++d);d--}else g+=l+c,l="";return f.column+=m.length,f.offset+=m.length,e(m+=g+l)({type:"heading",depth:u,children:this.tokenizeInline(g,f)})};var r="\n",i="\t",a=" ",o="#",s=6},function(e,t,n){"use strict";e.exports=function(e,t,n){var u,h,p,d,f=-1,m=t.length+1,g="";for(;++f<m&&((u=t.charAt(f))===i||u===a);)g+=u;if(u!==o&&u!==c&&u!==s)return;h=u,g+=u,p=1,d="";for(;++f<m;)if((u=t.charAt(f))===h)p++,g+=d+h,d="";else{if(u!==a)return p>=l&&(!u||u===r)?(g+=d,!!n||e(g)({type:"thematicBreak"})):void 0;d+=u}};var r="\n",i="\t",a=" ",o="*",s="_",c="-",l=3},function(e,t,n){"use strict";var r=n(23),i=n(48),a=n(35),o=n(70),s=n(170),c=n(50);e.exports=function(e,t,n){var i,o,s,m,v,y,b,_,w,T,P,A,O,C,R,L,I,k,N,z,D,B,j,F,U=this.options.commonmark,V=this.options.pedantic,H=this.blockTokenizers,G=this.interruptList,W=0,q=t.length,X=null,Y=0;for(;W<q;){if((m=t.charAt(W))===f)Y+=g-Y%g;else{if(m!==p)break;Y++}W++}if(Y>=g)return;if(m=t.charAt(W),i=U?M:E,!0===x[m])v=m,s=!1;else{for(s=!0,o="";W<q&&(m=t.charAt(W),a(m));)o+=m,W++;if(m=t.charAt(W),!o||!0!==i[m])return;X=parseInt(o,10),v=m}if((m=t.charAt(++W))!==p&&m!==f)return;if(n)return!0;W=0,C=[],R=[],L=[];for(;W<q;){for(y=t.indexOf(d,W),b=W,_=!1,F=!1,-1===y&&(y=q),j=W+g,Y=0;W<q;){if((m=t.charAt(W))===f)Y+=g-Y%g;else{if(m!==p)break;Y++}W++}if(Y>=g&&(F=!0),I&&Y>=I.indent&&(F=!0),m=t.charAt(W),w=null,!F){if(!0===x[m])w=m,W++,Y++;else{for(o="";W<q&&(m=t.charAt(W),a(m));)o+=m,W++;m=t.charAt(W),W++,o&&!0===i[m]&&(w=m,Y+=o.length+1)}if(w)if((m=t.charAt(W))===f)Y+=g-Y%g,W++;else if(m===p){for(j=W+g;W<j&&t.charAt(W)===p;)W++,Y++;W===j&&t.charAt(W)===p&&(W-=g-1,Y-=g-1)}else m!==d&&""!==m&&(w=null)}if(w){if(!V&&v!==w)break;_=!0}else U||F||t.charAt(b)!==p?U&&I&&(F=Y>=I.indent||Y>g):F=!0,_=!1,W=b;if(P=t.slice(b,y),T=b===W?P:t.slice(W,y),(w===l||w===u||w===h)&&H.thematicBreak.call(this,e,P,!0))break;if(A=O,O=!r(T).length,F&&I)I.value=I.value.concat(L,P),R=R.concat(L,P),L=[];else if(_)0!==L.length&&(I.value.push(""),I.trail=L.concat()),I={value:[P],indent:Y,trail:[]},C.push(I),R=R.concat(L,P),L=[];else if(O){if(A)break;L.push(P)}else{if(A)break;if(c(G,H,this,[e,P,!0]))break;I.value=I.value.concat(L,P),R=R.concat(L,P),L=[]}W=y+1}D=e(R.join(d)).reset({type:"list",ordered:s,start:X,loose:null,children:[]}),k=this.enterList(),N=this.enterBlock(),z=!1,W=-1,q=C.length;for(;++W<q;)I=C[W].value.join(d),B=e.now(),(I=e(I)(S(this,I,B),D)).loose&&(z=!0),I=C[W].trail.join(d),W!==q-1&&(I+=d),e(I);return k(),N(),D.loose=z,D};var l="*",u="_",h="-",p=" ",d="\n",f="\t",m="x",g=4,v=/\n\n(?!\s*$)/,y=/^\[([ \t]|x|X)][ \t]/,b=/^([ \t]*)([*+-]|\d+[.)])( {1,4}(?! )| |\t|$|(?=\n))([^\n]*)/,_=/^([ \t]*)([*+-]|\d+[.)])([ \t]+)/,w=/^( {1,4}|\t)?/gm,x={};x[l]=!0,x["+"]=!0,x[h]=!0;var E={".":!0},M={};function S(e,t,n){var r,i,a=e.offset,o=null;return t=(e.options.pedantic?T:P).apply(null,arguments),e.options.gfm&&(r=t.match(y))&&(i=r[0].length,o=r[1].toLowerCase()===m,a[n.line]+=i,t=t.slice(i)),{type:"listItem",loose:v.test(t)||t.charAt(t.length-1)===d,checked:o,children:e.tokenizeBlock(t,n)}}function T(e,t,n){var r=e.offset,i=n.line;return t=t.replace(_,a),i=n.line,t.replace(w,a);function a(e){return r[i]=(r[i]||0)+e.length,i++,""}}function P(e,t,n){var r,a,c,l,u,h,f,m=e.offset,g=n.line;for(l=(t=t.replace(b,function(e,t,n,o,s){a=t+n+o,c=s,Number(n)<10&&a.length%2==1&&(n=p+n);return(r=t+i(p,n.length)+o)+c})).split(d),(u=s(t,o(r).indent).split(d))[0]=c,m[g]=(m[g]||0)+a.length,g++,h=0,f=l.length;++h<f;)m[g]=(m[g]||0)+l[h].length-u[h].length,g++;return u.join(d)}M["."]=!0,M[")"]=!0},function(e,t,n){"use strict";var r=n(23),i=n(48),a=n(70);e.exports=function(e,t){var n,l,u,h,p=e.split(s),d=p.length+1,f=1/0,m=[];p.unshift(i(o,t)+"!");for(;d--;)if(l=a(p[d]),m[d]=l.stops,0!==r(p[d]).length){if(!l.indent){f=1/0;break}l.indent>0&&l.indent<f&&(f=l.indent)}if(f!==1/0)for(d=p.length;d--;){for(u=m[d],n=f;n&&!(n in u);)n--;h=0!==r(p[d]).length&&f&&n!==f?c:"",p[d]=h+p[d].slice(n in u?u[n]+1:0)}return p.shift(),p.join(s)};var o=" ",s="\n",c="\t"},function(e,t,n){"use strict";e.exports=function(e,t,n){var c,l,u,h,p,d=e.now(),f=t.length,m=-1,g="";for(;++m<f;){if((u=t.charAt(m))!==a||m>=o){m--;break}g+=u}c="",l="";for(;++m<f;){if((u=t.charAt(m))===r){m--;break}u===a||u===i?l+=u:(c+=l+u,l="")}if(d.column+=g.length,d.offset+=g.length,g+=c+l,u=t.charAt(++m),h=t.charAt(++m),u!==r||!s[h])return;g+=u,l=h,p=s[h];for(;++m<f;){if((u=t.charAt(m))!==h){if(u!==r)return;m--;break}l+=u}if(n)return!0;return e(g+l)({type:"heading",depth:p,children:this.tokenizeInline(c,d)})};var r="\n",i="\t",a=" ",o=3,s={};s["="]=1,s["-"]=2},function(e,t,n){"use strict";var r=n(71).openCloseTag;e.exports=function(e,t,n){var c,l,u,h,p,d,f,m=this.options.blocks,g=t.length,v=0,y=[[/^<(script|pre|style)(?=(\s|>|$))/i,/<\/(script|pre|style)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Za-z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+m.join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp(r.source+"\\s*$"),/^$/,!1]];for(;v<g&&((h=t.charAt(v))===i||h===a);)v++;if(t.charAt(v)!==s)return;c=-1===(c=t.indexOf(o,v+1))?g:c,l=t.slice(v,c),u=-1,p=y.length;for(;++u<p;)if(y[u][0].test(l)){d=y[u];break}if(!d)return;if(n)return d[2];if(v=c,!d[1].test(l))for(;v<g;){if(c=-1===(c=t.indexOf(o,v+1))?g:c,l=t.slice(v+1,c),d[1].test(l)){l&&(v=c);break}v=c}return f=t.slice(0,v),e(f)({type:"html",value:f})};var i="\t",a=" ",o="\n",s="<"},function(e,t,n){"use strict";var r=n(14),i=n(51);e.exports=f,f.notInList=!0,f.notInBlock=!0;var a="\\",o="\n",s="\t",c=" ",l="[",u="]",h="^",p=":",d=/^( {4}|\t)?/gm;function f(e,t,n){var f,m,g,v,y,b,_,w,x,E,M,S,T=this.offset;if(this.options.footnotes){for(f=0,m=t.length,g="",v=e.now(),y=v.line;f<m&&(x=t.charAt(f),r(x));)g+=x,f++;if(t.charAt(f)===l&&t.charAt(f+1)===h){for(f=(g+=l+h).length,_="";f<m&&(x=t.charAt(f))!==u;)x===a&&(_+=x,f++,x=t.charAt(f)),_+=x,f++;if(_&&t.charAt(f)===u&&t.charAt(f+1)===p){if(n)return!0;for(E=i(_),f=(g+=_+u+p).length;f<m&&((x=t.charAt(f))===s||x===c);)g+=x,f++;for(v.column+=g.length,v.offset+=g.length,_="",b="",w="";f<m;){if((x=t.charAt(f))===o){for(w=x,f++;f<m&&(x=t.charAt(f))===o;)w+=x,f++;for(_+=w,w="";f<m&&(x=t.charAt(f))===c;)w+=x,f++;if(0===w.length)break;_+=w}_&&(b+=_,_=""),b+=x,f++}return g+=b,b=b.replace(d,function(e){return T[y]=(T[y]||0)+e.length,y++,""}),M=e(g),S=this.enterBlock(),b=this.tokenizeBlock(b,v),S(),M({type:"footnoteDefinition",identifier:E,children:b})}}}}},function(e,t,n){"use strict";e.exports=function(e){return String(e).replace(/\s+/g," ")}},function(e,t,n){"use strict";var r=n(14),i=n(51);e.exports=y,y.notInList=!0,y.notInBlock=!0;var a='"',o="'",s="\\",c="\n",l="\t",u=" ",h="[",p="]",d="(",f=")",m=":",g="<",v=">";function y(e,t,n){for(var r,v,y,w,x,E,M,S,T=this.options.commonmark,P=0,A=t.length,O="";P<A&&((w=t.charAt(P))===u||w===l);)O+=w,P++;if((w=t.charAt(P))===h){for(P++,O+=w,y="";P<A&&(w=t.charAt(P))!==p;)w===s&&(y+=w,P++,w=t.charAt(P)),y+=w,P++;if(y&&t.charAt(P)===p&&t.charAt(P+1)===m){for(E=y,P=(O+=y+p+m).length,y="";P<A&&((w=t.charAt(P))===l||w===u||w===c);)O+=w,P++;if(y="",r=O,(w=t.charAt(P))===g){for(P++;P<A&&b(w=t.charAt(P));)y+=w,P++;if((w=t.charAt(P))===b.delimiter)O+=g+y+w,P++;else{if(T)return;P-=y.length+1,y=""}}if(!y){for(;P<A&&_(w=t.charAt(P));)y+=w,P++;O+=y}if(y){for(M=y,y="";P<A&&((w=t.charAt(P))===l||w===u||w===c);)y+=w,P++;if(x=null,(w=t.charAt(P))===a?x=a:w===o?x=o:w===d&&(x=f),x){if(!y)return;for(P=(O+=y+w).length,y="";P<A&&(w=t.charAt(P))!==x;){if(w===c){if(P++,(w=t.charAt(P))===c||w===x)return;y+=c}y+=w,P++}if((w=t.charAt(P))!==x)return;v=O,O+=y+w,P++,S=y,y=""}else y="",P=O.length;for(;P<A&&((w=t.charAt(P))===l||w===u);)O+=w,P++;return(w=t.charAt(P))&&w!==c?void 0:!!n||(r=e(r).test().end,M=this.decode.raw(this.unescape(M),r,{nonTerminated:!1}),S&&(v=e(v).test().end,S=this.decode.raw(this.unescape(S),v)),e(O)({type:"definition",identifier:i(E),title:S||null,url:M}))}}}}function b(e){return e!==v&&e!==h&&e!==p}function _(e){return e!==h&&e!==p&&!r(e)}b.delimiter=v},function(e,t,n){"use strict";var r=n(14);e.exports=function(e,t,n){var y,b,_,w,x,E,M,S,T,P,A,O,C,R,L,I,k,N,z,D,B,j,F,U;if(!this.options.gfm)return;y=0,N=0,E=t.length+1,M=[];for(;y<E;){if(j=t.indexOf(u,y),F=t.indexOf(s,y+1),-1===j&&(j=t.length),-1===F||F>j){if(N<d)return;break}M.push(t.slice(y,j)),N++,y=j+1}w=M.join(u),b=M.splice(1,1)[0]||[],y=0,E=b.length,N--,_=!1,A=[];for(;y<E;){if((T=b.charAt(y))===s){if(P=null,!1===_){if(!1===U)return}else A.push(_),_=!1;U=!1}else if(T===o)P=!0,_=_||v;else if(T===c)_=_===f?m:P&&_===v?g:f;else if(!r(T))return;y++}!1!==_&&A.push(_);if(A.length<p)return;if(n)return!0;k=-1,D=[],B=e(w).reset({type:"table",align:A,children:D});for(;++k<N;){for(z=M[k],x={type:"tableRow",children:[]},k&&e(u),e(z).reset(x,B),E=z.length+1,y=0,S="",O="",C=!0,R=null,L=null;y<E;)if((T=z.charAt(y))!==h&&T!==l){if(""===T||T===s)if(C)e(T);else{if(T&&L){S+=T,y++;continue}!O&&!T||C||(w=O,S.length>1&&(T?(w+=S.slice(0,S.length-1),S=S.charAt(S.length-1)):(w+=S,S="")),I=e.now(),e(w)({type:"tableCell",children:this.tokenizeInline(O,I)},x)),e(S+T),S="",O=""}else if(S&&(O+=S,S=""),O+=T,T===i&&y!==E-2&&(O+=z.charAt(y+1),y++),T===a){for(R=1;z.charAt(y+1)===T;)O+=T,y++,R++;L?R>=L&&(L=0):L=R}C=!1,y++}else O?S+=T:e(T),y++;k||e(u+b)}return B};var i="\\",a="`",o="-",s="|",c=":",l=" ",u="\n",h="\t",p=1,d=2,f="left",m="center",g="right",v=null},function(e,t,n){"use strict";var r=n(23),i=n(35),a=n(49),o=n(50);e.exports=function(e,t,n){var h,p,d,f,m,g=this.options,v=g.commonmark,y=g.gfm,b=this.blockTokenizers,_=this.interruptParagraph,w=t.indexOf(s),x=t.length;for(;w<x;){if(-1===w){w=x;break}if(t.charAt(w+1)===s)break;if(v){for(f=0,h=w+1;h<x;){if((d=t.charAt(h))===c){f=u;break}if(d!==l)break;f++,h++}if(f>=u){w=t.indexOf(s,w+1);continue}}if(p=t.slice(w+1),o(_,b,this,[e,p,!0]))break;if(b.list.call(this,e,p,!0)&&(this.inList||v||y&&!i(r.left(p).charAt(0))))break;if(h=w,-1!==(w=t.indexOf(s,w+1))&&""===r(t.slice(h,w))){w=h;break}}if(p=t.slice(0,w),""===r(p))return e(p),null;if(n)return!0;return m=e.now(),p=a(p),e(p)({type:"paragraph",children:this.tokenizeInline(p,m)})};var s="\n",c="\t",l=" ",u=4},function(e,t,n){"use strict";var r=n(179);function i(e,t,n){var r,i;if("\\"===t.charAt(0)&&(r=t.charAt(1),-1!==this.escape.indexOf(r)))return!!n||(i="\n"===r?{type:"break"}:{type:"text",value:r},e("\\"+r)(i))}e.exports=i,i.locator=r},function(e,t,n){"use strict";e.exports=function(e,t){return e.indexOf("\\",t)}},function(e,t,n){"use strict";var r=n(14),i=n(47),a=n(72);e.exports=p,p.locator=a,p.notInLink=!0;var o="<",s=">",c="@",l="/",u="mailto:",h=u.length;function p(e,t,n){var a,p,d,f,m,g,v,y,b,_,w;if(t.charAt(0)===o){for(this,a="",p=t.length,d=0,f="",g=!1,v="",d++,a=o;d<p&&(m=t.charAt(d),!(r(m)||m===s||m===c||":"===m&&t.charAt(d+1)===l));)f+=m,d++;if(f){if(v+=f,f="",v+=m=t.charAt(d),d++,m===c)g=!0;else{if(":"!==m||t.charAt(d+1)!==l)return;v+=l,d++}for(;d<p&&(m=t.charAt(d),!r(m)&&m!==s);)f+=m,d++;if(m=t.charAt(d),f&&m===s)return!!n||(b=v+=f,a+=v+m,(y=e.now()).column++,y.offset++,g&&(v.slice(0,h).toLowerCase()===u?(b=b.substr(h),y.column+=h,y.offset+=h):v=u+v),_=this.inlineTokenizers,this.inlineTokenizers={text:_.text},w=this.enterLink(),b=this.tokenizeInline(b,y),this.inlineTokenizers=_,w(),e(a)({type:"link",title:null,url:i(v,{nonTerminated:!1}),children:b}))}}}},function(e,t,n){"use strict";var r=n(47),i=n(14),a=n(182);e.exports=m,m.locator=a,m.notInLink=!0;var o="[",s="]",c="(",l=")",u="<",h="@",p="mailto:",d=["http://","https://",p],f=d.length;function m(e,t,n){var a,m,g,v,y,b,_,w,x,E,M,S;if(this.options.gfm){for(a="",v=-1,w=f;++v<w;)if(b=d[v],(_=t.slice(0,b.length)).toLowerCase()===b){a=_;break}if(a){for(v=a.length,w=t.length,x="",E=0;v<w&&(g=t.charAt(v),!i(g)&&g!==u)&&("."!==g&&","!==g&&":"!==g&&";"!==g&&'"'!==g&&"'"!==g&&")"!==g&&"]"!==g||(M=t.charAt(v+1))&&!i(M))&&(g!==c&&g!==o||E++,g!==l&&g!==s||!(--E<0));)x+=g,v++;if(x){if(m=a+=x,b===p){if(-1===(y=x.indexOf(h))||y===w-1)return;m=m.substr(p.length)}return!!n||(S=this.enterLink(),m=this.tokenizeInline(m,e.now()),S(),e(a)({type:"link",title:null,url:r(a,{nonTerminated:!1}),children:m}))}}}}},function(e,t,n){"use strict";e.exports=function(e,t){var n,i=r.length,a=-1,o=-1;if(!this.options.gfm)return-1;for(;++a<i;)-1!==(n=e.indexOf(r[a],t))&&(n<o||-1===o)&&(o=n);return o};var r=["https://","http://","mailto:"]},function(e,t,n){"use strict";var r=n(68),i=n(72),a=n(71).tag;e.exports=c,c.locator=i;var o=/^<a /i,s=/^<\/a>/i;function c(e,t,n){var i,c,l=t.length;if(!("<"!==t.charAt(0)||l<3)&&(i=t.charAt(1),(r(i)||"?"===i||"!"===i||"/"===i)&&(c=t.match(a))))return!!n||(c=c[0],!this.inLink&&o.test(c)?this.inLink=!0:this.inLink&&s.test(c)&&(this.inLink=!1),e(c)({type:"html",value:c}))}},function(e,t,n){"use strict";var r=n(14),i=n(73);e.exports=g,g.locator=i;var a={}.hasOwnProperty,o="\\",s="[",c="]",l="(",u=")",h="<",p=">",d="`",f={'"':'"',"'":"'"},m={};function g(e,t,n){var i,g,v,y,b,_,w,x,E,M,S,T,P,A,O,C,R,L,I,k="",N=0,z=t.charAt(0),D=this.options.pedantic,B=this.options.commonmark,j=this.options.gfm;if("!"===z&&(E=!0,k=z,z=t.charAt(++N)),z===s&&(E||!this.inLink)){for(k+=z,O="",N++,T=t.length,A=0,(R=e.now()).column+=N,R.offset+=N;N<T;){if(_=z=t.charAt(N),z===d){for(g=1;t.charAt(N+1)===d;)_+=z,N++,g++;v?g>=v&&(v=0):v=g}else if(z===o)N++,_+=t.charAt(N);else if(v&&!j||z!==s){if((!v||j)&&z===c){if(!A){if(!D)for(;N<T&&(z=t.charAt(N+1),r(z));)_+=z,N++;if(t.charAt(N+1)!==l)return;_+=l,i=!0,N++;break}A--}}else A++;O+=_,_="",N++}if(i){for(M=O,k+=O+_,N++;N<T&&(z=t.charAt(N),r(z));)k+=z,N++;if(z=t.charAt(N),x=B?m:f,O="",y=k,z===h){for(N++,y+=h;N<T&&(z=t.charAt(N))!==p;){if(B&&"\n"===z)return;O+=z,N++}if(t.charAt(N)!==p)return;k+=h+O+p,C=O,N++}else{for(z=null,_="";N<T&&(z=t.charAt(N),!_||!a.call(x,z));){if(r(z)){if(!D)break;_+=z}else{if(z===l)A++;else if(z===u){if(0===A)break;A--}O+=_,_="",z===o&&(O+=o,z=t.charAt(++N)),O+=z}N++}C=O,N=(k+=O).length}for(O="";N<T&&(z=t.charAt(N),r(z));)O+=z,N++;if(z=t.charAt(N),k+=O,O&&a.call(x,z))if(N++,k+=z,O="",S=x[z],b=k,B){for(;N<T&&(z=t.charAt(N))!==S;)z===o&&(O+=o,z=t.charAt(++N)),N++,O+=z;if((z=t.charAt(N))!==S)return;for(P=O,k+=O+z,N++;N<T&&(z=t.charAt(N),r(z));)k+=z,N++}else for(_="";N<T;){if((z=t.charAt(N))===S)w&&(O+=S+_,_=""),w=!0;else if(w){if(z===u){k+=O+S+_,P=O;break}r(z)?_+=z:(O+=S+_+z,_="",w=!1)}else O+=z;N++}if(t.charAt(N)===u)return!!n||(k+=u,C=this.decode.raw(this.unescape(C),e(y).test().end,{nonTerminated:!1}),P&&(b=e(b).test().end,P=this.decode.raw(this.unescape(P),b)),I={type:E?"image":"link",title:P||null,url:C},E?I.alt=this.decode.raw(this.unescape(M),R)||null:(L=this.enterLink(),I.children=this.tokenizeInline(M,R),L()),e(k)(I))}}}m['"']='"',m["'"]="'",m[l]=u},function(e,t,n){"use strict";var r=n(14),i=n(73),a=n(51);e.exports=g,g.locator=i;var o="link",s="image",c="footnote",l="shortcut",u="collapsed",h="full",p="^",d="\\",f="[",m="]";function g(e,t,n){var i,g,v,y,b,_,w,x,E=t.charAt(0),M=0,S=t.length,T="",P="",A=o,O=l;if("!"===E&&(A=s,P=E,E=t.charAt(++M)),E===f){if(M++,P+=E,_="",this.options.footnotes&&t.charAt(M)===p){if(A===s)return;P+=p,M++,A=c}for(x=0;M<S;){if((E=t.charAt(M))===f)w=!0,x++;else if(E===m){if(!x)break;x--}E===d&&(_+=d,E=t.charAt(++M)),_+=E,M++}if(T=_,i=_,(E=t.charAt(M))===m){for(M++,T+=E,_="";M<S&&(E=t.charAt(M),r(E));)_+=E,M++;if(E=t.charAt(M),A!==c&&E===f){for(g="",_+=E,M++;M<S&&(E=t.charAt(M))!==f&&E!==m;)E===d&&(g+=d,E=t.charAt(++M)),g+=E,M++;(E=t.charAt(M))===m?(O=g?h:u,_+=g+E,M++):g="",T+=_,_=""}else{if(!i)return;g=i}if(O===h||!w)return T=P+T,A===o&&this.inLink?null:!!n||(A===c&&-1!==i.indexOf(" ")?e(T)({type:"footnote",children:this.tokenizeInline(i,e.now())}):((v=e.now()).column+=P.length,v.offset+=P.length,y={type:A+"Reference",identifier:a(g=O===h?g:i)},A!==o&&A!==s||(y.referenceType=O),A===o?(b=this.enterLink(),y.children=this.tokenizeInline(i,v),b()):A===s&&(y.alt=this.decode.raw(this.unescape(i),v)||null),e(T)(y)))}}}},function(e,t,n){"use strict";var r=n(23),i=n(14),a=n(187);e.exports=c,c.locator=a;var o="*",s="_";function c(e,t,n){var a,c,l,u,h,p,d,f=0,m=t.charAt(f);if(!(m!==o&&m!==s||t.charAt(++f)!==m||(c=this.options.pedantic,h=(l=m)+l,p=t.length,f++,u="",m="",c&&i(t.charAt(f)))))for(;f<p;){if(d=m,!((m=t.charAt(f))!==l||t.charAt(f+1)!==l||c&&i(d))&&(m=t.charAt(f+2))!==l){if(!r(u))return;return!!n||((a=e.now()).column+=2,a.offset+=2,e(h+u+h)({type:"strong",children:this.tokenizeInline(u,a)}))}c||"\\"!==m||(u+=m,m=t.charAt(++f)),u+=m,f++}}},function(e,t,n){"use strict";e.exports=function(e,t){var n=e.indexOf("**",t),r=e.indexOf("__",t);if(-1===r)return n;if(-1===n)return r;return r<n?r:n}},function(e,t,n){"use strict";var r=n(23),i=n(189),a=n(14),o=n(190);e.exports=l,l.locator=o;var s="*",c="_";function l(e,t,n){var o,l,u,h,p,d,f,m=0,g=t.charAt(m);if(!(g!==s&&g!==c||(l=this.options.pedantic,p=g,u=g,d=t.length,m++,h="",g="",l&&a(t.charAt(m)))))for(;m<d;){if(f=g,!((g=t.charAt(m))!==u||l&&a(f))){if((g=t.charAt(++m))!==u){if(!r(h)||f===u)return;if(!l&&u===c&&i(g)){h+=u;continue}return!!n||((o=e.now()).column++,o.offset++,e(p+h+u)({type:"emphasis",children:this.tokenizeInline(h,o)}))}h+=u}l||"\\"!==g||(h+=g,g=t.charAt(++m)),h+=g,m++}}},function(e,t,n){"use strict";e.exports=function(e){return i.test("number"==typeof e?r(e):e.charAt(0))};var r=String.fromCharCode,i=/\w/},function(e,t,n){"use strict";e.exports=function(e,t){var n=e.indexOf("*",t),r=e.indexOf("_",t);if(-1===r)return n;if(-1===n)return r;return r<n?r:n}},function(e,t,n){"use strict";var r=n(14),i=n(192);e.exports=s,s.locator=i;var a="~",o="~~";function s(e,t,n){var i,s,c,l="",u="",h="",p="";if(this.options.gfm&&t.charAt(0)===a&&t.charAt(1)===a&&!r(t.charAt(2)))for(i=1,s=t.length,(c=e.now()).column+=2,c.offset+=2;++i<s;){if(!((l=t.charAt(i))!==a||u!==a||h&&r(h)))return!!n||e(o+p+o)({type:"delete",children:this.tokenizeInline(p,c)});p+=u,h=u,u=l}}},function(e,t,n){"use strict";e.exports=function(e,t){return e.indexOf("~~",t)}},function(e,t,n){"use strict";var r=n(14),i=n(194);e.exports=o,o.locator=i;var a="`";function o(e,t,n){for(var i,o,s,c,l,u,h,p,d=t.length,f=0,m="",g="";f<d&&t.charAt(f)===a;)m+=a,f++;if(m){for(l=m,c=f,m="",p=t.charAt(f),s=0;f<d;){if(u=p,p=t.charAt(f+1),u===a?(s++,g+=u):(s=0,m+=u),s&&p!==a){if(s===c){l+=m+g,h=!0;break}m+=g,g=""}f++}if(!h){if(c%2!=0)return;m=""}if(n)return!0;for(i="",o="",d=m.length,f=-1;++f<d;)u=m.charAt(f),r(u)?o+=u:(o&&(i&&(i+=o),o=""),i+=u);return e(l)({type:"inlineCode",value:i})}}},function(e,t,n){"use strict";e.exports=function(e,t){return e.indexOf("`",t)}},function(e,t,n){"use strict";var r=n(196);e.exports=a,a.locator=r;var i=2;function a(e,t,n){for(var r,a=t.length,o=-1,s="";++o<a;){if("\n"===(r=t.charAt(o))){if(o<i)return;return!!n||e(s+=r)({type:"break"})}if(" "!==r)return;s+=r}}},function(e,t,n){"use strict";e.exports=function(e,t){var n=e.indexOf("\n",t);for(;n>t&&" "===e.charAt(n-1);)n--;return n}},function(e,t,n){"use strict";e.exports=function(e,t,n){var r,i,a,o,s,c,l,u,h,p;if(n)return!0;r=this.inlineMethods,o=r.length,i=this.inlineTokenizers,a=-1,h=t.length;for(;++a<o;)"text"!==(u=r[a])&&i[u]&&((l=i[u].locator)||e.file.fail("Missing locator: `"+u+"`"),-1!==(c=l.call(this,t,1))&&c<h&&(h=c));s=t.slice(0,h),p=e.now(),this.decode(s,p,function(t,n,r){e(r||t)({type:"text",value:t})})}},function(e,t,n){var r=n(199);e.exports=function(){return function(e){return r(e,"list",function(e,t){var n,r,i=0;for(n=0,r=t.length;n<r;n++)"list"===t[n].type&&(i+=1);for(n=0,r=e.children.length;n<r;n++){var a=e.children[n];a.index=n,a.ordered=e.ordered}e.depth=i}),e}}},function(e,t,n){"use strict";e.exports=function(e,t,n){var r=[];"function"==typeof t&&(n=t,t=null);function i(e){var a;return t&&e.type!==t||(a=n(e,r.concat())),e.children&&!1!==a?function(e,t){var n,a=e.length,o=-1;r.push(t);for(;++o<a;)if((n=e[o])&&!1===i(n))return!1;return r.pop(),!0}(e.children,e):a}i(e)}},function(e,t,n){"use strict";var r=n(36),i="virtualHtml",a=/^<(area|base|br|col|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)\s*\/?>$/i,o=/^<(\/?)([a-z]+)\s*>$/;e.exports=function(e){var t,n;return r(e,"html",function(e,r,s){n!==s&&(t=[],n=s);var c=function(e){var t=e.value.match(a);return!!t&&t[1]}(e);if(c)return s.children.splice(r,1,{type:i,tag:c,position:e.position}),!0;var l=function(e,t){var n=e.value.match(o);return!!n&&{tag:n[2],opening:!n[1],node:e}}(e);if(!l)return!0;var u=function(e,t){var n=e.length;for(;n--;)if(e[n].tag===t)return e.splice(n,1)[0];return!1}(t,l.tag);return u?s.children.splice(r,0,function(e,t,n){var r=n.children.indexOf(e.node),a=n.children.indexOf(t.node),o=n.children.splice(r,a-r+1).slice(1,-1);return{type:i,children:o,tag:e.tag,position:{start:e.node.position.start,end:t.node.position.end,indent:[]}}}(l,u,s)):l.opening||t.push(l),!0},!0),e}},function(e,t,n){"use strict";var r=n(36);function i(e,t,n,r){if("remove"===r)n.children.splice(t,1);else if("unwrap"===r){var i=[t,1];e.children&&(i=i.concat(e.children)),Array.prototype.splice.apply(n.children,i)}}t.ofType=function(e,t){return function(t){return e.forEach(function(e){return r(t,e,n,!0)}),t};function n(e,n,r){r&&i(e,n,r,t)}},t.ifNotMatch=function(e,t){return function(e){return r(e,n,!0),e};function n(n,r,a){a&&!e(n,r,a)&&i(n,r,a,t)}}},function(e,t,n){"use strict";var r=n(0),i=n(18);function a(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,c=t.renderers[e.type],l=e.position.start,u=[e.type,l.line,l.column].join("-");if("function"!=typeof c&&"string"!=typeof c&&!function(e){return r.Fragment&&r.Fragment===e}(c))throw new Error("Renderer for type `".concat(e.type,"` not defined or is not renderable"));var h=function(e,t,n,s,c,l){var u={key:t},h="string"==typeof s;n.sourcePos&&e.position&&(u["data-sourcepos"]=[(p=e.position).start.line,":",p.start.column,"-",p.end.line,":",p.end.column].map(String).join(""));var p;n.rawSourcePos&&!h&&(u.sourcePosition=e.position);n.includeNodeIndex&&c.node&&c.node.children&&!h&&(u.index=c.node.children.indexOf(e),u.parentChildCount=c.node.children.length);var d=null!==e.identifier&&void 0!==e.identifier?n.definitions[e.identifier]||{}:null;switch(e.type){case"root":o(u,{className:n.className});break;case"text":u.nodeKey=t,u.children=e.value;break;case"heading":u.level=e.depth;break;case"list":u.start=e.start,u.ordered=e.ordered,u.tight=!e.loose,u.depth=e.depth;break;case"listItem":u.checked=e.checked,u.tight=!e.loose,u.ordered=e.ordered,u.index=e.index,u.children=function(e,t){if(e.loose)return e.children;if(t.node&&e.index>0&&t.node.children[e.index-1].loose)return e.children;return function(e){return e.children.reduce(function(e,t){return e.concat("paragraph"===t.type?t.children||[]:[t])},[])}(e)}(e,c).map(function(t,r){return a(t,n,{node:e,props:u},r)});break;case"definition":o(u,{identifier:e.identifier,title:e.title,url:e.url});break;case"code":o(u,{language:e.lang&&e.lang.split(/\s/,1)[0]});break;case"inlineCode":u.children=e.value,u.inline=!0;break;case"link":o(u,{title:e.title||void 0,target:"function"==typeof n.linkTarget?n.linkTarget(e.url,e.children,e.title):n.linkTarget,href:n.transformLinkUri?n.transformLinkUri(e.url,e.children,e.title):e.url});break;case"image":o(u,{alt:e.alt||void 0,title:e.title||void 0,src:n.transformImageUri?n.transformImageUri(e.url,e.children,e.title,e.alt):e.url});break;case"linkReference":o(u,i(d,{href:n.transformLinkUri?n.transformLinkUri(d.href):d.href}));break;case"imageReference":o(u,{src:n.transformImageUri&&d.href?n.transformImageUri(d.href,e.children,d.title,e.alt):d.href,title:d.title||void 0,alt:e.alt||void 0});break;case"table":case"tableHead":case"tableBody":u.columnAlignment=e.align;break;case"tableRow":u.isHeader="tableHead"===c.node.type,u.columnAlignment=c.props.columnAlignment;break;case"tableCell":o(u,{isHeader:c.props.isHeader,align:c.props.columnAlignment[l]});break;case"virtualHtml":u.tag=e.tag;break;case"html":u.isBlock=e.position.start.line!==e.position.end.line,u.escapeHtml=n.escapeHtml,u.skipHtml=n.skipHtml;break;case"parsedHtml":var f;e.children&&(f=e.children.map(function(t,r){return a(t,n,{node:e,props:u},r)})),u.escapeHtml=n.escapeHtml,u.skipHtml=n.skipHtml,u.element=function(e,t){var n=e.element;if(Array.isArray(n)){var i=r.Fragment||"div";return r.createElement(i,null,n)}if(n.props.children||t){var a=r.Children.toArray(n.props.children).concat(t);return r.cloneElement(n,null,a)}return r.cloneElement(n,null)}(e,f);break;default:o(u,i(e,{type:void 0,position:void 0,children:void 0}))}!h&&e.value&&(u.value=e.value);return u}(e,u,t,c,n,s);return r.createElement(c,h,h.children||e.children&&e.children.map(function(n,r){return a(n,t,{node:e,props:h},r)})||void 0)}function o(e,t){for(var n in t)void 0!==t[n]&&(e[n]=t[n])}e.exports=a},function(e,t,n){"use strict";var r=n(36);function i(e){var t=e.children;e.children=[{type:"tableHead",align:e.align,children:[t[0]],position:t[0].position}],t.length>1&&e.children.push({type:"tableBody",align:e.align,children:t.slice(1),position:{start:t[1].position.start,end:t[t.length-1].position.end}})}e.exports=function(e){return r(e,"table",i),e}},function(e,t,n){"use strict";e.exports=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(t.children||[]).reduce(function(t,n){return"definition"===n.type&&(t[n.identifier]={href:n.url,title:n.title}),e(n,t)},n)}},function(e,t,n){"use strict";var r=["http","https","mailto","tel"];e.exports=function(e){var t=(e||"").trim(),n=t.charAt(0);if("#"===n||"/"===n)return t;var i=t.indexOf(":");if(-1===i)return t;for(var a=r.length,o=-1;++o<a;){var s=r[o];if(i===s.length&&t.slice(0,s.length).toLowerCase()===s)return t}return-1!==(o=t.indexOf("?"))&&i>o?t:-1!==(o=t.indexOf("#"))&&i>o?t:"javascript:void(0)"}},function(e,t,n){"use strict";var r=n(18),i=n(0),a=parseInt((i.version||"16").slice(0,2),10)>=16,o=i.createElement;function s(e,t){return o(e,c(t),t.children)}function c(e){return e["data-sourcepos"]?{"data-sourcepos":e["data-sourcepos"]}:{}}e.exports={break:"br",paragraph:"p",emphasis:"em",strong:"strong",thematicBreak:"hr",blockquote:"blockquote",delete:"del",link:"a",image:"img",linkReference:"a",imageReference:"img",table:s.bind(null,"table"),tableHead:s.bind(null,"thead"),tableBody:s.bind(null,"tbody"),tableRow:s.bind(null,"tr"),tableCell:function(e){var t=e.align?{textAlign:e.align}:void 0,n=c(e);return o(e.isHeader?"th":"td",t?r({style:t},n):n,e.children)},root:function(e){var t=!e.className,n=t&&i.Fragment||"div";return o(n,t?null:e,e.children)},text:function(e){return a?e.children:o("span",null,e.children)},list:function(e){var t=c(e);null!==e.start&&1!==e.start&&(t.start=e.start.toString());return o(e.ordered?"ol":"ul",t,e.children)},listItem:function(e){var t=null;if(null!==e.checked){var n=e.checked;t=o("input",{type:"checkbox",checked:n,readOnly:!0})}return o("li",c(e),t,e.children)},definition:function(){return null},heading:function(e){return o("h".concat(e.level),c(e),e.children)},inlineCode:function(e){return o("code",c(e),e.children)},code:function(e){var t=e.language&&"language-".concat(e.language),n=o("code",t?{className:t}:null,e.value);return o("pre",c(e),n)},html:function(e){if(e.skipHtml)return null;var t=e.isBlock?"div":"span";if(e.escapeHtml){var n=i.Fragment||t;return o(n,null,e.value)}var r={dangerouslySetInnerHTML:{__html:e.value}};return o(t,r)},virtualHtml:function(e){return o(e.tag,c(e),e.children)},parsedHtml:function(e){return e["data-sourcepos"]?i.cloneElement(e.element,{"data-sourcepos":e["data-sourcepos"]}):e.element}}},function(e,t,n){"use strict";t.HtmlParser="undefined"==typeof Symbol?"__RMD_HTML_PARSER__":Symbol("__RMD_HTML_PARSER__")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(16),a=n(209);t.CustomLink=class extends r.Component{constructor(e){super(e)}render(){if(this.props.href.startsWith("footnote/")){const e=this.props.href.slice("footnote/".length);return r.createElement(a.FootnoteLink,{id:e,children:this.props.children})}if(this.props.href.startsWith("highlight-param/")){const e=this.props.href.slice("highlight-param/".length);return r.createElement("a",{href:"javascript:void",className:"param-highlight-link",onMouseEnter:()=>{i.publish("highlightParamMessage",{param:e,highlight:!0})},onMouseLeave:()=>{i.publish("highlightParamMessage",{param:e,highlight:!1})}},this.props.children)}return this.props.href.startsWith("/")||this.props.href.startsWith("mailto:")?r.createElement("a",{href:this.props.href},this.props.children):r.createElement("a",{href:this.props.href,rel:"noopener noreferrer",target:"_blank"},this.props.children)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(17),a=n(5),o=n(26),s=n(33);class c extends r.Component{constructor(e){super(e),this.sizeObserver=new a.SizeObserver,this.state={text:"",active:!1,activeMargin:0},this.footnoteRef=r.createRef(),this.handleClick=this.handleClick.bind(this),this.getActiveMargin=this.getActiveMargin.bind(this),this.onWindowResize=this.onWindowResize.bind(this)}render(){const e=`inline_footnote ${this.state.active?"active":""}`,t=this.state.active?{marginBottom:this.state.activeMargin}:{marginBottom:"0px"};return r.createElement("span",{className:e,style:t},r.createElement("a",{href:"javascript:void(0)",className:"inline_footnote__toggle"},r.createElement("span",{className:"inline_footnote__toggle_bg"}),r.createElement("span",{className:"inline_footnote__toggle_label",onClick:this.handleClick},this.props.children)),r.createElement("div",{className:"inline_footnote__container",ref:this.footnoteRef},r.createElement("div",{className:"inline_footnote__content_wrap"},r.createElement("div",{className:"inline_footnote__content"},o.renderMarkdown(this.getFootnoteText()))),r.createElement("a",{href:"javascript:void(0)",onClick:this.handleClick,className:"circle-button inline_footnote__close_button"},r.createElement("span",{className:"bg-indicator"}),r.createElement("span",{className:"icon"},r.createElement(i.FootnoteCloseIcon,null)))))}componentDidMount(){this.sizeObserver.startObserving(this.footnoteRef,this.onWindowResize)}componentWillUnmount(){this.sizeObserver.stopObserving()}onWindowResize(){this.state.active&&this.setState({activeMargin:this.getActiveMargin()})}getFootnoteText(){const e=this.context.chunks.find(e=>e.metadata.footnote===this.props.id);return void 0===e?`Footnote not found: ${this.props.id}`:e.markdown}getActiveMargin(){const e=this.footnoteRef.current;if(e){const t=32;return e.getBoundingClientRect().height+2*t}return 0}handleClick(){this.setState({active:!this.state.active,activeMargin:this.getActiveMargin()})}}c.contextType=s.PageContext,t.FootnoteLink=c},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,i=n;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0);t.Loader=class extends r.Component{constructor(e){super(e),this.state={component:void 0},this.props.componentPromise.then(e=>{this.setState({component:e})})}render(){return this.state.component?this.state.component:r.createElement(r.Fragment,null)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(12),i=n(8);t.findLessonSample=function(e,t){return fetch(r.urlForFile(`content/lessons/en/${t}/${e}.wav`)).then(e=>e.arrayBuffer()).then(e=>i.audioContext.decodeAudioData(e))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(75);t.ComponentName="def-player";t.DefPlayerComponent=class extends r.Component{constructor(e){super(e),this.handlePlayClick=e=>{this.defPlayer.play()},this.handleStopClick=e=>{this.defPlayer.stop()},this.defPlayer=new i.DefPlayer(this.props.player,this.props.defNotation)}render(){let e=this.props.defNotation.replace(/\/\/\s+/g,"//\n");return e=e.replace(/(\\tempo\s+\d+\.?\s+=\s+\d+\s+)/,"$1\n"),r.createElement("div",null,r.createElement("div",null,r.createElement("pre",null,e)),r.createElement("div",null,r.createElement("input",{type:"button",className:"musiclab--notation__transport-button",onClick:this.handlePlayClick,value:"Play"}),r.createElement("input",{type:"button",className:"musiclab--notation__transport-button",onClick:this.handleStopClick,value:"Stop"})))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(53),a=n(216),o=n(217),s=n(10),c=n(16);t.ComponentName="one-shot-sampler";t.Sampler=class extends r.Component{constructor(e){super(e),this.progress=0,this.startTime=0,this.animationFramer=new s.AnimationFramer,this.state={active:!1,playing:!1},this.tonePlayer=new i.Player(this.props.sample).toMaster(),this.tonePlayer.fadeOut=.5,this.tonePlayer.volume.value=void 0!==this.props.gainInDb?this.props.gainInDb:0,this.tonePlayer.loop=this.props.loop,this.togglePlay=this.togglePlay.bind(this),this.animationFrame=this.animationFrame.bind(this),this.onSoundPlaybackStartedMessage=this.onSoundPlaybackStartedMessage.bind(this)}componentDidMount(){c.subscribe("soundPlaybackStarted",this.onSoundPlaybackStartedMessage)}componentWillUnmount(){c.unsubscribe("soundPlaybackStarted",this.onSoundPlaybackStartedMessage),this.tonePlayer.stop(),this.animationFramer.stopAnimating()}render(){return r.createElement("div",{onMouseDown:this.togglePlay,className:"started"===this.tonePlayer.state?"one-shot-sampler one-shot-sampler--playing":"one-shot-sampler one-shot-sampler--stopped"},r.createElement("div",null,r.createElement(a.Waveform,{audioBuffer:this.tonePlayer.buffer.get(),progress:this.progress,normalize:!0,bipolar:!1,duration:this.props.duration}),r.createElement(o.PlayStopButton,{class:"one-shot-sampler__play-stop-toggle",playing:this.state.playing})))}togglePlay(){"stopped"===this.tonePlayer.state?this.play():this.stop()}play(){this.tonePlayer.stop(),this.tonePlayer.seek(0),this.props.loop?this.tonePlayer.start("+0","0"):this.tonePlayer.start("+0","0",this.durationToPlay()),this.startTime=performance.now(),this.animationFramer.startAnimating(this.animationFrame),this.setState({playing:!0}),c.publish("soundPlaybackStarted",{component:this})}stop(){this.tonePlayer.stop("+0"),this.setState({playing:!1})}durationToPlay(){return void 0===this.props.duration?this.tonePlayer.buffer.duration:Math.min(this.tonePlayer.buffer.duration,this.props.duration)}animationFrame(){this.progress=(performance.now()-this.startTime)/1e3/this.tonePlayer.buffer.duration,this.forceUpdate(),"started"!==this.tonePlayer.state&&(this.animationFramer.stopAnimating(),this.state.playing&&this.stop())}onSoundPlaybackStartedMessage(e){e.component!==this&&this.stop()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(52),a=n(5),o=n(6),s=n(12);t.Waveform=class extends r.Component{constructor(e){super(e),this.sizeObserver=new a.SizeObserver,this.waveformPoints="",this.uniqueId=i().replace(/-/g,"").substring(0,8),this.ref=r.createRef(),this.state={waveform:[]},this.onResize=this.onResize.bind(this)}render(){const e=`clip${this.uniqueId}`,t=`wave${this.uniqueId}`,n=this.sizeObserver.getHeight(),i=this.sizeObserver.getWidth();return r.createElement("div",{ref:this.ref,className:"waveform"},r.createElement("svg",{width:"100%",height:"100%"},r.createElement("clipPath",{id:e},r.createElement("rect",{x:"0",y:"0",width:`${i*this.playheadPct()}`,height:`${n}`})),r.createElement("polyline",{className:"waveform__background",points:this.waveformPoints}),r.createElement("polyline",{id:t,className:"waveform__foreground",clipPath:`url(#${e})`,points:this.waveformPoints})))}componentDidMount(){this.sizeObserver.startObserving(this.ref,this.onResize)}componentWillUnmount(){this.sizeObserver.stopObserving()}onResize(){this.computeWaveform().then(e=>{this.waveformPoints=this.props.bipolar?this.createBipolarWaveformPoints(e):this.createUnipolarWaveformPoints(e),this.forceUpdate()})}createBipolarWaveformPoints(e){const t=this.sizeObserver.getHeight()/2;let n="";e.forEach((e,r)=>{n+=`${r},${t-e*t-1} `});for(let r=e.length-1;r>=0;r--){const i=e[r]*t;n+=`${r},${t+i+1} `}return n}createUnipolarWaveformPoints(e){const t=this.sizeObserver.getHeight(),n=this.sizeObserver.getWidth();let r=`0,${t} `;return e.forEach((e,n)=>{r+=`${n},${t-e*t-1} `}),r+=`${n},${t} `}computeWaveform(){const e=this.sizeObserver.getWidth();return new Promise((t,n)=>{const r=new Worker(s.urlForFile("js/workers/waveform.js")),i={samples:this.props.audioBuffer.getChannelData(0),canvasWidth:e,samplesToDraw:this.samplesToDraw(),normalize:this.props.normalize};r.postMessage(i),r.onmessage=e=>{r.terminate(),t(e.data.waveform)}})}playheadPct(){if(0===this.props.progress)return 1;if(void 0===this.props.duration)return this.props.progress;{const e=this.props.audioBuffer.duration/this.props.duration,t=o.mapValueToRange(this.props.progress,0,1,0,e);return o.clamp(t,0,1)}}samplesToDraw(){return void 0===this.props.duration?this.props.audioBuffer.getChannelData(0).length:this.props.audioBuffer.sampleRate*this.props.duration}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(15),a=n(17);t.PlayStopButton=class extends r.PureComponent{constructor(e){super(e),this.playIconRef=r.createRef(),this.stopIconRef=r.createRef()}render(){return r.createElement("div",{className:this.props.class},r.createElement(a.PlayIcon,{ref:this.playIconRef}),r.createElement(a.StopIcon,{ref:this.stopIconRef}))}componentDidMount(){this.animateToggle(this.props.playing)}componentDidUpdate(){this.animateToggle(this.props.playing)}animateToggle(e){if(this.stopIconRef.current){const t=this.stopIconRef.current;i.remove(t),i({targets:t,opacity:e?1:0,scale:e?1:.5,elasticity:50,duration:500})}if(this.playIconRef.current){const t=this.playIconRef.current;i.remove(t),i({targets:t,opacity:e?0:1,scale:e?.5:1,elasticity:50,duration:500})}}}},function(e,t,n){var r,i,a;i=[],void 0===(a="function"==typeof(r=function(){var e=/^v?(?:\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+))?(?:-[\da-z\-]+(?:\.[\da-z\-]+)*)?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i;function t(e){var t,n,r=e.replace(/^v/,"").replace(/\+.*$/,""),i=(n="-",-1===(t=r).indexOf(n)?t.length:t.indexOf(n)),a=r.substring(0,i).split(".");return a.push(r.substring(i+1)),a}function n(e){return isNaN(Number(e))?e:Number(e)}function r(t){if("string"!=typeof t)throw new TypeError("Invalid argument expected string");if(!e.test(t))throw new Error("Invalid argument not valid semver ('"+t+"' received)")}function i(e,i){[e,i].forEach(r);for(var a=t(e),o=t(i),s=0;s<Math.max(a.length-1,o.length-1);s++){var c=parseInt(a[s]||0,10),l=parseInt(o[s]||0,10);if(c>l)return 1;if(l>c)return-1}var u=a[a.length-1],h=o[o.length-1];if(u&&h){var p=u.split(".").map(n),d=h.split(".").map(n);for(s=0;s<Math.max(p.length,d.length);s++){if(void 0===p[s]||"string"==typeof d[s]&&"number"==typeof p[s])return-1;if(void 0===d[s]||"string"==typeof p[s]&&"number"==typeof d[s])return 1;if(p[s]>d[s])return 1;if(d[s]>p[s])return-1}}else if(u||h)return u?-1:1;return 0}var a=[">",">=","=","<","<="];return i.compare=function(e,t,n){switch(function(e){if("string"!=typeof e)throw new TypeError("Invalid operator type, expected string but got "+typeof e);if(-1===a.indexOf(e))throw new TypeError("Invalid operator, expected one of "+a.join("|"))}(n),n){case">":return i(e,t)>0;case">=":return i(e,t)>=0;case"<":return i(e,t)<0;case"<=":return i(e,t)<=0;default:return 0===i(e,t)}},i})?r.apply(t,i):r)||(e.exports=a)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertHandled=function(e){throw new Error(`Unhandled object: ${e}`)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.KeyboardEventPlayer=class{constructor(e=2){this.pressedKeys=new Set,this.mode=e,this.onKeyPress=this.onKeyPress.bind(this),this.onKeyUp=this.onKeyUp.bind(this)}startObservingKeyboardEvents(e){this.midiListener||(window.addEventListener("keypress",this.onKeyPress),window.addEventListener("keyup",this.onKeyUp)),this.midiListener=e}stopObservingKeyboardEvents(){if(this.midiListener){window.removeEventListener("keypress",this.onKeyPress),window.removeEventListener("keyup",this.onKeyUp);for(const e of this.pressedKeys)this.midiListener.onNoteOff(this.keyEventCodeToNote(e),0)}this.pressedKeys.clear(),this.midiListener=void 0}onKeyPress(e){const t=this.keyEventCodeToNote(e.code);null===t||e.repeat||this.pressedKeys.has(e.code)||(this.pressedKeys.add(e.code),this.midiListener.onNoteOn(t,100))}onKeyUp(e){const t=this.keyEventCodeToNote(e.code);null!==t&&this.pressedKeys.delete(e.code)&&this.midiListener.onNoteOff(t,0)}keyEventCodeToNote(e){switch(this.mode){case 0:return this.singleOctaveMapping(e);case 1:return this.twoOctaveMapping(e);case 2:return this.isomorphicMapping(e,2,3);case 3:return this.isomorphicMapping(e,3,1);default:return null}}singleOctaveMapping(e){const t=["KeyA","KeyW","KeyS","KeyE","KeyD","KeyF","KeyT","KeyG","KeyY","KeyH","KeyU","KeyJ","KeyK","KeyO","KeyL","KeyP","Semicolon","Quote"].indexOf(e);return t>=0?60+t:null}twoOctaveMapping(e){let t=["KeyZ","KeyS","KeyX","KeyD","KeyC","KeyV","KeyG","KeyB","KeyH","KeyN","KeyJ","KeyM","Comma","KeyL","Period","Semicolon","Slash","Quote"].indexOf(e);return t>=0?48+t:(t=["KeyQ","Digit2","KeyW","Digit3","KeyE","KeyR","Digit5","KeyT","Digit6","KeyY","Digit7","KeyU","KeyI","Digit9","KeyO","Digit0","KeyP","BracketLeft"].indexOf(e))>=0?60+t:null}isomorphicMapping(e,t,n){let r=["KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash"].indexOf(e);return r>=0?36+r*t:(r=["KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote"].indexOf(e))>=0?36+n+r*t:(r=["KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Backslash"].indexOf(e))>=0?36+2*n+r*t:(r=["Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal"].indexOf(e))>=0?36+3*n+r*t:null}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0);t.ResetButton=class extends r.PureComponent{constructor(e){super(e)}render(){return r.createElement("div",{className:"subtractive-synth__reset-button",onClick:this.props.onClick},r.createElement("h4",null,"Reset"))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(223);t.SynthPlaybackControls=class extends r.Component{constructor(e){super(e)}render(){return r.createElement("div",{className:"subtractive-synth__playback_controls"},r.createElement(i.SynthPlayStopButton,{onClick:this.props.playingSequence?this.props.onStopSequence:this.props.onStartSequence,playing:this.props.playingSequence,progress:this.props.progress,tooltipKey:this.props.playButtonTooltipKey}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(15),a=n(3),o=n(17),s=n(24),c=n(13);t.SynthPlayStopButton=class extends r.PureComponent{constructor(e){super(e),this.pointerObserver=new c.PointerObserver,this.wasActivated=!1,this.playIconRef=r.createRef(),this.stopIconRef=r.createRef(),this.backgroundRef=r.createRef(),this.hitAreaRef=r.createRef(),this.onPointerChange=this.onPointerChange.bind(this)}render(){const e=2*Math.PI*19,t=this.props.progress?-(1-this.props.progress)*e:0,n=void 0!==this.props.progress&&this.props.progress>0,i=a("synth-playback_play-stop-button",{"synth-playback_play-stop-button--playing":this.props.playing},{"synth-playback_play-stop-button--show-progress":n},{"--was-activated":this.wasActivated});return r.createElement("div",{className:i,ref:this.hitAreaRef},r.createElement("span",{className:"bg"}),r.createElement("svg",{className:"progress",viewBox:"0 0 50 50"},r.createElement("circle",{className:"ring-bg",cx:"25px",cy:"25px",r:"19px"}),r.createElement("circle",{className:"ring",cx:"25px",cy:"25px",r:"19px",style:{strokeDasharray:`${e} ${e}`,strokeDashoffset:`${t}`}})),r.createElement(o.PlayIcon,{ref:this.playIconRef}),r.createElement(o.LessonStopIcon,{ref:this.stopIconRef}),this.props.tooltipKey&&r.createElement(s.ButtonTooltip,{tooltipKey:this.props.tooltipKey}))}componentDidMount(){this.animateToggle(this.props.playing),this.pointerObserver.startObserving(this.hitAreaRef.current,this.onPointerChange,{clampX:!0,clampY:!0})}componentWillUnmount(){this.pointerObserver.stopObserving()}componentDidUpdate(e){this.props.playing!==e.playing&&this.animateToggle(this.props.playing)}animateToggle(e){if(this.wasActivated=!0,this.stopIconRef.current){const t=this.stopIconRef.current;i.remove(t),i({targets:t,opacity:e?1:0,scale:e?1:.5,elasticity:50,duration:500})}if(this.playIconRef.current){const t=this.playIconRef.current;i.remove(t),i({targets:t,opacity:e?0:1,scale:e?.5:1,elasticity:50,duration:500})}if(this.backgroundRef.current){const t=this.backgroundRef.current;i.remove(t),i({targets:t,opacity:e?1:0,scale:e?1:0,elasticity:50,duration:500})}}onPointerChange(e){switch(e.type){case 0:this.props.onClick()}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(8),i=n(4);function a(e){return i.translated(e)+(r.browserSupportsAudioWorklet()?` ${i.translated("playground:sequences.with-drums")}`:"")}t.playgroundSequences=function(){return[{name:a("playground:sequences.no-downbeat"),notes:"d f a a' d' f a",sequence:"\n\\tempo 4 = 102\nr8 c,8.    c, c, c,8  bf16 c' //\nr8  hh  r  hh  r  hh                 r                   hh    //\nbd4     bd     bd    bd //\nr4      sn     r     sn\n".trim()},{name:a("playground:sequences.legato-lead"),notes:"c''4 c'''4 bf'' af'' g'' af'' f'' g'' f''g'' af'' g'' f'' af' g'",sequence:"\n\\tempo 4 = 88\nc''4 bf'' g'' f'' | r4 r8 f''16 g'' af''8 g''16 r16 f''16 af'8. //\nr8 c'''4 af'' af'' g''2 r2 g'8  //\nhh4/7 r r r hh r r hh4/7 r r r hh r r hh4/7 r r r hh r r hh4/7 r r r hh r r | hh4/7 r r r hh r r hh4/7 r r r hh r r hh4/7 r r r hh r r hh4/7 r r r hh r r //\nr4 sn r sn | r sn r sn //\nbd4 r bd r | bd4 r bd r4/7 r r r bd r r\n".trim()},{name:a("playground:sequences.midtempo"),notes:"d f a a' d' f a",sequence:"\n\\tempo 4 = 92\nd,8.    f,16  a, a, r d,8    f,16  a, a a, f16 c8  //\nr8  hh  r  hh  r  hh                 r                   hh    //\nbd4     bd     bd    bd8.               bd16 //\nr4      sn     r     sn\n".trim()},{name:i.translated("playground:sequences.slow-and-insistent"),notes:"e g",sequence:"\n\\tempo 4 = 64  a8. a8 a16 a16 r16 r8. a8 e'16 d'8 //\nr4 a'8 r8 r4 a'8 d'8\n".trim()},{name:i.translated("playground:sequences.eleven-fast-notes"),notes:"c df d ef e f gf g af a bf b c'",sequence:"\n\\tempo 4 = 108  d16 g a c d' f' f bf c' d'' c''\n".trim()},{name:i.translated("playground:sequences.not-quite-triplets"),notes:"c df d ef e f gf g af a bf b c'",sequence:"\n\\tempo 4 = 90 e16 c b8 c16 e b,32. d fs a, cs'8 b,16 g, g fs b, a16 c d'8  c16 e b,32. d fs a, cs'8 b,16 g, g fs b,\n".trim()},{name:i.translated("playground:sequences.four-on-the-floor"),notes:"f,,4 f,, f,, f,,",sequence:"\n\\tempo 4 = 133  f,,4 f,, f,, f,,\n".trim()}]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SliderGesture=class{constructor(e,t,n,r,i){this.pct=.5,this.initialPct=.5,this.pctTarget=.5,this.easing=5,this.restEasing=5,this.returnToInitial=!1,this.gestureActive=!1,this.initialPct=t,this.pct=e,this.pctTarget=t,this.easing=n,this.restEasing=i,this.returnToInitial=r}start(e){this.gestureStartTime=performance.now(),this.gestureActive=!0,this.setTargetPercent(e)}setTargetPercent(e){this.pctTarget=e}end(){this.gestureActive=!1}tick(){const e=this.getCurrentTarget()-this.pct;return this.pct=0===this.getCurrentEasing()||Math.abs(e)<.001?this.getCurrentTarget():this.pct+e/this.getCurrentEasing(),!this.gestureActive&&this.pct===this.getCurrentTarget()}getPercent(){return this.pct}getIsActive(){return this.gestureActive}getGestureStartTime(){return this.gestureStartTime}getCurrentTarget(){return this.isReturningToInitialValue()?this.initialPct:this.pctTarget}getCurrentEasing(){return this.isReturningToInitialValue()?this.restEasing:this.easing}isReturningToInitialValue(){return!1===this.gestureActive&&this.returnToInitial}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(3),a=n(4),o=n(16),s=n(17);t.LfoShapeChooser=class extends r.Component{constructor(e){super(e),this.state={highlight:!1},this.selectShape=this.selectShape.bind(this),this.onHighlightParamMessage=this.onHighlightParamMessage.bind(this)}componentDidMount(){this.props.player.addPlayerListener(this),o.subscribe("highlightParamMessage",this.onHighlightParamMessage)}componentWillUnmount(){this.props.player.removePlayerListener(this),o.unsubscribe("highlightParamMessage",this.onHighlightParamMessage)}onPresetEvent(e){this.forceUpdate()}render(){const e=this.props.player.getParameterByName("lfo_shape"),t=e.options.map((t,n)=>{const o=a.translated(`rnbo-test-instrument:parameter_names.lfo_shape_options.${t}`),s=i("components_embeds_subtractive-synth__lfo-shape-choice",{"components_embeds_subtractive-synth__lfo-shape-choice--selected":n===e.value});return r.createElement("div",{className:s,key:n,onMouseDown:this.selectShape,"data-index":n},this.getShape(o))});return r.createElement("div",{className:i("components_embeds_subtractive-synth__control-group",{"components_embeds_subtractive-synth__control-group--highlight":this.state.highlight})},r.createElement("div",{key:"highlight-bg",className:"components_control__highlight_bg"}),r.createElement("label",{key:"label",className:"components_embeds_subtractive-synth__parameter-label"},a.translated("rnbo-test-instrument:parameter_names.lfo_shape.label")),r.createElement("div",{key:"options",className:"components_embeds_subtractive-synth__lfo-shape-chooser"},r.createElement("div",{className:"components_embeds_subtractive-synth__lfo-shape-chooser_bg"}),t))}getShape(e){switch(e){case"Sine":return r.createElement(s.LFOPanelShapeSine,null);case"Saw":return r.createElement(s.LFOPanelShapeSaw,null);case"Square":return r.createElement(s.LFOPanelShapeSquare,null);case"S&H":return r.createElement(s.LFOPanelShapeSampleHold,null)}}selectShape(e){const t=parseInt(e.target.getAttribute("data-index"),10);this.props.player.setParameterValue("lfo_shape",t),this.forceUpdate()}onHighlightParamMessage(e){"lfo_shape"===e.param&&this.setState({highlight:e.highlight})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(3),a=n(5);t.SampleAndHoldLFO=class extends r.Component{constructor(e){super(e),this.sizeObserver=new a.SizeObserver,this.ref=r.createRef(),this.onResize=this.onResize.bind(this)}render(){const e=i("components--lfo-shape",{"active-shape":this.props.active}),t=this.sizeObserver.getWidth(),n=this.sizeObserver.getHeight();return r.createElement("div",{className:e,ref:this.ref},r.createElement("svg",{width:"100%",height:"100%"},r.createElement("polyline",{className:"components--lfo-shape__viz-waveshape-filled",points:this.randomPoints(t,n)})))}shouldComponentUpdate(e){return e.amplitude!==this.props.amplitude||e.phase!==this.props.phase||e.frequency!==this.props.frequency||e.active!==this.props.active}componentDidMount(){this.sizeObserver.startObserving(this.ref,this.onResize)}componentWillUnmount(){this.sizeObserver.stopObserving()}onResize(){this.forceUpdate()}randomPoints(e,t){let n=10;function r(){const e=1e4*Math.sin(n++);return e-Math.floor(e)}let i="";const a=e/(10*this.props.frequency*2);for(let n=0;n<e;n+=a){const e=r()*t;i+=`${n},${e} ${n+a},${e} `}return i}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(21),a=n(5);class o extends r.Component{constructor(e){super(e),this.sizeObserver=new a.SizeObserver,this.ref=r.createRef(),this.onResize=this.onResize.bind(this)}render(){return r.createElement("div",{ref:this.ref,className:"component_saw-waveform"},r.createElement("svg",null,r.createElement("polyline",{className:"component_saw-waveform__path",points:i.sawPolylinePoints(this.sizeObserver.getWidth(),this.sizeObserver.getHeight(),this.props.phase,this.props.amplitude,2)})))}shouldComponentUpdate(e){return e.amplitude!==this.props.amplitude||e.phase!==this.props.phase}componentDidMount(){this.sizeObserver.startObserving(this.ref,this.onResize)}componentWillUnmount(){this.sizeObserver.stopObserving()}onResize(){this.forceUpdate()}}o.defaultProps={amplitude:1,phase:0},t.SawWaveform=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(17);t.LessonShareToggle=class extends r.Component{constructor(e){super(e),this.shareIconRef=r.createRef()}render(){return r.createElement("div",{className:"components_lesson-viewer__share-toggle"},r.createElement("a",{href:"javascript:void(0)",className:"components_lesson-viewer__share-toggle-link"},r.createElement("span",{className:"components_lesson-viewer__share-toggle-bg"}),r.createElement("span",{className:"components_lesson-viewer__share-toggle-icons"},r.createElement(i.ShareIcon,{ref:this.shareIconRef}))))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(30),a=n(15),o=n(3),s=n(17),c=n(24),l=n(13);t.SynthPresetsToggleButton=class extends r.PureComponent{constructor(e){super(e),this.pointerObserver=new l.PointerObserver,this.wasActivated=!1,this.iconARef=r.createRef(),this.iconBRef=r.createRef(),this.hitAreaRef=r.createRef(),this.onPointerChange=this.onPointerChange.bind(this)}render(){const e=o("synth-presets-toggle-button",{"--was-activated":this.wasActivated});return r.createElement("div",{className:e,ref:this.hitAreaRef},r.createElement("span",{className:"bg"}),r.createElement("div",{className:"icon-container"},r.createElement(s.PresetsIcon,{ref:this.iconARef})),r.createElement("div",{className:"icon-container"},r.createElement(s.LessonTocMenuOpen,{ref:this.iconBRef})),this.props.tooltipKey&&r.createElement(c.ButtonTooltip,{tooltipKey:this.props.tooltipKey}))}componentDidMount(){this.animate(this.props.opened),this.pointerObserver.startObserving(this.hitAreaRef.current,this.onPointerChange,{clampX:!0,clampY:!0})}componentWillUnmount(){this.pointerObserver.stopObserving()}componentDidUpdate(e){this.props.opened!==e.opened&&this.animate(this.props.opened)}animate(e){if(this.wasActivated=!0,this.iconBRef.current){const t=i.findDOMNode(this.iconBRef.current);a.remove(t),a({targets:t,opacity:e?1:0,scale:e?1:.5,elasticity:50,duration:500})}if(this.iconARef.current){const t=i.findDOMNode(this.iconARef.current);a.remove(t),a({targets:t,opacity:e?0:1,scale:e?.5:1,elasticity:50,duration:500})}}onPointerChange(e){switch(e.type){case 0:this.props.onClick()}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(58),a=n(60);t.ComponentName="synth-xy";t.Synth=class extends r.Component{constructor(e){super(e),this.state={active:!1},this.player=this.props.player,this.setMacroValue(this.props.xMacro,.5),this.setMacroValue(this.props.yMacro,.5),this.onXYChange=this.onXYChange.bind(this)}render(){const e=this.props.visualization?t.ComponentName+" "+this.props.visualization:t.ComponentName;return r.createElement("div",{className:e},r.createElement(i.XYPad,{callback:this.onXYChange,visualization:e=>a.createVisualization(this.props.visualization,e,this.props.xMacro,this.props.yMacro,this.player),tooltipKey:this.props.tooltipKey,thumbRadius:16.5,easing:void 0!==this.props.easing?this.props.easing:5,rotation:this.props.rotation?+this.props.rotation:0,lockX:void 0===this.props.xMacro||0===this.props.xMacro.length,lockY:void 0===this.props.yMacro||0===this.props.yMacro.length,restAtInitialX:!!this.props.restAtInitialX&&this.props.restAtInitialX,restAtInitialY:!!this.props.restAtInitialY&&this.props.restAtInitialY,controls:this.props.controls}))}onXYChange(e){switch(e.type){case 0:this.player.playNote(this.props.note),this.setState({active:!0});break;case 1:this.setMacroValue(this.props.xMacro,e.xPctEased),this.setMacroValue(this.props.yMacro,1-e.yPctEased);break;case 2:this.player.stopNote(this.props.note),this.setState({active:!1})}}setMacroValue(e,t){void 0!==e&&this.player.setMacroValue(e,t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(6);t.XYGesture=class{constructor(e,t,n,r,i,a,o){this.x=.5,this.y=.5,this.initialX=.5,this.initialY=.5,this.rx=0,this.ry=0,this.xTarget=.5,this.yTarget=.5,this.rxTarget=0,this.ryTarget=0,this.rotation=0,this.easing=5,this.lockX=!1,this.lockY=!1,this.returnToInitial=!1,this.gestureActive=!1,this.initialX=e,this.initialY=t,this.x=e,this.y=t,this.xTarget=e,this.yTarget=t,this.lockX=n,this.lockY=r,this.rotation=i,this.easing=a,this.returnToInitial=o}start(e,t){this.gestureStartTime=performance.now(),this.gestureActive=!0,this.setTargetXY(e,t)}move(e,t){this.setTargetXY(e,t)}end(){this.gestureActive=!1,this.returnToInitial&&this.setTargetXY(this.initialX,this.initialY)}tick(){const e=this.xTarget-this.x,t=this.yTarget-this.y,n=this.rxTarget-this.rx,r=this.ryTarget-this.ry;return this.x=0===this.easing||Math.abs(e)<.001?this.xTarget:this.x+e/this.easing,this.y=0===this.easing||Math.abs(t)<.001?this.yTarget:this.y+t/this.easing,this.rx=0===this.easing||Math.abs(n)<.001?this.rxTarget:this.rx+n/this.easing,this.ry=0===this.easing||Math.abs(r)<.001?this.ryTarget:this.ry+r/this.easing,!this.gestureActive&&this.x===this.xTarget&&this.y===this.yTarget}getX(){return this.x}getY(){return this.y}getRotationX(){return this.ry}getRotationY(){return this.rx}getXTarget(){return this.xTarget}getYTarget(){return this.yTarget}getIsActive(){return this.gestureActive}getGestureStartTime(){return this.gestureStartTime}setTargetXY(e,t){this.xTarget=this.lockX?this.xTarget:e,this.yTarget=this.lockY?this.yTarget:t,this.rxTarget=r.mapValueToRange(t,0,1,-this.rotation,this.rotation),this.ryTarget=r.mapValueToRange(e,0,1,this.rotation,-this.rotation)}}},function(e,t,n){var r=n(94),i=n(234),a={};for(var o in r)r.hasOwnProperty(o)&&(a[r[o]]=o);var s=e.exports={to:{},get:{}};function c(e,t,n){return Math.min(Math.max(t,e),n)}function l(e){var t=e.toString(16).toUpperCase();return t.length<2?"0"+t:t}s.get=function(e){var t,n;switch(e.substring(0,3).toLowerCase()){case"hsl":t=s.get.hsl(e),n="hsl";break;case"hwb":t=s.get.hwb(e),n="hwb";break;default:t=s.get.rgb(e),n="rgb"}return t?{model:n,value:t}:null},s.get.rgb=function(e){if(!e)return null;var t,n,i,a=[0,0,0,1];if(t=e.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(i=t[2],t=t[1],n=0;n<3;n++){var o=2*n;a[n]=parseInt(t.slice(o,o+2),16)}i&&(a[3]=Math.round(parseInt(i,16)/255*100)/100)}else if(t=e.match(/^#([a-f0-9]{3,4})$/i)){for(i=(t=t[1])[3],n=0;n<3;n++)a[n]=parseInt(t[n]+t[n],16);i&&(a[3]=Math.round(parseInt(i+i,16)/255*100)/100)}else if(t=e.match(/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)){for(n=0;n<3;n++)a[n]=parseInt(t[n+1],0);t[4]&&(a[3]=parseFloat(t[4]))}else{if(!(t=e.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)))return(t=e.match(/(\D+)/))?"transparent"===t[1]?[0,0,0,0]:(a=r[t[1]])?(a[3]=1,a):null:null;for(n=0;n<3;n++)a[n]=Math.round(2.55*parseFloat(t[n+1]));t[4]&&(a[3]=parseFloat(t[4]))}for(n=0;n<3;n++)a[n]=c(a[n],0,255);return a[3]=c(a[3],0,1),a},s.get.hsl=function(e){if(!e)return null;var t=e.match(/^hsla?\(\s*([+-]?(?:\d*\.)?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(t){var n=parseFloat(t[4]);return[(parseFloat(t[1])+360)%360,c(parseFloat(t[2]),0,100),c(parseFloat(t[3]),0,100),c(isNaN(n)?1:n,0,1)]}return null},s.get.hwb=function(e){if(!e)return null;var t=e.match(/^hwb\(\s*([+-]?\d*[\.]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(t){var n=parseFloat(t[4]);return[(parseFloat(t[1])%360+360)%360,c(parseFloat(t[2]),0,100),c(parseFloat(t[3]),0,100),c(isNaN(n)?1:n,0,1)]}return null},s.to.hex=function(){var e=i(arguments);return"#"+l(e[0])+l(e[1])+l(e[2])+(e[3]<1?l(Math.round(255*e[3])):"")},s.to.rgb=function(){var e=i(arguments);return e.length<4||1===e[3]?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"},s.to.rgb.percent=function(){var e=i(arguments),t=Math.round(e[0]/255*100),n=Math.round(e[1]/255*100),r=Math.round(e[2]/255*100);return e.length<4||1===e[3]?"rgb("+t+"%, "+n+"%, "+r+"%)":"rgba("+t+"%, "+n+"%, "+r+"%, "+e[3]+")"},s.to.hsl=function(){var e=i(arguments);return e.length<4||1===e[3]?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"},s.to.hwb=function(){var e=i(arguments),t="";return e.length>=4&&1!==e[3]&&(t=", "+e[3]),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+t+")"},s.to.keyword=function(e){return a[e.slice(0,3)]}},function(e,t,n){"use strict";var r=n(235),i=Array.prototype.concat,a=Array.prototype.slice,o=e.exports=function(e){for(var t=[],n=0,o=e.length;n<o;n++){var s=e[n];r(s)?t=i.call(t,a.call(s)):t.push(s)}return t};o.wrap=function(e){return function(){return e(o(arguments))}}},function(e,t){e.exports=function(e){return!(!e||"string"==typeof e)&&(e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&"String"!==e.constructor.name))}},function(e,t,n){var r=n(95),i=n(237),a={};Object.keys(r).forEach(function(e){a[e]={},Object.defineProperty(a[e],"channels",{value:r[e].channels}),Object.defineProperty(a[e],"labels",{value:r[e].labels});var t=i(e);Object.keys(t).forEach(function(n){var r=t[n];a[e][n]=function(e){var t=function(t){if(null==t)return t;arguments.length>1&&(t=Array.prototype.slice.call(arguments));var n=e(t);if("object"==typeof n)for(var r=n.length,i=0;i<r;i++)n[i]=Math.round(n[i]);return n};return"conversion"in e&&(t.conversion=e.conversion),t}(r),a[e][n].raw=function(e){var t=function(t){return null==t?t:(arguments.length>1&&(t=Array.prototype.slice.call(arguments)),e(t))};return"conversion"in e&&(t.conversion=e.conversion),t}(r)})}),e.exports=a},function(e,t,n){var r=n(95);function i(e){var t=function(){for(var e={},t=Object.keys(r),n=t.length,i=0;i<n;i++)e[t[i]]={distance:-1,parent:null};return e}(),n=[e];for(t[e].distance=0;n.length;)for(var i=n.pop(),a=Object.keys(r[i]),o=a.length,s=0;s<o;s++){var c=a[s],l=t[c];-1===l.distance&&(l.distance=t[i].distance+1,l.parent=i,n.unshift(c))}return t}function a(e,t){return function(n){return t(e(n))}}function o(e,t){for(var n=[t[e].parent,e],i=r[t[e].parent][e],o=t[e].parent;t[o].parent;)n.unshift(t[o].parent),i=a(r[t[o].parent][o],i),o=t[o].parent;return i.conversion=n,i}e.exports=function(e){for(var t=i(e),n={},r=Object.keys(t),a=r.length,s=0;s<a;s++){var c=r[s];null!==t[c].parent&&(n[c]=o(c,t))}return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(3);t.GlowVisualization=class extends r.Component{constructor(e){super(e)}render(){const e=i("visualization-glow",{active:this.props.active});return r.createElement("div",{className:e},r.createElement("div",{className:"background"}),r.createElement("div",{className:"glow"}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(3),a=n(82);t.LowPassWithResonanceVisualization=class extends r.Component{constructor(e){super(e)}render(){const e=i("visualization-low-pass",{active:this.props.active});return r.createElement("div",{className:e,style:{width:"100%",height:"100%"}},r.createElement(a.FilterCurve,{type:"lowpass",frequency:this.props.frequency,resonance:this.props.resonance}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(3),a=n(5),o=n(90);t.AmplitudeRampVisualization=class extends r.Component{constructor(e){super(e),this.sizeObserver=new a.SizeObserver,this.ref=r.createRef(),this.onResize=this.onResize.bind(this)}render(){const e=i("visualization-amplitude-ramp",{active:this.props.active});return r.createElement("div",{className:e,ref:this.ref},r.createElement(o.AmplitudeRamp,{amplitude:this.props.x}),r.createElement("svg",{className:"control-svg fake",viewBox:"-64 -64 128 128",width:"128px",height:"128px",style:{top:"-64px",left:"-64px",zIndex:2,transform:this.controlTransform()}},r.createElement("circle",{className:"control-fill",r:15.5}),r.createElement("circle",{className:"control-outline",r:14.5})))}componentDidMount(){this.sizeObserver.startObserving(this.ref,this.onResize)}componentWillUnmount(){this.sizeObserver.stopObserving()}onResize(){this.forceUpdate()}controlTransform(){const e=this.sizeObserver.getHeight(),t=this.sizeObserver.getWidth(),n=e,r=t,i=this.props.x*t;return`translate3D(${i}px,${(0-n)/(r-0)*i+(n*r-0)/(r-0)}px,0px)`}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(3),a=n(20);class o extends r.Component{constructor(e){super(e)}render(){const e=i("visualization-pitch-strip",{active:this.props.active});return r.createElement("div",{className:e},r.createElement("div",{className:"visualization-pitch-strip_viz"},r.createElement("div",{className:"visualization-pitch-strip_viz-container"},r.createElement("div",{className:"visualization-pitch-strip_viz-background"},r.createElement("svg",{viewBox:"0 0 10 172",className:"visualization-helper-up-down-drag-arrows"},r.createElement("path",{d:"M5.5,8.5 L5.5,58.5 L5.5,59 L4.5,59\n                                L4.5,58.5 L4.5,8.5 L0.5,8.5 L5,-0.5 L9.5,8.5 L5.5,8.5 Z"}),r.createElement("path",{d:"M4.5,163 L4.5,113 L4.5,112.5 L5.5,112.5\n                                L5.5,113 L5.5,163 L9.5,163 L5,172 L0.5,163 L4.5,163 Z"}))),r.createElement("div",{className:"visualization-pitch-strip_viz-foreground"}))))}}o.contextType=a.ThemeContext,t.PitchStripVisualization=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(3),a=n(57),o=n(85),s=n(86),c=n(4);t.LfoWaveShapesVisualization=class extends r.Component{constructor(e){super(e),this.lfoPhase=0,this.lfoFreq=1,this.state={sineText:c.translated("rnbo-test-instrument:parameter_names.lfo_shape_options.sin"),sawText:c.translated("rnbo-test-instrument:parameter_names.lfo_shape_options.saw_down"),pulseText:c.translated("rnbo-test-instrument:parameter_names.lfo_shape_options.square")}}render(){return this.updateLfoPhase(),r.createElement("div",{className:"components_visualizations_lfo_wave_shapes"},r.createElement("div",{className:i({components_visualizations_lfo_wave_shapes__column:!0,"components_visualizations_lfo_wave_shapes__column--active":this.props.x<=1/3})},r.createElement("div",{className:"components_visualizations_lfo_wave_shapes__shape"},r.createElement(a.SineLFO,{phase:this.props.x<=1/3&&this.props.active?this.lfoPhase:0,frequency:this.lfoFreq,amplitude:1,active:this.props.x<=1/3&&this.props.active})),r.createElement("div",{className:"components_visualizations_lfo_wave_shapes__label"},r.createElement("h4",null,this.state.sineText))),r.createElement("div",{className:i({components_visualizations_lfo_wave_shapes__column:!0,"components_visualizations_lfo_wave_shapes__column--active":this.props.x>1/3&&this.props.x<=2/3})},r.createElement("div",{className:"components_visualizations_lfo_wave_shapes__shape"},r.createElement(o.SawLFO,{phase:this.props.x>1/3&&this.props.x<=2/3&&this.props.active?this.lfoPhase:0,frequency:this.lfoFreq,amplitude:1,active:this.props.x>1/3&&this.props.x<=2/3&&this.props.active})),r.createElement("div",{className:"components_visualizations_lfo_wave_shapes__label"},r.createElement("h4",null,this.state.sawText))),r.createElement("div",{className:i({components_visualizations_lfo_wave_shapes__column:!0,"components_visualizations_lfo_wave_shapes__column--active":this.props.x>2/3})},r.createElement("div",{className:"components_visualizations_lfo_wave_shapes__shape"},r.createElement(s.PulseLFO,{phase:this.props.x>2/3&&this.props.active?this.lfoPhase:0,frequency:this.lfoFreq,amplitude:1,active:this.props.x>2/3&&this.props.active})),r.createElement("div",{className:"components_visualizations_lfo_wave_shapes__label"},r.createElement("h4",null,this.state.pulseText))))}updateLfoPhase(){this.props.active&&void 0!==this.props.player&&void 0!==this.props.pointerDownTime&&performance.now()>this.props.pointerDownTime+20&&(this.lfoPhase=this.props.player.getModulatedParameterControlValue("lfo_phase"))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(3),a=n(27),o=n(8),s=n(28),c=n(6),l=n(244);t.XYOscShapeMixVisualization=class extends r.Component{constructor(e){super(e),this.adsrHistory=new a.ADSRHistory}componentDidMount(){this.props.player.addPlayerListener(this)}componentWillUnmount(){this.props.player.removePlayerListener(this)}render(){const e=i("visualization-xy-adsr",{active:this.props.active});return r.createElement("div",{className:e},r.createElement("div",{className:"visualization-osc-shape-mix-wrapper"},r.createElement(s.AnimationFrameUpdater,{render:()=>r.createElement(l.MixLFO,{phase:0,frequency:1,amplitude:1-this.props.y,active:this.props.active,percent:c.clamp(3*(this.props.x-1/3),0,1)})})))}onPlaybackEvent(e,t,n){switch(e){case 0:this.adsrHistory.startNote(o.audioContext.currentTime);break;case 1:break;case 2:this.adsrHistory.releaseNote(o.audioContext.currentTime)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(3),a=n(21),o=n(5);t.MixLFO=class extends r.Component{constructor(e){super(e),this.sizeObserver=new o.SizeObserver,this.ref=r.createRef(),this.onResize=this.onResize.bind(this)}render(){const e=i("components--lfo-shape",{"active-shape":this.props.active}),t=this.sizeObserver.getWidth(),n=this.sizeObserver.getHeight(),o=2*this.props.frequency,s=a.sawPulseMixPolylinePoints(t,n,this.props.phase,this.props.amplitude,o,.5,this.props.percent);return r.createElement("div",{className:e,ref:this.ref},r.createElement("svg",{width:"100%",height:"100%"},r.createElement("polyline",{className:"components--lfo-shape__viz-waveshape-filled",points:s}),r.createElement("circle",{className:"components--lfo-shape__viz-dot",cx:`${t/2}`,cy:0,r:"5"})))}shouldComponentUpdate(e){return e.amplitude!==this.props.amplitude||e.phase!==this.props.phase||e.percent!==this.props.percent||e.active!==this.props.active}componentDidMount(){this.sizeObserver.startObserving(this.ref,this.onResize)}componentWillUnmount(){this.sizeObserver.stopObserving()}onResize(){this.forceUpdate()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(3),a=n(59),o=n(57),s=n(6),c=n(20),l=n(61);class u extends r.Component{constructor(e){super(e)}componentDidMount(){this.context.theme.color=l.getColorFromCssVariable("--color-red")}render(){let e=this.props.player?this.props.player.getModulatedParameterValue("lfo_frequency"):1,t=this.props.player?this.props.player.getModulatedParameterControlValue("lfo_phase"):0,n=this.props.player?this.props.player.getModulatedParameterControlValue("oscillator_pitch_offset_lfo_amount"):1;n=s.mapValueToRange(n,.5,1,0,1);e>=32&&(e=32,t=performance.now()/1e3%1*32);const c=this.context.theme.color,l=this.props.x+.3,u=c.hue(),h=c.saturationl(),p=c.lightness(),d=this.context.global.shade.hue(),f=this.context.global.shade.saturationl(),m=this.context.global.shade.lightness(),g=l,v=s.mapNormalizedValueToRange(Math.pow(g,5),d,u),y=s.mapNormalizedValueToRange(Math.pow(g,5),f,h),b=s.mapNormalizedValueToRange(Math.pow(g,5),m,p),_=a().hsl(v,y,b),w=i("visualization-fast-lfo",{active:this.props.active},"visualization-glow");return r.createElement("div",{className:w},r.createElement("div",{className:"glow"},r.createElement("div",{className:i("visualization-fast-lfo__lfo-background",{"visualization-fast-lfo__lfo-background--shake":e>=32&&this.props.active&&this.props.y<.5}),style:{backgroundColor:_.string()}})),r.createElement("div",{className:"visualization-fast-lfo__lfo-holder"},r.createElement(o.SineLFO,{active:!1,phase:t,frequency:e,amplitude:n,window:!0})),r.createElement("div",{className:"background"}))}scaleX(e,t,n,r){return s.mapNormalizedValueToRange(Math.pow(e,t),n,r)}}u.contextType=c.ThemeContext,t.FastLfoVisualization=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(3),a=n(56),o=n(27),s=n(8),c=n(28);t.XYADSRVisualization=class extends r.Component{constructor(e){super(e),this.adsrHistory=new o.ADSRHistory}componentDidMount(){this.props.player.addPlayerListener(this)}componentWillUnmount(){this.props.player.removePlayerListener(this)}render(){const e=i("visualization-xy-adsr",{active:this.props.active});return r.createElement("div",{className:e},r.createElement("div",{className:"visualization-xy-adsr-wrapper"},r.createElement(c.AnimationFrameUpdater,{render:()=>(this.adsrHistory.setADR(this.props.player.getParameterValue("modulation_envelope_attack")/1e3,this.props.player.getParameterValue("modulation_envelope_decay")/1e3,this.props.player.getParameterValue("modulation_envelope_release")/1e3),r.createElement(a.SimpleADSR,{attack:this.props.player.getParameterControlValue("modulation_envelope_attack"),decay:this.props.player.getParameterControlValue("modulation_envelope_decay"),sustain:this.props.player.getParameterControlValue("modulation_envelope_sustain"),release:this.props.player.getParameterControlValue("modulation_envelope_release"),history:this.adsrHistory.getHistory(s.audioContext.currentTime)}))})))}onPlaybackEvent(e,t,n){switch(e){case 0:this.adsrHistory.startNote(s.audioContext.currentTime);break;case 1:break;case 2:this.adsrHistory.releaseNote(s.audioContext.currentTime)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(248),a=n(27),o=n(8),s=n(10),c=n(16);t.ComponentName="synth-adsr";t.Synth=class extends r.Component{constructor(e){super(e),this.animationFramer=new s.AnimationFramer,this.active=!1,this.wasChanged=!1,this.history={attackPct:0,decayPct:0,sustain:!1,releasePct:0},this.adsrHistory=new a.ADSRHistory,this.rnboPlayer=this.props.player,this.initialPlayerState=this.rnboPlayer.getStateCopy(),this.setupInitialState(),this.onADSRChange=this.onADSRChange.bind(this),this.onAnimationFrame=this.onAnimationFrame.bind(this),this.onResetPlayer=this.onResetPlayer.bind(this),this.onSoundPlaybackStartedMessage=this.onSoundPlaybackStartedMessage.bind(this)}render(){return r.createElement("div",{className:"synth-adsr"},r.createElement(i.ADSR,{callback:this.onADSRChange,attack:this.rnboPlayer.getParameterControlValue(this.props.attackParameter),decay:this.rnboPlayer.getParameterControlValue(this.props.decayParameter),sustain:this.rnboPlayer.getParameterControlValue(this.props.sustainParameter),release:this.rnboPlayer.getParameterControlValue(this.props.releaseParameter),attackAsString:this.rnboPlayer.getParameterValueAsString(this.props.attackParameter),decayAsString:this.rnboPlayer.getParameterValueAsString(this.props.decayParameter),sustainAsString:this.rnboPlayer.getParameterValueAsString(this.props.sustainParameter),releaseAsString:this.rnboPlayer.getParameterValueAsString(this.props.releaseParameter),lockAttack:this.props.lockAttack,lockDecaySustain:this.props.lockDecaySustain,lockRelease:this.props.lockRelease,history:this.history,showXAxis:this.props.showXAxis,showYAxis:this.props.showYAxis,showAttackLabel:this.props.showAttackLabel,showDecayLabel:this.props.showDecayLabel,showSustainLabel:this.props.showSustainLabel,showReleaseLabel:this.props.showReleaseLabel,yAxisLabelKey:this.props.yAxisLabelKey,handleRadius:this.props.handleRadius,showInteractionTooltip:this.props.showInteractionTooltip,showPlayButton:!0}),this.props.showResetButton&&this.wasChanged&&r.createElement("a",{className:"synth-adsr__reset-button small",onClick:this.onResetPlayer,href:"javascript:void(0)"},"Reset"))}componentDidMount(){c.subscribe("soundPlaybackStarted",this.onSoundPlaybackStartedMessage)}componentWillUnmount(){c.unsubscribe("soundPlaybackStarted",this.onSoundPlaybackStartedMessage),this.animationFramer.stopAnimating(),this.rnboPlayer.stopAllSound()}setADSRControlValues(e,t,n,r){this.props.linkAttack?(this.rnboPlayer.setParameterControlValue("amplitude_envelope_attack",e),this.rnboPlayer.setParameterControlValue("modulation_envelope_attack",e)):this.rnboPlayer.setParameterControlValue(this.props.attackParameter,e),this.props.linkDecay?(this.rnboPlayer.setParameterControlValue("amplitude_envelope_decay",t),this.rnboPlayer.setParameterControlValue("modulation_envelope_decay",t)):this.rnboPlayer.setParameterControlValue(this.props.decayParameter,t),this.props.linkSustain?(this.rnboPlayer.setParameterControlValue("amplitude_envelope_sustain",n),this.rnboPlayer.setParameterControlValue("modulation_envelope_sustain",n)):this.rnboPlayer.setParameterControlValue(this.props.sustainParameter,n),this.props.linkRelease?(this.rnboPlayer.setParameterControlValue("amplitude_envelope_release",r),this.rnboPlayer.setParameterControlValue("modulation_envelope_release",r)):this.rnboPlayer.setParameterControlValue(this.props.releaseParameter,r),this.updateADSRHistory()}setupInitialState(){const e=void 0!==this.props.attackOverrideInMs?this.rnboPlayer.convertToControlValue(this.props.attackParameter,this.props.attackOverrideInMs):this.rnboPlayer.getParameterControlValue(this.props.attackParameter),t=void 0!==this.props.decayOverrideInMs?this.rnboPlayer.convertToControlValue(this.props.decayParameter,this.props.decayOverrideInMs):this.rnboPlayer.getParameterControlValue(this.props.decayParameter),n=void 0!==this.props.sustainOverride?this.rnboPlayer.convertToControlValue(this.props.sustainParameter,this.props.sustainOverride):this.rnboPlayer.getParameterControlValue(this.props.sustainParameter),r=void 0!==this.props.releaseOverrideInMs?this.rnboPlayer.convertToControlValue(this.props.releaseParameter,this.props.releaseOverrideInMs):this.rnboPlayer.getParameterControlValue(this.props.releaseParameter);this.setADSRControlValues(e,t,n,r),this.initialPlayerState=this.rnboPlayer.getStateCopy()}onADSRChange(e){switch(e.type){case 0:this.active=!0,this.animationFramer.startAnimating(this.onAnimationFrame),void 0===e.handle?this.startNote():this.setADSRControlValues(e.attack,e.decay,e.sustain,e.release);break;case 1:void 0!==e.handle&&(this.wasChanged=!0,this.setADSRControlValues(e.attack,e.decay,e.sustain,e.release));break;case 2:this.active=!1,void 0===e.handle?this.stopNote():this.setADSRControlValues(e.attack,e.decay,e.sustain,e.release)}}updateADSRHistory(){this.adsrHistory.setADR(this.rnboPlayer.getParameterValue(this.props.attackParameter)/1e3,this.rnboPlayer.getParameterValue(this.props.decayParameter)/1e3,this.rnboPlayer.getParameterValue(this.props.releaseParameter)/1e3)}onResetPlayer(){this.rnboPlayer.preset(this.initialPlayerState),this.updateADSRHistory(),this.stopNote(),this.wasChanged=!1,this.forceUpdate()}startNote(){this.rnboPlayer.playNote(this.props.note),this.adsrHistory.startNote(o.audioContext.currentTime),c.publish("soundPlaybackStarted",{component:this})}stopNote(){this.rnboPlayer.stopNote(this.props.note),this.adsrHistory.releaseNote(o.audioContext.currentTime)}onAnimationFrame(){this.history=this.adsrHistory.getHistory(o.audioContext.currentTime);const e=this.active||this.history.releasePct<1;this.forceUpdate(),e||this.animationFramer.stopAnimating(),1===this.history.releasePct&&this.adsrHistory.finish()}onSoundPlaybackStartedMessage(e){e.component!==this&&(this.rnboPlayer.stopAllSound(),this.adsrHistory.finish())}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(3),a=n(5),o=n(6),s=n(249),c=n(13),l=n(250),u=n(4),h=n(251);t.ADSR=class extends r.Component{constructor(e){super(e),this.sizeObserver=new a.SizeObserver,this.pointerObserver=new c.PointerObserver,this.axisLabel="",this.attackX=0,this.attackY=0,this.decaySustainX=0,this.decaySustainY=0,this.sustainEndX=0,this.releaseX=0,this.releaseY=0,this.progressX=0,this.progressY=0,this.isPointerDown=!1,this.wasActivated=!1,this.state={activeHandle:void 0,pointerOffset:{xPct:0,yPct:0}},this.hitAreaRef=r.createRef(),this.onPointerEvent=this.onPointerEvent.bind(this),this.onResize=this.onResize.bind(this),this.axisLabel=this.props.yAxisLabelKey?u.translated(this.props.yAxisLabelKey):u.translated("envelopes:axisLabels.amplitude")}componentDidMount(){this.sizeObserver.startObserving(this.hitAreaRef,this.onResize),this.pointerObserver.startObserving(this.hitAreaRef.current,this.onPointerEvent,{clampX:!1,clampY:!1}),this.forceUpdate()}componentWillUnmount(){this.sizeObserver.stopObserving(),this.pointerObserver.stopObserving()}componentDidUpdate(e){e.yAxisLabelKey!==this.props.yAxisLabelKey&&(this.axisLabel=this.props.yAxisLabelKey?u.translated(this.props.yAxisLabelKey):u.translated("envelopes:axisLabels.amplitude"))}shouldComponentUpdate(e,t){return this.props.attack!==e.attack||this.props.decay!==e.decay||this.props.sustain!==e.sustain||this.props.release!==e.release||this.props.history.attackPct!==e.history.attackPct||this.props.history.decayPct!==e.history.decayPct||this.props.history.sustain||e.history.sustain||this.props.history.releasePct!==e.history.releasePct||this.state.activeHandle!==t.activeHandle}render(){return this.recomputePixelValues(),r.createElement("div",{ref:this.hitAreaRef,className:this.adsrContainerStateClasses()},r.createElement("svg",{className:"adsr-drawing"},r.createElement("path",{className:"adsr-envelope-shape",d:this.envelopePath()}),r.createElement("path",{className:"adsr-attack-shape",d:this.attackPathProgress()}),r.createElement("path",{className:"adsr-decay-shape",d:this.decayPathProgress()}),r.createElement("path",{className:"adsr-release-shape",d:this.releasePathProgress()}),this.renderAttackLabelOverlay(),this.renderDecayLabelOverlay(),this.renderReleaseLabelOverlay()),this.renderXAxis(),this.renderYAxis(),this.renderSustainViz(),this.renderSustainLabelOverlay(),this.renderAttackLabel(),this.renderDecayLabel(),this.renderReleaseLabel(),this.renderSustainLabel(),this.renderBottomBorder(),this.renderProgressDot(),this.props.showPlayButton&&r.createElement(h.PressAndHoldButton,{class:"synth-adsr__press-hold-button",playing:this.isPointerDown}),this.props.showInteractionTooltip&&r.createElement("div",{className:"synth-adsr__interaction-prompt adsr-tooltip adsr-tooltip-centered"},r.createElement("div",null,r.createElement("h4",{className:"adsr-tooltip-label"},u.translated("lesson-visualizations:labels.pressAndHold")))),this.renderAttackTooltip(),this.renderDecaySustainTooltip(),this.renderReleaseTooltip(),!this.props.lockAttack&&r.createElement(l.ADSRHandle,{xPx:this.attackX,yPx:this.attackY,active:0===this.state.activeHandle,radius:this.props.handleRadius}),!this.props.lockDecaySustain&&r.createElement(l.ADSRHandle,{xPx:this.decaySustainX,yPx:this.decaySustainY,active:1===this.state.activeHandle,radius:this.props.handleRadius}),!this.props.lockRelease&&r.createElement(l.ADSRHandle,{xPx:this.releaseX,yPx:this.releaseY,active:2===this.state.activeHandle,radius:this.props.handleRadius}))}notifyCallback(e,t={}){if(void 0===this.props.callback)return;const n={handle:this.state.activeHandle,attack:this.props.attack,decay:this.props.decay,sustain:this.props.sustain,release:this.props.release,type:e};this.props.callback(Object.assign({},n,t))}xRangeForHandleInPct(e){switch(e){case 0:return{low:0,high:.3};case 1:const t=this.xRangeForHandleInPct(0),n=o.mapNormalizedValueToRange(this.props.attack,t.low,t.high);return{low:n,high:n+.3};case 2:const r=this.xRangeForHandleInPct(1),i=.1+o.mapNormalizedValueToRange(this.props.decay,r.low,r.high);return{low:i,high:i+.3}}}computeAttackX(){return Math.round(this.handleX(0))}computeAttackY(){return 0}computeDecaySustainX(){return Math.round(this.handleX(1))}computeDecaySustainY(){return Math.round(this.pctToY(1-this.props.sustain))}computeSustainEndX(){return Math.round(this.pctToX(this.xRangeForHandleInPct(2).low))}computeReleaseX(){return Math.round(this.handleX(2))}computeReleaseY(){return Math.round(this.height())}handleX(e){const t=this.xRangeForHandleInPct(e),n=t.low,r=t.high;switch(e){case 0:return this.pctToX(o.mapNormalizedValueToRange(this.props.attack,n,r));case 1:return this.pctToX(o.mapNormalizedValueToRange(this.props.decay,n,r));case 2:return this.pctToX(o.mapNormalizedValueToRange(this.props.release,n,r))}}isHandleLocked(e){switch(e){case 0:return!0===this.props.lockAttack;case 1:return!0===this.props.lockDecaySustain;case 2:return!0===this.props.lockRelease}}handlesWithPosition(){const e=[];return this.isHandleLocked(1)||e.push({handle:1,x:this.decaySustainX,y:this.decaySustainY}),this.isHandleLocked(0)||e.push({handle:0,x:this.attackX,y:this.attackY}),this.isHandleLocked(2)||e.push({handle:2,x:this.releaseX,y:this.releaseY}),e}findControlNearPointer(e){const t=this.pctToX(e.xPct),n=this.pctToY(e.yPct),r=2*this.props.handleRadius,i=s.findNearest(t,n,this.handlesWithPosition(),r);if(void 0!==i)return{handle:i.handle,xOffsetPct:this.xToPct(t-i.x),yOffsetPct:this.yToPct(n-i.y)}}onPointerEvent(e){switch(e.type){case 0:this.handlePointerStart(e);break;case 1:this.handlePointerMove(e);break;case 2:this.handlePointerEnd(e)}}handlePointerStart(e){const t=this.findControlNearPointer(e);this.pointerStartTime=Date.now(),void 0!==t?this.setState({activeHandle:t.handle,pointerOffset:{xPct:t.xOffsetPct,yPct:t.yOffsetPct}}):(this.isPointerDown=!0,this.wasActivated=!0),this.notifyCallback(e.type)}handlePointerEnd(e){this.notifyCallback(e.type),this.isPointerDown=!1,this.setState({activeHandle:void 0})}handlePointerMove(e){const t=this.state.activeHandle;if(void 0===t)return;e.xPct-=this.state.pointerOffset.xPct,e.yPct-=this.state.pointerOffset.yPct;const n=this.xRangeForHandleInPct(t);switch(t){case 0:const r=o.normalize(e.xPct,n.low,n.high);this.notifyCallback(e.type,{attack:r});break;case 1:const i=o.normalize(e.xPct,n.low,n.high),a=o.mapNormalizedValueToRange(e.yPct,1,0);this.notifyCallback(e.type,{decay:i,sustain:a});break;case 2:const s=o.normalize(e.xPct,n.low,n.high);this.notifyCallback(e.type,{release:s})}}recomputePixelValues(){this.attackX=this.computeAttackX(),this.attackY=this.computeAttackY(),this.decaySustainX=this.computeDecaySustainX(),this.decaySustainY=this.computeDecaySustainY(),this.sustainEndX=this.computeSustainEndX(),this.releaseX=this.computeReleaseX(),this.releaseY=this.computeReleaseY(),this.progressX=this.computeProgressX(),this.progressY=this.computeProgressY()}width(){return this.sizeObserver.getWidth()}height(){return this.sizeObserver.getHeight()}envelopePath(){return`M${`0,${this.height()}`} L${`${this.attackX},${this.attackY}`} L${`${this.decaySustainX},${this.decaySustainY}`} L${`${this.sustainEndX},${this.decaySustainY}`} L${`${this.releaseX},${this.releaseY}`} Z`}attackPath(){return`M${`0,${this.height()}`} L${`${this.attackX},${this.attackY}`} L${`${this.attackX},${this.height()}`} Z`}attackPathProgress(){const e=this.attackPctToX(),t=this.attackPctToY();return`M${`0,${this.height()}`} L${`${e},${t}`} L${`${e},${this.height()}`} Z`}decayPath(){return`M${`${this.attackX},${this.attackY}`} L${`${this.decaySustainX},${this.decaySustainY}`} L${`${this.decaySustainX},${this.height()}`} L${`${this.attackX},${this.height()}`} Z`}decayPathProgress(){const e=this.decayPctToX(),t=this.decayPctToY();return`M${`${this.attackX},${this.attackY}`} L${`${e},${t}`} L${`${e},${this.height()}`} L${`${this.attackX},${this.height()}`} Z`}releasePath(){return`M${`${this.sustainEndX},${this.decaySustainY}`} L${`${this.releaseX},${this.releaseY}`} L${`${this.sustainEndX},${this.releaseY}`} Z`}releasePathProgress(){const e=this.releasePctToX(),t=this.releasePctToY();return`M${`${this.sustainEndX},${this.decaySustainY}`} L${`${e},${t}`} L${`${e},${this.height()}`} L${`${this.sustainEndX},${this.releaseY}`} Z`}sustainVizState(){return i({"sustain-started":this.props.history.sustain,"sustain-ended":this.props.history.releasePct>0,active:this.isSustainActive()})}adsrContainerStateClasses(){return i("adsr-container",{"adsr-pointer-down":this.isPointerDown,"adsr-active":this.props.history.attackPct>0&&1!==this.props.history.releasePct,"adsr-handle-active":void 0!==this.state.activeHandle,"adsr-has-y-axis":this.props.showYAxis,"accent-attack":this.props.showAttackLabel,"accent-decay":this.props.showDecayLabel,"accent-sustain":this.props.showSustainLabel,"accent-release":this.props.showReleaseLabel,"adsr--was-activated":this.wasActivated})}computeProgressX(){return this.props.history.releasePct>0?this.releasePctToX():this.props.history.decayPct>0?this.decayPctToX():this.props.history.attackPct>0?this.attackPctToX():0}attackPctToX(){return this.attackX*this.props.history.attackPct}decayPctToX(){return this.attackX+(this.decaySustainX-this.attackX)*this.props.history.decayPct}releasePctToX(){return this.sustainEndX+(this.releaseX-this.sustainEndX)*this.props.history.releasePct}computeProgressY(){return this.props.history.releasePct>0?this.releasePctToY():this.props.history.decayPct>0?this.decayPctToY():this.props.history.attackPct>0?this.attackPctToY():this.height()}attackPctToY(){return this.height()*(1-this.props.history.attackPct)}decayPctToY(){return this.decaySustainY*this.props.history.decayPct}releasePctToY(){return this.decaySustainY+(this.height()-this.decaySustainY)*this.props.history.releasePct}sustainWidthTransform(){return this.isSustainActive()?`translateX(${this.sustainEndX-this.decaySustainX}px)`:"translateX(0px)"}durationString(){return this.pointerStartTime?((Date.now()-this.pointerStartTime)/1e3).toFixed(2)+"s":""}renderXAxis(){return this.props.showXAxis?r.createElement("div",{className:"adsr-x-axis"},r.createElement("div",{className:"adsr-x-axis-line"},r.createElement("div",{className:"adsr-x-axis-arrow"})),r.createElement("h4",{className:"adsr-x-axis-label"},u.translated("envelopes:axisLabels.time")),r.createElement("div",{className:"adsr-x-axis-value "+this.sustainVizState(),style:{transform:`translateX(${this.progressX}px)`}},r.createElement("div",{className:"adsr-x-axis-value-container",style:{transform:this.sustainWidthTransform()}},r.createElement("h4",null,this.durationString())))):null}renderYAxis(){return this.props.showYAxis?r.createElement("div",{className:"adsr-y-axis"},r.createElement("div",{className:"adsr-y-axis-line"},r.createElement("div",{className:"adsr-y-axis-arrow"})),r.createElement("h4",{className:"adsr-y-axis-label"},this.axisLabel),r.createElement("div",{className:"adsr-y-axis-value",style:{transform:`translateY(${this.progressY}px)`}},r.createElement("div",{className:"adsr-y-axis-value-container"},r.createElement("h4",null,this.axisLabel)))):null}renderAttackLabel(){return this.props.showAttackLabel?r.createElement("div",{className:"adsr-attack-handle-label",style:{transform:`translateX(${this.attackX}px) translateY(${this.attackY}px)`}},r.createElement("h4",null,u.translated("envelopes:stages.attack"))):null}renderAttackLabelOverlay(){return this.props.showAttackLabel?r.createElement("path",{className:"adsr-attack-overlay",d:this.attackPath()}):null}renderDecayLabel(){return this.props.showDecayLabel?r.createElement("div",{className:"adsr-decay-handle-label",style:{transform:`translateX(${this.decaySustainX}px) translateY(${this.decaySustainY}px)`}},r.createElement("h4",null,u.translated("envelopes:stages.decay"))):null}renderDecayLabelOverlay(){return this.props.showDecayLabel?r.createElement("path",{className:"adsr-decay-overlay",d:this.decayPath()}):null}renderSustainLabel(){if(this.props.showSustainLabel){let e=this.sustainEndX-this.decaySustainX;const t=this.height()-this.decaySustainY;return t<1?(e=0,null):r.createElement("div",{className:"adsr-sustain-overlay-label",style:{transform:`translateX(${this.decaySustainX}px)`,width:e+"px",height:t+"px"}},r.createElement("h4",null,u.translated("envelopes:stages.sustain")))}return null}renderSustainLabelOverlay(){return this.props.showDecayLabel?r.createElement("div",{className:"adsr-sustain-overlay",style:{left:this.decaySustainX+"px",top:this.decaySustainY+"px",right:this.width()-this.sustainEndX+"px"}},r.createElement("div",{className:"adsr-sustain-viz-barberpole"})):null}renderReleaseLabel(){return this.props.showReleaseLabel?r.createElement("div",{className:"adsr-release-handle-label",style:{transform:`translateX(${this.releaseX}px) translateY(${this.releaseY}px)`}},r.createElement("h4",null,u.translated("envelopes:stages.release"))):null}renderReleaseLabelOverlay(){return this.props.showReleaseLabel?r.createElement("path",{className:"adsr-release-overlay",d:this.releasePath()}):null}renderSustainViz(){return r.createElement("div",{className:"adsr-sustain-viz "+this.sustainVizState(),style:{left:this.decaySustainX+"px",top:this.decaySustainY+"px",right:this.width()-this.sustainEndX+"px"}},r.createElement("div",{className:"adsr-sustain-viz-barberpole"},r.createElement("div",{className:"adsr-sustain-viz-barberpole-animation"})))}renderBottomBorder(){return this.props.showXAxis?null:r.createElement("div",{className:"adsr-border-bottom"})}renderProgressDot(){return r.createElement("div",{className:"adsr-progress-dot "+this.sustainVizState(),style:{transform:`translateX(${this.progressX}px) translateY(${this.progressY}px)`}},r.createElement("div",{className:"adsr-progress-dot-container",style:{transform:this.sustainWidthTransform()}},r.createElement("div",{className:"adsr-progress-dot-fill"})))}renderAttackTooltip(){return void 0===this.props.attackAsString?null:r.createElement("div",{className:0===this.state.activeHandle?"adsr-tooltip bottom-left active":"adsr-tooltip bottom-left",style:{transform:`translateX(${this.attackX}px)`}},r.createElement("div",null,r.createElement("h4",{className:"adsr-tooltip-label"},this.props.attackAsString)))}renderDecaySustainTooltip(){return void 0===this.props.decayAsString||void 0===this.props.sustainAsString?null:r.createElement("div",{className:1===this.state.activeHandle?"adsr-tooltip bottom-left active":"adsr-tooltip bottom-left",style:{transform:`translateX(${this.decaySustainX}px)\n                                    translateY(${this.decaySustainY}px)`}},r.createElement("div",null,r.createElement("h4",{className:"adsr-tooltip-label"},this.props.decayAsString),r.createElement("h4",{className:"adsr-tooltip-label"},this.props.sustainAsString)))}renderReleaseTooltip(){return void 0===this.props.releaseAsString?null:r.createElement("div",{className:2===this.state.activeHandle?"adsr-tooltip bottom-left active":"adsr-tooltip bottom-left",style:{transform:`translateX(${this.releaseX}px)\n                                    translateY(${this.releaseY-10}px)`}},r.createElement("div",null,r.createElement("h4",{className:"adsr-tooltip-label"},this.props.releaseAsString)))}xToPct(e){return e/this.width()}yToPct(e){return e/this.height()}pctToX(e){return e*this.width()}pctToY(e){return e*this.height()}onResize(){this.forceUpdate()}isSustainActive(){return this.props.history.sustain&&0===this.props.history.releasePct}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(6);t.findNearest=function(e,t,n,i=Number.MAX_VALUE){let a,o=Number.MAX_VALUE;return n.forEach(n=>{const s=r.euclideanDistance(e,t,n.x,n.y);s<o&&s<=i&&(a=n,o=s)}),a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(3);t.ADSRHandle=class extends r.PureComponent{constructor(e){super(e)}render(){const e=i("adsr-handle",{active:this.props.active});return r.createElement("svg",{className:e,viewBox:"-64 -64 128 128",width:"128px",height:"128px",style:{top:"-64px",left:"-64px",zIndex:2,transform:this.transform()}},r.createElement("rect",{className:"fill",x:-this.props.radius/2,y:-this.props.radius/2,width:this.props.radius,height:this.props.radius}),r.createElement("rect",{className:"outline",x:-this.props.radius/2,y:-this.props.radius/2,width:this.props.radius,height:this.props.radius}))}transform(){return`translate3D(${this.props.xPx}px, ${this.props.yPx}px, 10px)`}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(15);t.PressAndHoldButton=class extends r.PureComponent{constructor(e){super(e),this.holdingIndicatorRef=r.createRef()}render(){return r.createElement("div",{className:this.props.class},r.createElement("svg",{viewBox:"0 0 48 48",width:"48px",height:"48px"},r.createElement("circle",{r:"12.5",cx:"24",cy:"24"}),r.createElement("circle",{r:"12.5",cx:"24",cy:"24",ref:this.holdingIndicatorRef})))}componentDidMount(){this.animateToggle(this.props.playing)}componentDidUpdate(){this.animateToggle(this.props.playing)}animateToggle(e){if(this.holdingIndicatorRef.current){const t=this.holdingIndicatorRef.current;i.remove(t),i({targets:t,scale:e?1:.25,elasticity:50,duration:500})}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(52),a=n(3),o=n(15),s=n(8),c=n(13),l=n(5),u=n(6),h=n(17),p=n(10),d=n(4);var f;t.ComponentName="synth-envelope",function(e){e[e.Initial=0]="Initial",e[e.PlayingIntroAnimation=1]="PlayingIntroAnimation",e[e.UserIsDrawing=2]="UserIsDrawing",e[e.PlayingUserEnvelope=3]="PlayingUserEnvelope",e[e.Resting=4]="Resting"}(f||(f={}));t.Synth=class extends r.Component{constructor(e){super(e),this.pointerObserver=new c.PointerObserver,this.sizeObserver=new l.SizeObserver,this.animationFramer=new p.AnimationFramer,this.clipId=i().replace(/-/g,"").substring(0,8),this.points=[],this.cachedSvgPoints="",this.brushPosition={x:0,y:1},this.playheadTime=0,this.gestureStartDate=0,this.gestureEndDate=0,this.playbackState=f.Initial,this.hitAreaRef=r.createRef(),this.exampleAdsrPathRef=r.createRef(),this.player=this.props.player,this.onPointerEvent=this.onPointerEvent.bind(this),this.onResize=this.onResize.bind(this),this.onAnimationFrame=this.onAnimationFrame.bind(this),this.introAnimation=o.timeline({loop:!0,autoplay:!1})}render(){const e=a("components_embeds_synth-envelope",{ready:!0},{active:this.playbackState===f.UserIsDrawing},{hasBeenTouched:this.points.length>0}),t=`clip${this.clipId}`,n=this.envelopePoints(),i=this.brushPosition.x*this.sizeObserver.getWidth(),o=this.brushPosition.y*this.sizeObserver.getHeight();return r.createElement("div",{className:e},r.createElement("div",{ref:this.hitAreaRef,style:{width:"100%",height:"100%"},className:"components_embeds_synth-envelope-hitarea"},r.createElement("svg",{width:"100%",height:"100%"},r.createElement("polyline",{className:"components_embeds_synth-envelope__envelope-background",points:n}),r.createElement("polyline",{className:"components_embeds_synth-envelope__envelope-foreground",clipPath:`url(#${t})`,points:n}),this.playbackState===f.PlayingUserEnvelope&&r.createElement("circle",{r:"5",className:"components_embeds_synth-envelope__envelope-playhead",cx:this.playheadRectLeftX()+this.playheadRectWidth(),cy:(1-this.valueAtTime(this.playheadTime))*this.sizeObserver.getHeight()}),this.playbackState===f.PlayingUserEnvelope&&r.createElement("clipPath",{id:t},r.createElement("rect",{x:this.playheadRectLeftX(),y:"0",width:this.playheadRectWidth(),height:this.sizeObserver.getHeight()}))),this.renderAxis("x",d.translated("envelopes:axisLabels.time")),this.renderAxis("y",d.translated("envelopes:axisLabels.pitch")),this.renderDirectionalArrows(),this.renderExampleADSRShape(),r.createElement("div",{className:"components_embeds_synth-envelope__cursor",style:{transform:`translate(${i}px,${o}px) rotate(45deg)`}},r.createElement("div",{className:"components_embeds_synth-envelope__cursor_icon"},r.createElement(h.PencilIcon,null)))))}componentDidMount(){this.pointerObserver.startObserving(this.hitAreaRef.current,this.onPointerEvent,{clampX:!0,clampY:!0}),this.sizeObserver.startObserving(this.hitAreaRef,this.onResize),this.animationFramer.startAnimating(this.onAnimationFrame)}componentWillUnmount(){this.sizeObserver.stopObserving(),this.animationFramer.stopAnimating(),this.pointerObserver.stopObserving(),this.stopPlayback()}onResize(){this.cachedSvgPoints=this.points.reduce((e,t)=>e+this.toSvgPoint(t),""),this.forceUpdate()}onAnimationFrame(){switch(this.playbackState){case f.Initial:this.exampleAdsrPathRef.current&&(this.setupIntroAnimation(this.exampleAdsrPathRef.current),this.introAnimation.play(),this.playbackState=f.PlayingIntroAnimation);break;case f.UserIsDrawing:if(void 0!==this.pointerPosition){const e=5,t=this.pointerPosition.x-this.brushPosition.x,n=this.pointerPosition.y-this.brushPosition.y,r=t>0?this.brushPosition.x+t/e:this.brushPosition.x,i=this.brushPosition.y+n/e;this.brushPosition={x:r,y:i},this.brushPosition.x>this.points[this.points.length-1].x+.001&&(this.points.push(this.brushPosition),this.cachedSvgPoints+=this.toSvgPoint(this.brushPosition)),this.forceUpdate()}break;case f.PlayingUserEnvelope:const e=s.audioContext.currentTime,t=u.mapNormalizedValueToRange(this.valueAtTime(e),this.props.minPitchOffset,this.props.maxPitchOffset);this.player.setParameterValue("oscillator_pitch_offset",t),this.playheadTime=e,this.pctAtTime(e)>=1.1&&this.stopPlayback(),this.forceUpdate();break;case f.PlayingIntroAnimation:case f.Resting:}}onPointerEvent(e){switch(e.type){case 0:const t={x:e.xPct,y:e.yPct},n=[t];this.points=n,this.cachedSvgPoints=this.toSvgPoint(t),this.brushPosition=t,this.gestureStartDate=Date.now(),this.playbackState===f.PlayingIntroAnimation?(this.introAnimation.restart(),this.introAnimation.pause()):this.stopPlayback(),this.playbackState=f.UserIsDrawing,this.pointerPosition=t;break;case 1:this.pointerPosition={x:e.xPct,y:e.yPct};break;case 2:this.brushPosition={x:0,y:1},this.gestureEndDate=Date.now(),this.startPlayback()}}startPlayback(){const e=u.mapNormalizedValueToRange(this.points[0].y,this.props.minPitchOffset,this.props.maxPitchOffset),t=Number(this.player.getParameterValue("global_slew_time"));this.player.setParameterValue("global_slew_time",0),this.player.setParameterValue("oscillator_pitch_offset",e),this.player.setParameterValue("global_slew_time",t),this.player.playNote(this.props.note),this.noteStartTime=s.audioContext.currentTime,this.playbackState=f.PlayingUserEnvelope}stopPlayback(){this.player.stopNote(this.props.note),this.noteStartTime=void 0,this.playbackState=f.Resting}playheadRectLeftX(){return this.playbackState!==f.PlayingUserEnvelope?0:this.points[0].x*this.sizeObserver.getWidth()}playheadRectWidth(){if(this.playbackState!==f.PlayingUserEnvelope)return 0;const e=this.points[0],t=(this.points[this.points.length-1].x-e.x)*this.sizeObserver.getWidth();return Math.max(u.clamp(this.pctAtTime(this.playheadTime),0,1)*t,0)}pctAtTime(e){const t=(this.gestureEndDate-this.gestureStartDate)/1e3;return(e-this.noteStartTime)/t}valueAtTime(e){return this.valueAtPct(this.pctAtTime(e))}valueAtPct(e){const t=this.points[0],n=this.points[this.points.length-1];e=u.mapNormalizedValueToRange(e,t.x,n.x);const r=this.points.findIndex(t=>t.x>=e);if(-1===r)return n.y;const i=this.points[r],a=this.points[r-1];if(i.x===e)return 1-i.y;if(a.x===e)return 1-a.x;const o=(e-a.x)/(i.x-a.x);return 1-u.lerp(a.y,i.y,o)}envelopePoints(){return this.points.length>0?this.toSvgPoint({x:this.points[0].x,y:1})+this.cachedSvgPoints+this.toSvgPoint({x:this.points[this.points.length-1].x,y:1}):""}toSvgPoint(e){return`${e.x*this.sizeObserver.getWidth()},${e.y*this.sizeObserver.getHeight()} `}renderAxis(e,t){return r.createElement("div",{className:`adsr-${e}-axis`},r.createElement("div",{className:`adsr-${e}-axis-line`},r.createElement("div",{className:`adsr-${e}-axis-arrow`})),r.createElement("h4",{className:`adsr-${e}-axis-label`},t))}renderDirectionalArrows(){return this.playbackState===f.PlayingIntroAnimation?r.createElement("div",{className:"components_embeds_synth-envelope__example_arrows"},r.createElement(h.DirectionalArrowRight,null),r.createElement(h.DirectionalArrowRight,null),r.createElement(h.DirectionalArrowRight,null)):null}renderExampleADSRShape(){const e=24,t=this.sizeObserver.getWidth()-48,n=this.sizeObserver.getHeight()-48,i=this.playbackState===f.PlayingIntroAnimation||this.playbackState===f.Initial;if(t<=0||!i)return null;const a="M"+(e+0*t)+" "+(e+1*n)+" L"+(e+.25*t)+" "+(e+0*n)+" L"+(e+.5*t)+" "+(e+.5*n)+" L"+(e+.75*t)+" "+(e+.5*n)+" L"+(e+1*t)+" "+(e+1*n)+" ",o="components_embeds_synth-envelope__example_mask";return r.createElement("svg",{className:"components_embeds_synth-envelope__example_shape"},r.createElement("path",{d:a,clipPath:`url(#${o})`,id:"components_embeds_synth-envelope__example_fill"}),r.createElement("path",{d:a,ref:this.exampleAdsrPathRef}),r.createElement("clipPath",{id:o},r.createElement("rect",{x:0,y:e,id:"components_embeds_synth-envelope__example_mask_rect",width:0,height:n})))}setupIntroAnimation(e){const t=o.path(e),n=this.sizeObserver.getHeight()-24-20,r=".components_embeds_synth-envelope__cursor";this.introAnimation.add({targets:r,translateX:[24,24],translateY:[n,n],duration:150,easing:"easeInOutSine"}),this.introAnimation.add({targets:".components_embeds_synth-envelope__example_arrows svg",duration:650,easing:"easeInOutSine",opacity:[0,1,1,0],delay:(e,t,n)=>350*t}),this.introAnimation.add({targets:".components_embeds_synth-envelope__cursor svg",rotate:45,duration:300,easing:"easeInOutSine"}),this.introAnimation.add({targets:r,translateY:"+=20",translateX:"+=0",offset:"-=300",duration:300,easing:"easeInOutSine"}),this.introAnimation.add({targets:r,translateX:t("x"),translateY:t("y"),duration:3e3,delay:500,easing:"easeInOutSine"}),this.introAnimation.add({targets:e,strokeDashoffset:[o.setDashoffset,0],duration:3e3,offset:"-=3000",easing:"easeInOutSine"}),this.introAnimation.add({targets:".components_embeds_synth-envelope__cursor svg",rotate:0,delay:550,duration:750,elasticity:10}),this.introAnimation.add({targets:r,translateY:"-=20",translateX:"+=5",offset:"-=750",duration:750,elasticity:10}),this.introAnimation.add({targets:"#components_embeds_synth-envelope__example_mask_rect",width:t("x"),duration:3e3,easing:"easeInOutSine"}),this.introAnimation.add({targets:"#components_embeds_synth-envelope__example_fill",opacity:0,delay:1e3,duration:350,easing:"easeInOutSine"}),this.introAnimation.add({targets:e,opacity:0,offset:"-=350",duration:350,easing:"easeInOutSine"}),this.introAnimation.add({targets:r,translateX:24,translateY:n,duration:1250,elasticity:10})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(53),a=n(3),o=n(254),s=n(255),c=n(6),l=n(8),u=n(256),h=n(5);t.ComponentName="door-filter";t.DoorFilter=class extends r.Component{constructor(e){super(e),this.value=new u.EasedValue(0),this.sliderSizeObserver=new h.SizeObserver,this.sliderRef=r.createRef(),this.state={active:!1,percent:0},this.filter=i.context.createBiquadFilter(),this.filter.Q.value=0,this.filter.frequency.value=300,this.filter.type="lowpass",this.filter.connect(i.context.destination),this.tonePlayer=new i.Player(this.props.sample),this.tonePlayer.connect(this.filter),this.tonePlayer.loop=!0,this.tonePlayer.volume.value=-60,this.onValueChange=this.onValueChange.bind(this),this.onSliderChange=this.onSliderChange.bind(this)}componentDidMount(){this.value.start(0,0,this.onValueChange),this.sliderSizeObserver.startObserving(this.sliderRef)}componentWillUnmount(){this.tonePlayer.dispose(),this.sliderSizeObserver.stopObserving(),this.value.stop()}render(){const e=a("door_filter",{"door_filter--active":this.state.active});return r.createElement("div",{className:e},r.createElement("div",{className:"synth_slider__viz"},r.createElement(s.DoorVisualization,Object.assign({},this.state,{callback:this.onSliderChange,hitAreaWidth:this.sliderSizeObserver.getWidth()}))),r.createElement("div",{className:"synth_slider__control",ref:this.sliderRef},r.createElement(o.SliderPad,Object.assign({},this.state,{callback:this.onSliderChange,tooltipKey:this.props.tooltipKey}))))}onValueChange(e,t){this.filter.frequency.value=c.mapNormalizedValueToRange(e,250,8e3),this.setState({percent:e})}onSliderChange(e){switch(e.type){case 0:"stopped"===this.tonePlayer.state&&this.tonePlayer.start(l.audioContext.currentTime),this.tonePlayer.volume.rampTo(0,.1),this.setState({active:!0}),this.value.start(e.targetValue,5,this.onValueChange);break;case 1:this.value.start(e.targetValue,5,this.onValueChange);break;case 2:this.tonePlayer.volume.rampTo(-60,4),this.value.start(0,50,this.onValueChange),this.setState({active:!1})}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(3),a=n(13),o=n(5),s=n(24);t.SliderPad=class extends r.Component{constructor(e){super(e),this.sizeObserver=new o.SizeObserver,this.pointerObserver=new a.PointerObserver,this.wasActivated=!1,this.hitAreaRef=r.createRef(),this.onResize=this.onResize.bind(this),this.onPointerChange=this.onPointerChange.bind(this)}render(){const e=i("components_control__slider",{"components_control__slider--active":this.props.active},{"components_control__slider--was-activated":this.wasActivated}),t=this.sizeObserver.getWidth(),n=this.props.percent*t;return r.createElement("div",{className:e},r.createElement("div",{className:"components_control__slider_control",ref:this.hitAreaRef,tabIndex:0},r.createElement("div",{className:"components_control__slider_track"},this.renderSliderFill()),r.createElement("div",{className:"components_control__slider_handle_holder",style:{transform:`translate3D(${n}px, -50%, 0px)`}},r.createElement("div",{className:"components_control__slider_handle"}),this.props.tooltipKey&&r.createElement(s.ButtonTooltip,{tooltipKey:this.props.tooltipKey}))))}componentDidMount(){this.pointerObserver.startObserving(this.hitAreaRef.current,this.onPointerChange,{clampX:!0,clampY:!0}),this.sizeObserver.startObserving(this.hitAreaRef,this.onResize)}componentWillUnmount(){this.sizeObserver.stopObserving(),this.pointerObserver.stopObserving()}onResize(){this.forceUpdate()}renderSliderFill(){const e=this.props.percent;return r.createElement("div",{className:"components_control__slider_fill",style:{transform:`scaleX(${e})`}})}onPointerChange(e){const t=Math.abs(e.xPct-this.props.percent)<.05;switch(e.type){case 0:this.wasActivated=!0,this.hitAreaRef.current.focus(),this.notifyStateChange(e.type,t?this.props.percent:e.xPct);break;case 1:case 2:this.notifyStateChange(e.type,e.xPct)}}notifyStateChange(e,t){this.props.callback({type:e,targetValue:t})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(1),a=n(39),o=n(5),s=n(6),c=n(12),l=n(20),u=n(40),h=n(10),p=n(13);class d extends r.Component{constructor(e){super(e),this.sizeObserver=new o.SizeObserver,this.pointerObserver=new p.PointerObserver,this.scene=new i.Scene,this.camera=new i.PerspectiveCamera,this.renderer=new i.WebGLRenderer({antialias:u.getAntialiasingSetting()}),this.sceneBackgroundColor=16777215,this.doorGroup=new i.Object3D,this.mirrorBall=new i.Object3D,this.trimMaterial=new i.MeshLambertMaterial,this.trimOffColor=new i.Color("#00004c"),this.trimOnColor=new i.Color("#C4C4CD"),this.doorKnobMaterial=new i.MeshLambertMaterial,this.doorKnobOffColor=new i.Color("#00004c"),this.doorKnobOnColor=new i.Color("#94949D"),this.backRoomMaterial=new i.MeshLambertMaterial,this.backRoomOffColor=new i.Color("#00004c"),this.backRoomOnColor=new i.Color("#36ADF2"),this.animationFramer=new h.AnimationFramer,this.ref=r.createRef(),this.createRenderer(),this.createScene(),this.createCamera(),this.createLights(),this.onResize=this.onResize.bind(this),this.onPointerChange=this.onPointerChange.bind(this),this.onAnimationFrame=this.onAnimationFrame.bind(this)}render(){return r.createElement("div",{className:"door-scene"},r.createElement("div",{ref:this.ref,className:"threejs-door-scene"}))}componentDidUpdate(e){const t=Math.PI/180*0,n=Math.PI/180*130,r=s.mapNormalizedValueToRange(this.props.percent,t,n);this.doorGroup.rotation.y=r,this.updateMaterialColors(),this.props.active&&!e.active&&this.animationFramer.startAnimating(this.onAnimationFrame),!this.props.active&&this.props.percent<.001&&this.animationFramer.stopAnimating()}componentDidMount(){this.pointerObserver.startObserving(this.ref.current,this.onPointerChange,{clampX:!0,clampY:!0}),this.sizeObserver.startObserving(this.ref,this.onResize),this.ref.current.appendChild(this.renderer.domElement),this.loadGLTF()}componentWillUnmount(){this.pointerObserver.stopObserving(),this.sizeObserver.stopObserving(),this.animationFramer.stopAnimating()}onResize(){const e=this.sizeObserver.getHeight(),t=this.sizeObserver.getWidth();this.camera.aspect=t/e,this.camera.updateProjectionMatrix(),this.renderer.setSize(t,e),this.forceUpdate(),this.renderScene()}onPointerChange(e){const t=this.sizeObserver.getWidth();if(t>this.props.hitAreaWidth){const n=(t-256)/(2*t),r=n,i=1-n,a=s.normalize(s.clamp(e.xPct,r,i),r,i);this.props.callback({type:e.type,targetValue:a})}}loadGLTF(){const e=new a.GLTFLoader,t=c.urlForFile("content/assets/models/door-scene.glb");e.load(t,e=>{this.scene.add(e.scene),this.doorGroup=this.scene.getObjectByName("doorGroup"),this.mirrorBall=this.scene.getObjectByName("mirrorBall"),this.styleScene()},void 0,e=>{console.error(e)})}createRenderer(){this.renderer.setClearColor(this.sceneBackgroundColor),this.renderer.setPixelRatio(u.getPixelRatioSetting()),this.renderer.shadowMap.enabled=u.getShadowMapSetting(),this.renderer.shadowMap.type=i.PCFSoftShadowMap}createScene(){this.scene.background=new i.Color(this.sceneBackgroundColor)}createCamera(){this.camera=new i.PerspectiveCamera(35,16/9,.25,20),this.camera.position.set(0,.8,3.4),this.camera.rotation.set(0,0,0)}createLights(){const e=new i.AmbientLight(16777215,.97);this.scene.add(e);const t=new i.DirectionalLight(16777215,.25);this.scene.add(t),t.position.set(15,5,15);const n=new i.DirectionalLight(16777215,.15);n.position.set(-12,15,15),this.scene.add(n)}renderScene(){this.renderer.render(this.scene,this.camera)}styleScene(){const e=this.context.theme.color,t=e.darken(.5).rgb(),n=e.lighten(.75).rgb();this.addMaterialToObject("frontFloor",new i.MeshLambertMaterial({color:"#ffffff"}),!0,!0),this.addMaterialToObject("centerWall",new i.MeshLambertMaterial({color:"#ffffff"}),!1,!0),this.trimMaterial=new i.MeshLambertMaterial({color:"#00004c"}),this.doorKnobMaterial=new i.MeshLambertMaterial,this.addMaterialToObject("doorTrim",this.trimMaterial,!1,!0),this.addMaterialToObject("wallTrim",this.trimMaterial,!1,!0),this.addMaterialToObject("door",new i.MeshPhongMaterial({color:"#C6C6CC"}),!0,!0),this.addMaterialToObject("doorHandle",this.doorKnobMaterial,!0,!1);const r=this.scene.getObjectByName("posterGroup");r&&(r.visible=!1);const a=this.scene.getObjectByName("plantAndPot");a&&(a.visible=!1);const o=new i.MeshPhongMaterial({color:e.string(),opacity:1,transparent:!0,specular:16777215,shininess:100});this.addMaterialToObject("mirrorBall",o,!1,!1),this.addMaterialToObject("discoRod",new i.MeshLambertMaterial({color:n.string()}),!1,!0),this.backRoomMaterial=new i.MeshLambertMaterial({color:t.string()}),this.addMaterialToObject("backFloor",this.backRoomMaterial,!1,!0),this.addMaterialToObject("backWall",this.backRoomMaterial,!1,!0),this.backRoomOnColor=new i.Color(e.darken(.3).rgb().string()),this.updateMaterialColors(),this.renderScene()}addMaterialToObject(e,t,n,r){this.scene.getObjectByName(e).traverse(e=>{e instanceof i.Mesh&&(e.material=t,e.castShadow=n,e.receiveShadow=r)})}updateMaterialColors(){const e=10*(this.props.percent>.1?.1:this.props.percent);this.trimMaterial.color=this.trimOffColor.clone().lerp(this.trimOnColor,e),this.doorKnobMaterial.color=this.doorKnobOffColor.clone().lerp(this.doorKnobOnColor,e);const t=this.props.percent>1?1:this.props.percent;this.backRoomMaterial.color=this.backRoomOffColor.clone().lerp(this.backRoomOnColor,t)}onAnimationFrame(){this.mirrorBall.rotation.y+=.02,this.renderScene()}}d.contextType=l.ThemeContext,t.DoorVisualization=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(10);t.EasedValue=class{constructor(e){this.percent=0,this.targetPercent=0,this.easing=0,this.animationFramer=new r.AnimationFramer,this.percent=e,this.targetPercent=e,this.onAnimationFrame=this.onAnimationFrame.bind(this)}start(e,t,n){this.targetPercent=e,this.easing=t,this.callback=n,this.animationFramer.startAnimating(this.onAnimationFrame)}stop(){this.animationFramer.stopAnimating()}onAnimationFrame(){const e=this.targetPercent-this.percent;this.percent=0===this.easing||Math.abs(e)<=.001?this.targetPercent:this.percent+e/this.easing,this.percent===this.targetPercent&&this.animationFramer.stopAnimating(),this.callback(this.percent,this.targetPercent)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(3),a=n(37),o=n(13),s=n(5),c=n(258);t.ComponentName="carousel";t.Carousel=class extends r.Component{constructor(e){super(e),this.pointerObserver=new o.PointerObserver,this.sizeObserver=new s.SizeObserver,this.state={active:!1,percent:.5,targetPercent:.5,pointerDownTime:0},this.player=this.props.player,this.onResize=this.onResize.bind(this),this.onSliderChange=this.onSliderChange.bind(this),this.onVizPress=this.onVizPress.bind(this),this.vizHitAreaRef=r.createRef()}render(){const e=i("carousel_slider","synth_slider",{"synth_slider--ready":!0},{"synth_slider--active":this.state.active});return r.createElement("div",{className:e},r.createElement("div",{className:"synth_slider__viz",ref:this.vizHitAreaRef},r.createElement(c.CarouselLfoVisualization,Object.assign({},this.state,{maxFrequency:this.props.maxFrequency,player:this.player}))),r.createElement("div",{className:"synth_slider__control"},r.createElement(a.SliderPad,Object.assign({targetValue:this.state.targetPercent},this.state,{callback:this.onSliderChange,restEasing:10,tooltipKey:this.props.tooltipKey}))))}componentDidMount(){this.pointerObserver.startObserving(this.vizHitAreaRef.current,this.onVizPress,{clampX:!0,clampY:!0}),this.sizeObserver.startObserving(this.vizHitAreaRef,this.onResize)}componentWillUnmount(){this.sizeObserver.stopObserving(),this.pointerObserver.stopObserving()}onResize(){this.forceUpdate()}onVizPress(e){switch(e.type){case 0:this.setState({active:!0,pointerDownTime:performance.now()}),this.player.playNote(48);break;case 2:this.setState({active:!1}),this.player.stopNote(48)}}onSliderChange(e){switch(e.type){case 0:this.setState({active:!0,pointerDownTime:performance.now()}),this.player.playNote(48);break;case 1:break;case 2:this.setState({active:!1}),this.player.stopNote(48)}this.setState({percent:e.pctEased,targetPercent:e.pctRaw})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(1),a=n(39),o=n(15),s=n(5),c=n(12),l=n(20),u=n(10),h=n(40),p=n(6);class d extends r.Component{constructor(e){super(e),this.sizeObserver=new s.SizeObserver,this.carousel=new i.Object3D,this.matCarouselArms=new i.MeshBasicMaterial,this.offColorCarouselArms=new i.Color("#00004c"),this.onColorCarouselArms=new i.Color("#C4C4CD"),this.animeColorCarouselArms=new i.Color("#000000"),this.matSpeakerCones=new i.MeshBasicMaterial,this.offColorSpeakerCones=new i.Color("#00004c"),this.onColorSpeakerCones=new i.Color("#fb454f"),this.animeColorSpeakerCones=new i.Color("#000000"),this.carouselRotation=0,this.speed=0,this.targetSpeed=0,this.animationFramer=new u.AnimationFramer,this.ref=r.createRef(),this.sceneBackgroundColor=16777215,this.scene=new i.Scene,this.scene.background=new i.Color(this.sceneBackgroundColor),this.renderer=new i.WebGLRenderer({antialias:h.getAntialiasingSetting()}),this.renderer.setClearColor(this.sceneBackgroundColor),this.renderer.setPixelRatio(h.getPixelRatioSetting()),this.renderer.shadowMap.enabled=h.getShadowMapSetting(),this.renderer.shadowMap.type=i.PCFSoftShadowMap;this.camera=new i.PerspectiveCamera(45,16/9,.25,20);this.camera.position.set(1.8465044265912154,.5886084824280596,1.2176328483878334),this.camera.rotation.set(-.24867168623908703,.9753075203029795,.20720295582659562),this.createGround(),this.createLights(),this.onResize=this.onResize.bind(this),this.updateRotation=this.updateRotation.bind(this),this.onAnimationFrame=this.onAnimationFrame.bind(this),this.isModelLoaded=!1}render(){return r.createElement("div",{ref:this.ref,className:"carousel-scene",style:{opacity:this.isModelLoaded?1:0}})}componentDidMount(){this.sizeObserver.startObserving(this.ref,this.onResize),this.ref.current.appendChild(this.renderer.domElement),this.loadGLTF()}componentWillUnmount(){this.sizeObserver.stopObserving(),this.animationFramer.stopAnimating()}componentDidUpdate(e){this.props.active&&!e.active&&this.showAudioVisualization(),!this.props.active&&e.active&&this.hideAudioVisualization()}onResize(){const e=this.sizeObserver.getHeight(),t=this.sizeObserver.getWidth();this.camera.aspect=t/e,this.camera.updateProjectionMatrix(),this.renderer.setSize(t,e),this.renderer.render(this.scene,this.camera),this.forceUpdate()}createGround(){const e=new i.MeshLambertMaterial({color:16382457}),t=new i.Mesh(new i.PlaneBufferGeometry(20,20),e);t.rotation.x=-Math.PI/2,this.scene.add(t),t.receiveShadow=!0}createLights(){const e=new i.AmbientLight(16777215,1);this.scene.add(e);const t=new i.DirectionalLight(16777215,.1);t.position.set(1,1.75,0),t.position.multiplyScalar(30),t.castShadow=!0,this.scene.add(t)}loadGLTF(){const e=new a.GLTFLoader,t=c.urlForFile("content/assets/models/carousel-scene.glb");e.load(t,e=>{this.scene.add(e.scene),this.styleScene()},void 0,e=>{console.error(e)})}styleScene(){const e=this.context.theme.color;this.onColorSpeakerCones=new i.Color(e.string());const t=new i.MeshLambertMaterial({color:"#E2E2E8"});this.matSpeakerCones.color=this.offColorSpeakerCones,this.matCarouselArms.color=this.offColorCarouselArms;const n=new i.MeshLambertMaterial({color:"#EEEEEE"}),r=this.scene.getObjectByName("carousel");r&&(this.carousel=r);const a=this.scene.getObjectByName("base");this.addMaterialToObject(a,t,!0,!0);const o=this.scene.getObjectByName("baseCenter");this.addMaterialToObject(o,this.matCarouselArms,!1,!1);const s=this.scene.getObjectByName("arms");this.addMaterialToObject(s,this.matCarouselArms,!0,!1);const c=this.scene.getObjectByName("tree");c&&(c.visible=!1);const l=this.scene.getObjectByName("speakerCabinet");this.addMaterialToObject(l,n,!0,!1);const u=this.scene.getObjectByName("speakerCones");this.addMaterialToObject(u,this.matSpeakerCones,!0,!0);const h=this.scene.getObjectByName("speakerBack");this.addMaterialToObject(h,this.matSpeakerCones,!1,!1),this.isModelLoaded=!0,this.forceUpdate(),this.renderer.render(this.scene,this.camera)}addMaterialToObject(e,t,n,r){e.traverse(e=>{e instanceof i.Mesh&&(e.material=t,e.castShadow=n,e.receiveShadow=r)})}animateMaterialFromColorToColor(e,t,n){o.remove(t),t.r=e.color.r,t.g=e.color.g,t.b=e.color.b,o({targets:t,r:n.r,g:n.g,b:n.b,easing:"easeOutQuart",update:n=>{e.color=t}})}showAudioVisualization(){this.animationFramer.startAnimating(this.onAnimationFrame),this.animateMaterialFromColorToColor(this.matSpeakerCones,this.animeColorSpeakerCones,this.onColorSpeakerCones),this.animateMaterialFromColorToColor(this.matCarouselArms,this.animeColorCarouselArms,this.onColorCarouselArms)}hideAudioVisualization(){this.animateMaterialFromColorToColor(this.matSpeakerCones,this.animeColorSpeakerCones,this.offColorSpeakerCones),this.animateMaterialFromColorToColor(this.matCarouselArms,this.animeColorCarouselArms,this.offColorCarouselArms)}updateRotation(){const e=2*Math.PI/60*this.props.maxFrequency;if(this.carouselRotation=this.carouselRotation+this.speed,this.speed=this.speed+(this.targetSpeed-this.speed)/10,this.targetSpeed=this.props.active?e*this.props.percent:0,this.carousel.rotation.y=this.carouselRotation,void 0!==this.props.player){const e=(Math.sin(this.carouselRotation+.5*Math.PI)+1)/2,t=p.mapValueToRange(e,0,1,.1,1),n=p.mapValueToRange(e,0,1,.3,.7);this.props.player.setParameterControlValue("filter_frequency",t),this.props.player.setParameterControlValue("oscillator_pulse_width",n)}this.speed<1e-5&&0===this.targetSpeed&&!this.props.active&&this.animationFramer.stopAnimating()}onAnimationFrame(){this.updateRotation(),this.renderer.render(this.scene,this.camera)}}d.contextType=l.ThemeContext,t.CarouselLfoVisualization=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(3),a=n(13),o=n(5),s=n(96),c=n(8),l=n(10),u=n(260);t.ComponentName="modbot";t.ModBot=class extends r.Component{constructor(e){super(e),this.pointerObserver=new a.PointerObserver,this.sizeObserver=new o.SizeObserver,this.animationFramer=new l.AnimationFramer,this.state={active:!1,pointerDownTime:0},this.player=this.props.player,this.vizHitAreaRef=r.createRef(),this.onResize=this.onResize.bind(this),this.onAnimationFrame=this.onAnimationFrame.bind(this),this.onPress=this.onPress.bind(this)}componentDidMount(){this.pointerObserver.startObserving(this.vizHitAreaRef.current,this.onPress,{clampX:!0,clampY:!0}),this.sizeObserver.startObserving(this.vizHitAreaRef,this.onResize)}componentWillUnmount(){this.sizeObserver.stopObserving(),this.animationFramer.stopAnimating(),this.pointerObserver.stopObserving()}render(){const e=i("modbot",{"modbot--ready":!0},{"modbot--active":this.state.active});return r.createElement("div",{className:e},r.createElement("div",{className:"modbot__viz",ref:this.vizHitAreaRef},void 0!==this.player&&r.createElement(u.ModBotVisualization,Object.assign({},this.state,{player:this.player}))),r.createElement("div",{className:"modbot__control"},r.createElement(s.PressPad,Object.assign({},this.state,{callback:this.onPress,tooltipKey:this.props.tooltipKey}))))}onResize(){this.forceUpdate()}onAnimationFrame(){this.forceUpdate()}onPress(e){switch(e.type){case 0:this.player.playNote(this.props.note,c.audioContext.currentTime),this.setState({active:!0,pointerDownTime:performance.now()}),this.animationFramer.startAnimating(this.onAnimationFrame);break;case 2:this.player.stopNote(this.props.note,c.audioContext.currentTime),this.setState({active:!1}),this.animationFramer.stopAnimating()}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(3),a=n(15),o=n(5),s=n(4),c=n(6),l=n(261),u=120;t.ModBotVisualization=class extends r.Component{constructor(e){super(e),this.sizeObserver=new o.SizeObserver,this.animationObj={amplitude:0},this.maxAmplitude=.6,this.ref=r.createRef(),this.onResize=this.onResize.bind(this),this.startModulating=this.startModulating.bind(this),this.beginModulationLoop=this.beginModulationLoop.bind(this),this.updatePlayer=this.updatePlayer.bind(this),this.startBotAnimation=a.timeline({autoplay:!1}),this.stopBotAnimation=a.timeline({autoplay:!1}),this.dotYHistory=new l.RingBuffer(u)}render(){const e=i("visualization-modbot",{"visualization-modbot--active":this.props.active}),t=this.sizeObserver.getHeight(),n=this.sizeObserver.getWidth(),a=this.animationObj.amplitude,o=c.mapValueToRange(a,-this.maxAmplitude,this.maxAmplitude,t-75,75);!0===this.props.active&&this.dotYHistory.push(o);let l="",h=n/2;const p=n/2/u;this.dotYHistory.forEachLifo(e=>{l+=`${h},${e} `,h-=p});let d=n/4;d>90&&(d=90);const f=t-18,m=o,g=c.mapValueToRange(o,0,t,.25*t,t),v=c.mapValueToRange(o,0,t,.5*t,t-25);return r.createElement("div",{className:e},r.createElement("div",{ref:this.ref,className:"visualization-lfo-diagram-slider_viz"},r.createElement("svg",{width:"100%",height:"100%"},r.createElement("polyline",{className:"visualization-lfo-diagram_viz-waveshape-filled",points:l}),r.createElement("circle",{className:"visualization-lfo-diagram_viz-dot",cx:`${n/2}`,cy:o,r:"6"})),r.createElement("div",{className:"visualization-lfo-diagram_axis-x"},r.createElement("svg",{className:"visualization-lfo-diagram_axis-x-arrow",width:`${n}`,height:"11px",viewBox:`0 0 ${n} 11`},r.createElement("path",{d:`M1,5.5 L${n},5.5`}),r.createElement("polyline",{points:`${n-4.5} 1.5 ${n} 5.5 ${n-4.5} 9.5`})),r.createElement("h4",{className:"visualization-lfo-diagram_axis-x-label"},s.translated("lesson-visualizations:labels.time"))),r.createElement("div",{className:"visualization-lfo-diagram_target",style:{transform:`translate(${n/2}px, ${o}px)`}},r.createElement("h4",{className:"visualization-lfo-diagram_target-label"},s.translated(this.getDotTag()))),t>0&&r.createElement("div",{className:"visualization-modbot-drawing",style:{transform:"translateX(25%)"}},r.createElement("div",{className:"modbot_base",style:{left:`${d}px`,top:`${f-4}px`}},r.createElement("h4",null,s.translated("lesson-visualizations:labels.modbotLFOLabel"))),r.createElement("svg",{className:"visualization-modbot-drawing_svg",width:"100%",height:"100%"},r.createElement("g",{className:"modbot_wheels"},r.createElement("circle",{r:"6.0",cx:d-11.5,cy:f-6}),r.createElement("circle",{r:"6.0",cx:d+11.5,cy:f-6})),r.createElement("g",{transform:`translate(${d},0)`,className:"modbot_extendo-arm"},r.createElement("path",{d:`M0,${m} L0,${f-7}`}),r.createElement("path",{d:`M0,${g} L0,${f-7}`}),r.createElement("path",{d:`M0,${v} L0,${f-7}`})),r.createElement("g",{transform:`translate(0,${o})`,className:"modbot_forearm"},r.createElement("path",{d:`M20,0 L${d},0`})),r.createElement("g",{transform:`translate(0,${o})`,className:"modbot_hand"},r.createElement("g",{className:"modbot_hand_container"},r.createElement("path",{d:"M20,0 L20,17 L16,17 L16,5 L3,5 C1.34314575,5\n                                2.02906125e-16,3.65685425 0,2 L0,0 L20,0 Z",className:"modbot_finger1"}),r.createElement("path",{d:"M20,34 L0,34 L0,32 C2.02906125e-16,30.3431458\n                                1.34314575,29 3,29 L16,29 L16,17 L20,17 L20,34 Z",className:"modbot_finger2"}))),r.createElement("g",{transform:`translate(${d},${o})`,className:"modbot_elbow"},r.createElement("circle",{r:"11.5"}),r.createElement("circle",{r:"2.5"}))))))}componentDidMount(){this.sizeObserver.startObserving(this.ref,this.onResize),this.createBotAnimations()}componentWillUnmount(){this.sizeObserver.stopObserving()}componentDidUpdate(e){e.active!==this.props.active&&(this.createBotAnimations(),this.props.active?(this.updatePlayer(),this.startBotAnimation.play()):(a.remove(this.animationObj),this.stopBotAnimation.play()))}onResize(){this.forceUpdate()}getDotTag(){switch(this.getParameterName()){case"oscillator_pulse_width_lfo_amount":return"lesson-visualizations:labels.pulseWidth";default:return"lesson-visualizations:labels.pitch"}}getParameterName(){return""}createBotAnimations(){this.startBotAnimation.pause(),this.stopBotAnimation.pause(),this.startBotAnimation=a.timeline({autoplay:!1}),this.startBotAnimation.add({targets:".visualization-modbot-drawing",translateX:"0%",duration:750,easing:"easeInOutSine"}),this.startBotAnimation.add({targets:".modbot_finger1",translateY:"6px",duration:250,offset:"-=150",easing:"easeInOutSine"}),this.startBotAnimation.add({targets:".modbot_finger2",translateY:"-6px",duration:250,offset:"-=250",easing:"easeInOutSine"}),this.startBotAnimation.add({targets:".modbot_base",translateY:"6px",duration:250,offset:"-=250",easing:"easeInOutSine",complete:this.startModulating}),this.stopBotAnimation=a.timeline({autoplay:!1}),this.stopBotAnimation.add({targets:".modbot_base",translateY:"0px",duration:250,easing:"easeInOutSine"}),this.stopBotAnimation.add({targets:".modbot_finger1",translateY:"0px",duration:250,offset:"-=250",easing:"easeInOutSine"}),this.stopBotAnimation.add({targets:".modbot_finger2",translateY:"0px",duration:250,offset:"-=250",easing:"easeInOutSine"}),this.stopBotAnimation.add({targets:".visualization-modbot-drawing",translateX:"25%",duration:1350,easing:"easeInOutSine"})}startModulating(){a.remove(this.animationObj),a({targets:this.animationObj,amplitude:this.maxAmplitude,easing:"easeInOutSine",duration:350,update:this.updatePlayer,complete:this.beginModulationLoop})}beginModulationLoop(){a({targets:this.animationObj,amplitude:[this.maxAmplitude,-this.maxAmplitude],easing:"easeInOutSine",loop:!0,direction:"alternate",update:this.updatePlayer,duration:1e3})}updatePlayer(){if(void 0!==this.props.player){const e=c.mapValueToRange(this.animationObj.amplitude,-this.maxAmplitude,this.maxAmplitude,.4,.65);this.props.player.setParameterControlValue("oscillator_pitch_offset",e)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RingBuffer=class{constructor(e){this.currentIndex=0,this.isFull=!1,this.data=new Array(e)}reset(){this.currentIndex=0,this.isFull=!1}push(...e){e.forEach(e=>{this.pushElement(e)})}forEachLifo(e){for(let t=this.currentIndex-1;t>=0;t--)e(this.data[t]);if(this.isFull){const t=this.currentIndex;for(let n=this.data.length-1;n>=t;n--)e(this.data[n])}}forEachFifo(e){if(this.isFull){const t=this.data.length;for(let n=this.currentIndex;n<t;n++)e(this.data[n])}const t=this.currentIndex;for(let n=0;n<t;n++)e(this.data[n])}pushElement(e){this.data[this.currentIndex]=e,this.currentIndex++,this.currentIndex=this.currentIndex<this.data.length?this.currentIndex:0,this.isFull=this.isFull||0===this.currentIndex}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(80),a=n(81),o=n(83),s=n(84),c=n(87),l=n(88),u=n(93),h=n(91),p=n(89),d=n(263),f=n(33),m=n(26);t.ComponentName="synth-panel";class g extends r.Component{constructor(e){super(e),this.controlsRef=r.createRef(),this.player=this.props.player}componentDidMount(){this.props.sharedSynthComponent.addControlPortal(this.controlsRef.current)}render(){return this.props.texts?r.createElement("div",{className:"components_two-column-recipe"},r.createElement("div",{key:"left-column",className:"components_two-column-recipe__left-column",style:{"--current-theme-color":`var(${this.getColorVariableForPanel()})`}},this.props.texts&&this.props.texts.map(e=>{const t=this.getMarkdownForText(e);return m.renderMarkdown(t)})),r.createElement("div",{key:"right-column",className:"components_two-column-recipe__right-column"},r.createElement("div",null,this.createComponent(),r.createElement("div",{key:"controls",ref:this.controlsRef})))):r.createElement(r.Fragment,null,this.createComponent(),r.createElement("div",{key:"controls",ref:this.controlsRef}))}getMarkdownForText(e){const t=this.context.chunks.find(t=>t.metadata.footloose===e);return void 0===t?`Footloose text not found: ${e}`:t.markdown}createComponent(){switch(this.props.panel){case"amplitude-envelope":return r.createElement(i.AmplitudeEnvelopePanel,{player:this.player,key:"panel"});case"low-pass-filter":return r.createElement(a.LowPassFilterPanel,{player:this.player,key:"panel"});case"mod-envelope":return r.createElement(o.ModEnvelopePanel,{player:this.player,key:"panel"});case"lfo":return r.createElement(s.LfoPanel,{player:this.player,key:"panel"});case"pitch":return r.createElement(c.PitchPanel,{player:this.player,key:"panel"});case"noise":return r.createElement(l.NoisePanel,{player:this.player,key:"panel"});case"saw-oscillator":return r.createElement(u.SawOscillatorPanel,{player:this.player,key:"panel"});case"pulse-oscillator":return r.createElement(h.PulseOscillatorPanel,{player:this.player,key:"panel"});case"amplitude":return r.createElement(p.AmplitudePanel,{player:this.player,key:"panel"});case"xy":return r.createElement(d.XYPanel,{player:this.player,xMacro:void 0!==this.props.xMacro?this.props.xMacro:[],yMacro:void 0!==this.props.yMacro?this.props.yMacro:[],initialX:this.props.initialX,initialY:this.props.initialY,tooltipKey:this.props.tooltipKey,rotation:this.props.rotation,visualization:this.props.visualization,key:"panel"});default:throw new Error(`panel not found: ${this.props.panel}`)}}getColorVariableForPanel(){switch(this.props.panel){case"amplitude-envelope":case"amplitude":return"--color-green";case"low-pass-filter":return"--color-yellow";case"mod-envelope":case"lfo":return"--color-red";case"pitch":case"noise":case"saw-oscillator":case"pulse-oscillator":return"--color-blue";default:throw new Error(`panel not found: ${this.props.panel}`)}}}g.contextType=f.PageContext,t.SynthPanel=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(58),a=n(60),o=n(16);t.XYPanel=class extends r.Component{constructor(e){super(e),this.state={ready:!0,active:!1},this.onXYChange=this.onXYChange.bind(this),this.onPresetEvent=this.onPresetEvent.bind(this)}componentDidMount(){this.props.player.addPlayerListener(this)}componentWillUnmount(){this.props.player.removePlayerListener(this)}render(){return r.createElement("div",{className:"centered synth-xy-2 synth-xy glow",key:"xy-panel"},r.createElement(i.XYPad,{callback:this.onXYChange,visualization:e=>a.createVisualization(this.props.visualization?this.props.visualization:"glow",e,this.props.xMacro,this.props.yMacro,this.props.player),thumbRadius:16.5,easing:5,rotation:void 0!==this.props.rotation?this.props.rotation:7.5,lockX:void 0===this.props.xMacro||0===this.props.xMacro.length,lockY:void 0===this.props.yMacro||0===this.props.yMacro.length,initialX:this.props.initialX,initialY:this.props.initialY,tooltipKey:this.props.tooltipKey,restAtInitialX:!1,restAtInitialY:!1,controls:void 0,player:this.props.player}))}onPresetEvent(e){this.forceUpdate()}onXYChange(e){switch(e.type){case 0:o.publish("requestSharedSynthNoteOn",{}),this.setState({active:!0});break;case 1:this.setMacroValue(this.props.xMacro,e.xPctEased),this.setMacroValue(this.props.yMacro,1-e.yPctEased);break;case 2:o.publish("requestSharedSynthNoteOff",{}),this.setState({active:!1})}}setMacroValue(e,t){void 0!==this.props.player&&void 0!==e&&this.props.player.setMacroValue(e,t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(3),a=n(13),o=n(5),s=n(37),c=n(10),l=n(265),u=n(92),h=n(266),p=n(267),d=n(268),f=n(4);t.ComponentName="synth-slider";t.Synth=class extends r.Component{constructor(e){super(e),this.pointerObserver=new a.PointerObserver,this.sizeObserver=new o.SizeObserver,this.animationFramer=new c.AnimationFramer,this.state={active:!1,percent:void 0===this.props.initialPercent?.5:this.props.initialPercent,targetPercent:void 0===this.props.initialPercent?.5:this.props.initialPercent,pointerDownTime:0},this.player=this.props.player,this.setMacroValue(this.props.macro,this.state.percent),this.vizHitAreaRef=r.createRef(),this.onResize=this.onResize.bind(this),this.onAnimationFrame=this.onAnimationFrame.bind(this),this.onVizPress=this.onVizPress.bind(this),this.onSliderChange=this.onSliderChange.bind(this)}componentDidMount(){this.pointerObserver.startObserving(this.vizHitAreaRef.current,this.onVizPress,{clampX:!0,clampY:!0}),this.sizeObserver.startObserving(this.vizHitAreaRef,this.onResize)}componentWillUnmount(){this.sizeObserver.stopObserving(),this.animationFramer.stopAnimating(),this.pointerObserver.stopObserving()}render(){const e=i("synth_slider","synth_slider--ready",{"synth_slider--active":this.state.active},{"synth_slider--no-slider":0===this.props.macro.length},this.props.visualization);return r.createElement("div",{className:e},r.createElement("div",{className:"synth_slider__viz",ref:this.vizHitAreaRef},this.visualization()),r.createElement("div",{className:"synth_slider__control"},r.createElement(s.SliderPad,Object.assign({targetValue:this.state.targetPercent},this.state,{callback:this.onSliderChange,labelName:this.getParameterDisplayName(),labelValue:this.getParameterValueAsString(),labels:this.props.labels,tooltipKey:this.props.tooltipKey,restAtInitialPercent:this.props.restAtInitialPercent,initialPercent:this.props.initialPercent}))))}onResize(){this.forceUpdate()}onAnimationFrame(){this.forceUpdate()}onVizPress(e){switch(e.type){case 0:this.player.playNote(this.props.note),this.setState({active:!0,pointerDownTime:performance.now()}),this.animationFramer.startAnimating(this.onAnimationFrame);break;case 2:this.player.stopNote(this.props.note),this.setState({active:!1}),this.animationFramer.stopAnimating()}}onSliderChange(e){switch(e.type){case 0:this.player.playNote(this.props.note),this.setState({active:!0,pointerDownTime:performance.now()}),this.animationFramer.startAnimating(this.onAnimationFrame);break;case 1:this.setMacroValue(this.props.macro,e.pctEased);break;case 2:this.player.stopNote(this.props.note),this.setState({active:!1}),this.animationFramer.stopAnimating()}this.setState({percent:e.pctEased,targetPercent:e.pctRaw})}setMacroValue(e,t){void 0!==e&&this.player.setMacroValue(e,t)}visualization(){switch(this.props.visualization){case"pulse-width":return r.createElement(u.PulseWaveform,{width:this.state.percent,amplitude:1,phase:0});case"mixing-waveforms":return r.createElement(p.MixingWaveformsSliderVisualization,Object.assign({},this.state));case"buzzing-bee":return r.createElement(d.BuzzingBeeVisualization,Object.assign({},this.state));case"lfo-diagram":if(void 0!==this.player)return r.createElement(h.LfoDiagramSliderVisualization,Object.assign({},this.state,{macro:this.props.macro,player:this.player}));default:return r.createElement(l.MissingVisualization,Object.assign({},this.state))}}getParameterDisplayName(){const e=this.props.macro.length<1?"":this.props.macro[0].parameterName,t=this.getTagFromParameterName(e);return f.translated(t)}getTagFromParameterName(e){switch(e){case"oscillator_pulse_width_lfo_amount":case"oscillator_pitch_offset_lfo_amount":return"lesson-visualizations:labels.lfoAmount";case"oscillator_noise_amplitude":return"lesson-visualizations:labels.noiseAmplitude";case"oscillator_pulse_width":return"lesson-visualizations:labels.pulseWidth";case"lfo_frequency":return"lesson-visualizations:labels.rate";default:return e}}getParameterValueAsString(){return void 0!==this.props.macro&&this.props.macro.length>0&&this.player?this.player.getParameterValueAsString(this.props.macro[0].parameterName):""}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(3);t.MissingVisualization=class extends r.Component{constructor(e){super(e)}render(){const e=i("visualization-missing",{active:this.props.active});return r.createElement("div",{className:e},r.createElement("div",{className:"background"}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(3),a=n(5),o=n(4),s=n(21);t.LfoDiagramSliderVisualization=class extends r.Component{constructor(e){super(e),this.sizeObserver=new a.SizeObserver,this.lfoPhase=0,this.ref=r.createRef(),this.onResize=this.onResize.bind(this)}render(){const e=i("visualization-lfo-diagram-slider",{active:this.props.active}),t=this.sizeObserver.getHeight(),n=this.sizeObserver.getWidth();this.updateLfoPhase();const a=this.getAmplitude(),c=s.cosinePolylinePoints(n,t,this.lfoPhase,a,2),l=s.cosinePointAtPhase(t,this.lfoPhase,a),u=Math.abs(t*a*.75),h=t/2-u/2;return r.createElement("div",{className:e},r.createElement("div",{ref:this.ref,className:"visualization-lfo-diagram-slider_viz"},r.createElement("svg",{width:"100%",height:"100%"},r.createElement("defs",null,r.createElement("clipPath",{id:"clippath-filled"},r.createElement("rect",{x:"0",y:"0",width:n/2,height:t})),r.createElement("clipPath",{id:"clippath-dotted"},r.createElement("rect",{x:n/2,y:"0",width:n/2,height:t}))),this.showAmount()&&r.createElement("rect",{className:"visualization-lfo-diagram_viz-amount-indicator",rx:"4",ry:"4",x:n/2-4,y:h,width:"8.0",height:u}),r.createElement("polyline",{className:"visualization-lfo-diagram_viz-waveshape-filled",clipPath:"url(#clippath-filled)",points:c}),r.createElement("polyline",{className:"visualization-lfo-diagram_viz-waveshape-dotted",clipPath:"url(#clippath-dotted)",points:c}),r.createElement("circle",{className:"visualization-lfo-diagram_viz-dot",cx:`${n/2}`,cy:l,r:"6"})),0===this.props.macro.length&&r.createElement("div",{className:"visualization-lfo-diagram_axis-x"},r.createElement("svg",{className:"visualization-lfo-diagram_axis-x-arrow",width:`${n}`,height:"11px",viewBox:`0 0 ${n} 11`},r.createElement("path",{d:`M1,5.5 L${n},5.5`}),r.createElement("polyline",{points:`${n-4.5} 1.5 ${n} 5.5 ${n-4.5} 9.5`})),r.createElement("h4",{className:"visualization-lfo-diagram_axis-x-label"},o.translated("lesson-visualizations:labels.time"))),r.createElement("div",{className:"visualization-lfo-diagram_target",style:{transform:`translate(${n/2}px, ${l}px)`}},r.createElement("h4",{className:"visualization-lfo-diagram_target-label"},o.translated(this.getDotTag())))))}componentDidMount(){this.sizeObserver.startObserving(this.ref,this.onResize)}componentWillUnmount(){this.sizeObserver.stopObserving()}onResize(){this.forceUpdate()}updateLfoPhase(){this.props.active&&void 0!==this.props.player&&void 0!==this.props.pointerDownTime&&performance.now()>this.props.pointerDownTime+20&&(this.lfoPhase=this.props.player.getModulatedParameterControlValue("lfo_phase"))}showAmount(){switch(this.getParameterName()){case"oscillator_pitch_offset_lfo_amount":case"oscillator_pulse_width_lfo_amount":return!0;default:return!1}}getAmplitude(){switch(this.getParameterName()){case"oscillator_pitch_offset_lfo_amount":case"oscillator_pulse_width_lfo_amount":return this.props.percent;default:return.5}}getDotTag(){switch(this.getParameterName()){case"oscillator_pulse_width_lfo_amount":return"lesson-visualizations:labels.pulseWidth";default:return"lesson-visualizations:labels.pitch"}}getParameterName(){return this.props.macro.length<1?"":this.props.macro[0].parameterName}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(3),a=n(5),o=n(6);t.MixingWaveformsSliderVisualization=class extends r.Component{constructor(e){super(e),this.sizeObserver=new a.SizeObserver,this.ref=r.createRef(),this.onResize=this.onResize.bind(this)}render(){const e=this.sizeObserver.getHeight(),t=this.sizeObserver.getWidth()/96,n=e/48,a=[{x:2,y:46},{x:2,y:2},{x:17,y:2},{x:17,y:46},{x:33,y:46},{x:33,y:2},{x:48,y:2},{x:48,y:46},{x:64,y:46},{x:64,y:2},{x:79,y:2},{x:79,y:46},{x:94,y:46}],s=[{x:2,y:24},{x:10,y:13},{x:17,y:2},{x:17,y:46},{x:25,y:35},{x:41,y:13},{x:48,y:2},{x:48,y:46},{x:56,y:35},{x:72,y:13},{x:79,y:2},{x:79,y:46},{x:94,y:24}],c=[{x:o.mapNormalizedValueToRange(this.props.percent,a[0].x,s[0].x)*t,y:o.mapNormalizedValueToRange(this.props.percent,a[0].y,s[0].y)*n},{x:o.mapNormalizedValueToRange(this.props.percent,a[1].x,s[1].x)*t,y:o.mapNormalizedValueToRange(this.props.percent,a[1].y,s[1].y)*n},{x:o.mapNormalizedValueToRange(this.props.percent,a[2].x,s[2].x)*t,y:o.mapNormalizedValueToRange(this.props.percent,a[2].y,s[2].y)*n},{x:o.mapNormalizedValueToRange(this.props.percent,a[3].x,s[3].x)*t,y:o.mapNormalizedValueToRange(this.props.percent,a[3].y,s[3].y)*n},{x:o.mapNormalizedValueToRange(this.props.percent,a[4].x,s[4].x)*t,y:o.mapNormalizedValueToRange(this.props.percent,a[4].y,s[4].y)*n},{x:o.mapNormalizedValueToRange(this.props.percent,a[5].x,s[5].x)*t,y:o.mapNormalizedValueToRange(this.props.percent,a[5].y,s[5].y)*n},{x:o.mapNormalizedValueToRange(this.props.percent,a[6].x,s[6].x)*t,y:o.mapNormalizedValueToRange(this.props.percent,a[6].y,s[6].y)*n},{x:o.mapNormalizedValueToRange(this.props.percent,a[7].x,s[7].x)*t,y:o.mapNormalizedValueToRange(this.props.percent,a[7].y,s[7].y)*n},{x:o.mapNormalizedValueToRange(this.props.percent,a[8].x,s[8].x)*t,y:o.mapNormalizedValueToRange(this.props.percent,a[8].y,s[8].y)*n},{x:o.mapNormalizedValueToRange(this.props.percent,a[9].x,s[9].x)*t,y:o.mapNormalizedValueToRange(this.props.percent,a[9].y,s[9].y)*n},{x:o.mapNormalizedValueToRange(this.props.percent,a[10].x,s[10].x)*t,y:o.mapNormalizedValueToRange(this.props.percent,a[10].y,s[10].y)*n},{x:o.mapNormalizedValueToRange(this.props.percent,a[11].x,s[11].x)*t,y:o.mapNormalizedValueToRange(this.props.percent,a[11].y,s[11].y)*n},{x:o.mapNormalizedValueToRange(this.props.percent,a[12].x,s[12].x)*t,y:o.mapNormalizedValueToRange(this.props.percent,a[12].y,s[12].y)*n}],l=i("components_visualizations_mixing_waveforms",{"components_visualizations_mixing_waveforms--active":this.props.active});return r.createElement("div",{className:l},r.createElement("div",{ref:this.ref,className:"components_visualizations_mixing_waveforms__viz"},r.createElement("svg",{style:{width:"100%",height:"100%"}},r.createElement("polyline",{points:`\n                            ${c[0].x} ${c[0].y}\n                            ${c[1].x} ${c[1].y}\n                            ${c[2].x} ${c[2].y}\n                            ${c[3].x} ${c[3].y}\n                            ${c[4].x} ${c[4].y}\n                            ${c[5].x} ${c[5].y}\n                            ${c[6].x} ${c[6].y}\n                            ${c[7].x} ${c[7].y}\n                            ${c[8].x} ${c[8].y}\n                            ${c[9].x} ${c[9].y}\n                            ${c[10].x} ${c[10].y}\n                            ${c[11].x} ${c[11].y}\n                            ${c[12].x} ${c[12].y}\n                        `}))))}componentDidMount(){this.sizeObserver.startObserving(this.ref,this.onResize)}componentWillUnmount(){this.sizeObserver.stopObserving()}onResize(){this.forceUpdate()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(3),a=n(1),o=n(39),s=n(15),c=n(6),l=n(12),u=n(20),h=n(5),p=n(10),d=n(40),f=.575,m=1.7,g=20,v=.05,y=10,b=30,_=.25,w=Math.PI/180*-25,x=Math.PI/180*-40;class E extends r.Component{constructor(e){super(e),this.sizeObserver=new h.SizeObserver,this.scene=new a.Scene,this.camera=new a.PerspectiveCamera,this.renderer=new a.WebGLRenderer({antialias:d.getAntialiasingSetting()}),this.sceneBackgroundColor=16777215,this.beeGroup=new a.Object3D,this.bee=new a.Object3D,this.wing1=new a.Object3D,this.wing2=new a.Object3D,this.bodyMaterial=new a.MeshLambertMaterial({color:"#E2E2E8"}),this.beeBodyOffColor=new a.Color("#E2E2E8"),this.beeBodyOnColor=new a.Color("#FFBE2E"),this.beeBodyAnimationColor=new a.Color("#000000"),this.stripeMaterial=new a.MeshBasicMaterial({color:"#00004c"}),this.beeStripesOffColor=new a.Color("#00004c"),this.beeStripesOnColor=new a.Color("#463721"),this.beeStripesAnimationColor=new a.Color("#000000"),this.wingPhase=0,this.wingSpeed=0,this.wingAmplitudeTarget=0,this.wingAmplitude=0,this.altitude=f,this.altitudeTarget=f,this.animationFramer=new p.AnimationFramer,this.ref=r.createRef(),this.rendererRef=r.createRef(),this.createRenderer(),this.createScene(),this.createLights(),this.createCamera(),this.createGround(),this.shouldRender=!0,this.onResize=this.onResize.bind(this),this.onAnimationFrame=this.onAnimationFrame.bind(this)}render(){const e=i("components_visualizations_buzzing_bee",{"components_visualizations_buzzing_bee--active":this.props.active});return r.createElement("div",{ref:this.ref,className:e},r.createElement("div",{ref:this.rendererRef,className:"components_visualizations_buzzing_bee__viz"}))}componentDidUpdate(e){this.props.active&&!e.active&&this.activateBee(),!this.props.active&&e.active&&this.deactivateBee()}componentDidMount(){this.rendererRef.current.appendChild(this.renderer.domElement),this.sizeObserver.startObserving(this.ref,this.onResize),this.animationFramer.startAnimating(this.onAnimationFrame),this.loadGLTF()}componentWillUnmount(){this.sizeObserver.stopObserving(),this.animationFramer.stopAnimating()}onResize(){const e=this.sizeObserver.getHeight(),t=this.sizeObserver.getWidth();this.camera.aspect=t/e,this.camera.updateProjectionMatrix(),this.renderer.setSize(t,e),this.renderer.render(this.scene,this.camera),this.forceUpdate()}loadGLTF(){const e=new o.GLTFLoader,t=l.urlForFile("content/assets/models/bee-scene.glb");e.load(t,e=>{this.scene.add(e.scene),this.styleScene()},void 0,e=>{console.error(e)})}createRenderer(){this.renderer.setClearColor(this.sceneBackgroundColor),this.renderer.setPixelRatio(d.getPixelRatioSetting()),this.renderer.shadowMap.enabled=d.getShadowMapSetting(),this.renderer.shadowMap.type=a.PCFSoftShadowMap}createScene(){this.scene.background=new a.Color(this.sceneBackgroundColor)}createGround(){const e=new a.MeshLambertMaterial({color:16382457}),t=new a.Mesh(new a.PlaneBufferGeometry(20,20),e);t.rotation.x=-Math.PI/2,this.scene.add(t),t.receiveShadow=!0}createLights(){const e=new a.AmbientLight(16777215,1);this.scene.add(e);const t=new a.DirectionalLight(16777215,.1);t.position.set(-.3,2,.5),this.scene.add(t),t.castShadow=!0}createCamera(){this.camera=new a.PerspectiveCamera(45,16/9,.25,20);this.camera.position.set(0,1.5,3.8),this.camera.rotation.set(0,0,0),this.camera.lookAt(0,1.3,0)}styleScene(){const e=this.context.theme.color;this.beeBodyOnColor=new a.Color(e.string()),this.beeStripesOnColor=new a.Color(e.darken(.75).rgb().string());const t=new a.MeshBasicMaterial({color:"#C4C4CD",opacity:.5,transparent:!0,side:a.DoubleSide}),n=this.scene.getObjectByName("beeGroup");n&&(this.beeGroup=n),this.addMaterialToObject(this.beeGroup,!1,!0,!0);const r=this.scene.getObjectByName("bee");r&&(this.bee=r);const i=this.scene.getObjectByName("wing1");i&&(this.wing1=i);const o=this.scene.getObjectByName("wing2");o&&(this.wing2=o),this.addMaterialToObject(this.wing1,t,!0,!1),this.addMaterialToObject(this.wing2,t,!0,!1);const s=this.scene.getObjectByName("stripe1");s&&this.addMaterialToObject(s,this.stripeMaterial,!0,!0);const c=this.scene.getObjectByName("stripe2");c&&this.addMaterialToObject(c,this.stripeMaterial,!0,!0);const l=this.scene.getObjectByName("legs");this.addMaterialToObject(l,this.stripeMaterial,!0,!0);const u=this.scene.getObjectByName("stinger");this.addMaterialToObject(u,this.stripeMaterial,!0,!0);const h=this.scene.getObjectByName("eye1");this.addMaterialToObject(h,this.stripeMaterial,!0,!0);const p=this.scene.getObjectByName("eye2");this.addMaterialToObject(p,this.stripeMaterial,!0,!0);const d=this.scene.getObjectByName("smile");d&&(d.visible=!1);const f=this.scene.getObjectByName("body");this.addMaterialToObject(f,this.bodyMaterial,!0,!0);const m=this.scene.getObjectByName("plant");m&&(m.visible=!1),this.shouldRender=!0}addMaterialToObject(e,t,n,r){e.traverse(e=>{e instanceof a.Mesh&&(e.material=t,e.castShadow=n,e.receiveShadow=r)})}activateBee(){this.animateBeeColor(this.beeBodyOnColor),this.animateBeeStripesColor(this.beeStripesOnColor),this.wingAmplitudeTarget=b}deactivateBee(){this.animateBeeColor(this.beeBodyOffColor),this.animateBeeStripesColor(this.beeStripesOffColor),this.wingAmplitudeTarget=0}animateBeeColor(e){s.remove(this.beeBodyAnimationColor),this.beeBodyAnimationColor=this.bodyMaterial.color,s({targets:this.beeBodyAnimationColor,r:e.r,g:e.g,b:e.b,easing:"easeOutQuart",update:()=>{this.bodyMaterial.color=this.beeBodyAnimationColor}})}animateBeeStripesColor(e){s.remove(this.beeStripesAnimationColor),this.beeStripesAnimationColor=this.stripeMaterial.color,s({targets:this.beeStripesAnimationColor,r:e.r,g:e.g,b:e.b,easing:"easeOutQuart",update:()=>{this.stripeMaterial.color=this.beeStripesAnimationColor}})}onAnimationFrame(){(s.running.length>0||this.shouldRender||this.props.active)&&(this.updateBeePosition(),this.renderer.render(this.scene,this.camera),this.shouldRender=!1)}updateBeePosition(){this.altitudeTarget=this.props.active?c.mapNormalizedValueToRange(this.props.percent,f,m):f,this.wingAmplitude=this.wingAmplitude+(this.wingAmplitudeTarget-this.wingAmplitude)/y,this.altitude=this.altitude+(this.altitudeTarget-this.altitude)/g,this.wingSpeed=2*(this.props.percent+v),this.wingPhase+=this.wingSpeed;const e=this.wingAmplitude*Math.sin(this.wingPhase),t=e*(Math.PI/180)-_;this.wing1&&(this.wing1.rotation.z=-t),this.wing2&&(this.wing2.rotation.z=t),this.bee&&(this.bee.position.y=2e-4*-e*(1-this.props.percent)),this.beeGroup&&(this.beeGroup.position.y=this.altitude,this.beeGroup.rotation.y=c.mapNormalizedValueToRange(this.props.percent,w,x))}}E.contextType=u.ThemeContext,t.BuzzingBeeVisualization=E},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(3),a=n(96),o=n(62),s=n(22);t.ComponentName="synth3d-press";t.Synth3DPress=class extends r.Component{constructor(e){super(e),this.musicEvents=[],this.musicEventIndex=0,this.state={active:!1},this.player=this.props.player,this.musicEvents=s.notationToMusicEvents(this.props.notes),this.onPress=this.onPress.bind(this)}render(){const e=i("synth3d",t.ComponentName,{"synth3d--ready":!0},{"synth3d--active":this.state.active});return r.createElement("div",{className:e},r.createElement(o.Synth3DViz,{player:this.player,musicEvents:this.musicEvents,rotation:this.props.rotation,position:this.props.position,showPlant:this.props.showPlant,active:this.state.active,emphasizeParameters:this.props.emphasizeParameters}),r.createElement(a.PressPad,{active:this.state.active,callback:this.onPress,tooltipKey:this.props.tooltipKey}))}onPress(e){switch(e.type){case 0:this.playNote(),this.setState({active:!0});break;case 2:this.stopNote(),this.setState({active:!1})}}playNote(){const e=this.musicEvents[this.musicEventIndex%this.musicEvents.length].pitch;this.player.playNote(e)}stopNote(){const e=this.musicEvents[this.musicEventIndex%this.musicEvents.length].pitch;this.musicEventIndex++,this.player.stopNote(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(3),a=n(37),o=n(62),s=n(22),c=n(33),l=n(26);t.ComponentName="synth3d-sliders";class u extends r.Component{constructor(e){super(e),this.musicEvents=[],this.musicEventIndex=0,this.parameterNames=[],this.state={active:!1,slider1Active:!1,slider2Active:!1,slider3Active:!1,slider1TargetValue:1,slider2TargetValue:1,slider3TargetValue:0},this.player=this.props.player,this.musicEvents=s.notationToMusicEvents(this.props.notes),this.parameterNames=[this.props.slider1Macro[0].parameterName,this.props.slider2Macro[0].parameterName,this.props.slider3Macro[0].parameterName],this.onSlider1Change=this.onSlider1Change.bind(this),this.onSlider2Change=this.onSlider2Change.bind(this),this.onSlider3Change=this.onSlider3Change.bind(this),this.onPress=this.onPress.bind(this)}render(){const e=i("synth3d",t.ComponentName,{"synth3d--ready":!0},{"synth3d--active":this.state.active});return r.createElement("div",{className:e},r.createElement(o.Synth3DViz,{player:this.player,musicEvents:this.musicEvents,rotation:this.props.rotation,position:this.props.position,showPlant:this.props.showPlant,active:this.state.active,callback:this.onPress,parameterNames:this.parameterNames,activeParameterNames:this.state.activeParameterNames,emphasizeParameters:!0}),r.createElement("div",{className:"synth3d__slider-text"},l.renderMarkdown(this.getMarkdownForText(this.props.slider1Text))),r.createElement(a.SliderPad,{targetValue:this.state.slider1TargetValue,active:this.state.slider1Active,callback:this.onSlider1Change,labelName:"",labelValue:"",labels:!1,restAtInitialPercent:!1,initialPercent:this.state.slider1TargetValue,tooltipKey:this.props.tooltipKey}),r.createElement("div",{className:"synth3d__slider-text"},l.renderMarkdown(this.getMarkdownForText(this.props.slider2Text))),r.createElement(a.SliderPad,{targetValue:this.state.slider2TargetValue,active:this.state.slider2Active,callback:this.onSlider2Change,labelName:"",labelValue:"",labels:!1,restAtInitialPercent:!1,initialPercent:this.state.slider2TargetValue}),r.createElement("div",{className:"synth3d__slider-text"},l.renderMarkdown(this.getMarkdownForText(this.props.slider3Text))),r.createElement(a.SliderPad,{targetValue:this.state.slider3TargetValue,active:this.state.slider3Active,callback:this.onSlider3Change,labelName:"",labelValue:"",labels:!1,restAtInitialPercent:!1,initialPercent:this.state.slider3TargetValue}))}onSlider1Change(e){const t=this.props.slider1Macro[0].parameterName;switch(e.type){case 0:this.setState({slider1Active:!0,active:!0,activeParameterNames:[t]}),this.playNote();break;case 1:this.setMacroValue(this.props.slider1Macro,e.pctEased);break;case 2:this.setState({slider1Active:!1,active:!1}),this.stopNote()}this.setState({slider1TargetValue:e.pctRaw})}onSlider2Change(e){const t=this.props.slider2Macro[0].parameterName;switch(e.type){case 0:this.setState({slider2Active:!0,active:!0,activeParameterNames:[t]}),this.playNote();break;case 1:this.setMacroValue(this.props.slider2Macro,e.pctEased);break;case 2:this.setState({slider2Active:!1,active:!1}),this.stopNote()}this.setState({slider2TargetValue:e.pctRaw})}onSlider3Change(e){const t=this.props.slider3Macro[0].parameterName;switch(e.type){case 0:this.setState({slider3Active:!0,active:!0,activeParameterNames:[t]}),this.playNote();break;case 1:this.setMacroValue(this.props.slider3Macro,e.pctEased);break;case 2:this.setState({slider3Active:!1,active:!1}),this.stopNote()}this.setState({slider3TargetValue:e.pctRaw})}onPress(e){switch(e.type){case 0:this.setState({active:!0}),this.playNote();break;case 2:this.setState({active:!1}),this.stopNote()}}playNote(){const e=this.musicEvents[this.musicEventIndex%this.musicEvents.length].pitch;this.player.playNote(e)}stopNote(){const e=this.musicEvents[this.musicEventIndex%this.musicEvents.length].pitch;this.musicEventIndex++,this.player.stopNote(e)}setMacroValue(e,t){void 0!==e&&this.player.setMacroValue(e,t)}getMarkdownForText(e){const t=this.context.chunks.find(t=>t.metadata.footloose===e);return void 0===t?`Footloose text not found: ${e}`:t.markdown}}u.contextType=c.PageContext,t.Synth3DSliders=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(3),a=n(22),o=n(58),s=n(60),c=n(62);t.ComponentName="synth3d-xy";t.Synth3DXY=class extends r.Component{constructor(e){super(e),this.musicEvents=[],this.musicEventIndex=0;const t=this.props.xMacro.concat(this.props.yMacro);this.state={active:!1,activeParameterNames:t.map(e=>e.parameterName)},this.player=this.props.player,this.musicEvents=a.notationToMusicEvents(this.props.notes),this.onXYChange=this.onXYChange.bind(this)}render(){const e=i("synth3d",t.ComponentName,{"synth3d--ready":!0},{"synth3d--active":this.state.active});return r.createElement("div",{className:e},r.createElement(c.Synth3DViz,{player:this.player,musicEvents:this.musicEvents,rotation:this.props.rotation||"0 0 0",position:this.props.position||"0 0 0",showPlant:this.props.showPlant||!1,active:this.state.active,parameterNames:this.state.activeParameterNames,activeParameterNames:this.state.activeParameterNames,emphasizeParameters:!0}),r.createElement(o.XYPad,{callback:this.onXYChange,visualization:e=>s.createVisualization("glow",e,this.props.xMacro,this.props.yMacro,this.player),tooltipKey:this.props.tooltipKey,thumbRadius:16.5,easing:5,rotation:0,lockX:!1,lockY:!1,restAtInitialX:!1,restAtInitialY:!1,controls:""}))}onXYChange(e){switch(e.type){case 0:this.playNote(),this.setState({active:!0});break;case 1:this.setMacroValue(this.props.xMacro,e.xPctEased),this.setMacroValue(this.props.yMacro,1-e.yPctEased);break;case 2:this.stopNote(),this.setState({active:!1})}}setMacroValue(e,t){void 0!==e&&this.player.setMacroValue(e,t)}playNote(){const e=this.musicEvents[this.musicEventIndex%this.musicEvents.length].pitch;this.player.playNote(e)}stopNote(){const e=this.musicEvents[this.musicEventIndex%this.musicEvents.length].pitch;this.musicEventIndex++,this.player.stopNote(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(77),i=n(44),a=n(43);t.createPlayer=function(e,t){const n=new r.Player(a.provideInstrument);return void 0!==e&&void 0!==t&&n.preset(i.findLessonPreset(t,e)),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(46),a=n(274),o=n(275),s=n(4);t.LessonFooter=class extends r.PureComponent{constructor(e){super(e)}render(){const e=i.findNextPage(this.props.lesson,this.props.chapterId,this.props.pageId),t=void 0===e?void 0:i.resolveIds(this.props.lesson,e.chapterId,e.pageId),n=void 0===e?"/playground":`/${e.chapterId}/${e.pageId}`,c=i.findPrevPage(this.props.lesson,this.props.chapterId,this.props.pageId),l=void 0===c?void 0:`/${c.chapterId}/${c.pageId}`,u=void 0===t?s.translated("common:names.playground"):t.page.name;return r.createElement("div",{className:"components_lesson-viewer__footer"},r.createElement(a.NextLink,{url:n,text:u}),l&&r.createElement(o.PrevLink,{url:l}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(29),a=n(4),o=n(17);t.NextLink=class extends r.PureComponent{constructor(e){super(e)}render(){return r.createElement(i.Link,{to:this.props.url,className:"components_lesson-viewer__next-chapter"},r.createElement("div",{className:"components_lesson-viewer__next-chapter-caption"},a.translated("common:navigation.next")),r.createElement("div",{className:"components_lesson-viewer__next-chapter-label-separator"},""),r.createElement("div",{className:"components_lesson-viewer__next-chapter-subtitle"},this.props.text),r.createElement("div",{className:"components_lesson-viewer__next-chapter-indicator"},r.createElement("div",{className:"glyph-button-background"}),r.createElement(o.LessonNextChapterArrow,null)))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(29),a=n(4);t.PrevLink=class extends r.PureComponent{constructor(e){super(e)}render(){return r.createElement(i.Link,{to:this.props.url,className:"components_lesson-viewer__prev-chapter"},r.createElement("div",{className:"components_lesson-viewer__prev-chapter-label-separator"},""),r.createElement("div",{className:"components_lesson-viewer__prev-chapter-caption"},a.translated("common:navigation.previous")))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(3),a=n(277),o=n(16),s=n(278),c=n(279),l=n(4);t.LessonTableOfContents=class extends r.Component{constructor(e){super(e),this.state={expandedChapterIds:[]},this.onClose=this.onClose.bind(this)}render(){return r.createElement(r.Fragment,null,r.createElement(s.LessonTocToggle,null),r.createElement("div",{className:"components_lesson-viewer__toc"},r.createElement("div",{className:"components_lesson-viewer__toc-overlay",onClick:this.onClose}),r.createElement("div",{className:"components_lesson-viewer__toc-menu"},r.createElement("div",{className:"components_lesson-viewer__toc-scroll-area"},r.createElement("div",{className:"components_lesson-viewer__toc-header"},r.createElement(a.HashLink,{to:"/",onClick:this.onClose},r.createElement("h1",{className:"components_lesson-viewer__toc-lesson-title"},this.props.lesson.name))),r.createElement("div",{className:"components_lesson-viewer__toc-chapters"},this.props.lesson.chapters.map(e=>this.renderChapter(e))),r.createElement(a.HashLink,{to:"/playground",onClick:this.onClose,className:i("components_lesson-viewer__toc-chapter-title","components_lesson-viewer__toc-playground-title","theme-rainbow")},r.createElement("div",{className:"components_lesson-viewer__toc-chapter-heading"},l.translated("common:names.playground")),r.createElement("h4",{className:"components_lesson-viewer__toc-chapter-subtitle"},l.translated("common:descriptions.playground"))),r.createElement(c.SettingsPanel,null))),r.createElement("div",{className:"components_lesson-viewer__toc-menu-cover"})))}renderChapterHeader(e){const t=r.createElement(r.Fragment,null,r.createElement("div",{className:"components_lesson-viewer__toc-chapter-heading-container"},r.createElement("div",{className:"components_lesson-viewer__toc-chapter-heading-bg"}),r.createElement("div",{className:"components_lesson-viewer__toc-chapter-heading"},e.title),e.subtitle&&r.createElement("h4",{className:"components_lesson-viewer__toc-chapter-subtitle"},e.subtitle))),n=e.pages.length>1,o=i("components_lesson-viewer__toc-chapter-title",{"components_lesson-viewer__toc-chapter-title--current":this.getShouldChapterBeExpanded(e)});return n?r.createElement("a",{className:o,onClick:()=>{this.focusChapter(e)}},t):r.createElement(a.HashLink,{to:`/${e.id}`,onClick:this.onClose,className:o},t)}renderChapterPages(e){return 1===e.pages.length?r.createElement(r.Fragment,null):r.createElement("div",{className:i("components_lesson-viewer__toc-chapter-sections",{"components_lesson-viewer__toc-chapter-sections--current":this.getShouldChapterBeExpanded(e)})},e.pages.map((t,n)=>{const o=this.props.currentPageId===t.id&&this.props.currentChapterId===e.id||this.props.currentChapterId===e.id&&void 0===this.props.currentPageId&&0===n;return r.createElement(a.HashLink,{className:i("components_lesson-viewer__toc-chapter-section",{"components_lesson-viewer__toc-chapter-section--current":o}),onClick:this.onClose,key:t.id,to:`/${e.id}/${t.id}`},t.name)}))}renderChapter(e){return r.createElement("div",{key:e.id,className:i("components_lesson-viewer__toc-chapter",e.theme,{"components_lesson-viewer__toc-chapter--single-section":1===e.pages.length})},this.renderChapterHeader(e),this.renderChapterPages(e))}getShouldChapterBeExpanded(e){return this.state.expandedChapterIds.indexOf(e.id)>-1||this.props.currentChapterId===e.id}focusChapter(e){this.state.expandedChapterIds.indexOf(e.id)>-1?this.setState({expandedChapterIds:this.state.expandedChapterIds.filter(t=>t!==e.id)}):this.setState({expandedChapterIds:this.state.expandedChapterIds.concat(e.id)})}onClose(){this.setState({expandedChapterIds:[]}),o.publish("toggleTableOfContents",{show:!1})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.genericHashLink=m,t.HashLink=g,t.NavHashLink=v;var a=c(n(0)),o=c(n(2)),s=n(29);function c(e){return e&&e.__esModule?e:{default:e}}var l="",u=null,h=null,p=null;function d(){l="",null!==u&&u.disconnect(),null!==h&&(window.clearTimeout(h),h=null)}function f(){var e=document.getElementById(l);return null!==e&&(p(e),d(),!0)}function m(e,t){e.scroll,e.smooth;var n=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(e,["scroll","smooth"]);return a.default.createElement(t,r({},n,{onClick:function(t){d(),e.onClick&&e.onClick(t),"string"==typeof e.to?l=e.to.split("#").slice(1).join("#"):"object"===i(e.to)&&"string"==typeof e.to.hash&&(l=e.to.hash.replace("#","")),""!==l&&(p=e.scroll||function(t){return e.smooth?t.scrollIntoView({behavior:"smooth"}):t.scrollIntoView()},window.setTimeout(function(){!1===f()&&(null===u&&(u=new MutationObserver(f)),u.observe(document,{attributes:!0,childList:!0,subtree:!0}),h=window.setTimeout(function(){d()},1e4))},0))}}),e.children)}function g(e){return m(e,s.Link)}function v(e){return m(e,s.NavLink)}var y={onClick:o.default.func,children:o.default.node,scroll:o.default.func,to:o.default.oneOfType([o.default.string,o.default.object])};g.propTypes=y,v.propTypes=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(30),a=n(15),o=n(16),s=n(17);t.LessonTocToggle=class extends r.Component{constructor(e){super(e),this.closedIconRef=r.createRef(),this.openIconRef=r.createRef(),this.animate=this.animate.bind(this),this.handleClick=this.handleClick.bind(this),this.onToggleTableOfContentsMessage=this.onToggleTableOfContentsMessage.bind(this),this.onKeyDown=this.onKeyDown.bind(this)}render(){return r.createElement("div",{className:"components_lesson-viewer__toc-toggle"},r.createElement("a",{href:"javascript:void(0)",className:"components_lesson-viewer__toc-toggle-link",onClick:this.handleClick},r.createElement("span",{className:"components_lesson-viewer__toc-toggle-bg"},r.createElement("div",{className:"glyph-button-background"}),r.createElement("div",{className:"glyph-button-active-background"})),r.createElement("span",{className:"components_lesson-viewer__toc-toggle-icons"},r.createElement(s.LessonTocMenuClosed,{ref:this.closedIconRef}),r.createElement(s.LessonTocMenuOpen,{ref:this.openIconRef}))))}componentDidMount(){document.addEventListener("keydown",this.onKeyDown),o.subscribe("toggleTableOfContents",this.onToggleTableOfContentsMessage)}componentWillUnmount(){document.removeEventListener("keydown",this.onKeyDown),o.unsubscribe("toggleTableOfContents",this.onToggleTableOfContentsMessage)}onKeyDown(e){switch(e.key){case"Escape":if(document.body.classList.contains("show-toc"))return o.publish("toggleTableOfContents",{show:!1})}}animate(e){if(this.openIconRef.current){const t=i.findDOMNode(this.openIconRef.current);a.remove(t),a({targets:t,opacity:e?1:0,scale:e?1:.5,elasticity:50,duration:500})}if(this.closedIconRef.current){const t=i.findDOMNode(this.closedIconRef.current);a.remove(t),a({targets:t,opacity:e?0:1,scale:e?.5:1,elasticity:50,duration:500})}}onToggleTableOfContentsMessage(e){this.animate(e.show),document.body.classList.toggle("show-toc")}handleClick(e){o.publish("toggleTableOfContents",{show:!document.body.classList.contains("show-toc")})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(3),a=n(25),o=n(42),s=n(4);t.SettingsPanel=class extends r.Component{render(){return r.createElement("div",{className:"components_lesson-viewer__toc-settings-panel"},r.createElement("div",{className:"components_lesson-viewer__toc-settings-panel-title"},s.translated("common:names.settings")),r.createElement("div",{className:"components_lesson-viewer__toc-settings-section"},r.createElement("h4",null,s.translated("common:settings.audioQuality")),r.createElement("div",{className:"components_lesson-viewer__toc-settings-row"},r.createElement("span",{className:i("components_lesson-viewer__toc-setting-choice",{"components_lesson-viewer__toc-setting-choice--selected":"low"===a.getAudioQualitySetting()}),onClick:()=>{a.setAudioQualitySetting("low")}},s.translated("common:settings.low")),r.createElement("span",{className:i("components_lesson-viewer__toc-setting-choice",{"components_lesson-viewer__toc-setting-choice--selected":"medium"===a.getAudioQualitySetting()}),onClick:()=>{a.setAudioQualitySetting("medium")}},s.translated("common:settings.medium")),r.createElement("span",{className:i("components_lesson-viewer__toc-setting-choice",{"components_lesson-viewer__toc-setting-choice--selected":"high"===a.getAudioQualitySetting()}),onClick:()=>{a.setAudioQualitySetting("high")}},s.translated("common:settings.high"))),r.createElement("p",{className:"components_lesson-viewer__toc-setting-caption"},s.translated("common:settings.audioQualityInfo"))),r.createElement("div",{className:"components_lesson-viewer__toc-settings-section"},r.createElement("h4",null,s.translated("common:settings.midiInput")),o.isWebMidiAvailable()&&r.createElement("div",{className:"components_lesson-viewer__toc-settings-row"},r.createElement("span",{className:i("components_lesson-viewer__toc-setting-choice",{"components_lesson-viewer__toc-setting-choice--selected":"all"===a.getMIDIInputSetting()}),onClick:()=>{a.setMIDIInputSetting("all")}},s.translated("common:settings.on")),r.createElement("span",{className:i("components_lesson-viewer__toc-setting-choice",{"components_lesson-viewer__toc-setting-choice--selected":"none"===a.getMIDIInputSetting()}),onClick:()=>{a.setMIDIInputSetting("none")}},s.translated("common:settings.off"))),!o.isWebMidiAvailable()&&r.createElement("div",{className:"components_lesson-viewer__toc-settings-row"},r.createElement("p",{className:"components_lesson-viewer__toc-setting-caption"},s.translated("common:settings.midiInputUnavailable")))))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(34);t.LessonScrollHelper=class{constructor(){this.onResize=this.onResize.bind(this),this.debouncedResize=r.debounce(this.onResize,200)}start(){this.measureScrollbars(),window.addEventListener("resize",this.debouncedResize)}stop(){window.removeEventListener("resize",this.debouncedResize)}onResize(){this.measureScrollbars()}measureScrollbars(){const e=document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.position="absolute",e.style.top="-100000px",e.style.overflow="scroll",document.body.appendChild(e);const t=e.offsetWidth-e.clientWidth;document.body.removeChild(e);const n=document.documentElement;n&&n.style.setProperty("--scrollbar-width",t+"px")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(32),a=n(76),o=n(17),s=n(98),c=n(65),l=n(16),u=n(4);t.SynthesisPlaygroundPage=class extends r.Component{render(){return r.createElement(r.Fragment,null,r.createElement(i.Helmet,{title:"Synthesis Playground"}),r.createElement(c.ScrollIntoView,{id:void 0}),r.createElement("div",{className:"components_lesson-viewer__header"},r.createElement("div",{className:"components_lesson-viewer__header-content"},r.createElement("a",{href:"https://www.ableton.com",className:"components_lesson-viewer__header-content-logo"},r.createElement(o.AbletonLogo,null)),r.createElement("div",{className:"components_lesson-viewer__header-content-title"},r.createElement("a",{href:"javascript:void(0)",onClick:()=>{l.publish("toggleTableOfContents",{show:!0})}},r.createElement("span",{className:"components_lesson-viewer__header-content-title-primary"},u.translated("common:names.learning-synths")),r.createElement("span",{className:"components_lesson-viewer__header-content-title-secondary"}," ",u.translated("common:names.playground")))))),r.createElement(a.SubtractiveSynthComponent,null),r.createElement(s.BrandFooter,null))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),i=n(4);t.UnmuteIPhoneReminder=class extends r.Component{render(){return r.createElement("div",{id:"unmute-iphone-modal"},r.createElement("svg",{id:"unmute-iphone-modal__ableton-logo",viewBox:"0 0 45 21"},r.createElement("rect",{width:"3",height:"21"}),r.createElement("rect",{x:"6",width:"3",height:"21"}),r.createElement("rect",{x:"12",width:"3",height:"21"}),r.createElement("rect",{x:"18",width:"3",height:"21"}),r.createElement("rect",{x:"24",y:"18",width:"21",height:"3"}),r.createElement("rect",{x:"24",y:"12",width:"21",height:"3"}),r.createElement("rect",{x:"24",y:"6",width:"21",height:"3"}),r.createElement("rect",{x:"24",width:"21",height:"3"})),r.createElement("div",{id:"unmute-iphone-modal__content"},r.createElement("div",{id:"unmute-iphone-modal__content-primary"},r.createElement("div",{id:"unmute-iphone-modal__message"},i.translated("common:unmute-screen:message")),r.createElement("div",{id:"unmute-iphone-modal__audio-waves"},r.createElement("svg",{viewBox:"0 0 51 32"},r.createElement("path",{id:"unmute-iphone-modal__audio-waves-w1-off",d:"M14,29 C16.4,25.4 20.6,22.8 25.2,22.8 C30,22.8 34,25.2 36.4,29"}),r.createElement("path",{id:"unmute-iphone-modal__audio-waves-w1-on",d:"M14,29 C16.4,25.4 20.6,22.8 25.2,22.8 C30,22.8 34,25.2 36.4,29"}),r.createElement("path",{id:"unmute-iphone-modal__audio-waves-w2-off",d:"M8.4,20.6 C12.6,16 18.6,13 25.2,13 C32,13 38,16 42,20.6"}),r.createElement("path",{id:"unmute-iphone-modal__audio-waves-w2-on",d:"M8.4,20.6 C12.6,16 18.6,13 25.2,13 C32,13 38,16 42,20.6"}),r.createElement("path",{id:"unmute-iphone-modal__audio-waves-w3-off",d:"M3,12.2 C8.6,6.6 16.6,3 25.2,3 C34,3 41.8,6.6 47.6,12.4"}),r.createElement("path",{id:"unmute-iphone-modal__audio-waves-w3-on",d:"M3,12.2 C8.6,6.6 16.6,3 25.2,3 C34,3 41.8,6.6 47.6,12.4"}))),r.createElement("div",{id:"unmute-iphone-modal__phone"},r.createElement("div",{id:"unmute-iphone-modal__phone-case"}),r.createElement("div",{id:"unmute-iphone-modal__phone-antenna-line"}),r.createElement("div",{id:"unmute-iphone-modal__phone-ringer-well"},r.createElement("div",{id:"unmute-iphone-modal__phone-ringer-well-on-indicator"})),r.createElement("div",{id:"unmute-iphone-modal__phone-ringer-switch"}),r.createElement("div",{id:"unmute-iphone-modal__phone-volume-up"}),r.createElement("div",{id:"unmute-iphone-modal__phone-volume-down"})),r.createElement("div",{id:"unmute-iphone-modal__arrow"},r.createElement("svg",{viewBox:"0 0 30 34"},r.createElement("polygon",{points:"15 0 30 14 30 18.75 17 7 17 34 13 34 13 7 0 18.75 0 14"})))),r.createElement("div",{id:"unmute-iphone-modal__content-secondary"},r.createElement("div",{id:"unmute-iphone-modal__button"},r.createElement("button",{onClick:()=>{this.props.onUnmute()}},i.translated("common:unmute-screen:button"))))))}}},function(e,t,n){"use strict";n.r(t);var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var i={type:"logger",log:function(e){this.output("log",e)},warn:function(e){this.output("warn",e)},error:function(e){this.output("error",e)},output:function(e,t){var n;console&&console[e]&&(n=console)[e].apply(n,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(t))}},a=new(function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init(t,n)}return e.prototype.init=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.prefix=t.prefix||"i18next:",this.logger=e||i,this.options=t,this.debug=t.debug},e.prototype.setDebug=function(e){this.debug=e},e.prototype.log=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"log","",!0)},e.prototype.warn=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"warn","",!0)},e.prototype.error=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"error","")},e.prototype.deprecate=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"warn","WARNING DEPRECATED: ",!0)},e.prototype.forward=function(e,t,n,r){return r&&!this.debug?null:("string"==typeof e[0]&&(e[0]=""+n+this.prefix+" "+e[0]),this.logger[t](e))},e.prototype.create=function(t){return new e(this.logger,r({prefix:this.prefix+":"+t+":"},this.options))},e}());var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observers={}}return e.prototype.on=function(e,t){var n=this;return e.split(" ").forEach(function(e){n.observers[e]=n.observers[e]||[],n.observers[e].push(t)}),this},e.prototype.off=function(e,t){var n=this;this.observers[e]&&this.observers[e].forEach(function(){if(t){var r=n.observers[e].indexOf(t);r>-1&&n.observers[e].splice(r,1)}else delete n.observers[e]})},e.prototype.emit=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(this.observers[e]){var i=[].concat(this.observers[e]);i.forEach(function(e){e.apply(void 0,n)})}if(this.observers["*"]){var a=[].concat(this.observers["*"]);a.forEach(function(t){t.apply(t,[e].concat(n))})}},e}();function s(e){return null==e?"":""+e}function c(e,t,n){function r(e){return e&&e.indexOf("###")>-1?e.replace(/###/g,"."):e}function i(){return!e||"string"==typeof e}for(var a="string"!=typeof t?[].concat(t):t.split(".");a.length>1;){if(i())return{};var o=r(a.shift());!e[o]&&n&&(e[o]=new n),e=e[o]}return i()?{}:{obj:e,k:r(a.shift())}}function l(e,t,n){var r=c(e,t,Object);r.obj[r.k]=n}function u(e,t){var n=c(e,t),r=n.obj,i=n.k;if(r)return r[i]}function h(e,t,n){for(var r in t)r in e?"string"==typeof e[r]||e[r]instanceof String||"string"==typeof t[r]||t[r]instanceof String?n&&(e[r]=t[r]):h(e[r],t[r],n):e[r]=t[r];return e}function p(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var d={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function f(e){return"string"==typeof e?e.replace(/[&<>"'\/]/g,function(e){return d[e]}):e}var m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function g(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):function(e,t){for(var n=Object.getOwnPropertyNames(t),r=0;r<n.length;r++){var i=n[r],a=Object.getOwnPropertyDescriptor(t,i);a&&a.configurable&&void 0===e[i]&&Object.defineProperty(e,i,a)}}(e,t))}var v=function(e){function t(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this));return i.data=n||{},i.options=r,void 0===i.options.keySeparator&&(i.options.keySeparator="."),i}return g(t,e),t.prototype.addNamespaces=function(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)},t.prototype.removeNamespaces=function(e){var t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)},t.prototype.getResource=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=void 0!==r.keySeparator?r.keySeparator:this.options.keySeparator,a=[e,t];return n&&"string"!=typeof n&&(a=a.concat(n)),n&&"string"==typeof n&&(a=a.concat(i?n.split(i):n)),e.indexOf(".")>-1&&(a=e.split(".")),u(this.data,a)},t.prototype.addResource=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{silent:!1},a=this.options.keySeparator;void 0===a&&(a=".");var o=[e,t];n&&(o=o.concat(a?n.split(a):n)),e.indexOf(".")>-1&&(r=t,t=(o=e.split("."))[1]),this.addNamespaces(t),l(this.data,o,r),i.silent||this.emit("added",e,t,n,r)},t.prototype.addResources=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(var i in n)"string"==typeof n[i]&&this.addResource(e,t,i,n[i],{silent:!0});r.silent||this.emit("added",e,t,n)},t.prototype.addResourceBundle=function(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{silent:!1},o=[e,t];e.indexOf(".")>-1&&(r=n,n=t,t=(o=e.split("."))[1]),this.addNamespaces(t);var s=u(this.data,o)||{};r?h(s,n,i):s=m({},s,n),l(this.data,o,s),a.silent||this.emit("added",e,t,n)},t.prototype.removeResourceBundle=function(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)},t.prototype.hasResourceBundle=function(e,t){return void 0!==this.getResource(e,t)},t.prototype.getResourceBundle=function(e,t){return t||(t=this.options.defaultNS),"v1"===this.options.compatibilityAPI?m({},this.getResource(e,t)):this.getResource(e,t)},t.prototype.getDataByLanguage=function(e){return this.data[e]},t.prototype.toJSON=function(){return this.data},t}(o),y={processors:{},addPostProcessor:function(e){this.processors[e.name]=e},handle:function(e,t,n,r,i){var a=this;return e.forEach(function(e){a.processors[e]&&(t=a.processors[e].process(t,n,r,i))}),t}},b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function w(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):function(e,t){for(var n=Object.getOwnPropertyNames(t),r=0;r<n.length;r++){var i=n[r],a=Object.getOwnPropertyDescriptor(t,i);a&&a.configurable&&void 0===e[i]&&Object.defineProperty(e,i,a)}}(e,t))}var x=function(e){function t(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this));return function(e,t,n){e.forEach(function(e){t[e]&&(n[e]=t[e])})}(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat"],n,i),i.options=r,void 0===i.options.keySeparator&&(i.options.keySeparator="."),i.logger=a.create("translator"),i}return w(t,e),t.prototype.changeLanguage=function(e){e&&(this.language=e)},t.prototype.exists=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}},n=this.resolve(e,t);return n&&void 0!==n.res},t.prototype.extractFromKey=function(e,t){var n=t.nsSeparator||this.options.nsSeparator;void 0===n&&(n=":");var r=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator,i=t.ns||this.options.defaultNS;if(n&&e.indexOf(n)>-1){var a=e.split(n);(n!==r||n===r&&this.options.ns.indexOf(a[0])>-1)&&(i=a.shift()),e=a.join(r)}return"string"==typeof i&&(i=[i]),{key:e,namespaces:i}},t.prototype.translate=function(e,t){var n=this;if("object"!==(void 0===t?"undefined":_(t))&&this.options.overloadTranslationOptionHandler&&(t=this.options.overloadTranslationOptionHandler(arguments)),t||(t={}),null==e||""===e)return"";"number"==typeof e&&(e=String(e)),"string"==typeof e&&(e=[e]);var r=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator,i=this.extractFromKey(e[e.length-1],t),a=i.key,o=i.namespaces,s=o[o.length-1],c=t.lng||this.language,l=t.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(c&&"cimode"===c.toLowerCase()){if(l){var u=t.nsSeparator||this.options.nsSeparator;return s+u+a}return a}var h=this.resolve(e,t),p=h&&h.res,d=h&&h.usedKey||a,f=Object.prototype.toString.apply(p),m=["[object Number]","[object Function]","[object RegExp]"],g=void 0!==t.joinArrays?t.joinArrays:this.options.joinArrays,v=!this.i18nFormat||this.i18nFormat.handleAsObject,y="string"!=typeof p&&"boolean"!=typeof p&&"number"!=typeof p;if(v&&p&&y&&m.indexOf(f)<0&&(!g||"[object Array]"!==f)){if(!t.returnObjects&&!this.options.returnObjects)return this.logger.warn("accessing an object - but returnObjects options is not enabled!"),this.options.returnedObjectHandler?this.options.returnedObjectHandler(d,p,t):"key '"+a+" ("+this.language+")' returned an object instead of string.";if(r){var w="[object Array]"===f?[]:{};for(var x in p)if(Object.prototype.hasOwnProperty.call(p,x)){var E=""+d+r+x;w[x]=this.translate(E,b({},t,{joinArrays:!1,ns:o})),w[x]===E&&(w[x]=p[x])}p=w}}else if(v&&g&&"[object Array]"===f)(p=p.join(g))&&(p=this.extendTranslation(p,e,t));else{var M=!1,S=!1;if(!this.isValidLookup(p)&&void 0!==t.defaultValue){if(M=!0,void 0!==t.count){var T=this.pluralResolver.getSuffix(c,t.count);p=t["defaultValue"+T]}p||(p=t.defaultValue)}this.isValidLookup(p)||(S=!0,p=a);var P=t.defaultValue&&t.defaultValue!==p&&this.options.updateMissing;if(S||M||P){this.logger.log(P?"updateKey":"missingKey",c,s,a,P?t.defaultValue:p);var A=[],O=this.languageUtils.getFallbackCodes(this.options.fallbackLng,t.lng||this.language);if("fallback"===this.options.saveMissingTo&&O&&O[0])for(var C=0;C<O.length;C++)A.push(O[C]);else"all"===this.options.saveMissingTo?A=this.languageUtils.toResolveHierarchy(t.lng||this.language):A.push(t.lng||this.language);var R=function(e,r){n.options.missingKeyHandler?n.options.missingKeyHandler(e,s,r,P?t.defaultValue:p,P,t):n.backendConnector&&n.backendConnector.saveMissing&&n.backendConnector.saveMissing(e,s,r,P?t.defaultValue:p,P,t),n.emit("missingKey",e,s,r,p)};if(this.options.saveMissing){var L=void 0!==t.count&&"string"!=typeof t.count;this.options.saveMissingPlurals&&L?A.forEach(function(e){n.pluralResolver.getPluralFormsOfKey(e,a).forEach(function(t){return R([e],t)})}):R(A,a)}}p=this.extendTranslation(p,e,t,h),S&&p===a&&this.options.appendNamespaceToMissingKey&&(p=s+":"+a),S&&this.options.parseMissingKeyHandler&&(p=this.options.parseMissingKeyHandler(p))}return p},t.prototype.extendTranslation=function(e,t,n,r){var i=this;if(this.i18nFormat&&this.i18nFormat.parse)e=this.i18nFormat.parse(e,n,r.usedLng,r.usedNS,r.usedKey,{resolved:r});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init(b({},n,{interpolation:b({},this.options.interpolation,n.interpolation)}));var a=n.replace&&"string"!=typeof n.replace?n.replace:n;this.options.interpolation.defaultVariables&&(a=b({},this.options.interpolation.defaultVariables,a)),e=this.interpolator.interpolate(e,a,n.lng||this.language,n),!1!==n.nest&&(e=this.interpolator.nest(e,function(){return i.translate.apply(i,arguments)},n)),n.interpolation&&this.interpolator.reset()}var o=n.postProcess||this.options.postProcess,s="string"==typeof o?[o]:o;return null!=e&&s&&s.length&&!1!==n.applyPostProcessor&&(e=y.handle(s,e,t,n,this)),e},t.prototype.resolve=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=void 0,i=void 0,a=void 0,o=void 0;return"string"==typeof e&&(e=[e]),e.forEach(function(e){if(!t.isValidLookup(r)){var s=t.extractFromKey(e,n),c=s.key;i=c;var l=s.namespaces;t.options.fallbackNS&&(l=l.concat(t.options.fallbackNS));var u=void 0!==n.count&&"string"!=typeof n.count,h=void 0!==n.context&&"string"==typeof n.context&&""!==n.context,p=n.lngs?n.lngs:t.languageUtils.toResolveHierarchy(n.lng||t.language,n.fallbackLng);l.forEach(function(e){t.isValidLookup(r)||(o=e,p.forEach(function(i){if(!t.isValidLookup(r)){a=i;var o=c,s=[o];if(t.i18nFormat&&t.i18nFormat.addLookupKeys)t.i18nFormat.addLookupKeys(s,c,i,e,n);else{var l=void 0;u&&(l=t.pluralResolver.getSuffix(i,n.count)),u&&h&&s.push(o+l),h&&s.push(o+=""+t.options.contextSeparator+n.context),u&&s.push(o+=l)}for(var p=void 0;p=s.pop();)t.isValidLookup(r)||(r=t.getResource(i,e,p,n))}}))})}}),{res:r,usedKey:i,usedLng:a,usedNS:o}},t.prototype.isValidLookup=function(e){return!(void 0===e||!this.options.returnNull&&null===e||!this.options.returnEmptyString&&""===e)},t.prototype.getResource=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(e,t,n,r):this.resourceStore.getResource(e,t,n,r)},t}(o);function E(e){return e.charAt(0).toUpperCase()+e.slice(1)}var M=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t,this.whitelist=this.options.whitelist||!1,this.logger=a.create("languageUtils")}return e.prototype.getScriptPartFromCode=function(e){if(!e||e.indexOf("-")<0)return null;var t=e.split("-");return 2===t.length?null:(t.pop(),this.formatLanguageCode(t.join("-")))},e.prototype.getLanguagePartFromCode=function(e){if(!e||e.indexOf("-")<0)return e;var t=e.split("-");return this.formatLanguageCode(t[0])},e.prototype.formatLanguageCode=function(e){if("string"==typeof e&&e.indexOf("-")>-1){var t=["hans","hant","latn","cyrl","cans","mong","arab"],n=e.split("-");return this.options.lowerCaseLng?n=n.map(function(e){return e.toLowerCase()}):2===n.length?(n[0]=n[0].toLowerCase(),n[1]=n[1].toUpperCase(),t.indexOf(n[1].toLowerCase())>-1&&(n[1]=E(n[1].toLowerCase()))):3===n.length&&(n[0]=n[0].toLowerCase(),2===n[1].length&&(n[1]=n[1].toUpperCase()),"sgn"!==n[0]&&2===n[2].length&&(n[2]=n[2].toUpperCase()),t.indexOf(n[1].toLowerCase())>-1&&(n[1]=E(n[1].toLowerCase())),t.indexOf(n[2].toLowerCase())>-1&&(n[2]=E(n[2].toLowerCase()))),n.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e},e.prototype.isWhitelisted=function(e){return("languageOnly"===this.options.load||this.options.nonExplicitWhitelist)&&(e=this.getLanguagePartFromCode(e)),!this.whitelist||!this.whitelist.length||this.whitelist.indexOf(e)>-1},e.prototype.getFallbackCodes=function(e,t){if(!e)return[];if("string"==typeof e&&(e=[e]),"[object Array]"===Object.prototype.toString.apply(e))return e;if(!t)return e.default||[];var n=e[t];return n||(n=e[this.getScriptPartFromCode(t)]),n||(n=e[this.formatLanguageCode(t)]),n||(n=e.default),n||[]},e.prototype.toResolveHierarchy=function(e,t){var n=this,r=this.getFallbackCodes(t||this.options.fallbackLng||[],e),i=[],a=function(e){e&&(n.isWhitelisted(e)?i.push(e):n.logger.warn("rejecting non-whitelisted language code: "+e))};return"string"==typeof e&&e.indexOf("-")>-1?("languageOnly"!==this.options.load&&a(this.formatLanguageCode(e)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&a(this.getScriptPartFromCode(e)),"currentOnly"!==this.options.load&&a(this.getLanguagePartFromCode(e))):"string"==typeof e&&a(this.formatLanguageCode(e)),r.forEach(function(e){i.indexOf(e)<0&&a(n.formatLanguageCode(e))}),i},e}();var S=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","id","ja","jbo","ka","kk","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he"],nr:[1,2,20,21],fc:22}],T={1:function(e){return Number(e>1)},2:function(e){return Number(1!=e)},3:function(e){return 0},4:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},5:function(e){return Number(0===e?0:1==e?1:2==e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5)},6:function(e){return Number(1==e?0:e>=2&&e<=4?1:2)},7:function(e){return Number(1==e?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},8:function(e){return Number(1==e?0:2==e?1:8!=e&&11!=e?2:3)},9:function(e){return Number(e>=2)},10:function(e){return Number(1==e?0:2==e?1:e<7?2:e<11?3:4)},11:function(e){return Number(1==e||11==e?0:2==e||12==e?1:e>2&&e<20?2:3)},12:function(e){return Number(e%10!=1||e%100==11)},13:function(e){return Number(0!==e)},14:function(e){return Number(1==e?0:2==e?1:3==e?2:3)},15:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&(e%100<10||e%100>=20)?1:2)},16:function(e){return Number(e%10==1&&e%100!=11?0:0!==e?1:2)},17:function(e){return Number(1==e||e%10==1?0:1)},18:function(e){return Number(0==e?0:1==e?1:2)},19:function(e){return Number(1==e?0:0===e||e%100>1&&e%100<11?1:e%100>10&&e%100<20?2:3)},20:function(e){return Number(1==e?0:0===e||e%100>0&&e%100<20?1:2)},21:function(e){return Number(e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0)},22:function(e){return Number(1===e?0:2===e?1:(e<0||e>10)&&e%10==0?2:3)}};var P=function(){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.languageUtils=t,this.options=r,this.logger=a.create("pluralResolver"),this.rules=(n={},S.forEach(function(e){e.lngs.forEach(function(t){n[t]={numbers:e.nr,plurals:T[e.fc]}})}),n)}return e.prototype.addRule=function(e,t){this.rules[e]=t},e.prototype.getRule=function(e){return this.rules[e]||this.rules[this.languageUtils.getLanguagePartFromCode(e)]},e.prototype.needsPlural=function(e){var t=this.getRule(e);return t&&t.numbers.length>1},e.prototype.getPluralFormsOfKey=function(e,t){var n=this,r=[],i=this.getRule(e);return i?(i.numbers.forEach(function(i){var a=n.getSuffix(e,i);r.push(""+t+a)}),r):r},e.prototype.getSuffix=function(e,t){var n=this,r=this.getRule(e);if(r){var i=r.noAbs?r.plurals(t):r.plurals(Math.abs(t)),a=r.numbers[i];this.options.simplifyPluralSuffix&&2===r.numbers.length&&1===r.numbers[0]&&(2===a?a="plural":1===a&&(a=""));var o=function(){return n.options.prepend&&a.toString()?n.options.prepend+a.toString():a.toString()};return"v1"===this.options.compatibilityJSON?1===a?"":"number"==typeof a?"_plural_"+a.toString():o():"v2"===this.options.compatibilityJSON&&2===r.numbers.length&&1===r.numbers[0]?o():this.options.simplifyPluralSuffix&&2===r.numbers.length&&1===r.numbers[0]?o():this.options.prepend&&i.toString()?this.options.prepend+i.toString():i.toString()}return this.logger.warn("no plural rule found for: "+e),""},e}(),A=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var O=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.logger=a.create("interpolator"),this.init(t,!0)}return e.prototype.init=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];t&&(this.options=e,this.format=e.interpolation&&e.interpolation.format||function(e){return e}),e.interpolation||(e.interpolation={escapeValue:!0});var n=e.interpolation;this.escape=void 0!==n.escape?n.escape:f,this.escapeValue=void 0===n.escapeValue||n.escapeValue,this.useRawValueToEscape=void 0!==n.useRawValueToEscape&&n.useRawValueToEscape,this.prefix=n.prefix?p(n.prefix):n.prefixEscaped||"{{",this.suffix=n.suffix?p(n.suffix):n.suffixEscaped||"}}",this.formatSeparator=n.formatSeparator?n.formatSeparator:n.formatSeparator||",",this.unescapePrefix=n.unescapeSuffix?"":n.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":n.unescapeSuffix||"",this.nestingPrefix=n.nestingPrefix?p(n.nestingPrefix):n.nestingPrefixEscaped||p("$t("),this.nestingSuffix=n.nestingSuffix?p(n.nestingSuffix):n.nestingSuffixEscaped||p(")"),this.maxReplaces=n.maxReplaces?n.maxReplaces:1e3,this.resetRegExp()},e.prototype.reset=function(){this.options&&this.init(this.options)},e.prototype.resetRegExp=function(){var e=this.prefix+"(.+?)"+this.suffix;this.regexp=new RegExp(e,"g");var t=""+this.prefix+this.unescapePrefix+"(.+?)"+this.unescapeSuffix+this.suffix;this.regexpUnescape=new RegExp(t,"g");var n=this.nestingPrefix+"(.+?)"+this.nestingSuffix;this.nestingRegexp=new RegExp(n,"g")},e.prototype.interpolate=function(e,t,n,r){var i=this,a=void 0,o=void 0,c=void 0;function l(e){return e.replace(/\$/g,"$$$$")}var h=function(e){if(e.indexOf(i.formatSeparator)<0)return u(t,e);var r=e.split(i.formatSeparator),a=r.shift().trim(),o=r.join(i.formatSeparator).trim();return i.format(u(t,a),o,n)};this.resetRegExp();var p=r&&r.missingInterpolationHandler||this.options.missingInterpolationHandler;for(c=0;(a=this.regexpUnescape.exec(e))&&(o=h(a[1].trim()),e=e.replace(a[0],o),this.regexpUnescape.lastIndex=0,!(++c>=this.maxReplaces)););for(c=0;a=this.regexp.exec(e);){if(void 0===(o=h(a[1].trim())))if("function"==typeof p){var d=p(e,a);o="string"==typeof d?d:""}else this.logger.warn("missed to pass in variable "+a[1]+" for interpolating "+e),o="";else"string"==typeof o||this.useRawValueToEscape||(o=s(o));if(o=this.escapeValue?l(this.escape(o)):l(o),e=e.replace(a[0],o),this.regexp.lastIndex=0,++c>=this.maxReplaces)break}return e},e.prototype.nest=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=void 0,i=void 0,a=A({},n);function o(e,t){if(e.indexOf(",")<0)return e;var n=e.split(",");e=n.shift();var r=n.join(",");r=(r=this.interpolate(r,a)).replace(/'/g,'"');try{a=JSON.parse(r),t&&(a=A({},t,a))}catch(t){this.logger.error("failed parsing options string in nesting for key "+e,t)}return e}for(a.applyPostProcessor=!1;r=this.nestingRegexp.exec(e);){if((i=t(o.call(this,r[1].trim(),a),a))&&r[0]===e&&"string"!=typeof i)return i;"string"!=typeof i&&(i=s(i)),i||(this.logger.warn("missed to resolve "+r[1]+" for nesting "+e),i=""),e=e.replace(r[0],i),this.regexp.lastIndex=0}return e},e}(),C=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},R=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};function L(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):function(e,t){for(var n=Object.getOwnPropertyNames(t),r=0;r<n.length;r++){var i=n[r],a=Object.getOwnPropertyDescriptor(t,i);a&&a.configurable&&void 0===e[i]&&Object.defineProperty(e,i,a)}}(e,t))}var I=function(e){function t(n,r,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var s=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this));return s.backend=n,s.store=r,s.languageUtils=i.languageUtils,s.options=o,s.logger=a.create("backendConnector"),s.state={},s.queue=[],s.backend&&s.backend.init&&s.backend.init(i,o.backend,o),s}return L(t,e),t.prototype.queueLoad=function(e,t,n,r){var i=this,a=[],o=[],s=[],c=[];return e.forEach(function(e){var r=!0;t.forEach(function(t){var s=e+"|"+t;!n.reload&&i.store.hasResourceBundle(e,t)?i.state[s]=2:i.state[s]<0||(1===i.state[s]?o.indexOf(s)<0&&o.push(s):(i.state[s]=1,r=!1,o.indexOf(s)<0&&o.push(s),a.indexOf(s)<0&&a.push(s),c.indexOf(t)<0&&c.push(t)))}),r||s.push(e)}),(a.length||o.length)&&this.queue.push({pending:o,loaded:{},errors:[],callback:r}),{toLoad:a,pending:o,toLoadLanguages:s,toLoadNamespaces:c}},t.prototype.loaded=function(e,t,n){var r=e.split("|"),i=R(r,2),a=i[0],o=i[1];t&&this.emit("failedLoading",a,o,t),n&&this.store.addResourceBundle(a,o,n),this.state[e]=t?-1:2;var s={};this.queue.forEach(function(n){var r,i,l,u,h,p;r=n.loaded,i=o,u=c(r,[a],Object),h=u.obj,p=u.k,h[p]=h[p]||[],l&&(h[p]=h[p].concat(i)),l||h[p].push(i),function(e,t){for(var n=e.indexOf(t);-1!==n;)e.splice(n,1),n=e.indexOf(t)}(n.pending,e),t&&n.errors.push(t),0!==n.pending.length||n.done||(Object.keys(n.loaded).forEach(function(e){s[e]||(s[e]=[]),n.loaded[e].length&&n.loaded[e].forEach(function(t){s[e].indexOf(t)<0&&s[e].push(t)})}),n.done=!0,n.errors.length?n.callback(n.errors):n.callback())}),this.emit("loaded",s),this.queue=this.queue.filter(function(e){return!e.done})},t.prototype.read=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=this,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:250,o=arguments[5];return e.length?this.backend[n](e,t,function(s,c){s&&c&&r<5?setTimeout(function(){i.read.call(i,e,t,n,r+1,2*a,o)},a):o(s,c)}):o(null,{})},t.prototype.prepareLoading=function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments[3];if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),i&&i();"string"==typeof e&&(e=this.languageUtils.toResolveHierarchy(e)),"string"==typeof t&&(t=[t]);var a=this.queueLoad(e,t,r,i);if(!a.toLoad.length)return a.pending.length||i(),null;a.toLoad.forEach(function(e){n.loadOne(e)})},t.prototype.load=function(e,t,n){this.prepareLoading(e,t,{},n)},t.prototype.reload=function(e,t,n){this.prepareLoading(e,t,{reload:!0},n)},t.prototype.loadOne=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=e.split("|"),i=R(r,2),a=i[0],o=i[1];this.read(a,o,"read",null,null,function(r,i){r&&t.logger.warn(n+"loading namespace "+o+" for language "+a+" failed",r),!r&&i&&t.logger.log(n+"loaded namespace "+o+" for language "+a,i),t.loaded(e,r,i)})},t.prototype.saveMissing=function(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};this.backend&&this.backend.create&&this.backend.create(e,t,n,r,null,C({},a,{isUpdate:i})),e&&e[0]&&this.store.addResource(e[0],t,n,r)},t}(o);function k(e){return"string"==typeof e.ns&&(e.ns=[e.ns]),"string"==typeof e.fallbackLng&&(e.fallbackLng=[e.fallbackLng]),"string"==typeof e.fallbackNS&&(e.fallbackNS=[e.fallbackNS]),e.whitelist&&e.whitelist.indexOf("cimode")<0&&(e.whitelist=e.whitelist.concat(["cimode"])),e}var N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function D(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function B(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):function(e,t){for(var n=Object.getOwnPropertyNames(t),r=0;r<n.length;r++){var i=n[r],a=Object.getOwnPropertyDescriptor(t,i);a&&a.configurable&&void 0===e[i]&&Object.defineProperty(e,i,a)}}(e,t))}function j(){}var F=new(function(e){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments[1];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=D(this,e.call(this));if(i.options=k(n),i.services={},i.logger=a,i.modules={external:[]},r&&!i.isInitialized&&!n.isClone){var o;if(!i.options.initImmediate)return o=i.init(n,r),D(i,o);setTimeout(function(){i.init(n,r)},0)}return i}return B(t,e),t.prototype.init=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments[1];function r(e){return e?"function"==typeof e?new e:e:null}if("function"==typeof t&&(n=t,t={}),this.options=z({},{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,whitelist:!1,nonExplicitWhitelist:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,returnNull:!0,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:function(){},parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(e){var t={};return e[1]&&(t.defaultValue=e[1]),e[2]&&(t.tDescription=e[2]),t},interpolation:{escapeValue:!0,format:function(e,t,n){return e},prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",maxReplaces:1e3}},this.options,k(t)),this.format=this.options.interpolation.format,n||(n=j),!this.options.isClone){this.modules.logger?a.init(r(this.modules.logger),this.options):a.init(null,this.options);var i=new M(this.options);this.store=new v(this.options.resources,this.options);var o=this.services;o.logger=a,o.resourceStore=this.store,o.languageUtils=i,o.pluralResolver=new P(i,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),o.interpolator=new O(this.options),o.backendConnector=new I(r(this.modules.backend),o.resourceStore,o,this.options),o.backendConnector.on("*",function(t){for(var n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];e.emit.apply(e,[t].concat(r))}),this.modules.languageDetector&&(o.languageDetector=r(this.modules.languageDetector),o.languageDetector.init(o,this.options.detection,this.options)),this.modules.i18nFormat&&(o.i18nFormat=r(this.modules.i18nFormat),o.i18nFormat.init&&o.i18nFormat.init(this)),this.translator=new x(this.services,this.options),this.translator.on("*",function(t){for(var n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];e.emit.apply(e,[t].concat(r))}),this.modules.external.forEach(function(t){t.init&&t.init(e)})}var s=["getResource","addResource","addResources","addResourceBundle","removeResourceBundle","hasResourceBundle","getResourceBundle","getDataByLanguage"];s.forEach(function(t){e[t]=function(){var n;return(n=e.store)[t].apply(n,arguments)}});var c=function(){e.changeLanguage(e.options.lng,function(t,r){e.isInitialized=!0,e.logger.log("initialized",e.options),e.emit("initialized",e.options),n(t,r)})};return this.options.resources||!this.options.initImmediate?c():setTimeout(c,0),this},t.prototype.loadResources=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j;if(!this.options.resources||this.options.partialBundledLanguages){if(this.language&&"cimode"===this.language.toLowerCase())return t();var n=[],r=function(t){t&&e.services.languageUtils.toResolveHierarchy(t).forEach(function(e){n.indexOf(e)<0&&n.push(e)})};if(this.language)r(this.language);else{var i=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);i.forEach(function(e){return r(e)})}this.options.preload&&this.options.preload.forEach(function(e){return r(e)}),this.services.backendConnector.load(n,this.options.ns,t)}else t(null)},t.prototype.reloadResources=function(e,t,n){e||(e=this.languages),t||(t=this.options.ns),n||(n=function(){}),this.services.backendConnector.reload(e,t,n)},t.prototype.use=function(e){return"backend"===e.type&&(this.modules.backend=e),("logger"===e.type||e.log&&e.warn&&e.error)&&(this.modules.logger=e),"languageDetector"===e.type&&(this.modules.languageDetector=e),"i18nFormat"===e.type&&(this.modules.i18nFormat=e),"postProcessor"===e.type&&y.addPostProcessor(e),"3rdParty"===e.type&&this.modules.external.push(e),this},t.prototype.changeLanguage=function(e,t){var n=this,r=function(e){e&&(n.language=e,n.languages=n.services.languageUtils.toResolveHierarchy(e),n.translator.language||n.translator.changeLanguage(e),n.services.languageDetector&&n.services.languageDetector.cacheUserLanguage(e)),n.loadResources(function(r){!function(e,r){n.translator.changeLanguage(r),r&&(n.emit("languageChanged",r),n.logger.log("languageChanged",r)),t&&t(e,function(){return n.t.apply(n,arguments)})}(r,e)})};e||!this.services.languageDetector||this.services.languageDetector.async?!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect(r):r(e):r(this.services.languageDetector.detect())},t.prototype.getFixedT=function(e,t){var n=this,r=function e(t,r){for(var i=arguments.length,a=Array(i>2?i-2:0),o=2;o<i;o++)a[o-2]=arguments[o];var s=z({},r);return"object"!==(void 0===r?"undefined":N(r))&&(s=n.options.overloadTranslationOptionHandler([t,r].concat(a))),s.lng=s.lng||e.lng,s.lngs=s.lngs||e.lngs,s.ns=s.ns||e.ns,n.t(t,s)};return"string"==typeof e?r.lng=e:r.lngs=e,r.ns=t,r},t.prototype.t=function(){var e;return this.translator&&(e=this.translator).translate.apply(e,arguments)},t.prototype.exists=function(){var e;return this.translator&&(e=this.translator).exists.apply(e,arguments)},t.prototype.setDefaultNamespace=function(e){this.options.defaultNS=e},t.prototype.loadNamespaces=function(e,t){var n=this;if(!this.options.ns)return t&&t();"string"==typeof e&&(e=[e]),e.forEach(function(e){n.options.ns.indexOf(e)<0&&n.options.ns.push(e)}),this.loadResources(t)},t.prototype.loadLanguages=function(e,t){"string"==typeof e&&(e=[e]);var n=this.options.preload||[],r=e.filter(function(e){return n.indexOf(e)<0});if(!r.length)return t();this.options.preload=n.concat(r),this.loadResources(t)},t.prototype.dir=function(e){if(e||(e=this.languages&&this.languages.length>0?this.languages[0]:this.language),!e)return"rtl";return["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam"].indexOf(this.services.languageUtils.getLanguagePartFromCode(e))>=0?"rtl":"ltr"},t.prototype.createInstance=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments[1];return new t(e,n)},t.prototype.cloneInstance=function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:j,i=z({},this.options,n,{isClone:!0}),a=new t(i),o=["store","services","language"];return o.forEach(function(t){a[t]=e[t]}),a.translator=new x(a.services,a.options),a.translator.on("*",function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];a.emit.apply(a,[e].concat(n))}),a.init(i,r),a.translator.options=a.options,a},t}(o));n.d(t,"changeLanguage",function(){return U}),n.d(t,"cloneInstance",function(){return V}),n.d(t,"createInstance",function(){return H}),n.d(t,"dir",function(){return G}),n.d(t,"exists",function(){return W}),n.d(t,"getFixedT",function(){return q}),n.d(t,"init",function(){return X}),n.d(t,"loadLanguages",function(){return Y}),n.d(t,"loadNamespaces",function(){return K}),n.d(t,"loadResources",function(){return $}),n.d(t,"off",function(){return Z}),n.d(t,"on",function(){return J}),n.d(t,"setDefaultNamespace",function(){return Q}),n.d(t,"t",function(){return ee}),n.d(t,"use",function(){return te});t.default=F;var U=F.changeLanguage.bind(F),V=F.cloneInstance.bind(F),H=F.createInstance.bind(F),G=F.dir.bind(F),W=F.exists.bind(F),q=F.getFixedT.bind(F),X=F.init.bind(F),Y=F.loadLanguages.bind(F),K=F.loadNamespaces.bind(F),$=F.loadResources.bind(F),Z=F.off.bind(F),J=F.on.bind(F),Q=F.setDefaultNamespace.bind(F),ee=F.t.bind(F),te=F.use.bind(F)}]);